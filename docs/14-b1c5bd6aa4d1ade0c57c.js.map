{"version":3,"sources":["webpack:///./node_modules/plotly.js/src/plots/gl3d/project.js","webpack:///./node_modules/plotly.js/src/components/images/draw.js","webpack:///./node_modules/plotly.js/src/components/colorbar/index.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/draw.js","webpack:///./node_modules/core-js/internals/native-promise-constructor.js","webpack:///./node_modules/plotly.js/src/traces/scatter/get_trace_color.js","webpack:///./node_modules/plotly.js/src/snapshot/cloneplot.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/category_order_defaults.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/attributes.js","webpack:///./node_modules/plotly.js/src/components/images/attributes.js","webpack:///./node_modules/plotly.js/src/components/errorbars/calc.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/defaults.js","webpack:///./node_modules/plotly.js/src/components/annotations3d/convert.js","webpack:///./node_modules/plotly.js/src/components/sliders/constants.js","webpack:///./node_modules/plotly.js/src/snapshot/filesaver.js","webpack:///./node_modules/plotly.js/src/traces/scatter/text_defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/line_shape_defaults.js","webpack:///./node_modules/plotly.js/src/snapshot/toimage.js","webpack:///./node_modules/plotly.js/src/components/sliders/index.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/position_defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/marker_colorbar.js","webpack:///./node_modules/core-js/internals/new-promise-capability.js","webpack:///./node_modules/plotly.js/src/components/sliders/draw.js","webpack:///./node_modules/plotly.js/src/traces/scatter/plot.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/defaults.js","webpack:///./node_modules/plotly.js/src/components/annotations3d/draw.js","webpack:///./node_modules/plotly.js/src/traces/scatter/link_traces.js","webpack:///./node_modules/plotly.js/src/traces/scatter/cross_trace_defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/xy_defaults.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/transition_axes.js","webpack:///./node_modules/plotly.js/build/plotcss.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/index.js","webpack:///./node_modules/plotly.js/src/traces/scatter/colorscale_calc.js","webpack:///./node_modules/plotly.js/src/components/shapes/draw_newshape/defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/defaults.js","webpack:///./node_modules/es6-promise/dist/es6-promise.js","webpack:///./node_modules/plotly.js/src/traces/scatter/arrays_to_calcdata.js","webpack:///./node_modules/plotly.js/src/plots/polar/legacy/undo_manager.js","webpack:///./node_modules/plotly.js/src/components/annotations3d/attributes.js","webpack:///./node_modules/plotly.js/src/components/annotations/common_defaults.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/graph_interact.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/index.js","webpack:///./node_modules/plotly.js/src/locale-en-us.js","webpack:///./node_modules/plotly.js/src/locale-en.js","webpack:///./node_modules/plotly.js/src/plots/polar/legacy/micropolar_manager.js","webpack:///./node_modules/plotly.js/src/components/errorbars/defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/select.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/constants.js","webpack:///./node_modules/plotly.js/src/components/annotations/draw.js","webpack:///./node_modules/plotly.js/src/plot_api/template_api.js","webpack:///./node_modules/plotly.js/src/components/shapes/index.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/include_components.js","webpack:///./node_modules/plotly.js/src/components/annotations/click.js","webpack:///./node_modules/plotly.js/src/components/annotations/convert_coords.js","webpack:///./node_modules/plotly.js/src/traces/scatter/fillcolor_defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/hover.js","webpack:///./node_modules/plotly.js/src/plots/polar/legacy/micropolar.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/attributes.js","webpack:///./node_modules/plotly.js/src/plot_api/validate.js","webpack:///./node_modules/plotly.js/src/components/errorbars/compute_error.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/constants.js","webpack:///./node_modules/plotly.js/src/traces/scatter/calc_selection.js","webpack:///./node_modules/plotly.js/src/snapshot/helpers.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/attributes.js","webpack:///./node_modules/plotly.js/src/traces/scatter/cross_trace_calc.js","webpack:///./node_modules/plotly.js/src/plot_api/index.js","webpack:///./node_modules/plotly.js/src/components/images/defaults.js","webpack:///./node_modules/core-js/internals/species-constructor.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/helpers.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/calc_autorange.js","webpack:///./node_modules/plotly.js/src/snapshot/svgtoimg.js","webpack:///./node_modules/plotly.js/src/traces/scatter/marker_defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/style.js","webpack:///./node_modules/plotly.js/src/plots/polar/legacy/index.js","webpack:///./node_modules/plotly.js/src/components/errorbars/plot.js","webpack:///./node_modules/plotly.js/src/components/shapes/defaults.js","webpack:///./node_modules/plotly.js/src/version.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/oppaxis_attributes.js","webpack:///./node_modules/gl-mat4/fromQuat.js","webpack:///./node_modules/plotly.js/src/traces/scatter/line_defaults.js","webpack:///./node_modules/plotly.js/src/components/annotations/draw_arrow_head.js","webpack:///./node_modules/plotly.js/src/traces/scatter/index.js","webpack:///./node_modules/plotly.js/src/components/images/convert_coords.js","webpack:///./node_modules/plotly.js/src/traces/scatter/stack_defaults.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/defaults.js","webpack:///./node_modules/plotly.js/src/traces/scatter/calc.js","webpack:///./node_modules/plotly.js/src/components/annotations/index.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/axis_defaults.js","webpack:///./node_modules/plotly.js/src/components/sliders/defaults.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/line_grid_defaults.js","webpack:///./node_modules/plotly.js/src/fonts/mathjax_config.js","webpack:///./node_modules/plotly.js/src/components/grid/index.js","webpack:///./node_modules/plotly.js/src/components/images/index.js","webpack:///./node_modules/plotly.js/src/traces/scatter/format_labels.js","webpack:///./node_modules/plotly.js/src/components/errorbars/index.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/layout_defaults.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/draw.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/draw.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/scrollbox.js","webpack:///./node_modules/plotly.js/src/components/errorbars/attributes.js","webpack:///./node_modules/plotly.js/src/components/colorbar/draw.js","webpack:///./node_modules/plotly.js/src/components/rangeslider/attributes.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/index.js","webpack:///./node_modules/plotly.js/src/components/legend/index.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/dragbox.js","webpack:///./node_modules/plotly.js/src/components/sliders/attributes.js","webpack:///./node_modules/plotly.js/src/traces/scatter/line_points.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/get_update_object.js","webpack:///./node_modules/plotly.js/src/plot_api/to_image.js","webpack:///./node_modules/core-js/modules/es.promise.finally.js","webpack:///./node_modules/plotly.js/src/plot_api/container_array_match.js","webpack:///./node_modules/plotly.js/src/components/shapes/attributes.js","webpack:///./node_modules/plotly.js/src/components/annotations/arrow_paths.js","webpack:///./node_modules/plotly.js/src/components/colorbar/constants.js","webpack:///./node_modules/plotly.js/src/components/errorbars/style.js","webpack:///./node_modules/plotly.js/src/snapshot/download.js","webpack:///./node_modules/plotly.js/src/components/rangeselector/constants.js","webpack:///./node_modules/plotly.js/src/plot_api/manage_arrays.js","webpack:///./node_modules/plotly.js/src/plots/cartesian/type_defaults.js","webpack:///./node_modules/plotly.js/src/plot_api/plot_api.js","webpack:///./node_modules/plotly.js/src/components/annotations/attributes.js","webpack:///./node_modules/plotly.js/src/components/annotations/defaults.js","webpack:///./node_modules/plotly.js/lib/core.js","webpack:///./node_modules/plotly.js/src/plot_api/helpers.js","webpack:///./node_modules/plotly.js/src/core.js","webpack:///./node_modules/plotly.js/src/components/annotations3d/defaults.js","webpack:///./node_modules/plotly.js/src/lib/queue.js","webpack:///./node_modules/plotly.js/src/components/annotations3d/index.js","webpack:///./node_modules/plotly.js/src/snapshot/index.js","webpack:///./node_modules/plotly.js/src/snapshot/tosvg.js","webpack:///./node_modules/plotly.js/src/components/updatemenus/index.js","webpack:///./node_modules/plotly.js/src/components/annotations/calc_autorange.js","webpack:///./node_modules/core-js/internals/promise-resolve.js","webpack:///./node_modules/plotly.js/src/components/shapes/calc_autorange.js"],"names":["xformMatrix","m","v","i","j","out","module","exports","camera","projection","view","model","d3","Drawing","Axes","xmlnsNamespaces","gd","subplot","fullLayout","_fullLayout","imageDataAbove","imageDataSubplot","imageDataBelow","images","length","img","visible","layer","xref","yref","plotinfo","_plots","push","mainplot","id","anchors","left","sizing","offset","center","right","top","middle","bottom","setImage","d","thisImage","select","this","_imgSrc","source","attr","svg","slice","imagePromise","Promise","resolve","Image","errorHandler","remove","setAttribute","onerror","onload","canvas","document","createElement","width","height","getContext","drawImage","dataURL","toDataURL","on","src","bind","_promises","applyAttributes","xa","getFromId","ya","size","_size","Math","abs","l2p","sizex","w","sizey","h","xOffset","xanchor","yOffset","yanchor","xPos","r2p","x","_offset","l","yPos","y","t","preserveAspectRatio","opacity","clipAxes","_id","setClipUrl","_uid","imagesBelow","_imageLowerLayer","selectAll","data","imagesAbove","_imageUpperLayer","enter","append","exit","each","allSubplots","Object","keys","subplotObj","imagelayer","imagesOnSubplot","moduleType","name","attributes","supplyDefaults","draw","hasColorbar","Plots","Color","Lib","svgTextUtils","arrayEditor","LINE_SPACING","constants","ScrollBox","keyFunction","menuOpts","_index","isActive","gButton","menuIndexAttrName","setActive","buttonOpts","gHeader","scrollBox","buttonIndex","isSilentUpdate","active","layout","applyUpdate","type","drawButtons","drawHeader","header","ensureSingle","headerClassName","s","style","dims","_dims","headerOpts","buttons","blankHeaderOpts","posOpts","pad","yPad","xPad","index","positionOverrides","headerWidth","headerHeight","call","drawItem","setItemPosition","headerArrowClassName","classed","font","text","arrowSymbol","direction","arrowOffsetX","textOffsetY","removeAllButtons","String","styleOnMouseOver","styleOnMouseOut","setTranslate","lx","ly","buttonData","isFolded","klass","dropdownButtonClassName","buttonClassName","filterVisible","transition","x0","y0","isVertical","indexOf","gapButtonHeader","gapButton","openHeight","openWidth","scrollBoxPosition","borderwidth","button","event","defaultPrevented","execute","args2","executeAPICommand","method","args","emit","menu","styleButtons","max","position","translateX","translateY","heights","widths","enable","hbar","vbar","drawScrollBox","hasHBar","hasVBar","disable","hideScrollBox","item","itemOpts","drawItemRect","drawItemText","itemRectClassName","rx","ry","stroke","bordercolor","fill","bgcolor","itemTextClassName","tx","label","_meta","templateString","convertToTspans","showactive","activeColor","hoverColor","findDimensions","width1","height1","totalWidth","totalHeight","fakeButtons","tester","tWidth","node","bBox","wEff","textPadX","minWidth","tHeight","tLines","lineCount","hEff","minHeight","ceil","arrowPadX","paddedWidth","r","paddedHeight","b","graphSize","isRightAnchor","isCenterAnchor","isBottomAnchor","isMiddleAnchor","round","autoMargin","autoMarginId","autoMarginIdRoot","overrideOpts","rect","borderWidth","finalHeight","spanOffset","positionText","textOffsetX","newMenuIndexAttr","menuData","clearAutoMargin","menus","_menulayer","containerClassName","headerGroupClassName","headerGroups","dropdownButtonGroupClassName","scrollBoxId","parentNode","appendChild","_gButton","manageCommandObserver","global","subtypes","trace","di","lc","tc","mode","line","color","fillcolor","mc","mcc","marker","mlc","mlcc","mlw","addOpacity","hasLines","Registry","extendFlat","extendDeep","cloneLayoutOverride","tileClass","override","autosize","title","showlegend","margin","annotations","hidesources","graphObj","options","framework","isPolar","getConfig","keyName","oldData","oldLayout","newData","newLayout","context","_context","showscale","traceIs","textposition","Array","isArray","sceneIds","filter","key","match","axesImageOverride","showaxeslabels","showticklabels","linetickenable","scene","xaxis","yaxis","zaxis","_scene","className","plotTile","td","config","staticPlot","undefined","plotGlPixelRatio","displaylogo","showLink","showTips","mapboxAccessToken","setBackground","defaultLayout","containerIn","containerOut","coerce","opts","orderDefault","arrayIn","categoryarray","isValidArray","array","order","categoryorder","_initialCategories","ax","axData","dataAttr","charAt","lookup","vals","findCategories","sort","reverse","fontAttrs","colorAttrs","buttonAttrs","templatedArray","valType","role","dflt","editType","description","step","values","join","stepmode","count","min","lightLine","activecolor","defaultLine","cartesianConstants","idRegex","toString","isNumeric","makeComputeError","calcOneAxis","calcTrace","axis","coord","computeError","calcPt","iIn","calcCoord","c2l","errors","shoe","hat","axId","baseExtremes","_extremes","extremes","findExtremes","tozero","padded","concat","calcdata","handleArrayContainerDefaults","menuDefaults","menuIn","menuOut","layoutOut","handleItemDefaults","buttonDefaults","noneOrAll","coerceFont","paper_bgcolor","buttonIn","buttonOut","layoutIn","mockAnnAxes","ann","domain","fullSceneLayout","base","pdata","autorange","range","Infinity","_xa","setConvert","_pdata","_ya","anns","_infolayer","groupClassName","inputAreaClass","railRectClass","railTouchRectClass","gripRectClass","tickRectClass","inputProxyClass","labelsClass","labelGroupClass","labelClass","currentValueClass","railHeight","railRadius","railWidth","railBorder","railBorderWidth","railBorderColor","railBgColor","railInset","stepInset","gripRadius","gripWidth","gripHeight","gripBorder","gripBorderWidth","gripBorderColor","gripBgColor","gripBgActiveColor","labelPadding","labelOffset","tickWidth","tickColor","tickOffset","tickLength","minorTickOffset","minorTickColor","minorTickLength","currentValuePadding","currentValueInset","helpers","url","format","saveLink","canUseSaveLink","reject","blob","objectUrl","isIE9orBelow","Error","isSafari","prefix","octetStream","encodeURIComponent","isIE","createBlob","window","navigator","msSaveBlob","createObjectURL","href","download","body","click","removeChild","revokeObjectURL","traceIn","traceOut","noSelect","EventEmitter","clonePlot","toSVG","svgToImg","ev","clone","clonedGd","redrawFunc","getRedrawFunc","then","delay","getDelay","setTimeout","randstr","emitter","clean","catch","err","layoutAttributes","supplyLayoutDefaults","dfltAnchor","dfltDomain","dfltSide","dfltPosition","counterAxes","overlayableAxes","letter","grid","_domains","_axisMap","_anchors","split","anchor","side","overlaying","container","aFunction","PromiseCapability","C","promise","$$resolve","$$reject","TypeError","f","alignmentConstants","FROM_TL","FROM_BR","sliderOpts","sliderLabels","_visibleSteps","maxLabelWidth","labelHeight","stepOpts","textNode","drawLabel","inputAreaWidth","lenmode","outerLength","len","inputAreaStart","inputAreaLength","availableSpacePerLabel","_stepCount","computedSpacePerLabel","labelStride","currentValueMaxWidth","currentValueHeight","currentValueTotalHeight","currentValueMaxLines","currentvalue","dummyGroup","curValPrefix","drawCurrentValue","curValSize","lines","ticklen","marginOpts","xl","xr","sliderGroup","valueOverride","textAnchor","str","curVal","steps","_gd","suffix","drawGrip","attachGripEvents","drawLabelGroup","labels","labelItems","labelSteps","normalizedValueToPosition","fraction","handleInput","normalizedPosition","doTransition","quantizedPosition","quantizedIndex","doCallback","previousActive","setGripPosition","slider","interaction","_nextMethod","_nextMethodRaf","requestAnimationFrame","_step","$gd","getSliderOpts","grip","stopPropagation","preventDefault","activebgcolor","positionToNormalizedValue","mouse","_dragging","drawTicks","tick","tickwidth","isMajor","minorticklen","tickcolor","_invokingCommand","el","duration","ease","easing","drawTouchRect","drawRail","computedLength","sliderData","contOpts","makeSliderData","sliders","clearSlider","_commandObserver","sliderGroups","gSlider","nsteps","computeLabelSteps","drawSlider","identity","subTypes","linePoints","linkTraces","polygonTester","plotOne","idx","cdscatter","cdscatterAll","element","transitionOpts","extent","simpleMap","r2c","yr","hasMarkers","mnum","maxdisplayed","cd","inc","tnum","forEach","cdj","tracei","i0","floor","vis","selectMarkers","hasTransition","selection","tr","errorBarGroup","points","getComponentMethod","ownFillEl3","tonext","ownFillDir","isRangePlot","thispath","thisrevpath","prevRevpath","prevPolygons","prevtrace","_prevtrace","_prevRevpath","_nextFill","_polygons","pathfn","revpathbase","revpathfn","pt0","lastSegment","pt1","thisPolygons","fullpath","revpath","segments","makeUpdate","noop","_ownFill","datum","shape","pts","pLast","smoothclosed","smoothing","smoothopen","connectGaps","connectgaps","baseTolerance","simplify","isEnter","substr","lineGroupStyle","sel","singleLineStyle","lineJoin","layerClipId","c2p","singleFillStyle","clearFill","_prevPolygons","showMarkers","showText","hasText","keyFunc","getKeyFunc","markerFilter","hideFilter","textFilter","showFilter","stackGroup","stackgroup","isInferZero","_scatterStackOpts","stackgaps","_needsCull","visFilterWithGaps","visFilter","gapFilter","styleFns","pointStyle","translatePoints","makePointStyleFns","translatePoint","singlePointStyle","hideOutsideRangePoint","xcalendar","ycalendar","customdata","g","textPointStyle","makePoints","clipUrl","cliponaxis","gap","ids","scatterLayer","makeOnCompleteCallback","onComplete","isFullReplot","cdscatterSorted","uid","traceJoin","fills","fillData","_ownfill","_nexttrace","fillJoin","createFills","Template","selectorOut","calendar","selectorIn","rangeselector","newContainer","posDflt","anchoredList","posY","getPosDflt","bgColor","contrast","lightAmount","darkAmount","drawRaw","project","axLetters","dataScale","annotationIsOffscreen","axLetter","pos","posFraction","r2fraction","glplot","cameraParams","r2l","z","graphDiv","LINKEDFILLS","tonextx","tonexty","group","groupIndex","groupIndices","needsSort","prevGroupIndex","nextGroupIndex","prevUnstackedGroupIndex","_groupIndex","a","traceA","traceB","prevtraces","fullData","filli","tracej","handleCalendarDefaults","xlen","minRowLength","_length","edits","t1","t2","raf","easeFn","_transitionData","_interruptCallbacks","cancelAnimationFrame","aobj","edit","xr0","_name","yr0","unsetSubplotTransform","transitionInterrupt","Date","now","doFrame","tInterp","progress","updateSubplot","xr1","yr1","transitionComplete","_defs","clipId","setScale","plot","traceGroups","setPointGroupScale","setTextPointsScale","hideOutsideRangePoints","ylen","editX","editY","viewBox","dx0","dx1","l2r","dy0","dy1","drawOne","skipTitle","redrawComponents","xScaleFactor","yScaleFactor","clipDx","clipDy","fracDx","fracDy","plotDx","plotDy","clipRect","zoomScalePts","zoomScaleTxt","rules","Y","selector","fullSelector","replace","addStyleRule","schema","subplots","handleDefaults","hasColorscale","calcColorscale","containerStr","cLetter","plot_bgcolor","handleXYDefaults","handleStackDefaults","handleMarkerDefaults","handleLineDefaults","handleLineShapeDefaults","handleTextDefaults","handleFillColorDefaults","defaultColor","stackGroupOpts","defaultMode","PTS_LINESONLY","gradient","dfltHoverOn","fillDflt","lineColor","markerColor","hoveron","errorBarsSupplyDefaults","inherit","coerceSelectionMarkerOpacity","factory","isFunction","prototype","vertxNext","customSchedulerFn","asap","callback","arg","queue","flush","scheduleFlush","browserWindow","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","self","process","isWorker","Uint8ClampedArray","importScripts","MessageChannel","useSetTimeout","globalSetTimeout","channel","iterations","observer","onFulfillment","onRejection","parent","child","constructor","PROMISE_ID","makePromise","_state","arguments","invokeCallback","_result","subscribe","resolve$1","object","nextTick","createTextNode","observe","characterData","port1","onmessage","port2","postMessage","vertx","Function","require","runOnLoop","runOnContext","e","attemptVertx","random","substring","handleMaybeThenable","maybeThenable","then$$1","thenable","fulfill","value","reason","handleOwnThenable","sealed","error","fulfillmentHandler","rejectionHandler","tryThen","_label","handleForeignThenable","publishRejection","_onerror","publish","_subscribers","subscribers","settled","detail","hasCallback","succeeded","Enumerator","Constructor","input","_instanceConstructor","_remaining","_enumerate","_eachEntry","entry","c","resolve$$1","_then","didError","_settledAt","Promise$1","_willSettleAt","state","enumerator","resolver","needsResolver","initializePromise","needsNew","finally","all","entries","race","_","_setScheduler","scheduleFn","_setAsap","asapFn","_asap","polyfill","local","P","promiseToString","cast","mergeArray","texttemplate","hovertext","textfont","mergeArrayCastPositive","family","symbol","markerLine","markerGradient","undoCommands","isExecuting","command","action","add","splice","setCallback","callbackFunc","undo","redo","clear","hasUndo","hasRedo","getCommands","getPreviousCommand","getIndex","annAttrs","overrideAll","ay","xshift","yshift","textangle","align","valign","borderpad","showarrow","arrowcolor","arrowhead","startarrowhead","arrowside","arrowsize","startarrowsize","arrowwidth","standoff","startstandoff","hoverlabel","captureevents","annIn","annOut","borderColor","borderOpacity","showArrow","_dfltTitle","annotation","hoverText","globalHoverLabel","hoverBG","rgb","hoverBorder","Fx","dragElement","setCursor","makeDragBox","DRAGGERSIZE","initInteractions","_has","aParts","bParts","Number","maindrag","onmousemove","evt","_rehover","_hoversubplot","hover","_lasthover","onmouseout","unhover","showAxisDragHandles","_mainSubplot","_mainLinePosition","hoverLayer","_hoverlayer","target","onclick","onmousedown","updateFx","cursor","dragmode","_draggers","attrs","oppAxisAttrs","rangeslider","calcAutorange","isVisible","makeData","autoMarginOpts","dictionary","date","days","shortDays","months","shortMonths","periods","dateTime","time","decimal","thousands","grouping","currency","year","month","dayMonth","dayMonthYear","micropolar","UndoManager","extendDeepAll","manager","previousConfigClone","convertedInput","undoManager","_inputConfig","_container","Axis","adapter","plotly","convert","render","fillLayout","getLiveConfig","getLiveScales","angularScale","radialScale","setUndoPoint","_configClone","_previousConfigClone","that","configClone","util","cloneJson","paperDiv","paper","dflts","background","_paperdiv","_paper","objName","symmetric","copyAttr","thickness","searchInfo","selectionTester","selected","contains","pointNumber","c2d","bgClassName","rangePlotClassName","maskMinClassName","maskMaxClassName","slideBoxClassName","grabberMinClassName","grabAreaMinClassName","handleMinClassName","grabberMaxClassName","grabAreaMaxClassName","handleMaxClassName","maskMinOppAxisClassName","maskMaxOppAxisClassName","maskColor","maskOppAxisColor","slideBoxFill","slideBoxCursor","grabAreaFill","grabAreaCursor","grabAreaWidth","handleWidth","handleRadius","handleStrokeWidth","extraPad","drawArrowHead","subplotId","gs","editHelpers","modifyBase","modifyItem","getUpdateObj","annClipID","_input","annPosPx","annGroup","annTextGroup","editTextPosition","textEvents","annotationText","annTextGroupInner","makeEventData","hoverOptions","hoverFont","getBoundingClientRect","bBoxRef","loneHover","x1","fontFamily","fontSize","fontColor","outerContainer","loneUnhover","borderfull","annTextBG","isSizeConstrained","annTextClip","_topclips","annText","makeEditable","delegate","textLayout","_text","initialEvent","eventData","fullAnnotation","drawGraphicalElements","anchor3","insert","mathjaxGroup","hasMathjax","empty","anntextBB","textWidth","textHeight","annWidth","annHeight","outerWidth","outerHeight","shiftFraction","letters","basePx","textPadShift","alignPosition","autoAlignFraction","textShift","axRef","tailRef","dimAngle","PI","annSizeFromWidth","cos","annSizeFromHeight","sin","annSize","overallShift","posPx","head","arrowLength","tail","maxPx","constrain","shiftPlus","shiftMinus","xShift","yShift","texty","textx","setRect","transform","baseTextTransform","drawArrow","dx","dy","headX","headY","tailX","tailY","textX","textY","rotationXYMatrix","applyTransform","apply2DTransform","applyTransform2","apply2DTransform2","xLeft","xRight","yTop","yBottom","edges","map","reduce","segmentsIntersect","p","strokewidth","arrowColor","arrowSide","arrowGroup","arrow","annotationPosition","arrowDragHeadX","arrowDragHeadY","sqrt","pow","annx0","anny0","arrowDrag","init","prepFn","getTranslate","moveFn","annxy0","xcenter","ycenter","p2r","axref","ayref","doneFn","notesBox","querySelector","redraw","selectedObj","csr","xUpdate","yUpdate","widthFraction","_xsize","_xshift","heightFraction","_ysize","_yshift","getCursor","clickFn","previousPromises","isPlainObject","PlotSchema","plotAttributes","dfltConfig","mergeTemplates","oldTemplate","newTemplate","oldKeys","mergeOne","oldVal","newVal","templater","arrayTemplater","_template","oldItem","newItem","defaultItems","templateitemname","getBaseKey","key2","baseKey2","walkStyleKeys","templateOut","getAttributeInfo","path","basePath","pathAttr","nextPath","getNextPath","nextBasePath","baseKey","_noTemplating","arrayOk","_isLinkedToArray","dfltDone","namedIndex","usedNames","dfltPath","arrayDefaultKey","pathInArray","itemPropInArray","nestedProperty","set","get","getLayoutInfo","getLayoutValObject","parts","getTraceInfo","getTraceValObject","hasPlainObject","arr","msg","code","traceType","dataCount","templateCount","makeTemplate","figure","getGraphDiv","_basePlotModules","_modules","template","traceTemplate","typeTemplates","oldTypeTemplates","oldTypeLen","typeLen","oldLayoutTemplate","oldDataTemplate","validateTemplate","figureIn","layoutTemplate","dataTemplate","errorList","_fullData","layoutPaths","crawlLayoutForContainers","obj","paths","nextPaths","crawlLayoutTemplateForContainers","typeCount","fullTrace","_fullInput","crawlForMissingTemplates","val","drawModule","supplyDrawNewShapeDefaults","includeBasePlot","containerArrayName","Cartesian","subplotsRegistry","cartesian","_subplots","xaList","yaList","cartesianList","hasCartesianOrGL2D","itemi","hasXref","test","hasYref","pushUnique","newAxis","getToggleSets","hoverData","anni","showMode","pointj","onSet","offSet","explicitOffSet","hoverLen","clicktoshow","d2r","clickData2r","_xclick","_yclick","off","explicitOff","hasClickToShow","sets","onClick","toggleSets","update","annotationsOut","toLogRange","newType","doExtra","toLog","fromLog","attrPrefix","currentVal","isArrayOrTypedArray","inheritColorFromMarker","markerLineColor","getTraceColor","fillText","pointData","xval","yval","hovermode","xpx","ypx","pt","minRad","dxy","rad","mrc","distfn","getDistanceFunction","kink","dxRaw","dyRaw","getClosest","xc","yc","orientation","sizeVal","sNorm","xLabelVal","yLabelVal","y1","spikeDistance","hovertemplate","polygon","xCross","polygons","polygonsIn","inside","xmin","xmax","ymin","ymax","yAvg","distance","maxHoverDistance","MID_SHIFT","µ","version","inputConfig","liveConfig","dispatch","axisConfig","nodeName","_data","dataOriginal","colorIndex","defaultColorRange","strokeColor","geometry","darker","strokeDash","strokeSize","isStacked","dataWithGroupId","groupId","grouped","nest","dataYStack","stacked","prevArray","yStack","sumArrays","merge","radius","chartCenter","arrayLast","flattenArray","radialAxis","DATAEXTENT","scale","linear","ticks","angularDataMerged","isOrdinal","deduplicate","result","hasOnlyLineOrDotPlot","needsEndSpacing","angularDomain","angularAxis","angularDomainStep","angularDomainWithPadding","tickCount","ticksCount","ticksStep","angularTicksStep","minorTicks","angularAxisRange","apply","parseFloat","toPrecision","endPadding","doc","DOMParser","parseFromString","newSvg","ownerDocument","importNode","documentElement","legendContainer","chartGroup","lineStyle","fontStyle","outlineColor","showLegend","display","elements","datumClone","dotType","visibleInLegend","Legend","legendConfig","defaultConfig","reverseOrder","legend","legendBBox","getBBox","centeringOffset","titleBBox","gridLinesVisible","gridCircles","backgroundCircle","backgroundColor","currentAngle","tickSize","textContent","ticksSuffix","tickOrientation","angularAxisEnter","x2","ticksText","angle","orient","labelsVisible","rewriteTicks","rightmostTickEndX","getCTM","hasGeometry","geometryContainer","geometryConfigs","geometryConfig","dB","iB","geometryConfigsGrouped","geometryConfigsGrouped2","finalGeometryConfig","angularValue","radialValue","guides","tooltipContainer","angularTooltip","tooltipPanel","radialTooltip","geometryTooltip","hasTick","angularGuideLine","y2","mouseAngle","getMousePos","angleWithOriginOffset","invert","convertToCartesian","move","angularGuideCircle","hide","newColor","hsl","textData","bbox","svgBBox","which","show","fillColor","_x","xClone","getinputConfig","rebind","category10","AREA","LINE","DOT","BAR","_override","_objA","_objB","_extend","_rndSnd","dataFromEquation2","_equation","deg","theta","dataFromEquation","ensureArray","_val","_count","fillArrays","_obj","_valueNames","json","JSON","parse","stringify","validateKeys","next","shift","objHasKeys","zip","sum","arrayEqual","thetaRadians","_value","_digits","digits","mult","_referenceElement","mousePos","mouseX","mouseY","atan2","duplicatesCount","uniques","dups","duplicates","translator","sourceBranch","targetBranch","targetBranchCopy","previousValue","currentValue","PolyChart","dashArray","solid","dash","dot","_config","isStack","domainMin","generator","pI","dataConfig","stackTop","barWidth","stackedData","dotSize","polarCoordinates","getPolarCoordinates","radial","interpolate","lineInterpolation","lineData","dotVisible","markStyle","lineSelection","angularRange","triangleAngle","arc","startAngle","endAngle","innerRadius","outerRadius","geometryLayer","geometryType","getColorScale","colorScale","category20","BarChart","AreaChart","DotPlot","LinePlot","flattenData","colors","lineHeight","isContinuous","svgEnter","xmlns","dataNumbered","colorBandWidth","legendElement","_d","_type","squareSize","symbolType","symbolTypes","legendAxis","textColor","tooltipEl","tooltipTextEl","backgroundEl","padding","tooltipEnter","boxStyle","backGroundW","backGroundH","_pos","outputConfig","barmode","angularaxis","radialaxis","traceorder","nticks","crawl","objIn","objOut","list","k","valIn","valOut","nestedSchema","getNestedSchema","nestedValType","isInfoArray","isColorscale","items","isInSchema","n","valInPart","valOutPart","arrayItems","dimensions","len2","validate","_p","_nestedSchema","indexList","valInj","valOutj","coerceNumber","fillLayoutSchema","dataOut","layoutSchema","traceSchema","traces","traceLayoutAttr","dataIn","transformsIn","transforms","transformsOut","transformType","transformSchema","code2msgFunc","astr","inBase","unused","dynamic","invisible","convertPathToAttributeString","log","splitKey","keyMinusId","_isSubplotObj","counterRegex","idMatch","makeComputeErrorValue","dataPt","arrayminus","valMinus","isNaN","NaN","computeErrorValue","computeErrorValueMinus","valueminus","up","down","selectedpoints","tagSelected","encodeSVG","encodeJSON","DOM_URL","URL","webkitURL","Blob","binary","buf","ArrayBuffer","Uint8Array","charCodeAt","fixBinary","atob","location","IMAGE_URL_PREFIX","MSG_IE_BAD_FORMAT","padAttrs","buttonsAttrs","freeLength","_arrayAttrRegexps","borderLine","calc","insertBlank","traceIndex","hasAnyBlanks","posAttr","newEntry","prevEntry","getInterp","subplotStackOpts","i2","cd0","posj","sumj","norm","groupOpts","groupnorm","valAttr","calcTraces","indices","traceIndices","allPositions","serieslen","_rawLength","ppad","calcMarkerSize","arrayPad","ppadRaw","calcAxisExpansion","main","newPlot","restyle","relayout","_guiRestyle","_guiRelayout","_guiUpdate","_storeDirectGUIEdit","react","extendTraces","prependTraces","addTraces","deleteTraces","moveTraces","purge","addFrames","deleteFrames","animate","setPlotConfig","toImage","downloadImage","templateApi","imageDefaults","imageIn","imageOut","gdMock","coerceRef","_imgIndices","coercePosition","anObject","SPECIES","wellKnownSymbol","O","defaultConstructor","S","axisIDs","rangeSlider","axes","rangeSliderData","_height","_offsetShift","_rangeSliderData","bottomDepth","titleHeight","_depth","BR_TAG_ALL","_counterDomainMin","listAxes","getAutoRange","ieSvgError","svgBlob","w0","h0","w1","h1","ctx","imgData","errorMsg","colorscaleDefaults","isBubble","noLine","stylePoints","styleText","fillGroupStyle","styleOnSelect","selectedPointStyle","selectedTextStyle","hasAnimation","xObj","error_x","yObj","error_y","sparse","errorbars","errorbar","coords","yh","ys","noYS","xh","xs","noXS","errorCoords","yerror","yw","xerror","xw","copy_ystyle","handleShapeDefaults","shapeIn","shapeOut","shapeType","xSizeMode","ySizeMode","pos2r","r2pos","attrAnchor","sizeMode","_shapeIndices","rangeToShapePosition","shapePositionToRange","attr0","attr1","in0","in1","inAnchor","rangemode","q","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","noDash","ARROWPATHS","el3","ends","start","end","startRot","endRot","headStyle","startHeadStyle","startScale","doStart","doEnd","backOff","backoff","startBackOff","hideLine","backOffX","backOffY","startBackOffX","startbackOffY","pathlen","getTotalLength","start0","getPointAtLength","dstart","end0","dend","drawhead","arrowHeadStyle","rot","arrowScale","noRotate","crossTraceDefaults","crossTraceCalc","arraysToCalcdata","colorbar","formatLabels","hoverPoints","selectPoints","animatable","basePlotModule","categories","meta","image","currentPos","currentSize","newPos","newSize","LN10","perStackAttrs","stackOpts","firstTrace","attrFound","traceHasAttr","isOrientation","trace2","axisIds","axName","axIn","axOut","_requestRangeslider","rangeContainerIn","rangeContainerOut","isValidRange","yIds","name2id","yNames","id2name","yName","rangemodeDflt","yAxOut","coerceRange","BADNUM","calcSelection","xId","yId","firstScatter","_firstScatter","firstScatterGroup","stackOrientation","getStackOpts","_minDtick","xOptions","yOptions","openEnded","markerTrans","sizeref","sizemode","makeCalcdata","sizeOut","setFirstScatter","stackAx","isV","vali","interpolateGaps","xAttr","yAttr","_expandedIndex","cdi","xValid","yValid","pos0","size0","clickModule","convertCoords","handleTickValueDefaults","handleTickMarkDefaults","handleTickLabelDefaults","handleCategoryOrderDefaults","handleLineGridDefaults","DAY_OF_WEEK","WEEKDAY_PATTERN","HOUR","HOUR_PATTERN","rangebreaksDefaults","itemIn","itemOut","rangebreaks","bnds","dfltPattern","indexOfDay","pattern","bounds","enabled","rng","splomStash","visibleDflt","axTemplate","axType","autorangeDflt","reverseDflt","cleanRange","noHover","dfltColor","dfltFontColor","dfltTitle","pass","showGrid","showline","automargin","ticksonDflt","isMultiCategory","noTickson","showgrid","inclusionAttr","_hasDayOfWeekBreaks","warn","dayStrToNum","sun","mon","tue","wed","thu","fri","sat","toLowerCase","stepAttrs","sliderDefaults","sliderIn","sliderOut","stepDefaults","stepCount","visSteps","valueIn","valueOut","colorMix","mix","lightFraction","coerce2","lineWidth","showLine","linecolor","linewidth","gridColor","blend","toRgbString","gridWidth","gridcolor","gridwidth","noZeroLine","zeroLineColor","zeroLineWidth","zerolinecolor","zerolinewidth","MathJax","PlotlyConfig","MathJaxConfig","Hub","Config","messageStyle","skipStartupTypeset","displayAlign","tex2jax","inlineMath","Configured","counter","domainAttrs","cartesianIdRegex","gridAttrs","rows","roworder","columns","xaxes","yaxes","xgap","ygap","noGridCell","xside","yside","getAxes","gridVal","splomVal","_splomAxes","fillGridPositions","dfltGap","reversed","dirGap","cellDomain","cellStart","fillGridAxes","axesIn","axesAllowed","axisMap","fillOneAxis","axisId","sizeDefaults","gridIn","xAxes","yAxes","dfltRows","dfltColumns","hasSubplotGrid","hasXaxes","hasYaxes","isSplomGenerated","gridOut","_hasSubplotGrid","dfltSideX","dfltSideY","dfltGapX","dfltGapY","_splomGridDflt","contentDefaults","subplotsOut","useDefaultSubplots","subplotsIn","rowOut","rowIn","iFinal","column","row","mockGd","getFromTrace","xLabel","tickText","yLabel","xyAttrs","copy_zstyle","xyzAttrs","error_z","scatter","bar","histogram","scatter3d","scattergl","hoverInfo","calcPoint","hoverPoint","yerr","yerrneg","xerr","xerrneg","isUnifiedHover","handleHoverModeDefaults","basePlotLayoutAttributes","handleTypeDefaults","handleAxisDefaults","handleConstraintDefaults","handlePositionDefaults","AX_ID_PATTERN","appendList","cont","ax2traces","xaMayHide","yaMayHide","xaMustDisplay","yaMustDisplay","yaMustNotReverse","yaMayReverse","axHasImage","outerTicks","noGrids","xaName","yaName","_cheater","xIds","xNames","axNames","plotBgColor","axLayoutIn","axLayoutOut","combine","newAxLayoutOut","_traceIndices","_annIndices","_subplotsWith","_counterAxes","_attr","getCounterAxes","getOverlayableAxes","axName2","allAxisIds","missingMatchedAxisIdsLookup","missingMatchedAxisIds","addMissingMatchedAxis","matchesIn","matches","unifiedHover","defaultOptions","uirevision","unifiedSpike","spikecolor","spikethickness","spikedash","spikemode","spikesnap","defaultOptions2","rangeSliderDefaults","rangeSelectorDefaults","anchoredAxis","constraintGroups","_axisConstraintGroups","matchGroups","_axisMatchGroups","allAxisIdsIncludingMissing","axNamesIncludingMissing","scaleanchorDflt","constrainDflt","hasOwnProperty","_matchGroup","group2","axId2","getUpdateObject","selectorKeyFunc","drawButtonRect","selectorLayout","_isActive","_isHovered","getFillColor","drawButtonText","getLabel","selectors","makeSelectorData","axisLayout","_dragged","minButtonWidth","reposition","Titles","drawBg","axisOpts","bg","borderCorrect","offsetShift","lw","crispRound","_width","addClipPath","ensureSingleById","_topdefs","_clipId","drawRangePlot","mainplotinfo","calcData","rangePlots","plotgroup","isMainPlot","oppAxisOpts","oppAxisName","oppAxisRangeOpts","mockFigure","clearCalc","rangePlot","filterRangePlotCalcData","drawMasks","maskOppBorder","drawSlideBox","drawGrabbers","grabberMin","grabberMax","handleFixAttrs","handleDynamicAttrs","grabAreaFixAttrs","rangeSliders","newRng","axRng","_rl","rl0","rl1","drl","p2d","d2p","rsBreaks","locateBreaks","brk","lBreaks","m2","_B","pmin","pmax","range0OppAxis","distOppAxis","d2pOppAxis","slideBox","grabAreaMin","grabAreaMax","startX","clientX","offsetX","minVal","maxVal","dragCover","coverSlip","mouseMove","pixelMin","pixelMax","delta","tmp","_pixelMin","_pixelMax","clamp","dataMin","dataMax","setDataRange","addEventListener","mouseUp","removeEventListener","removeElement","setupDragElement","hw2","clampOppAxis","clampHandle","pixelMinOppAxis","pixelMaxOppAxis","xMin","xMax","setPixelRange","propContainer","propName","placeholder","barLength","barRadius","barPad","barColor","fullWidth","fullHeight","boxL","boxR","boxT","boxB","isDown","isLeft","isUp","boxW","boxH","_box","needsHorizontalScrollBar","hbarW","hbarH","hbarL","hbarT","_hbarXMin","_hbarTranslateMax","needsVerticalScrollBar","vbarW","vbarH","vbarL","vbarT","_vbarYMin","_vbarTranslateMax","clipL","clipR","clipT","clipB","clipPath","_clipRect","onBoxDrag","behavior","drag","sourceEvent","_onBoxDrag","_onBoxWheel","onBarDrag","_onBarDrag","deltaY","yMin","yMax","translateXMax","translateYMax","xf","yf","traceref","tracerefminus","_deprecated","tinycolor","flipScale","handleAxisPositionDefaults","axisLayoutAttrs","cn","colorBars","cbOpt","initOpts","_fillcolor","_line","_levels","_filllevels","_fillgradient","_zrange","calcOpts","reversescale","colorscale","moduleOpts","_module","allowsMultiplotCbs","cbOpts","contName","_traceIndex","_propPrefix","_colorAxes","colorAxOpts","makeColorBarData","cbbg","cbfills","cblines","cbaxis","crisp","cbtitleunshift","cbtitle","cboutline","done","titleSide","zrange","lineColormap","fillColormap","levelsIn","levelsOut","lineLevels","fillLevels","l0","ls","zr0","zr1","fillLevelsIn","calcLevels","thickPx","thicknessmode","thickFrac","lenPx","lenFrac","xpadFrac","xpad","yExtraPx","outlinewidth","ypadFrac","ypad","xLeftFrac","yBottomFrac","yBottomPx","yTopPx","_lenFrac","_thickFrac","_xLeftFrac","_yBottomFrac","_axis","cbAxisIn","tickmode","tick0","dtick","tickvals","ticktext","tickfont","tickangle","tickformat","exponentformat","separatethousands","showexponent","showtickprefix","tickprefix","showticksuffix","ticksuffix","cbAxisOut","axisOptions","mockColorBarAxis","titlex","titley","autoNtick","dtFactor","dtexp","roundUp","titleEl","titleCont","axLayer","drawTitle","titleClass","titleOpts","dfltTitleOpts","containerGroup","otherClass","syncOrAsync","titleGroup","titleText","titleTrans","mathJaxNode","lineSize","parseInt","jsPlaceholder","nlines","cbfill","zBounds","fillEl","colorString","toHexString","cbline","calcTicks","transFn","makeTransFn","tickSign","getTickSigns","clipEnds","makeTickPath","drawLabels","labelFns","makeLabelFns","avoid","offsetLeft","offsetTop","maxShift","rotate","innerWidth","titleWidth","outerwidth","outerheight","outlinecolor","xoffset","tFrac","bFrac","yt","yb","lFrac","rFrac","extraThickness","drawColorBar","colorbarPosition","t0","colorAttributes","impliedEdits","getModuleCalcData","ensureSingleAndAddDatum","nodeType","cdSubplot","cdModuleAndOthers","cdModule","traceLayerClasses","modules","layerData","zoomScaleQueryParts","layerName","plotMethod","zoomScale","layers","clipOnAxisFalseQuery","getModule","_hasClipOnAxisFalse","clipOnAxisFalseTraces","makeSubplotLayer","xLayer","layerValue2layerClass","yLayer","hasOnlyLargeSploms","_hasOnlyLargeSploms","mainplotgroup","gridlayer","zerolinelayer","overlinesBelow","overaxesBelow","overplot","overlinesAbove","overaxesAbove","xlines","ylines","xaxislayer","yaxislayer","backLayer","shapelayer","idSort","purgeSubplotLayers","overlayIdsToRemove","removeSubplotExtras","overlays","overlayInfo","idRoot","attrRegex","transitionAxes","finalizeSubplots","xi","yi","xList","yList","spSVG","spAll","gl2d","allX","allY","ki","pcd","subplotInfo","carpet","newFullData","newFullLayout","oldFullData","oldFullLayout","oldPlots","newPlots","oldSubplotList","hadGl","hasGl","destroy","oldAxIDs","listIds","oldAxId","hadCartesian","hasCartesian","_cartesianlayer","oldSubplotId","drawFramework","subplotData","regulars","xa2","_mainAxis","ya2","mainPlotinfo","subplotIds","makeSubplotData","subplotLayers","draglayer","imageRoot","_glimages","root","imageData","supportsPassive","selectingOrDrawing","freeMode","clearGlCanvases","redrawReglTraces","prepSelect","clearSelect","selectOnClick","scaleZoom","MINDRAG","MINZOOM","SHOWZOOMOUTTIP","makeDragger","dragClass","dragger3","makeRectDragger","dragger","isDirectionActive","axList","activeVal","fixedrange","zoomAxRanges","r0Fraction","r1Fraction","updates","linkedAxes","axi","isY","r0F","r1F","p2l","axRangeLinear0","axRangeLinearSpan","linkedR0Fraction","dragAxList","pix","p1","_m","dZoom","makeZoombox","zoomlayer","lum","path0","makeCorners","updateZoombox","zb","corners","box","dimmed","transitionZoombox","removeZoombox","showDoubleClickNotifier","notifier","xyCorners","clen","calcLinks","groups","xaHash","yaHash","xID","yID","xLinkID","yLinkID","isSubplotConstrained","xLinks","yLinks","xaHashLinked","xaxesLinked","yaHashLinked","yaxesLinked","attachWheelEventHandler","handler","wheelEventName","onwheel","_onwheel","passive","onmousewheel","isAddedWheelEvent","hashValues","hash","ns","ew","xa0","ya0","pw","ph","links","xActive","yActive","allFixedRanges","hasScatterGl","hasSplom","hasSVG","_zoomlayer","isMainDrag","singleEnd","recomputeAxisLists","nsew","getDragCursor","pointerEvents","zoomMode","zoomDragged","dragOptions","clearAndResetSelect","numClicks","_activeShapeIndex","_deactivateShape","clickmode","doubleClick","attrStr","initialText","dig","initialVal","diff","getEndText","hAlign","vAlign","showAxisRangeEntryBoxes","immediate","horizontalAlign","verticalAlign","zoomMove","_transitioningWithDuration","noZoom","r0","r1","xCorners","yCorners","computeZoomUpdates","updateMatchedAxRange","zoomDone","dragTail","startY","dragModePrev","dragModeNow","shiftKey","ctrlKey","minDrag","dragBBox","_hmpixcount","_hmlumcount","getLuminance","zoomPrep","plotDrag","_redrag","dragDataNow","_dragdata","updateSubplots","scrollViewBox","redrawTimer","REDRAWDELAY","_replotting","ticksAndAnnotations","dxySign","dxyFraction","dz","xStart","yStart","_r","axArray","movedAx","newLinearizedEnd","otherEnd","newEnd","matchedAxes","constrainedAxes","ax2","activeAxIds","pushActiveAxIds","doubleClickConfig","rangeInitial","_rangeInitial","sp","plotinfos","splom","xrng","yrng","xScaleFactor2","yScaleFactor2","editX2","editY2","getShift","scaleAndGetShift","getLinkedScaleFactor","scaleFactor","from","constraintoward","_scrollZoom","_enablescrollzoom","clearTimeout","wheelDelta","isFinite","zoom","exp","gbb","xfrac","yfrac","clientY","zoomWheelOneAxis","centerFraction","axRange","v0","animationAttrs","stepsAttrs","numConstants","LOG_CLIP","LOG_CLIP_PLUS","LOG_CLIP_MINUS","clusterStartPt","clusterEndPt","clusterHighPt","clusterLowPt","thisPt","clusterHighFirst","clusterUnitVector","thisVector","clusterRefDist","clusterHighVal","clusterLowVal","thisVal","clusterMinDeviation","clusterMaxDeviation","thisDeviation","latestXFrac","latestYFrac","xLog","yLog","xLen","yLen","minTolerance","pti","getPt","linearized","crossesViewport","xFrac0","yFrac0","xFrac1","yFrac1","norm2","cross","getTolerance","nextPt","xFrac","yFrac","offScreenFraction","toleranceGrowth","ptDist","pt2","xEdge","yEdge","lastXEdge","lastYEdge","lastFarPt","edgePt","getEdgeIntersections","maxScreensAway","xEdge0","xEdge1","yEdge0","yEdge1","onlyConstrainedPoint","sameEdge","getABAEdgeIntersections","dim","limit0","limit1","ptInt1","ptInt2","midShift","updateEdge","xSame","ySame","xSame2","ySame2","updateEdgesForReentry","addPt","intersections","lastPt","ptCount","edge","ptInt","unshift","buttonLayout","xrange","range0","currentRange","utc","base2","range1","getXRange","plotApi","plots","imageDataOnly","isImpliedOrValid","fullOpts","layoutImage","configImage","_exportedPlot","wait","cleanup","graphJson","urlToImageData","$","IS_PURE","NativePromise","fails","getBuiltIn","speciesConstructor","promiseResolve","redefine","proto","real","forced","onFinally","arrayStr","rootContainers","layoutArrayContainers","regexpContainers","layoutArrayRegexes","rootPart","property","scatterLineAttrs","xsizemode","ysizemode","fillrule","editable","fileSaver","_snapshotInProgress","filename","fn","Loggers","sorterAsc","containerArrayMatch","isAddVal","isRemoveVal","applyContainerArrayChanges","np","flags","_nestedProperty","componentType","supplyComponentDefaults","replotLater","replot","recalc","fullVal","componentNum","objEdits","objKeys","objVal","adding","componentNums","componentArrayIn","componentArray","componentArrayFull","deletes","firstIndexChange","maxIndex","indicesToDraw","autoType","getBoxPosLetter","isBoxWithoutPositionCoords","posLetter","isBox","isCandlestick","d0","getFirstNonEmptyTrace","calAttr","noMultiCategory","_hasPreCompStats","boxPositions","_axesDim","setAutoType","hasHover","Events","Queue","Polar","manageArrays","subroutines","editTypes","AX_NAME_PATTERN","numericNameWarningCount","emitAfterPlot","_redrawFromAutoMarginCount","opaqueSetBackground","setPlotContext","_baseUrl","plot3dPixelRatio","autosizable","scrollZoom","displayModeBar","_hasZeroHeight","clientHeight","_hasZeroWidth","clientWidth","szIn","szOut","gl3d","geo","mapbox","positivifyIndices","parentLength","positiveIndices","assertIndexArray","arrayName","checkMoveTracesArgs","currentIndices","newIndices","spliceTraces","maxPoints","updateArray","maxPointsIsObject","assertExtendTracesArgs","updateProps","prop","maxp","getExtendProperties","undoUpdate","undoPoints","concatTypedArray","arr0","arr1","arr2","_traces","clearPromiseQueue","changed","coerceTraceIndices","specs","_restyle","clearAxisTypes","seq","fullReplot","markerSize","doCalcdata","addAxRangeSequence","doTraceStyle","colorbars","doColorBars","rehover","redrag","undoit","redoit","plotDone","undefinedToNull","makeNP","preGUI","guiEditFlag","npSet","storeCurrent","arrayVal","arrayNew","maxLen","objNew","objBoth","_guiEditing","layoutNP","_preGUI","cleanDeprecatedAttributeKeys","axlist","traceFlags","a0","addToAxlist","axid","autorangeAttr","rangeAttr","getFullTrace","doextra","hasParent","extraparam","_tracePreGUI","allBins","binAttr","arrayBins","vij","ai","contFull","param","valObject","vi","finalPart","prefixDot","innerContFull","impliedKey","relativeAttr","labelsTo","valuesTo","swapAttrs","_pielayer","topOrBottom","thicknorm","lennorm","defaultOrientation","swapXYData","dataArrayContainers","manageArrayContainers","swap","extendDeepNoArrays","oldAxisTitleRegex","colorbarRegex","oldAttrStr","newAttrStr","_relayout","layoutReplot","axRangeSupplyDefaultsByPass","doLegend","layoutstyle","layoutStyles","axrange","rangesAltered","doTicksRelayout","modebar","doModeBar","doCamera","drawAxes","axIds","id2","doAutoRangeAndConstraints","drawData","finalDraw","AX_RANGE_RE","AX_AUTORANGE_RE","AX_DOMAIN_RE","arrayEdits","axisAttr","newkey","layoutFlags","recordAlteredAxis","pleafPlus","pend","pleaf","ptrunk","parentIn","parentFull","vOld","oppositeAttr","_initialAutoSize","axFull","_inputDomain","polar","_subplot","viewInitial","fullProp","propStr","updateValObject","constraints","groupAxId","_constraintShrinkable","updateAutosize","oldWidth","oldHeight","plotAutoSize","traceUpdate","layoutUpdate","restyleSpecs","restyleFlags","relayoutSpecs","relayoutFlags","guiEdit","func","layoutUIControlPatterns","traceUIControlPatterns","findUIPattern","patternSpecs","spec","getNewRev","revAttr","newRev","pop","getFullTraceIndexFromUid","getTraceIndexFromUid","valsMatch","v1","v2","v1IsObj","v1IsArray","getDiffFlags","oldContainer","outerparts","getValObject","immutable","inArray","arrayIndex","arrays","nChanges","anim","nChangesAnim","newDataRevision","valObjectCanBeDataArray","tickMode","_compareAsJSON","canBeDataArray","wasArray","nowArray","inputKey","oldValIn","newValIn","arrayEditIndices","extraIndices","minLen","makePlotFramework","gd3","_glcontainer","_toppaper","_modebardiv","_hoverpaper","otherUids","svgAttrs","_clips","_bgLayer","layerBelow","_shapeLowerLayer","_polarlayer","_ternarylayer","_geolayer","_funnelarealayer","_treemaplayer","_sunburstlayer","_indicatorlayer","layerAbove","_shapeUpperLayer","frameOrGroupNameOrFrameList","animationOpts","isPlotDiv","trans","_frameQueue","supplyAnimationDefaults","frameOpts","frame","getTransitionOpts","getFrameOpts","callbackOnNthTime","cb","cnt","_frameWaitingCnt","nextFrame","_currentFrame","newFrame","stringName","_lastFrameAt","_timeToNext","animation","_animationRaf","beginAnimationLoop","_runningTransitions","configCounter","setTransitionConfig","frameList","allFrames","isFrameArray","_frames","frameOrName","_frameHash","onInterrupt","discardExistingFrames","currentFrame","fromcurrent","filteredFrameList","computedFrame","computeFrame","queueFrames","bigIndex","insertions","_frameHashLocal","lookupName","newName","collisionPresent","supplyFrameDefaults","ops","revops","frameCount","_counter","undoFunc","modifyFrames","redoFunc","undoArgs","redoArgs","checkAddTracesArgs","cleanData","startSequence","stopSequence","deletedTrace","sorterDes","newArray","remainder","isTypedArray","none","both","numberOfItemsFromInsert","subarray","numberOfItemsFromTarget","targetBegin","movingTraceMap","newIndex","cleanPlot","frames","triggerHandler","makeTester","graphWasEmpty","cleanLayout","plotContainer","html","polarPlotSVG","txt","titleLayout","placeholderText","setContenteditable","addLinks","plotLegacyPolar","_shouldCreateBgLayer","initGradients","saveShowSpikeInitial","responsive","_responsiveChartHandler","isHidden","resize","clearResponsive","oldMargins","drawFrameworkCalls","marginPushers","clearAutoMarginIds","drawMarginPushers","allowAutoMargin","doAutoMargin","_transitioning","saveRangeInitial","basePlotModules","_glcanvas","pick","overflow","regl","_gl","drawingBufferWidth","drawingBufferHeight","didMarginChange","configChanged","oldConfig","diffConfig","newConfig","oldRev","preGUIVal","newNP","layoutPreGUI","bothInheritAutorange","newRangeAccepted","axAttr","newAx","allTracePreGUI","fullInput","tracePreGUI","newTrace","fulli","newTracei","applyUIRevisions","allNames","getOwnPropertyNames","emptyCategories","_emptyCategories","skipUpdateCalc","datarevision","diffLayout","sameTraceLength","diffOpts","seenUIDs","hasMakesDataTransform","diffData","supplyDefaultsUpdateCalc","createTransitionData","transitionFromReact","_skipDefaults","colorEditType","extras","xclick","yclick","ref","handleAnnotationCommonDefaults","handleAnnotationDefaults","clickToShow","arrowPosDflt","arrowPosAttr","aaxRef","aDflt","xClick","yClick","cleanPosition","m4FromQuat","AxisIds","cleanId","cleanAxRef","cleanTitle","titleContainer","rewireAttr","oldAttrName","newAttrName","oldAttrSet","newAttrSet","cleanFinanceDir","dirContainer","dirName","commonPrefix","name1","name2","show1","show2","trim","cleanTextPosition","posX","emptyContainer","outer","innerStr","xaxis1","yaxis1","scene1","axisAttrRegex","polarAttrRegex","ternaryAttrRegex","ternary","sceneAttrRegex","isdate","islog","autotick","aaxis","baxis","caxis","cameraposition","rotation","mat","eye","annotationsLen","shapesLen","shapes","ybins","xbins","dc","defaults","yeColor","bardir","scl","reversescl","containerName","contours","highlightColor","highlightcolor","highlightWidth","highlightwidth","increasingShowlegend","increasing","decreasingShowlegend","decreasing","increasingName","decreasingName","filtersrc","valuecalendar","styles","prevStyles","styleKeys","autobinx","autobiny","transpose","errorY","copyYstyle","hoverinfo","hoverInfoParts","traceIndicesOut","isIndex","pLength","pLastIsNumber","contPath","ATTR_TAIL_RE","getParent","search","attrParent","sceneName","typeAttr","register","methodNames","PlotlyLocales","Icons","Snapshot","sceneLayout","zref","sceneLayoutIn","sceneLayoutOut","queueObj","queueIndex","undoQueue","sequence","autoplay","inSequence","beginSequence","calls","queueLength","plotDo","copy","copyArgArray","GL3D","DOUBLEQUOTE_REGEX","DUMMY_REGEX","RegExp","toppaper","nodes","childNodes","topGroups","topGroup","visibility","ff","_gradientUrlQueryParts","queryParts","setAttributeNS","xlink","XMLSerializer","serializeToString","hiddenDiv","replaced","htmlEntityDecode","annAutorange","apos","aref","padplus","padminus","headSize","headPlus","headMinus","startHeadSize","startHeadPlus","startHeadMinus","extremeArrowHead","ppadplus","ppadminus","extremeText","isObject","newPromiseCapability","promiseCapability","calcXPaddingOptions","calcPaddingOptions","calcYPaddingOptions","isYAxis","axisDirectionReverted","extractPathCoords","paramIsY","paramIsX","maxValue","aggNums","minValue","beforePad","afterPad","shapeBounds","paramsToUse","convertVal","d2c","drawnParam","params","segmentRE","decodeDate","drawn","paramRE","shapeList","vx0","vx1","vy0","vy1"],"mappings":"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","file":"14-b1c5bd6aa4d1ade0c57c.js","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nfunction xformMatrix(m, v) {\n  var out = [0, 0, 0, 0];\n  var i, j;\n\n  for (i = 0; i < 4; ++i) {\n    for (j = 0; j < 4; ++j) {\n      out[j] += m[4 * i + j] * v[i];\n    }\n  }\n\n  return out;\n}\n\nfunction project(camera, v) {\n  var p = xformMatrix(camera.projection, xformMatrix(camera.view, xformMatrix(camera.model, [v[0], v[1], v[2], 1])));\n  return p;\n}\n\nmodule.exports = project;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Drawing = require('../drawing');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar xmlnsNamespaces = require('../../constants/xmlns_namespaces');\n\nmodule.exports = function draw(gd) {\n  var fullLayout = gd._fullLayout;\n  var imageDataAbove = [];\n  var imageDataSubplot = {};\n  var imageDataBelow = [];\n  var subplot;\n  var i; // Sort into top, subplot, and bottom layers\n\n  for (i = 0; i < fullLayout.images.length; i++) {\n    var img = fullLayout.images[i];\n\n    if (img.visible) {\n      if (img.layer === 'below' && img.xref !== 'paper' && img.yref !== 'paper') {\n        subplot = img.xref + img.yref;\n        var plotinfo = fullLayout._plots[subplot];\n\n        if (!plotinfo) {\n          // Fall back to _imageLowerLayer in case the requested subplot doesn't exist.\n          // This can happen if you reference the image to an x / y axis combination\n          // that doesn't have any data on it (and layer is below)\n          imageDataBelow.push(img);\n          continue;\n        }\n\n        if (plotinfo.mainplot) {\n          subplot = plotinfo.mainplot.id;\n        }\n\n        if (!imageDataSubplot[subplot]) {\n          imageDataSubplot[subplot] = [];\n        }\n\n        imageDataSubplot[subplot].push(img);\n      } else if (img.layer === 'above') {\n        imageDataAbove.push(img);\n      } else {\n        imageDataBelow.push(img);\n      }\n    }\n  }\n\n  var anchors = {\n    x: {\n      left: {\n        sizing: 'xMin',\n        offset: 0\n      },\n      center: {\n        sizing: 'xMid',\n        offset: -1 / 2\n      },\n      right: {\n        sizing: 'xMax',\n        offset: -1\n      }\n    },\n    y: {\n      top: {\n        sizing: 'YMin',\n        offset: 0\n      },\n      middle: {\n        sizing: 'YMid',\n        offset: -1 / 2\n      },\n      bottom: {\n        sizing: 'YMax',\n        offset: -1\n      }\n    }\n  }; // Images must be converted to dataURL's for exporting.\n\n  function setImage(d) {\n    var thisImage = d3.select(this);\n\n    if (this._imgSrc === d.source) {\n      return;\n    }\n\n    thisImage.attr('xmlns', xmlnsNamespaces.svg);\n\n    if (d.source && d.source.slice(0, 5) === 'data:') {\n      thisImage.attr('xlink:href', d.source);\n      this._imgSrc = d.source;\n    } else {\n      var imagePromise = new Promise(function (resolve) {\n        var img = new Image();\n        this.img = img; // If not set, a `tainted canvas` error is thrown\n\n        img.setAttribute('crossOrigin', 'anonymous');\n        img.onerror = errorHandler;\n\n        img.onload = function () {\n          var canvas = document.createElement('canvas');\n          canvas.width = this.width;\n          canvas.height = this.height;\n          var ctx = canvas.getContext('2d');\n          ctx.drawImage(this, 0, 0);\n          var dataURL = canvas.toDataURL('image/png');\n          thisImage.attr('xlink:href', dataURL); // resolve promise in onload handler instead of on 'load' to support IE11\n          // see https://github.com/plotly/plotly.js/issues/1685\n          // for more details\n\n          resolve();\n        };\n\n        thisImage.on('error', errorHandler);\n        img.src = d.source;\n        this._imgSrc = d.source;\n\n        function errorHandler() {\n          thisImage.remove();\n          resolve();\n        }\n      }.bind(this));\n\n      gd._promises.push(imagePromise);\n    }\n  }\n\n  function applyAttributes(d) {\n    var thisImage = d3.select(this); // Axes if specified\n\n    var xa = Axes.getFromId(gd, d.xref);\n    var ya = Axes.getFromId(gd, d.yref);\n    var size = fullLayout._size;\n    var width = xa ? Math.abs(xa.l2p(d.sizex) - xa.l2p(0)) : d.sizex * size.w;\n    var height = ya ? Math.abs(ya.l2p(d.sizey) - ya.l2p(0)) : d.sizey * size.h; // Offsets for anchor positioning\n\n    var xOffset = width * anchors.x[d.xanchor].offset;\n    var yOffset = height * anchors.y[d.yanchor].offset;\n    var sizing = anchors.x[d.xanchor].sizing + anchors.y[d.yanchor].sizing; // Final positions\n\n    var xPos = (xa ? xa.r2p(d.x) + xa._offset : d.x * size.w + size.l) + xOffset;\n    var yPos = (ya ? ya.r2p(d.y) + ya._offset : size.h - d.y * size.h + size.t) + yOffset; // Construct the proper aspectRatio attribute\n\n    switch (d.sizing) {\n      case 'fill':\n        sizing += ' slice';\n        break;\n\n      case 'stretch':\n        sizing = 'none';\n        break;\n    }\n\n    thisImage.attr({\n      x: xPos,\n      y: yPos,\n      width: width,\n      height: height,\n      preserveAspectRatio: sizing,\n      opacity: d.opacity\n    }); // Set proper clipping on images\n\n    var xId = xa ? xa._id : '';\n    var yId = ya ? ya._id : '';\n    var clipAxes = xId + yId;\n    Drawing.setClipUrl(thisImage, clipAxes ? 'clip' + fullLayout._uid + clipAxes : null, gd);\n  }\n\n  var imagesBelow = fullLayout._imageLowerLayer.selectAll('image').data(imageDataBelow);\n\n  var imagesAbove = fullLayout._imageUpperLayer.selectAll('image').data(imageDataAbove);\n\n  imagesBelow.enter().append('image');\n  imagesAbove.enter().append('image');\n  imagesBelow.exit().remove();\n  imagesAbove.exit().remove();\n  imagesBelow.each(function (d) {\n    setImage.bind(this)(d);\n    applyAttributes.bind(this)(d);\n  });\n  imagesAbove.each(function (d) {\n    setImage.bind(this)(d);\n    applyAttributes.bind(this)(d);\n  });\n  var allSubplots = Object.keys(fullLayout._plots);\n\n  for (i = 0; i < allSubplots.length; i++) {\n    subplot = allSubplots[i];\n    var subplotObj = fullLayout._plots[subplot]; // filter out overlaid plots (which havd their images on the main plot)\n    // and gl2d plots (which don't support below images, at least not yet)\n\n    if (!subplotObj.imagelayer) continue;\n    var imagesOnSubplot = subplotObj.imagelayer.selectAll('image') // even if there are no images on this subplot, we need to run\n    // enter and exit in case there were previously\n    .data(imageDataSubplot[subplot] || []);\n    imagesOnSubplot.enter().append('image');\n    imagesOnSubplot.exit().remove();\n    imagesOnSubplot.each(function (d) {\n      setImage.bind(this)(d);\n      applyAttributes.bind(this)(d);\n    });\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'colorbar',\n  attributes: require('./attributes'),\n  supplyDefaults: require('./defaults'),\n  draw: require('./draw').draw,\n  hasColorbar: require('./has_colorbar')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Plots = require('../../plots/plots');\n\nvar Color = require('../color');\n\nvar Drawing = require('../drawing');\n\nvar Lib = require('../../lib');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar arrayEditor = require('../../plot_api/plot_template').arrayEditor;\n\nvar LINE_SPACING = require('../../constants/alignment').LINE_SPACING;\n\nvar constants = require('./constants');\n\nvar ScrollBox = require('./scrollbox');\n\nmodule.exports = function draw(gd) {\n  var fullLayout = gd._fullLayout;\n  var menuData = Lib.filterVisible(fullLayout[constants.name]);\n  /* Update menu data is bound to the header-group.\n   * The items in the header group are always present.\n   *\n   * Upon clicking on a header its corresponding button\n   * data is bound to the button-group.\n   *\n   * We draw all headers in one group before all buttons\n   * so that the buttons *always* appear above the headers.\n   *\n   * Note that only one set of buttons are visible at once.\n   *\n   * <g container />\n   *\n   *     <g header-group />\n   *         <g item header />\n   *         <text item header-arrow />\n   *     <g header-group />\n   *         <g item header />\n   *         <text item header-arrow />\n   *     ...\n   *\n   *     <g button-group />\n   *         <g item button />\n   *         <g item button />\n   *         ...\n   */\n\n  function clearAutoMargin(menuOpts) {\n    Plots.autoMargin(gd, autoMarginId(menuOpts));\n  } // draw update menu container\n\n\n  var menus = fullLayout._menulayer.selectAll('g.' + constants.containerClassName).data(menuData.length > 0 ? [0] : []);\n\n  menus.enter().append('g').classed(constants.containerClassName, true).style('cursor', 'pointer');\n  menus.exit().each(function () {\n    // Most components don't need to explicitly remove autoMargin, because\n    // marginPushers does this - but updatemenu updates don't go through\n    // a full replot so we need to explicitly remove it.\n    // This is for removing *all* updatemenus, removing individuals is\n    // handled below, in headerGroups.exit\n    d3.select(this).selectAll('g.' + constants.headerGroupClassName).each(clearAutoMargin);\n  }).remove(); // return early if no update menus are visible\n\n  if (menuData.length === 0) return; // join header group\n\n  var headerGroups = menus.selectAll('g.' + constants.headerGroupClassName).data(menuData, keyFunction);\n  headerGroups.enter().append('g').classed(constants.headerGroupClassName, true); // draw dropdown button container\n\n  var gButton = Lib.ensureSingle(menus, 'g', constants.dropdownButtonGroupClassName, function (s) {\n    s.style('pointer-events', 'all');\n  }); // find dimensions before plotting anything (this mutates menuOpts)\n\n  for (var i = 0; i < menuData.length; i++) {\n    var menuOpts = menuData[i];\n    findDimensions(gd, menuOpts);\n  } // setup scrollbox\n\n\n  var scrollBoxId = 'updatemenus' + fullLayout._uid;\n  var scrollBox = new ScrollBox(gd, gButton, scrollBoxId); // remove exiting header, remove dropped buttons and reset margins\n\n  if (headerGroups.enter().size()) {\n    // make sure gButton is on top of all headers\n    gButton.node().parentNode.appendChild(gButton.node());\n    gButton.call(removeAllButtons);\n  }\n\n  headerGroups.exit().each(function (menuOpts) {\n    gButton.call(removeAllButtons);\n    clearAutoMargin(menuOpts);\n  }).remove(); // draw headers!\n\n  headerGroups.each(function (menuOpts) {\n    var gHeader = d3.select(this);\n\n    var _gButton = menuOpts.type === 'dropdown' ? gButton : null;\n\n    Plots.manageCommandObserver(gd, menuOpts, menuOpts.buttons, function (data) {\n      setActive(gd, menuOpts, menuOpts.buttons[data.index], gHeader, _gButton, scrollBox, data.index, true);\n    });\n\n    if (menuOpts.type === 'dropdown') {\n      drawHeader(gd, gHeader, gButton, scrollBox, menuOpts); // if this menu is active, update the dropdown container\n\n      if (isActive(gButton, menuOpts)) {\n        drawButtons(gd, gHeader, gButton, scrollBox, menuOpts);\n      }\n    } else {\n      drawButtons(gd, gHeader, null, null, menuOpts);\n    }\n  });\n}; // Note that '_index' is set at the default step,\n// it corresponds to the menu index in the user layout update menu container.\n// Because a menu can be set invisible,\n// this is a more 'consistent' field than the index in the menuData.\n\n\nfunction keyFunction(menuOpts) {\n  return menuOpts._index;\n}\n\nfunction isFolded(gButton) {\n  return +gButton.attr(constants.menuIndexAttrName) === -1;\n}\n\nfunction isActive(gButton, menuOpts) {\n  return +gButton.attr(constants.menuIndexAttrName) === menuOpts._index;\n}\n\nfunction setActive(gd, menuOpts, buttonOpts, gHeader, gButton, scrollBox, buttonIndex, isSilentUpdate) {\n  // update 'active' attribute in menuOpts\n  menuOpts.active = buttonIndex; // due to templating, it's possible this slider doesn't even exist yet\n\n  arrayEditor(gd.layout, constants.name, menuOpts).applyUpdate('active', buttonIndex);\n\n  if (menuOpts.type === 'buttons') {\n    drawButtons(gd, gHeader, null, null, menuOpts);\n  } else if (menuOpts.type === 'dropdown') {\n    // fold up buttons and redraw header\n    gButton.attr(constants.menuIndexAttrName, '-1');\n    drawHeader(gd, gHeader, gButton, scrollBox, menuOpts);\n\n    if (!isSilentUpdate) {\n      drawButtons(gd, gHeader, gButton, scrollBox, menuOpts);\n    }\n  }\n}\n\nfunction drawHeader(gd, gHeader, gButton, scrollBox, menuOpts) {\n  var header = Lib.ensureSingle(gHeader, 'g', constants.headerClassName, function (s) {\n    s.style('pointer-events', 'all');\n  });\n  var dims = menuOpts._dims;\n  var active = menuOpts.active;\n  var headerOpts = menuOpts.buttons[active] || constants.blankHeaderOpts;\n  var posOpts = {\n    y: menuOpts.pad.t,\n    yPad: 0,\n    x: menuOpts.pad.l,\n    xPad: 0,\n    index: 0\n  };\n  var positionOverrides = {\n    width: dims.headerWidth,\n    height: dims.headerHeight\n  };\n  header.call(drawItem, menuOpts, headerOpts, gd).call(setItemPosition, menuOpts, posOpts, positionOverrides); // draw drop arrow at the right edge\n\n  var arrow = Lib.ensureSingle(gHeader, 'text', constants.headerArrowClassName, function (s) {\n    s.classed('user-select-none', true).attr('text-anchor', 'end').call(Drawing.font, menuOpts.font).text(constants.arrowSymbol[menuOpts.direction]);\n  });\n  arrow.attr({\n    x: dims.headerWidth - constants.arrowOffsetX + menuOpts.pad.l,\n    y: dims.headerHeight / 2 + constants.textOffsetY + menuOpts.pad.t\n  });\n  header.on('click', function () {\n    gButton.call(removeAllButtons, String(isActive(gButton, menuOpts) ? -1 : menuOpts._index));\n    drawButtons(gd, gHeader, gButton, scrollBox, menuOpts);\n  });\n  header.on('mouseover', function () {\n    header.call(styleOnMouseOver);\n  });\n  header.on('mouseout', function () {\n    header.call(styleOnMouseOut, menuOpts);\n  }); // translate header group\n\n  Drawing.setTranslate(gHeader, dims.lx, dims.ly);\n}\n\nfunction drawButtons(gd, gHeader, gButton, scrollBox, menuOpts) {\n  // If this is a set of buttons, set pointer events = all since we play\n  // some minor games with which container is which in order to simplify\n  // the drawing of *either* buttons or menus\n  if (!gButton) {\n    gButton = gHeader;\n    gButton.attr('pointer-events', 'all');\n  }\n\n  var buttonData = !isFolded(gButton) || menuOpts.type === 'buttons' ? menuOpts.buttons : [];\n  var klass = menuOpts.type === 'dropdown' ? constants.dropdownButtonClassName : constants.buttonClassName;\n  var buttons = gButton.selectAll('g.' + klass).data(Lib.filterVisible(buttonData));\n  var enter = buttons.enter().append('g').classed(klass, true);\n  var exit = buttons.exit();\n\n  if (menuOpts.type === 'dropdown') {\n    enter.attr('opacity', '0').transition().attr('opacity', '1');\n    exit.transition().attr('opacity', '0').remove();\n  } else {\n    exit.remove();\n  }\n\n  var x0 = 0;\n  var y0 = 0;\n  var dims = menuOpts._dims;\n  var isVertical = ['up', 'down'].indexOf(menuOpts.direction) !== -1;\n\n  if (menuOpts.type === 'dropdown') {\n    if (isVertical) {\n      y0 = dims.headerHeight + constants.gapButtonHeader;\n    } else {\n      x0 = dims.headerWidth + constants.gapButtonHeader;\n    }\n  }\n\n  if (menuOpts.type === 'dropdown' && menuOpts.direction === 'up') {\n    y0 = -constants.gapButtonHeader + constants.gapButton - dims.openHeight;\n  }\n\n  if (menuOpts.type === 'dropdown' && menuOpts.direction === 'left') {\n    x0 = -constants.gapButtonHeader + constants.gapButton - dims.openWidth;\n  }\n\n  var posOpts = {\n    x: dims.lx + x0 + menuOpts.pad.l,\n    y: dims.ly + y0 + menuOpts.pad.t,\n    yPad: constants.gapButton,\n    xPad: constants.gapButton,\n    index: 0\n  };\n  var scrollBoxPosition = {\n    l: posOpts.x + menuOpts.borderwidth,\n    t: posOpts.y + menuOpts.borderwidth\n  };\n  buttons.each(function (buttonOpts, buttonIndex) {\n    var button = d3.select(this);\n    button.call(drawItem, menuOpts, buttonOpts, gd).call(setItemPosition, menuOpts, posOpts);\n    button.on('click', function () {\n      // skip `dragend` events\n      if (d3.event.defaultPrevented) return;\n\n      if (buttonOpts.execute) {\n        if (buttonOpts.args2 && menuOpts.active === buttonIndex) {\n          setActive(gd, menuOpts, buttonOpts, gHeader, gButton, scrollBox, -1);\n          Plots.executeAPICommand(gd, buttonOpts.method, buttonOpts.args2);\n        } else {\n          setActive(gd, menuOpts, buttonOpts, gHeader, gButton, scrollBox, buttonIndex);\n          Plots.executeAPICommand(gd, buttonOpts.method, buttonOpts.args);\n        }\n      }\n\n      gd.emit('plotly_buttonclicked', {\n        menu: menuOpts,\n        button: buttonOpts,\n        active: menuOpts.active\n      });\n    });\n    button.on('mouseover', function () {\n      button.call(styleOnMouseOver);\n    });\n    button.on('mouseout', function () {\n      button.call(styleOnMouseOut, menuOpts);\n      buttons.call(styleButtons, menuOpts);\n    });\n  });\n  buttons.call(styleButtons, menuOpts);\n\n  if (isVertical) {\n    scrollBoxPosition.w = Math.max(dims.openWidth, dims.headerWidth);\n    scrollBoxPosition.h = posOpts.y - scrollBoxPosition.t;\n  } else {\n    scrollBoxPosition.w = posOpts.x - scrollBoxPosition.l;\n    scrollBoxPosition.h = Math.max(dims.openHeight, dims.headerHeight);\n  }\n\n  scrollBoxPosition.direction = menuOpts.direction;\n\n  if (scrollBox) {\n    if (buttons.size()) {\n      drawScrollBox(gd, gHeader, gButton, scrollBox, menuOpts, scrollBoxPosition);\n    } else {\n      hideScrollBox(scrollBox);\n    }\n  }\n}\n\nfunction drawScrollBox(gd, gHeader, gButton, scrollBox, menuOpts, position) {\n  // enable the scrollbox\n  var direction = menuOpts.direction;\n  var isVertical = direction === 'up' || direction === 'down';\n  var dims = menuOpts._dims;\n  var active = menuOpts.active;\n  var translateX, translateY;\n  var i;\n\n  if (isVertical) {\n    translateY = 0;\n\n    for (i = 0; i < active; i++) {\n      translateY += dims.heights[i] + constants.gapButton;\n    }\n  } else {\n    translateX = 0;\n\n    for (i = 0; i < active; i++) {\n      translateX += dims.widths[i] + constants.gapButton;\n    }\n  }\n\n  scrollBox.enable(position, translateX, translateY);\n\n  if (scrollBox.hbar) {\n    scrollBox.hbar.attr('opacity', '0').transition().attr('opacity', '1');\n  }\n\n  if (scrollBox.vbar) {\n    scrollBox.vbar.attr('opacity', '0').transition().attr('opacity', '1');\n  }\n}\n\nfunction hideScrollBox(scrollBox) {\n  var hasHBar = !!scrollBox.hbar;\n  var hasVBar = !!scrollBox.vbar;\n\n  if (hasHBar) {\n    scrollBox.hbar.transition().attr('opacity', '0').each('end', function () {\n      hasHBar = false;\n      if (!hasVBar) scrollBox.disable();\n    });\n  }\n\n  if (hasVBar) {\n    scrollBox.vbar.transition().attr('opacity', '0').each('end', function () {\n      hasVBar = false;\n      if (!hasHBar) scrollBox.disable();\n    });\n  }\n}\n\nfunction drawItem(item, menuOpts, itemOpts, gd) {\n  item.call(drawItemRect, menuOpts).call(drawItemText, menuOpts, itemOpts, gd);\n}\n\nfunction drawItemRect(item, menuOpts) {\n  var rect = Lib.ensureSingle(item, 'rect', constants.itemRectClassName, function (s) {\n    s.attr({\n      rx: constants.rx,\n      ry: constants.ry,\n      'shape-rendering': 'crispEdges'\n    });\n  });\n  rect.call(Color.stroke, menuOpts.bordercolor).call(Color.fill, menuOpts.bgcolor).style('stroke-width', menuOpts.borderwidth + 'px');\n}\n\nfunction drawItemText(item, menuOpts, itemOpts, gd) {\n  var text = Lib.ensureSingle(item, 'text', constants.itemTextClassName, function (s) {\n    s.classed('user-select-none', true).attr({\n      'text-anchor': 'start',\n      'data-notex': 1\n    });\n  });\n  var tx = itemOpts.label;\n  var _meta = gd._fullLayout._meta;\n  if (_meta) tx = Lib.templateString(tx, _meta);\n  text.call(Drawing.font, menuOpts.font).text(tx).call(svgTextUtils.convertToTspans, gd);\n}\n\nfunction styleButtons(buttons, menuOpts) {\n  var active = menuOpts.active;\n  buttons.each(function (buttonOpts, i) {\n    var button = d3.select(this);\n\n    if (i === active && menuOpts.showactive) {\n      button.select('rect.' + constants.itemRectClassName).call(Color.fill, constants.activeColor);\n    }\n  });\n}\n\nfunction styleOnMouseOver(item) {\n  item.select('rect.' + constants.itemRectClassName).call(Color.fill, constants.hoverColor);\n}\n\nfunction styleOnMouseOut(item, menuOpts) {\n  item.select('rect.' + constants.itemRectClassName).call(Color.fill, menuOpts.bgcolor);\n} // find item dimensions (this mutates menuOpts)\n\n\nfunction findDimensions(gd, menuOpts) {\n  var dims = menuOpts._dims = {\n    width1: 0,\n    height1: 0,\n    heights: [],\n    widths: [],\n    totalWidth: 0,\n    totalHeight: 0,\n    openWidth: 0,\n    openHeight: 0,\n    lx: 0,\n    ly: 0\n  };\n  var fakeButtons = Drawing.tester.selectAll('g.' + constants.dropdownButtonClassName).data(Lib.filterVisible(menuOpts.buttons));\n  fakeButtons.enter().append('g').classed(constants.dropdownButtonClassName, true);\n  var isVertical = ['up', 'down'].indexOf(menuOpts.direction) !== -1; // loop over fake buttons to find width / height\n\n  fakeButtons.each(function (buttonOpts, i) {\n    var button = d3.select(this);\n    button.call(drawItem, menuOpts, buttonOpts, gd);\n    var text = button.select('.' + constants.itemTextClassName); // width is given by max width of all buttons\n\n    var tWidth = text.node() && Drawing.bBox(text.node()).width;\n    var wEff = Math.max(tWidth + constants.textPadX, constants.minWidth); // height is determined by item text\n\n    var tHeight = menuOpts.font.size * LINE_SPACING;\n    var tLines = svgTextUtils.lineCount(text);\n    var hEff = Math.max(tHeight * tLines, constants.minHeight) + constants.textOffsetY;\n    hEff = Math.ceil(hEff);\n    wEff = Math.ceil(wEff); // Store per-item sizes since a row of horizontal buttons, for example,\n    // don't all need to be the same width:\n\n    dims.widths[i] = wEff;\n    dims.heights[i] = hEff; // Height and width of individual element:\n\n    dims.height1 = Math.max(dims.height1, hEff);\n    dims.width1 = Math.max(dims.width1, wEff);\n\n    if (isVertical) {\n      dims.totalWidth = Math.max(dims.totalWidth, wEff);\n      dims.openWidth = dims.totalWidth;\n      dims.totalHeight += hEff + constants.gapButton;\n      dims.openHeight += hEff + constants.gapButton;\n    } else {\n      dims.totalWidth += wEff + constants.gapButton;\n      dims.openWidth += wEff + constants.gapButton;\n      dims.totalHeight = Math.max(dims.totalHeight, hEff);\n      dims.openHeight = dims.totalHeight;\n    }\n  });\n\n  if (isVertical) {\n    dims.totalHeight -= constants.gapButton;\n  } else {\n    dims.totalWidth -= constants.gapButton;\n  }\n\n  dims.headerWidth = dims.width1 + constants.arrowPadX;\n  dims.headerHeight = dims.height1;\n\n  if (menuOpts.type === 'dropdown') {\n    if (isVertical) {\n      dims.width1 += constants.arrowPadX;\n      dims.totalHeight = dims.height1;\n    } else {\n      dims.totalWidth = dims.width1;\n    }\n\n    dims.totalWidth += constants.arrowPadX;\n  }\n\n  fakeButtons.remove();\n  var paddedWidth = dims.totalWidth + menuOpts.pad.l + menuOpts.pad.r;\n  var paddedHeight = dims.totalHeight + menuOpts.pad.t + menuOpts.pad.b;\n  var graphSize = gd._fullLayout._size;\n  dims.lx = graphSize.l + graphSize.w * menuOpts.x;\n  dims.ly = graphSize.t + graphSize.h * (1 - menuOpts.y);\n  var xanchor = 'left';\n\n  if (Lib.isRightAnchor(menuOpts)) {\n    dims.lx -= paddedWidth;\n    xanchor = 'right';\n  }\n\n  if (Lib.isCenterAnchor(menuOpts)) {\n    dims.lx -= paddedWidth / 2;\n    xanchor = 'center';\n  }\n\n  var yanchor = 'top';\n\n  if (Lib.isBottomAnchor(menuOpts)) {\n    dims.ly -= paddedHeight;\n    yanchor = 'bottom';\n  }\n\n  if (Lib.isMiddleAnchor(menuOpts)) {\n    dims.ly -= paddedHeight / 2;\n    yanchor = 'middle';\n  }\n\n  dims.totalWidth = Math.ceil(dims.totalWidth);\n  dims.totalHeight = Math.ceil(dims.totalHeight);\n  dims.lx = Math.round(dims.lx);\n  dims.ly = Math.round(dims.ly);\n  Plots.autoMargin(gd, autoMarginId(menuOpts), {\n    x: menuOpts.x,\n    y: menuOpts.y,\n    l: paddedWidth * ({\n      right: 1,\n      center: 0.5\n    }[xanchor] || 0),\n    r: paddedWidth * ({\n      left: 1,\n      center: 0.5\n    }[xanchor] || 0),\n    b: paddedHeight * ({\n      top: 1,\n      middle: 0.5\n    }[yanchor] || 0),\n    t: paddedHeight * ({\n      bottom: 1,\n      middle: 0.5\n    }[yanchor] || 0)\n  });\n}\n\nfunction autoMarginId(menuOpts) {\n  return constants.autoMarginIdRoot + menuOpts._index;\n} // set item positions (mutates posOpts)\n\n\nfunction setItemPosition(item, menuOpts, posOpts, overrideOpts) {\n  overrideOpts = overrideOpts || {};\n  var rect = item.select('.' + constants.itemRectClassName);\n  var text = item.select('.' + constants.itemTextClassName);\n  var borderWidth = menuOpts.borderwidth;\n  var index = posOpts.index;\n  var dims = menuOpts._dims;\n  Drawing.setTranslate(item, borderWidth + posOpts.x, borderWidth + posOpts.y);\n  var isVertical = ['up', 'down'].indexOf(menuOpts.direction) !== -1;\n  var finalHeight = overrideOpts.height || (isVertical ? dims.heights[index] : dims.height1);\n  rect.attr({\n    x: 0,\n    y: 0,\n    width: overrideOpts.width || (isVertical ? dims.width1 : dims.widths[index]),\n    height: finalHeight\n  });\n  var tHeight = menuOpts.font.size * LINE_SPACING;\n  var tLines = svgTextUtils.lineCount(text);\n  var spanOffset = (tLines - 1) * tHeight / 2;\n  svgTextUtils.positionText(text, constants.textOffsetX, finalHeight / 2 - spanOffset + constants.textOffsetY);\n\n  if (isVertical) {\n    posOpts.y += dims.heights[index] + posOpts.yPad;\n  } else {\n    posOpts.x += dims.widths[index] + posOpts.xPad;\n  }\n\n  posOpts.index++;\n}\n\nfunction removeAllButtons(gButton, newMenuIndexAttr) {\n  gButton.attr(constants.menuIndexAttrName, newMenuIndexAttr || '-1').selectAll('g.' + constants.dropdownButtonClassName).remove();\n}","var global = require('../internals/global');\n\nmodule.exports = global.Promise;\n","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Color = require('../../components/color');\n\nvar subtypes = require('./subtypes');\n\nmodule.exports = function getTraceColor(trace, di) {\n  var lc, tc; // TODO: text modes\n\n  if (trace.mode === 'lines') {\n    lc = trace.line.color;\n    return lc && Color.opacity(lc) ? lc : trace.fillcolor;\n  } else if (trace.mode === 'none') {\n    return trace.fill ? trace.fillcolor : '';\n  } else {\n    var mc = di.mcc || (trace.marker || {}).color;\n    var mlc = di.mlcc || ((trace.marker || {}).line || {}).color;\n    tc = mc && Color.opacity(mc) ? mc : mlc && Color.opacity(mlc) && (di.mlw || ((trace.marker || {}).line || {}).width) ? mlc : '';\n\n    if (tc) {\n      // make sure the points aren't TOO transparent\n      if (Color.opacity(tc) < 0.3) {\n        return Color.addOpacity(tc, 0.3);\n      } else return tc;\n    } else {\n      lc = (trace.line || {}).color;\n      return lc && Color.opacity(lc) && subtypes.hasLines(trace) && trace.line.width ? lc : trace.fillcolor;\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Registry = require('../registry');\n\nvar Lib = require('../lib');\n\nvar extendFlat = Lib.extendFlat;\nvar extendDeep = Lib.extendDeep; // Put default plotTile layouts here\n\nfunction cloneLayoutOverride(tileClass) {\n  var override;\n\n  switch (tileClass) {\n    case 'themes__thumb':\n      override = {\n        autosize: true,\n        width: 150,\n        height: 150,\n        title: {\n          text: ''\n        },\n        showlegend: false,\n        margin: {\n          l: 5,\n          r: 5,\n          t: 5,\n          b: 5,\n          pad: 0\n        },\n        annotations: []\n      };\n      break;\n\n    case 'thumbnail':\n      override = {\n        title: {\n          text: ''\n        },\n        hidesources: true,\n        showlegend: false,\n        borderwidth: 0,\n        bordercolor: '',\n        margin: {\n          l: 1,\n          r: 1,\n          t: 1,\n          b: 1,\n          pad: 0\n        },\n        annotations: []\n      };\n      break;\n\n    default:\n      override = {};\n  }\n\n  return override;\n}\n\nfunction keyIsAxis(keyName) {\n  var types = ['xaxis', 'yaxis', 'zaxis'];\n  return types.indexOf(keyName.slice(0, 5)) > -1;\n}\n\nmodule.exports = function clonePlot(graphObj, options) {\n  // Polar plot compatibility\n  if (graphObj.framework && graphObj.framework.isPolar) {\n    graphObj = graphObj.framework.getConfig();\n  }\n\n  var i;\n  var oldData = graphObj.data;\n  var oldLayout = graphObj.layout;\n  var newData = extendDeep([], oldData);\n  var newLayout = extendDeep({}, oldLayout, cloneLayoutOverride(options.tileClass));\n  var context = graphObj._context || {};\n  if (options.width) newLayout.width = options.width;\n  if (options.height) newLayout.height = options.height;\n\n  if (options.tileClass === 'thumbnail' || options.tileClass === 'themes__thumb') {\n    // kill annotations\n    newLayout.annotations = [];\n    var keys = Object.keys(newLayout);\n\n    for (i = 0; i < keys.length; i++) {\n      if (keyIsAxis(keys[i])) {\n        newLayout[keys[i]].title = {\n          text: ''\n        };\n      }\n    } // kill colorbar and pie labels\n\n\n    for (i = 0; i < newData.length; i++) {\n      var trace = newData[i];\n      trace.showscale = false;\n      if (trace.marker) trace.marker.showscale = false;\n      if (Registry.traceIs(trace, 'pie-like')) trace.textposition = 'none';\n    }\n  }\n\n  if (Array.isArray(options.annotations)) {\n    for (i = 0; i < options.annotations.length; i++) {\n      newLayout.annotations.push(options.annotations[i]);\n    }\n  } // TODO: does this scene modification really belong here?\n  // If we still need it, can it move into the gl3d module?\n\n\n  var sceneIds = Object.keys(newLayout).filter(function (key) {\n    return key.match(/^scene\\d*$/);\n  });\n\n  if (sceneIds.length) {\n    var axesImageOverride = {};\n\n    if (options.tileClass === 'thumbnail') {\n      axesImageOverride = {\n        title: {\n          text: ''\n        },\n        showaxeslabels: false,\n        showticklabels: false,\n        linetickenable: false\n      };\n    }\n\n    for (i = 0; i < sceneIds.length; i++) {\n      var scene = newLayout[sceneIds[i]];\n\n      if (!scene.xaxis) {\n        scene.xaxis = {};\n      }\n\n      if (!scene.yaxis) {\n        scene.yaxis = {};\n      }\n\n      if (!scene.zaxis) {\n        scene.zaxis = {};\n      }\n\n      extendFlat(scene.xaxis, axesImageOverride);\n      extendFlat(scene.yaxis, axesImageOverride);\n      extendFlat(scene.zaxis, axesImageOverride); // TODO what does this do?\n\n      scene._scene = null;\n    }\n  }\n\n  var gd = document.createElement('div');\n  if (options.tileClass) gd.className = options.tileClass;\n  var plotTile = {\n    gd: gd,\n    td: gd,\n    // for external (image server) compatibility\n    layout: newLayout,\n    data: newData,\n    config: {\n      staticPlot: options.staticPlot === undefined ? true : options.staticPlot,\n      plotGlPixelRatio: options.plotGlPixelRatio === undefined ? 2 : options.plotGlPixelRatio,\n      displaylogo: options.displaylogo || false,\n      showLink: options.showLink || false,\n      showTips: options.showTips || false,\n      mapboxAccessToken: context.mapboxAccessToken\n    }\n  };\n\n  if (options.setBackground !== 'transparent') {\n    plotTile.config.setBackground = options.setBackground || 'opaque';\n  } // attaching the default Layout the gd, so you can grab it later\n\n\n  plotTile.gd.defaultLayout = cloneLayoutOverride(options.tileClass);\n  return plotTile;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nfunction findCategories(ax, opts) {\n  var dataAttr = opts.dataAttr || ax._id.charAt(0);\n\n  var lookup = {};\n  var axData;\n  var i, j;\n\n  if (opts.axData) {\n    // non-x/y case\n    axData = opts.axData;\n  } else {\n    // x/y case\n    axData = [];\n\n    for (i = 0; i < opts.data.length; i++) {\n      var trace = opts.data[i];\n\n      if (trace[dataAttr + 'axis'] === ax._id) {\n        axData.push(trace);\n      }\n    }\n  }\n\n  for (i = 0; i < axData.length; i++) {\n    var vals = axData[i][dataAttr];\n\n    for (j = 0; j < vals.length; j++) {\n      var v = vals[j];\n\n      if (v !== null && v !== undefined) {\n        lookup[v] = 1;\n      }\n    }\n  }\n\n  return Object.keys(lookup);\n}\n/**\n * Fills in category* default and initial categories.\n *\n * @param {object} containerIn : input axis object\n * @param {object} containerOut : full axis object\n * @param {function} coerce : Lib.coerce fn wrapper\n * @param {object} opts :\n *   - data {array} : (full) data trace\n * OR\n *   - axData {array} : (full) data associated with axis being coerced here\n *   - dataAttr {string} : attribute name corresponding to coordinate array\n */\n\n\nmodule.exports = function handleCategoryOrderDefaults(containerIn, containerOut, coerce, opts) {\n  if (containerOut.type !== 'category') return;\n  var arrayIn = containerIn.categoryarray;\n  var isValidArray = Array.isArray(arrayIn) && arrayIn.length > 0; // override default 'categoryorder' value when non-empty array is supplied\n\n  var orderDefault;\n  if (isValidArray) orderDefault = 'array';\n  var order = coerce('categoryorder', orderDefault);\n  var array; // coerce 'categoryarray' only in array order case\n\n  if (order === 'array') {\n    array = coerce('categoryarray');\n  } // cannot set 'categoryorder' to 'array' with an invalid 'categoryarray'\n\n\n  if (!isValidArray && order === 'array') {\n    order = containerOut.categoryorder = 'trace';\n  } // set up things for makeCalcdata\n\n\n  if (order === 'trace') {\n    containerOut._initialCategories = [];\n  } else if (order === 'array') {\n    containerOut._initialCategories = array.slice();\n  } else {\n    array = findCategories(containerOut, opts).sort();\n\n    if (order === 'category ascending') {\n      containerOut._initialCategories = array;\n    } else if (order === 'category descending') {\n      containerOut._initialCategories = array.reverse();\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar fontAttrs = require('../../plots/font_attributes');\n\nvar colorAttrs = require('../color/attributes');\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nvar buttonAttrs = templatedArray('button', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    editType: 'plot',\n    description: 'Determines whether or not this button is visible.'\n  },\n  step: {\n    valType: 'enumerated',\n    role: 'info',\n    values: ['month', 'year', 'day', 'hour', 'minute', 'second', 'all'],\n    dflt: 'month',\n    editType: 'plot',\n    description: ['The unit of measurement that the `count` value will set the range by.'].join(' ')\n  },\n  stepmode: {\n    valType: 'enumerated',\n    role: 'info',\n    values: ['backward', 'todate'],\n    dflt: 'backward',\n    editType: 'plot',\n    description: ['Sets the range update mode.', 'If *backward*, the range update shifts the start of range', 'back *count* times *step* milliseconds.', 'If *todate*, the range update shifts the start of range', 'back to the first timestamp from *count* times', '*step* milliseconds back.', 'For example, with `step` set to *year* and `count` set to *1*', 'the range update shifts the start of the range back to', 'January 01 of the current year.', 'Month and year *todate* are currently available only', 'for the built-in (Gregorian) calendar.'].join(' ')\n  },\n  count: {\n    valType: 'number',\n    role: 'info',\n    min: 0,\n    dflt: 1,\n    editType: 'plot',\n    description: ['Sets the number of steps to take to update the range.', 'Use with `step` to specify the update interval.'].join(' ')\n  },\n  label: {\n    valType: 'string',\n    role: 'info',\n    editType: 'plot',\n    description: 'Sets the text label to appear on the button.'\n  },\n  editType: 'plot',\n  description: ['Sets the specifications for each buttons.', 'By default, a range selector comes with no buttons.'].join(' ')\n});\nmodule.exports = {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    editType: 'plot',\n    description: ['Determines whether or not this range selector is visible.', 'Note that range selectors are only available for x axes of', '`type` set to or auto-typed to *date*.'].join(' ')\n  },\n  buttons: buttonAttrs,\n  x: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the x position (in normalized coordinates) of the range selector.'\n  },\n  xanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'left', 'center', 'right'],\n    dflt: 'left',\n    role: 'info',\n    editType: 'plot',\n    description: ['Sets the range selector\\'s horizontal position anchor.', 'This anchor binds the `x` position to the *left*, *center*', 'or *right* of the range selector.'].join(' ')\n  },\n  y: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the y position (in normalized coordinates) of the range selector.'\n  },\n  yanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'top', 'middle', 'bottom'],\n    dflt: 'bottom',\n    role: 'info',\n    editType: 'plot',\n    description: ['Sets the range selector\\'s vertical position anchor', 'This anchor binds the `y` position to the *top*, *middle*', 'or *bottom* of the range selector.'].join(' ')\n  },\n  font: fontAttrs({\n    editType: 'plot',\n    description: 'Sets the font of the range selector button text.'\n  }),\n  bgcolor: {\n    valType: 'color',\n    dflt: colorAttrs.lightLine,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the background color of the range selector buttons.'\n  },\n  activecolor: {\n    valType: 'color',\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the background color of the active range selector button.'\n  },\n  bordercolor: {\n    valType: 'color',\n    dflt: colorAttrs.defaultLine,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the color of the border enclosing the range selector.'\n  },\n  borderwidth: {\n    valType: 'number',\n    min: 0,\n    dflt: 0,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the width (in px) of the border enclosing the range selector.'\n  },\n  editType: 'plot'\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar cartesianConstants = require('../../plots/cartesian/constants');\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nmodule.exports = templatedArray('image', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    editType: 'arraydraw',\n    description: ['Determines whether or not this image is visible.'].join(' ')\n  },\n  source: {\n    valType: 'string',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Specifies the URL of the image to be used.', 'The URL must be accessible from the domain where the', 'plot code is run, and can be either relative or absolute.'].join(' ')\n  },\n  layer: {\n    valType: 'enumerated',\n    values: ['below', 'above'],\n    dflt: 'above',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Specifies whether images are drawn below or above traces.', 'When `xref` and `yref` are both set to `paper`,', 'image is drawn below the entire plot area.'].join(' ')\n  },\n  sizex: {\n    valType: 'number',\n    role: 'info',\n    dflt: 0,\n    editType: 'arraydraw',\n    description: ['Sets the image container size horizontally.', 'The image will be sized based on the `position` value.', 'When `xref` is set to `paper`, units are sized relative', 'to the plot width.'].join(' ')\n  },\n  sizey: {\n    valType: 'number',\n    role: 'info',\n    dflt: 0,\n    editType: 'arraydraw',\n    description: ['Sets the image container size vertically.', 'The image will be sized based on the `position` value.', 'When `yref` is set to `paper`, units are sized relative', 'to the plot height.'].join(' ')\n  },\n  sizing: {\n    valType: 'enumerated',\n    values: ['fill', 'contain', 'stretch'],\n    dflt: 'contain',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Specifies which dimension of the image to constrain.'].join(' ')\n  },\n  opacity: {\n    valType: 'number',\n    role: 'info',\n    min: 0,\n    max: 1,\n    dflt: 1,\n    editType: 'arraydraw',\n    description: 'Sets the opacity of the image.'\n  },\n  x: {\n    valType: 'any',\n    role: 'info',\n    dflt: 0,\n    editType: 'arraydraw',\n    description: ['Sets the image\\'s x position.', 'When `xref` is set to `paper`, units are sized relative', 'to the plot height.', 'See `xref` for more info'].join(' ')\n  },\n  y: {\n    valType: 'any',\n    role: 'info',\n    dflt: 0,\n    editType: 'arraydraw',\n    description: ['Sets the image\\'s y position.', 'When `yref` is set to `paper`, units are sized relative', 'to the plot height.', 'See `yref` for more info'].join(' ')\n  },\n  xanchor: {\n    valType: 'enumerated',\n    values: ['left', 'center', 'right'],\n    dflt: 'left',\n    role: 'info',\n    editType: 'arraydraw',\n    description: 'Sets the anchor for the x position'\n  },\n  yanchor: {\n    valType: 'enumerated',\n    values: ['top', 'middle', 'bottom'],\n    dflt: 'top',\n    role: 'info',\n    editType: 'arraydraw',\n    description: 'Sets the anchor for the y position.'\n  },\n  xref: {\n    valType: 'enumerated',\n    values: ['paper', cartesianConstants.idRegex.x.toString()],\n    dflt: 'paper',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Sets the images\\'s x coordinate axis.', 'If set to a x axis id (e.g. *x* or *x2*), the `x` position', 'refers to an x data coordinate', 'If set to *paper*, the `x` position refers to the distance from', 'the left of plot in normalized coordinates', 'where *0* (*1*) corresponds to the left (right).'].join(' ')\n  },\n  yref: {\n    valType: 'enumerated',\n    values: ['paper', cartesianConstants.idRegex.y.toString()],\n    dflt: 'paper',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Sets the images\\'s y coordinate axis.', 'If set to a y axis id (e.g. *y* or *y2*), the `y` position', 'refers to a y data coordinate.', 'If set to *paper*, the `y` position refers to the distance from', 'the bottom of the plot in normalized coordinates', 'where *0* (*1*) corresponds to the bottom (top).'].join(' ')\n  },\n  editType: 'arraydraw'\n});","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Registry = require('../../registry');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar Lib = require('../../lib');\n\nvar makeComputeError = require('./compute_error');\n\nmodule.exports = function calc(gd) {\n  var calcdata = gd.calcdata;\n\n  for (var i = 0; i < calcdata.length; i++) {\n    var calcTrace = calcdata[i];\n    var trace = calcTrace[0].trace;\n\n    if (trace.visible === true && Registry.traceIs(trace, 'errorBarsOK')) {\n      var xa = Axes.getFromId(gd, trace.xaxis);\n      var ya = Axes.getFromId(gd, trace.yaxis);\n      calcOneAxis(calcTrace, trace, xa, 'x');\n      calcOneAxis(calcTrace, trace, ya, 'y');\n    }\n  }\n};\n\nfunction calcOneAxis(calcTrace, trace, axis, coord) {\n  var opts = trace['error_' + coord] || {};\n  var isVisible = opts.visible && ['linear', 'log'].indexOf(axis.type) !== -1;\n  var vals = [];\n  if (!isVisible) return;\n  var computeError = makeComputeError(opts);\n\n  for (var i = 0; i < calcTrace.length; i++) {\n    var calcPt = calcTrace[i];\n    var iIn = calcPt.i; // for types that don't include `i` in each calcdata point\n\n    if (iIn === undefined) iIn = i; // for stacked area inserted points\n    // TODO: errorbars have been tested cursorily with stacked area,\n    // but not thoroughly. It's not even really clear what you want to do:\n    // Should it just be calculated based on that trace's size data?\n    // Should you add errors from below in quadrature?\n    // And what about normalization, where in principle the errors shrink\n    // again when you get up to the top end?\n    // One option would be to forbid errorbars with stacking until we\n    // decide how to handle these questions.\n    else if (iIn === null) continue;\n    var calcCoord = calcPt[coord];\n    if (!isNumeric(axis.c2l(calcCoord))) continue;\n    var errors = computeError(calcCoord, iIn);\n\n    if (isNumeric(errors[0]) && isNumeric(errors[1])) {\n      var shoe = calcPt[coord + 's'] = calcCoord - errors[0];\n      var hat = calcPt[coord + 'h'] = calcCoord + errors[1];\n      vals.push(shoe, hat);\n    }\n  }\n\n  var axId = axis._id;\n  var baseExtremes = trace._extremes[axId];\n  var extremes = Axes.findExtremes(axis, vals, Lib.extendFlat({\n    tozero: baseExtremes.opts.tozero\n  }, {\n    padded: true\n  }));\n  baseExtremes.min = baseExtremes.min.concat(extremes.min);\n  baseExtremes.max = baseExtremes.max.concat(extremes.max);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar attributes = require('./attributes');\n\nvar constants = require('./constants');\n\nvar name = constants.name;\nvar buttonAttrs = attributes.buttons;\n\nmodule.exports = function updateMenusDefaults(layoutIn, layoutOut) {\n  var opts = {\n    name: name,\n    handleItemDefaults: menuDefaults\n  };\n  handleArrayContainerDefaults(layoutIn, layoutOut, opts);\n};\n\nfunction menuDefaults(menuIn, menuOut, layoutOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(menuIn, menuOut, attributes, attr, dflt);\n  }\n\n  var buttons = handleArrayContainerDefaults(menuIn, menuOut, {\n    name: 'buttons',\n    handleItemDefaults: buttonDefaults\n  });\n  var visible = coerce('visible', buttons.length > 0);\n  if (!visible) return;\n  coerce('active');\n  coerce('direction');\n  coerce('type');\n  coerce('showactive');\n  coerce('x');\n  coerce('y');\n  Lib.noneOrAll(menuIn, menuOut, ['x', 'y']);\n  coerce('xanchor');\n  coerce('yanchor');\n  coerce('pad.t');\n  coerce('pad.r');\n  coerce('pad.b');\n  coerce('pad.l');\n  Lib.coerceFont(coerce, 'font', layoutOut.font);\n  coerce('bgcolor', layoutOut.paper_bgcolor);\n  coerce('bordercolor');\n  coerce('borderwidth');\n}\n\nfunction buttonDefaults(buttonIn, buttonOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(buttonIn, buttonOut, buttonAttrs, attr, dflt);\n  }\n\n  var visible = coerce('visible', buttonIn.method === 'skip' || Array.isArray(buttonIn.args));\n\n  if (visible) {\n    coerce('method');\n    coerce('args');\n    coerce('args2');\n    coerce('label');\n    coerce('execute');\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nmodule.exports = function convert(scene) {\n  var fullSceneLayout = scene.fullSceneLayout;\n  var anns = fullSceneLayout.annotations;\n\n  for (var i = 0; i < anns.length; i++) {\n    mockAnnAxes(anns[i], scene);\n  }\n\n  scene.fullLayout._infolayer.selectAll('.annotation-' + scene.id).remove();\n};\n\nfunction mockAnnAxes(ann, scene) {\n  var fullSceneLayout = scene.fullSceneLayout;\n  var domain = fullSceneLayout.domain;\n  var size = scene.fullLayout._size;\n  var base = {\n    // this gets fill in on render\n    pdata: null,\n    // to get setConvert to not execute cleanly\n    type: 'linear',\n    // don't try to update them on `editable: true`\n    autorange: false,\n    // set infinite range so that annotation draw routine\n    // does not try to remove 'outside-range' annotations,\n    // this case is handled in the render loop\n    range: [-Infinity, Infinity]\n  };\n  ann._xa = {};\n  Lib.extendFlat(ann._xa, base);\n  Axes.setConvert(ann._xa);\n  ann._xa._offset = size.l + domain.x[0] * size.w;\n\n  ann._xa.l2p = function () {\n    return 0.5 * (1 + ann._pdata[0] / ann._pdata[3]) * size.w * (domain.x[1] - domain.x[0]);\n  };\n\n  ann._ya = {};\n  Lib.extendFlat(ann._ya, base);\n  Axes.setConvert(ann._ya);\n  ann._ya._offset = size.t + (1 - domain.y[1]) * size.h;\n\n  ann._ya.l2p = function () {\n    return 0.5 * (1 - ann._pdata[1] / ann._pdata[3]) * size.h * (domain.y[1] - domain.y[0]);\n  };\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  // layout attribute name\n  name: 'sliders',\n  // class names\n  containerClassName: 'slider-container',\n  groupClassName: 'slider-group',\n  inputAreaClass: 'slider-input-area',\n  railRectClass: 'slider-rail-rect',\n  railTouchRectClass: 'slider-rail-touch-rect',\n  gripRectClass: 'slider-grip-rect',\n  tickRectClass: 'slider-tick-rect',\n  inputProxyClass: 'slider-input-proxy',\n  labelsClass: 'slider-labels',\n  labelGroupClass: 'slider-label-group',\n  labelClass: 'slider-label',\n  currentValueClass: 'slider-current-value',\n  railHeight: 5,\n  // DOM attribute name in button group keeping track\n  // of active update menu\n  menuIndexAttrName: 'slider-active-index',\n  // id root pass to Plots.autoMargin\n  autoMarginIdRoot: 'slider-',\n  // min item width / height\n  minWidth: 30,\n  minHeight: 30,\n  // padding around item text\n  textPadX: 40,\n  // arrow offset off right edge\n  arrowOffsetX: 4,\n  railRadius: 2,\n  railWidth: 5,\n  railBorder: 4,\n  railBorderWidth: 1,\n  railBorderColor: '#bec8d9',\n  railBgColor: '#f8fafc',\n  // The distance of the rail from the edge of the touchable area\n  // Slightly less than the step inset because of the curved edges\n  // of the rail\n  railInset: 8,\n  // The distance from the extremal tick marks to the edge of the\n  // touchable area. This is basically the same as the grip radius,\n  // but for other styles it wouldn't really need to be.\n  stepInset: 10,\n  gripRadius: 10,\n  gripWidth: 20,\n  gripHeight: 20,\n  gripBorder: 20,\n  gripBorderWidth: 1,\n  gripBorderColor: '#bec8d9',\n  gripBgColor: '#f6f8fa',\n  gripBgActiveColor: '#dbdde0',\n  labelPadding: 8,\n  labelOffset: 0,\n  tickWidth: 1,\n  tickColor: '#333',\n  tickOffset: 25,\n  tickLength: 7,\n  minorTickOffset: 25,\n  minorTickColor: '#333',\n  minorTickLength: 4,\n  // Extra space below the current value label:\n  currentValuePadding: 8,\n  currentValueInset: 0\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar helpers = require('./helpers');\n/*\n* substantial portions of this code from FileSaver.js\n* https://github.com/eligrey/FileSaver.js\n* License: https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n* 1.1.20160328\n*\n* By Eli Grey, http://eligrey.com\n* License: MIT\n*   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n*/\n\n\nfunction fileSaver(url, name, format) {\n  var saveLink = document.createElement('a');\n  var canUseSaveLink = ('download' in saveLink);\n  var promise = new Promise(function (resolve, reject) {\n    var blob;\n    var objectUrl;\n\n    if (Lib.isIE9orBelow()) {\n      reject(new Error('IE < 10 unsupported'));\n    } // Safari doesn't allow downloading of blob urls\n\n\n    if (Lib.isSafari()) {\n      var prefix = format === 'svg' ? ',' : ';base64,';\n      helpers.octetStream(prefix + encodeURIComponent(url));\n      return resolve(name);\n    } // IE 10+ (native saveAs)\n\n\n    if (Lib.isIE()) {\n      // At this point we are only dealing with a decoded SVG as\n      // a data URL (since IE only supports SVG)\n      blob = helpers.createBlob(url, 'svg');\n      window.navigator.msSaveBlob(blob, name);\n      blob = null;\n      return resolve(name);\n    }\n\n    if (canUseSaveLink) {\n      blob = helpers.createBlob(url, format);\n      objectUrl = helpers.createObjectURL(blob);\n      saveLink.href = objectUrl;\n      saveLink.download = name;\n      document.body.appendChild(saveLink);\n      saveLink.click();\n      document.body.removeChild(saveLink);\n      helpers.revokeObjectURL(objectUrl);\n      blob = null;\n      return resolve(name);\n    }\n\n    reject(new Error('download error'));\n  });\n  return promise;\n}\n\nmodule.exports = fileSaver;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n/*\n * opts: object of flags to control features not all text users support\n *   noSelect: caller does not support selected/unselected attribute containers\n */\n\n\nmodule.exports = function (traceIn, traceOut, layout, coerce, opts) {\n  opts = opts || {};\n  coerce('textposition');\n  Lib.coerceFont(coerce, 'textfont', layout.font);\n\n  if (!opts.noSelect) {\n    coerce('selected.textfont.color');\n    coerce('unselected.textfont.color');\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict'; // common to 'scatter' and 'scatterternary'\n\nmodule.exports = function handleLineShapeDefaults(traceIn, traceOut, coerce) {\n  var shape = coerce('line.shape');\n  if (shape === 'spline') coerce('line.smoothing');\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar Registry = require('../registry');\n\nvar Lib = require('../lib');\n\nvar helpers = require('./helpers');\n\nvar clonePlot = require('./cloneplot');\n\nvar toSVG = require('./tosvg');\n\nvar svgToImg = require('./svgtoimg');\n/**\n * @param {object} gd figure Object\n * @param {object} opts option object\n * @param opts.format 'jpeg' | 'png' | 'webp' | 'svg'\n */\n\n\nfunction toImage(gd, opts) {\n  // first clone the GD so we can operate in a clean environment\n  var ev = new EventEmitter();\n  var clone = clonePlot(gd, {\n    format: 'png'\n  });\n  var clonedGd = clone.gd; // put the cloned div somewhere off screen before attaching to DOM\n\n  clonedGd.style.position = 'absolute';\n  clonedGd.style.left = '-5000px';\n  document.body.appendChild(clonedGd);\n\n  function wait() {\n    var delay = helpers.getDelay(clonedGd._fullLayout);\n    setTimeout(function () {\n      var svg = toSVG(clonedGd);\n      var canvas = document.createElement('canvas');\n      canvas.id = Lib.randstr();\n      ev = svgToImg({\n        format: opts.format,\n        width: clonedGd._fullLayout.width,\n        height: clonedGd._fullLayout.height,\n        canvas: canvas,\n        emitter: ev,\n        svg: svg\n      });\n\n      ev.clean = function () {\n        if (clonedGd) document.body.removeChild(clonedGd);\n      };\n    }, delay);\n  }\n\n  var redrawFunc = helpers.getRedrawFunc(clonedGd);\n  Registry.call('plot', clonedGd, clone.data, clone.layout, clone.config).then(redrawFunc).then(wait).catch(function (err) {\n    ev.emit('error', err);\n  });\n  return ev;\n}\n\nmodule.exports = toImage;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar constants = require('./constants');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: constants.name,\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  draw: require('./draw')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Lib = require('../../lib');\n\nmodule.exports = function handlePositionDefaults(containerIn, containerOut, coerce, options) {\n  var counterAxes = options.counterAxes || [];\n  var overlayableAxes = options.overlayableAxes || [];\n  var letter = options.letter;\n  var grid = options.grid;\n  var dfltAnchor, dfltDomain, dfltSide, dfltPosition;\n\n  if (grid) {\n    dfltDomain = grid._domains[letter][grid._axisMap[containerOut._id]];\n    dfltAnchor = grid._anchors[containerOut._id];\n\n    if (dfltDomain) {\n      dfltSide = grid[letter + 'side'].split(' ')[0];\n      dfltPosition = grid.domain[letter][dfltSide === 'right' || dfltSide === 'top' ? 1 : 0];\n    }\n  } // Even if there's a grid, this axis may not be in it - fall back on non-grid defaults\n\n\n  dfltDomain = dfltDomain || [0, 1];\n  dfltAnchor = dfltAnchor || (isNumeric(containerIn.position) ? 'free' : counterAxes[0] || 'free');\n  dfltSide = dfltSide || (letter === 'x' ? 'bottom' : 'left');\n  dfltPosition = dfltPosition || 0;\n  var anchor = Lib.coerce(containerIn, containerOut, {\n    anchor: {\n      valType: 'enumerated',\n      values: ['free'].concat(counterAxes),\n      dflt: dfltAnchor\n    }\n  }, 'anchor');\n  if (anchor === 'free') coerce('position', dfltPosition);\n  Lib.coerce(containerIn, containerOut, {\n    side: {\n      valType: 'enumerated',\n      values: letter === 'x' ? ['bottom', 'top'] : ['left', 'right'],\n      dflt: dfltSide\n    }\n  }, 'side');\n  var overlaying = false;\n\n  if (overlayableAxes.length) {\n    overlaying = Lib.coerce(containerIn, containerOut, {\n      overlaying: {\n        valType: 'enumerated',\n        values: [false].concat(overlayableAxes),\n        dflt: false\n      }\n    }, 'overlaying');\n  }\n\n  if (!overlaying) {\n    // TODO: right now I'm copying this domain over to overlaying axes\n    // in ax.setscale()... but this means we still need (imperfect) logic\n    // in the axes popover to hide domain for the overlaying axis.\n    // perhaps I should make a private version _domain that all axes get???\n    var domain = coerce('domain', dfltDomain); // according to https://www.npmjs.com/package/canvas-size\n    // the minimum value of max canvas width across browsers and devices is 4096\n    // which applied in the calculation below:\n\n    if (domain[0] > domain[1] - 1 / 4096) containerOut.domain = dfltDomain;\n    Lib.noneOrAll(containerIn.domain, containerOut.domain, dfltDomain);\n  }\n\n  coerce('layer');\n  return containerOut;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  container: 'marker',\n  min: 'cmin',\n  max: 'cmax'\n};","'use strict';\nvar aFunction = require('../internals/a-function');\n\nvar PromiseCapability = function (C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n};\n\n// 25.4.1.5 NewPromiseCapability(C)\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Plots = require('../../plots/plots');\n\nvar Color = require('../color');\n\nvar Drawing = require('../drawing');\n\nvar Lib = require('../../lib');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar arrayEditor = require('../../plot_api/plot_template').arrayEditor;\n\nvar constants = require('./constants');\n\nvar alignmentConstants = require('../../constants/alignment');\n\nvar LINE_SPACING = alignmentConstants.LINE_SPACING;\nvar FROM_TL = alignmentConstants.FROM_TL;\nvar FROM_BR = alignmentConstants.FROM_BR;\n\nmodule.exports = function draw(gd) {\n  var fullLayout = gd._fullLayout;\n  var sliderData = makeSliderData(fullLayout, gd); // draw a container for *all* sliders:\n\n  var sliders = fullLayout._infolayer.selectAll('g.' + constants.containerClassName).data(sliderData.length > 0 ? [0] : []);\n\n  sliders.enter().append('g').classed(constants.containerClassName, true).style('cursor', 'ew-resize');\n\n  function clearSlider(sliderOpts) {\n    if (sliderOpts._commandObserver) {\n      sliderOpts._commandObserver.remove();\n\n      delete sliderOpts._commandObserver;\n    } // Most components don't need to explicitly remove autoMargin, because\n    // marginPushers does this - but slider updates don't go through\n    // a full replot so we need to explicitly remove it.\n\n\n    Plots.autoMargin(gd, autoMarginId(sliderOpts));\n  }\n\n  sliders.exit().each(function () {\n    d3.select(this).selectAll('g.' + constants.groupClassName).each(clearSlider);\n  }).remove(); // Return early if no menus visible:\n\n  if (sliderData.length === 0) return;\n  var sliderGroups = sliders.selectAll('g.' + constants.groupClassName).data(sliderData, keyFunction);\n  sliderGroups.enter().append('g').classed(constants.groupClassName, true);\n  sliderGroups.exit().each(clearSlider).remove(); // Find the dimensions of the sliders:\n\n  for (var i = 0; i < sliderData.length; i++) {\n    var sliderOpts = sliderData[i];\n    findDimensions(gd, sliderOpts);\n  }\n\n  sliderGroups.each(function (sliderOpts) {\n    var gSlider = d3.select(this);\n    computeLabelSteps(sliderOpts);\n    Plots.manageCommandObserver(gd, sliderOpts, sliderOpts._visibleSteps, function (data) {\n      // NB: Same as below. This is *not* always the same as sliderOpts since\n      // if a new set of steps comes in, the reference in this callback would\n      // be invalid. We need to refetch it from the slider group, which is\n      // the join data that creates this slider. So if this slider still exists,\n      // the group should be valid, *to the best of my knowledge.* If not,\n      // we'd have to look it up by d3 data join index/key.\n      var opts = gSlider.data()[0];\n      if (opts.active === data.index) return;\n      if (opts._dragging) return;\n      setActive(gd, gSlider, opts, data.index, false, true);\n    });\n    drawSlider(gd, d3.select(this), sliderOpts);\n  });\n};\n\nfunction autoMarginId(sliderOpts) {\n  return constants.autoMarginIdRoot + sliderOpts._index;\n} // This really only just filters by visibility:\n\n\nfunction makeSliderData(fullLayout, gd) {\n  var contOpts = fullLayout[constants.name];\n  var sliderData = [];\n\n  for (var i = 0; i < contOpts.length; i++) {\n    var item = contOpts[i];\n    if (!item.visible) continue;\n    item._gd = gd;\n    sliderData.push(item);\n  }\n\n  return sliderData;\n} // This is set in the defaults step:\n\n\nfunction keyFunction(opts) {\n  return opts._index;\n} // Compute the dimensions (mutates sliderOpts):\n\n\nfunction findDimensions(gd, sliderOpts) {\n  var sliderLabels = Drawing.tester.selectAll('g.' + constants.labelGroupClass).data(sliderOpts._visibleSteps);\n  sliderLabels.enter().append('g').classed(constants.labelGroupClass, true); // loop over fake buttons to find width / height\n\n  var maxLabelWidth = 0;\n  var labelHeight = 0;\n  sliderLabels.each(function (stepOpts) {\n    var labelGroup = d3.select(this);\n    var text = drawLabel(labelGroup, {\n      step: stepOpts\n    }, sliderOpts);\n    var textNode = text.node();\n\n    if (textNode) {\n      var bBox = Drawing.bBox(textNode);\n      labelHeight = Math.max(labelHeight, bBox.height);\n      maxLabelWidth = Math.max(maxLabelWidth, bBox.width);\n    }\n  });\n  sliderLabels.remove();\n  var dims = sliderOpts._dims = {};\n  dims.inputAreaWidth = Math.max(constants.railWidth, constants.gripHeight); // calculate some overall dimensions - some of these are needed for\n  // calculating the currentValue dimensions\n\n  var graphSize = gd._fullLayout._size;\n  dims.lx = graphSize.l + graphSize.w * sliderOpts.x;\n  dims.ly = graphSize.t + graphSize.h * (1 - sliderOpts.y);\n\n  if (sliderOpts.lenmode === 'fraction') {\n    // fraction:\n    dims.outerLength = Math.round(graphSize.w * sliderOpts.len);\n  } else {\n    // pixels:\n    dims.outerLength = sliderOpts.len;\n  } // The length of the rail, *excluding* padding on either end:\n\n\n  dims.inputAreaStart = 0;\n  dims.inputAreaLength = Math.round(dims.outerLength - sliderOpts.pad.l - sliderOpts.pad.r);\n  var textableInputLength = dims.inputAreaLength - 2 * constants.stepInset;\n  var availableSpacePerLabel = textableInputLength / (sliderOpts._stepCount - 1);\n  var computedSpacePerLabel = maxLabelWidth + constants.labelPadding;\n  dims.labelStride = Math.max(1, Math.ceil(computedSpacePerLabel / availableSpacePerLabel));\n  dims.labelHeight = labelHeight; // loop over all possible values for currentValue to find the\n  // area we need for it\n\n  dims.currentValueMaxWidth = 0;\n  dims.currentValueHeight = 0;\n  dims.currentValueTotalHeight = 0;\n  dims.currentValueMaxLines = 1;\n\n  if (sliderOpts.currentvalue.visible) {\n    // Get the dimensions of the current value label:\n    var dummyGroup = Drawing.tester.append('g');\n    sliderLabels.each(function (stepOpts) {\n      var curValPrefix = drawCurrentValue(dummyGroup, sliderOpts, stepOpts.label);\n      var curValSize = curValPrefix.node() && Drawing.bBox(curValPrefix.node()) || {\n        width: 0,\n        height: 0\n      };\n      var lines = svgTextUtils.lineCount(curValPrefix);\n      dims.currentValueMaxWidth = Math.max(dims.currentValueMaxWidth, Math.ceil(curValSize.width));\n      dims.currentValueHeight = Math.max(dims.currentValueHeight, Math.ceil(curValSize.height));\n      dims.currentValueMaxLines = Math.max(dims.currentValueMaxLines, lines);\n    });\n    dims.currentValueTotalHeight = dims.currentValueHeight + sliderOpts.currentvalue.offset;\n    dummyGroup.remove();\n  }\n\n  dims.height = dims.currentValueTotalHeight + constants.tickOffset + sliderOpts.ticklen + constants.labelOffset + dims.labelHeight + sliderOpts.pad.t + sliderOpts.pad.b;\n  var xanchor = 'left';\n\n  if (Lib.isRightAnchor(sliderOpts)) {\n    dims.lx -= dims.outerLength;\n    xanchor = 'right';\n  }\n\n  if (Lib.isCenterAnchor(sliderOpts)) {\n    dims.lx -= dims.outerLength / 2;\n    xanchor = 'center';\n  }\n\n  var yanchor = 'top';\n\n  if (Lib.isBottomAnchor(sliderOpts)) {\n    dims.ly -= dims.height;\n    yanchor = 'bottom';\n  }\n\n  if (Lib.isMiddleAnchor(sliderOpts)) {\n    dims.ly -= dims.height / 2;\n    yanchor = 'middle';\n  }\n\n  dims.outerLength = Math.ceil(dims.outerLength);\n  dims.height = Math.ceil(dims.height);\n  dims.lx = Math.round(dims.lx);\n  dims.ly = Math.round(dims.ly);\n  var marginOpts = {\n    y: sliderOpts.y,\n    b: dims.height * FROM_BR[yanchor],\n    t: dims.height * FROM_TL[yanchor]\n  };\n\n  if (sliderOpts.lenmode === 'fraction') {\n    marginOpts.l = 0;\n    marginOpts.xl = sliderOpts.x - sliderOpts.len * FROM_TL[xanchor];\n    marginOpts.r = 0;\n    marginOpts.xr = sliderOpts.x + sliderOpts.len * FROM_BR[xanchor];\n  } else {\n    marginOpts.x = sliderOpts.x;\n    marginOpts.l = dims.outerLength * FROM_TL[xanchor];\n    marginOpts.r = dims.outerLength * FROM_BR[xanchor];\n  }\n\n  Plots.autoMargin(gd, autoMarginId(sliderOpts), marginOpts);\n}\n\nfunction drawSlider(gd, sliderGroup, sliderOpts) {\n  // This is related to the other long notes in this file regarding what happens\n  // when slider steps disappear. This particular fix handles what happens when\n  // the *current* slider step is removed. The drawing functions will error out\n  // when they fail to find it, so the fix for now is that it will just draw the\n  // slider in the first position but will not execute the command.\n  if (!(sliderOpts.steps[sliderOpts.active] || {}).visible) {\n    sliderOpts.active = sliderOpts._visibleSteps[0]._index;\n  } // These are carefully ordered for proper z-ordering:\n\n\n  sliderGroup.call(drawCurrentValue, sliderOpts).call(drawRail, sliderOpts).call(drawLabelGroup, sliderOpts).call(drawTicks, sliderOpts).call(drawTouchRect, gd, sliderOpts).call(drawGrip, gd, sliderOpts);\n  var dims = sliderOpts._dims; // Position the rectangle:\n\n  Drawing.setTranslate(sliderGroup, dims.lx + sliderOpts.pad.l, dims.ly + sliderOpts.pad.t);\n  sliderGroup.call(setGripPosition, sliderOpts, false);\n  sliderGroup.call(drawCurrentValue, sliderOpts);\n}\n\nfunction drawCurrentValue(sliderGroup, sliderOpts, valueOverride) {\n  if (!sliderOpts.currentvalue.visible) return;\n  var dims = sliderOpts._dims;\n  var x0, textAnchor;\n\n  switch (sliderOpts.currentvalue.xanchor) {\n    case 'right':\n      // This is anchored left and adjusted by the width of the longest label\n      // so that the prefix doesn't move. The goal of this is to emphasize\n      // what's actually changing and make the update less distracting.\n      x0 = dims.inputAreaLength - constants.currentValueInset - dims.currentValueMaxWidth;\n      textAnchor = 'left';\n      break;\n\n    case 'center':\n      x0 = dims.inputAreaLength * 0.5;\n      textAnchor = 'middle';\n      break;\n\n    default:\n      x0 = constants.currentValueInset;\n      textAnchor = 'left';\n  }\n\n  var text = Lib.ensureSingle(sliderGroup, 'text', constants.labelClass, function (s) {\n    s.classed('user-select-none', true).attr({\n      'text-anchor': textAnchor,\n      'data-notex': 1\n    });\n  });\n  var str = sliderOpts.currentvalue.prefix ? sliderOpts.currentvalue.prefix : '';\n\n  if (typeof valueOverride === 'string') {\n    str += valueOverride;\n  } else {\n    var curVal = sliderOpts.steps[sliderOpts.active].label;\n    var _meta = sliderOpts._gd._fullLayout._meta;\n    if (_meta) curVal = Lib.templateString(curVal, _meta);\n    str += curVal;\n  }\n\n  if (sliderOpts.currentvalue.suffix) {\n    str += sliderOpts.currentvalue.suffix;\n  }\n\n  text.call(Drawing.font, sliderOpts.currentvalue.font).text(str).call(svgTextUtils.convertToTspans, sliderOpts._gd);\n  var lines = svgTextUtils.lineCount(text);\n  var y0 = (dims.currentValueMaxLines + 1 - lines) * sliderOpts.currentvalue.font.size * LINE_SPACING;\n  svgTextUtils.positionText(text, x0, y0);\n  return text;\n}\n\nfunction drawGrip(sliderGroup, gd, sliderOpts) {\n  var grip = Lib.ensureSingle(sliderGroup, 'rect', constants.gripRectClass, function (s) {\n    s.call(attachGripEvents, gd, sliderGroup, sliderOpts).style('pointer-events', 'all');\n  });\n  grip.attr({\n    width: constants.gripWidth,\n    height: constants.gripHeight,\n    rx: constants.gripRadius,\n    ry: constants.gripRadius\n  }).call(Color.stroke, sliderOpts.bordercolor).call(Color.fill, sliderOpts.bgcolor).style('stroke-width', sliderOpts.borderwidth + 'px');\n}\n\nfunction drawLabel(item, data, sliderOpts) {\n  var text = Lib.ensureSingle(item, 'text', constants.labelClass, function (s) {\n    s.classed('user-select-none', true).attr({\n      'text-anchor': 'middle',\n      'data-notex': 1\n    });\n  });\n  var tx = data.step.label;\n  var _meta = sliderOpts._gd._fullLayout._meta;\n  if (_meta) tx = Lib.templateString(tx, _meta);\n  text.call(Drawing.font, sliderOpts.font).text(tx).call(svgTextUtils.convertToTspans, sliderOpts._gd);\n  return text;\n}\n\nfunction drawLabelGroup(sliderGroup, sliderOpts) {\n  var labels = Lib.ensureSingle(sliderGroup, 'g', constants.labelsClass);\n  var dims = sliderOpts._dims;\n  var labelItems = labels.selectAll('g.' + constants.labelGroupClass).data(dims.labelSteps);\n  labelItems.enter().append('g').classed(constants.labelGroupClass, true);\n  labelItems.exit().remove();\n  labelItems.each(function (d) {\n    var item = d3.select(this);\n    item.call(drawLabel, d, sliderOpts);\n    Drawing.setTranslate(item, normalizedValueToPosition(sliderOpts, d.fraction), constants.tickOffset + sliderOpts.ticklen + // position is the baseline of the top line of text only, even\n    // if the label spans multiple lines\n    sliderOpts.font.size * LINE_SPACING + constants.labelOffset + dims.currentValueTotalHeight);\n  });\n}\n\nfunction handleInput(gd, sliderGroup, sliderOpts, normalizedPosition, doTransition) {\n  var quantizedPosition = Math.round(normalizedPosition * (sliderOpts._stepCount - 1));\n  var quantizedIndex = sliderOpts._visibleSteps[quantizedPosition]._index;\n\n  if (quantizedIndex !== sliderOpts.active) {\n    setActive(gd, sliderGroup, sliderOpts, quantizedIndex, true, doTransition);\n  }\n}\n\nfunction setActive(gd, sliderGroup, sliderOpts, index, doCallback, doTransition) {\n  var previousActive = sliderOpts.active;\n  sliderOpts.active = index; // due to templating, it's possible this slider doesn't even exist yet\n\n  arrayEditor(gd.layout, constants.name, sliderOpts).applyUpdate('active', index);\n  var step = sliderOpts.steps[sliderOpts.active];\n  sliderGroup.call(setGripPosition, sliderOpts, doTransition);\n  sliderGroup.call(drawCurrentValue, sliderOpts);\n  gd.emit('plotly_sliderchange', {\n    slider: sliderOpts,\n    step: sliderOpts.steps[sliderOpts.active],\n    interaction: doCallback,\n    previousActive: previousActive\n  });\n\n  if (step && step.method && doCallback) {\n    if (sliderGroup._nextMethod) {\n      // If we've already queued up an update, just overwrite it with the most recent:\n      sliderGroup._nextMethod.step = step;\n      sliderGroup._nextMethod.doCallback = doCallback;\n      sliderGroup._nextMethod.doTransition = doTransition;\n    } else {\n      sliderGroup._nextMethod = {\n        step: step,\n        doCallback: doCallback,\n        doTransition: doTransition\n      };\n      sliderGroup._nextMethodRaf = window.requestAnimationFrame(function () {\n        var _step = sliderGroup._nextMethod.step;\n        if (!_step.method) return;\n\n        if (_step.execute) {\n          Plots.executeAPICommand(gd, _step.method, _step.args);\n        }\n\n        sliderGroup._nextMethod = null;\n        sliderGroup._nextMethodRaf = null;\n      });\n    }\n  }\n}\n\nfunction attachGripEvents(item, gd, sliderGroup) {\n  var node = sliderGroup.node();\n  var $gd = d3.select(gd); // NB: This is *not* the same as sliderOpts itself! These callbacks\n  // are in a closure so this array won't actually be correct if the\n  // steps have changed since this was initialized. The sliderGroup,\n  // however, has not changed since that *is* the slider, so it must\n  // be present to receive mouse events.\n\n  function getSliderOpts() {\n    return sliderGroup.data()[0];\n  }\n\n  item.on('mousedown', function () {\n    var sliderOpts = getSliderOpts();\n    gd.emit('plotly_sliderstart', {\n      slider: sliderOpts\n    });\n    var grip = sliderGroup.select('.' + constants.gripRectClass);\n    d3.event.stopPropagation();\n    d3.event.preventDefault();\n    grip.call(Color.fill, sliderOpts.activebgcolor);\n    var normalizedPosition = positionToNormalizedValue(sliderOpts, d3.mouse(node)[0]);\n    handleInput(gd, sliderGroup, sliderOpts, normalizedPosition, true);\n    sliderOpts._dragging = true;\n    $gd.on('mousemove', function () {\n      var sliderOpts = getSliderOpts();\n      var normalizedPosition = positionToNormalizedValue(sliderOpts, d3.mouse(node)[0]);\n      handleInput(gd, sliderGroup, sliderOpts, normalizedPosition, false);\n    });\n    $gd.on('mouseup', function () {\n      var sliderOpts = getSliderOpts();\n      sliderOpts._dragging = false;\n      grip.call(Color.fill, sliderOpts.bgcolor);\n      $gd.on('mouseup', null);\n      $gd.on('mousemove', null);\n      gd.emit('plotly_sliderend', {\n        slider: sliderOpts,\n        step: sliderOpts.steps[sliderOpts.active]\n      });\n    });\n  });\n}\n\nfunction drawTicks(sliderGroup, sliderOpts) {\n  var tick = sliderGroup.selectAll('rect.' + constants.tickRectClass).data(sliderOpts._visibleSteps);\n  var dims = sliderOpts._dims;\n  tick.enter().append('rect').classed(constants.tickRectClass, true);\n  tick.exit().remove();\n  tick.attr({\n    width: sliderOpts.tickwidth + 'px',\n    'shape-rendering': 'crispEdges'\n  });\n  tick.each(function (d, i) {\n    var isMajor = i % dims.labelStride === 0;\n    var item = d3.select(this);\n    item.attr({\n      height: isMajor ? sliderOpts.ticklen : sliderOpts.minorticklen\n    }).call(Color.fill, isMajor ? sliderOpts.tickcolor : sliderOpts.tickcolor);\n    Drawing.setTranslate(item, normalizedValueToPosition(sliderOpts, i / (sliderOpts._stepCount - 1)) - 0.5 * sliderOpts.tickwidth, (isMajor ? constants.tickOffset : constants.minorTickOffset) + dims.currentValueTotalHeight);\n  });\n}\n\nfunction computeLabelSteps(sliderOpts) {\n  var dims = sliderOpts._dims;\n  dims.labelSteps = [];\n  var nsteps = sliderOpts._stepCount;\n\n  for (var i = 0; i < nsteps; i += dims.labelStride) {\n    dims.labelSteps.push({\n      fraction: i / (nsteps - 1),\n      step: sliderOpts._visibleSteps[i]\n    });\n  }\n}\n\nfunction setGripPosition(sliderGroup, sliderOpts, doTransition) {\n  var grip = sliderGroup.select('rect.' + constants.gripRectClass);\n  var quantizedIndex = 0;\n\n  for (var i = 0; i < sliderOpts._stepCount; i++) {\n    if (sliderOpts._visibleSteps[i]._index === sliderOpts.active) {\n      quantizedIndex = i;\n      break;\n    }\n  }\n\n  var x = normalizedValueToPosition(sliderOpts, quantizedIndex / (sliderOpts._stepCount - 1)); // If this is true, then *this component* is already invoking its own command\n  // and has triggered its own animation.\n\n  if (sliderOpts._invokingCommand) return;\n  var el = grip;\n\n  if (doTransition && sliderOpts.transition.duration > 0) {\n    el = el.transition().duration(sliderOpts.transition.duration).ease(sliderOpts.transition.easing);\n  } // Drawing.setTranslate doesn't work here becasue of the transition duck-typing.\n  // It's also not necessary because there are no other transitions to preserve.\n\n\n  el.attr('transform', 'translate(' + (x - constants.gripWidth * 0.5) + ',' + sliderOpts._dims.currentValueTotalHeight + ')');\n} // Convert a number from [0-1] to a pixel position relative to the slider group container:\n\n\nfunction normalizedValueToPosition(sliderOpts, normalizedPosition) {\n  var dims = sliderOpts._dims;\n  return dims.inputAreaStart + constants.stepInset + (dims.inputAreaLength - 2 * constants.stepInset) * Math.min(1, Math.max(0, normalizedPosition));\n} // Convert a position relative to the slider group to a nubmer in [0, 1]\n\n\nfunction positionToNormalizedValue(sliderOpts, position) {\n  var dims = sliderOpts._dims;\n  return Math.min(1, Math.max(0, (position - constants.stepInset - dims.inputAreaStart) / (dims.inputAreaLength - 2 * constants.stepInset - 2 * dims.inputAreaStart)));\n}\n\nfunction drawTouchRect(sliderGroup, gd, sliderOpts) {\n  var dims = sliderOpts._dims;\n  var rect = Lib.ensureSingle(sliderGroup, 'rect', constants.railTouchRectClass, function (s) {\n    s.call(attachGripEvents, gd, sliderGroup, sliderOpts).style('pointer-events', 'all');\n  });\n  rect.attr({\n    width: dims.inputAreaLength,\n    height: Math.max(dims.inputAreaWidth, constants.tickOffset + sliderOpts.ticklen + dims.labelHeight)\n  }).call(Color.fill, sliderOpts.bgcolor).attr('opacity', 0);\n  Drawing.setTranslate(rect, 0, dims.currentValueTotalHeight);\n}\n\nfunction drawRail(sliderGroup, sliderOpts) {\n  var dims = sliderOpts._dims;\n  var computedLength = dims.inputAreaLength - constants.railInset * 2;\n  var rect = Lib.ensureSingle(sliderGroup, 'rect', constants.railRectClass);\n  rect.attr({\n    width: computedLength,\n    height: constants.railWidth,\n    rx: constants.railRadius,\n    ry: constants.railRadius,\n    'shape-rendering': 'crispEdges'\n  }).call(Color.stroke, sliderOpts.bordercolor).call(Color.fill, sliderOpts.bgcolor).style('stroke-width', sliderOpts.borderwidth + 'px');\n  Drawing.setTranslate(rect, constants.railInset, (dims.inputAreaWidth - constants.railWidth) * 0.5 + dims.currentValueTotalHeight);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar ensureSingle = Lib.ensureSingle;\nvar identity = Lib.identity;\n\nvar Drawing = require('../../components/drawing');\n\nvar subTypes = require('./subtypes');\n\nvar linePoints = require('./line_points');\n\nvar linkTraces = require('./link_traces');\n\nvar polygonTester = require('../../lib/polygon').tester;\n\nmodule.exports = function plot(gd, plotinfo, cdscatter, scatterLayer, transitionOpts, makeOnCompleteCallback) {\n  var join, onComplete; // If transition config is provided, then it is only a partial replot and traces not\n  // updated are removed.\n\n  var isFullReplot = !transitionOpts;\n  var hasTransition = !!transitionOpts && transitionOpts.duration > 0; // Link traces so the z-order of fill layers is correct\n\n  var cdscatterSorted = linkTraces(gd, plotinfo, cdscatter);\n  join = scatterLayer.selectAll('g.trace').data(cdscatterSorted, function (d) {\n    return d[0].trace.uid;\n  }); // Append new traces:\n\n  join.enter().append('g').attr('class', function (d) {\n    return 'trace scatter trace' + d[0].trace.uid;\n  }).style('stroke-miterlimit', 2);\n  join.order();\n  createFills(gd, join, plotinfo);\n\n  if (hasTransition) {\n    if (makeOnCompleteCallback) {\n      // If it was passed a callback to register completion, make a callback. If\n      // this is created, then it must be executed on completion, otherwise the\n      // pos-transition redraw will not execute:\n      onComplete = makeOnCompleteCallback();\n    }\n\n    var transition = d3.transition().duration(transitionOpts.duration).ease(transitionOpts.easing).each('end', function () {\n      onComplete && onComplete();\n    }).each('interrupt', function () {\n      onComplete && onComplete();\n    });\n    transition.each(function () {\n      // Must run the selection again since otherwise enters/updates get grouped together\n      // and these get executed out of order. Except we need them in order!\n      scatterLayer.selectAll('g.trace').each(function (d, i) {\n        plotOne(gd, i, plotinfo, d, cdscatterSorted, this, transitionOpts);\n      });\n    });\n  } else {\n    join.each(function (d, i) {\n      plotOne(gd, i, plotinfo, d, cdscatterSorted, this, transitionOpts);\n    });\n  }\n\n  if (isFullReplot) {\n    join.exit().remove();\n  } // remove paths that didn't get used\n\n\n  scatterLayer.selectAll('path:not([d])').remove();\n};\n\nfunction createFills(gd, traceJoin, plotinfo) {\n  traceJoin.each(function (d) {\n    var fills = ensureSingle(d3.select(this), 'g', 'fills');\n    Drawing.setClipUrl(fills, plotinfo.layerClipId, gd);\n    var trace = d[0].trace;\n    var fillData = [];\n    if (trace._ownfill) fillData.push('_ownFill');\n    if (trace._nexttrace) fillData.push('_nextFill');\n    var fillJoin = fills.selectAll('g').data(fillData, identity);\n    fillJoin.enter().append('g');\n    fillJoin.exit().each(function (d) {\n      trace[d] = null;\n    }).remove();\n    fillJoin.order().each(function (d) {\n      // make a path element inside the fill group, just so\n      // we can give it its own data later on and the group can\n      // keep its simple '_*Fill' data\n      trace[d] = ensureSingle(d3.select(this), 'path', 'js-fill');\n    });\n  });\n}\n\nfunction plotOne(gd, idx, plotinfo, cdscatter, cdscatterAll, element, transitionOpts) {\n  var i; // Since this has been reorganized and we're executing this on individual traces,\n  // we need to pass it the full list of cdscatter as well as this trace's index (idx)\n  // since it does an internal n^2 loop over comparisons with other traces:\n\n  selectMarkers(gd, idx, plotinfo, cdscatter, cdscatterAll);\n  var hasTransition = !!transitionOpts && transitionOpts.duration > 0;\n\n  function transition(selection) {\n    return hasTransition ? selection.transition() : selection;\n  }\n\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  var trace = cdscatter[0].trace;\n  var line = trace.line;\n  var tr = d3.select(element);\n  var errorBarGroup = ensureSingle(tr, 'g', 'errorbars');\n  var lines = ensureSingle(tr, 'g', 'lines');\n  var points = ensureSingle(tr, 'g', 'points');\n  var text = ensureSingle(tr, 'g', 'text'); // error bars are at the bottom\n\n  Registry.getComponentMethod('errorbars', 'plot')(gd, errorBarGroup, plotinfo, transitionOpts);\n  if (trace.visible !== true) return;\n  transition(tr).style('opacity', trace.opacity); // BUILD LINES AND FILLS\n\n  var ownFillEl3, tonext;\n  var ownFillDir = trace.fill.charAt(trace.fill.length - 1);\n  if (ownFillDir !== 'x' && ownFillDir !== 'y') ownFillDir = ''; // store node for tweaking by selectPoints\n\n  cdscatter[0][plotinfo.isRangePlot ? 'nodeRangePlot3' : 'node3'] = tr;\n  var prevRevpath = '';\n  var prevPolygons = [];\n  var prevtrace = trace._prevtrace;\n\n  if (prevtrace) {\n    prevRevpath = prevtrace._prevRevpath || '';\n    tonext = prevtrace._nextFill;\n    prevPolygons = prevtrace._polygons;\n  }\n\n  var thispath;\n  var thisrevpath; // fullpath is all paths for this curve, joined together straight\n  // across gaps, for filling\n\n  var fullpath = ''; // revpath is fullpath reversed, for fill-to-next\n\n  var revpath = ''; // functions for converting a point array to a path\n\n  var pathfn, revpathbase, revpathfn; // variables used before and after the data join\n\n  var pt0, lastSegment, pt1, thisPolygons; // initialize line join data / method\n\n  var segments = [];\n  var makeUpdate = Lib.noop;\n  ownFillEl3 = trace._ownFill;\n\n  if (subTypes.hasLines(trace) || trace.fill !== 'none') {\n    if (tonext) {\n      // This tells .style which trace to use for fill information:\n      tonext.datum(cdscatter);\n    }\n\n    if (['hv', 'vh', 'hvh', 'vhv'].indexOf(line.shape) !== -1) {\n      pathfn = Drawing.steps(line.shape);\n      revpathbase = Drawing.steps(line.shape.split('').reverse().join(''));\n    } else if (line.shape === 'spline') {\n      pathfn = revpathbase = function revpathbase(pts) {\n        var pLast = pts[pts.length - 1];\n\n        if (pts.length > 1 && pts[0][0] === pLast[0] && pts[0][1] === pLast[1]) {\n          // identical start and end points: treat it as a\n          // closed curve so we don't get a kink\n          return Drawing.smoothclosed(pts.slice(1), line.smoothing);\n        } else {\n          return Drawing.smoothopen(pts, line.smoothing);\n        }\n      };\n    } else {\n      pathfn = revpathbase = function revpathbase(pts) {\n        return 'M' + pts.join('L');\n      };\n    }\n\n    revpathfn = function revpathfn(pts) {\n      // note: this is destructive (reverses pts in place) so can't use pts after this\n      return revpathbase(pts.reverse());\n    };\n\n    segments = linePoints(cdscatter, {\n      xaxis: xa,\n      yaxis: ya,\n      connectGaps: trace.connectgaps,\n      baseTolerance: Math.max(line.width || 1, 3) / 4,\n      shape: line.shape,\n      simplify: line.simplify,\n      fill: trace.fill\n    }); // since we already have the pixel segments here, use them to make\n    // polygons for hover on fill\n    // TODO: can we skip this if hoveron!=fills? That would mean we\n    // need to redraw when you change hoveron...\n\n    thisPolygons = trace._polygons = new Array(segments.length);\n\n    for (i = 0; i < segments.length; i++) {\n      trace._polygons[i] = polygonTester(segments[i]);\n    }\n\n    if (segments.length) {\n      pt0 = segments[0][0];\n      lastSegment = segments[segments.length - 1];\n      pt1 = lastSegment[lastSegment.length - 1];\n    }\n\n    makeUpdate = function makeUpdate(isEnter) {\n      return function (pts) {\n        thispath = pathfn(pts);\n        thisrevpath = revpathfn(pts);\n\n        if (!fullpath) {\n          fullpath = thispath;\n          revpath = thisrevpath;\n        } else if (ownFillDir) {\n          fullpath += 'L' + thispath.substr(1);\n          revpath = thisrevpath + ('L' + revpath.substr(1));\n        } else {\n          fullpath += 'Z' + thispath;\n          revpath = thisrevpath + 'Z' + revpath;\n        }\n\n        if (subTypes.hasLines(trace) && pts.length > 1) {\n          var el = d3.select(this); // This makes the coloring work correctly:\n\n          el.datum(cdscatter);\n\n          if (isEnter) {\n            transition(el.style('opacity', 0).attr('d', thispath).call(Drawing.lineGroupStyle)).style('opacity', 1);\n          } else {\n            var sel = transition(el);\n            sel.attr('d', thispath);\n            Drawing.singleLineStyle(cdscatter, sel);\n          }\n        }\n      };\n    };\n  }\n\n  var lineJoin = lines.selectAll('.js-line').data(segments);\n  transition(lineJoin.exit()).style('opacity', 0).remove();\n  lineJoin.each(makeUpdate(false));\n  lineJoin.enter().append('path').classed('js-line', true).style('vector-effect', 'non-scaling-stroke').call(Drawing.lineGroupStyle).each(makeUpdate(true));\n  Drawing.setClipUrl(lineJoin, plotinfo.layerClipId, gd);\n\n  function clearFill(selection) {\n    transition(selection).attr('d', 'M0,0Z');\n  }\n\n  if (segments.length) {\n    if (ownFillEl3) {\n      ownFillEl3.datum(cdscatter);\n\n      if (pt0 && pt1) {\n        if (ownFillDir) {\n          if (ownFillDir === 'y') {\n            pt0[1] = pt1[1] = ya.c2p(0, true);\n          } else if (ownFillDir === 'x') {\n            pt0[0] = pt1[0] = xa.c2p(0, true);\n          } // fill to zero: full trace path, plus extension of\n          // the endpoints to the appropriate axis\n          // For the sake of animations, wrap the points around so that\n          // the points on the axes are the first two points. Otherwise\n          // animations get a little crazy if the number of points changes.\n\n\n          transition(ownFillEl3).attr('d', 'M' + pt1 + 'L' + pt0 + 'L' + fullpath.substr(1)).call(Drawing.singleFillStyle);\n        } else {\n          // fill to self: just join the path to itself\n          transition(ownFillEl3).attr('d', fullpath + 'Z').call(Drawing.singleFillStyle);\n        }\n      }\n    } else if (tonext) {\n      if (trace.fill.substr(0, 6) === 'tonext' && fullpath && prevRevpath) {\n        // fill to next: full trace path, plus the previous path reversed\n        if (trace.fill === 'tonext') {\n          // tonext: for use by concentric shapes, like manually constructed\n          // contours, we just add the two paths closed on themselves.\n          // This makes strange results if one path is *not* entirely\n          // inside the other, but then that is a strange usage.\n          transition(tonext).attr('d', fullpath + 'Z' + prevRevpath + 'Z').call(Drawing.singleFillStyle);\n        } else {\n          // tonextx/y: for now just connect endpoints with lines. This is\n          // the correct behavior if the endpoints are at the same value of\n          // y/x, but if they *aren't*, we should ideally do more complicated\n          // things depending on whether the new endpoint projects onto the\n          // existing curve or off the end of it\n          transition(tonext).attr('d', fullpath + 'L' + prevRevpath.substr(1) + 'Z').call(Drawing.singleFillStyle);\n        }\n\n        trace._polygons = trace._polygons.concat(prevPolygons);\n      } else {\n        clearFill(tonext);\n        trace._polygons = null;\n      }\n    }\n\n    trace._prevRevpath = revpath;\n    trace._prevPolygons = thisPolygons;\n  } else {\n    if (ownFillEl3) clearFill(ownFillEl3);else if (tonext) clearFill(tonext);\n    trace._polygons = trace._prevRevpath = trace._prevPolygons = null;\n  }\n\n  function visFilter(d) {\n    return d.filter(function (v) {\n      return !v.gap && v.vis;\n    });\n  }\n\n  function visFilterWithGaps(d) {\n    return d.filter(function (v) {\n      return v.vis;\n    });\n  }\n\n  function gapFilter(d) {\n    return d.filter(function (v) {\n      return !v.gap;\n    });\n  }\n\n  function keyFunc(d) {\n    return d.id;\n  } // Returns a function if the trace is keyed, otherwise returns undefined\n\n\n  function getKeyFunc(trace) {\n    if (trace.ids) {\n      return keyFunc;\n    }\n  }\n\n  function hideFilter() {\n    return false;\n  }\n\n  function makePoints(points, text, cdscatter) {\n    var join, selection, hasNode;\n    var trace = cdscatter[0].trace;\n    var showMarkers = subTypes.hasMarkers(trace);\n    var showText = subTypes.hasText(trace);\n    var keyFunc = getKeyFunc(trace);\n    var markerFilter = hideFilter;\n    var textFilter = hideFilter;\n\n    if (showMarkers || showText) {\n      var showFilter = identity; // if we're stacking, \"infer zero\" gap mode gets markers in the\n      // gap points - because we've inferred a zero there - but other\n      // modes (currently \"interpolate\", later \"interrupt\" hopefully)\n      // we don't draw generated markers\n\n      var stackGroup = trace.stackgroup;\n      var isInferZero = stackGroup && gd._fullLayout._scatterStackOpts[xa._id + ya._id][stackGroup].stackgaps === 'infer zero';\n\n      if (trace.marker.maxdisplayed || trace._needsCull) {\n        showFilter = isInferZero ? visFilterWithGaps : visFilter;\n      } else if (stackGroup && !isInferZero) {\n        showFilter = gapFilter;\n      }\n\n      if (showMarkers) markerFilter = showFilter;\n      if (showText) textFilter = showFilter;\n    } // marker points\n\n\n    selection = points.selectAll('path.point');\n    join = selection.data(markerFilter, keyFunc);\n    var enter = join.enter().append('path').classed('point', true);\n\n    if (hasTransition) {\n      enter.call(Drawing.pointStyle, trace, gd).call(Drawing.translatePoints, xa, ya).style('opacity', 0).transition().style('opacity', 1);\n    }\n\n    join.order();\n    var styleFns;\n\n    if (showMarkers) {\n      styleFns = Drawing.makePointStyleFns(trace);\n    }\n\n    join.each(function (d) {\n      var el = d3.select(this);\n      var sel = transition(el);\n      hasNode = Drawing.translatePoint(d, sel, xa, ya);\n\n      if (hasNode) {\n        Drawing.singlePointStyle(d, sel, trace, styleFns, gd);\n\n        if (plotinfo.layerClipId) {\n          Drawing.hideOutsideRangePoint(d, sel, xa, ya, trace.xcalendar, trace.ycalendar);\n        }\n\n        if (trace.customdata) {\n          el.classed('plotly-customdata', d.data !== null && d.data !== undefined);\n        }\n      } else {\n        sel.remove();\n      }\n    });\n\n    if (hasTransition) {\n      join.exit().transition().style('opacity', 0).remove();\n    } else {\n      join.exit().remove();\n    } // text points\n\n\n    selection = text.selectAll('g');\n    join = selection.data(textFilter, keyFunc); // each text needs to go in its own 'g' in case\n    // it gets converted to mathjax\n\n    join.enter().append('g').classed('textpoint', true).append('text');\n    join.order();\n    join.each(function (d) {\n      var g = d3.select(this);\n      var sel = transition(g.select('text'));\n      hasNode = Drawing.translatePoint(d, sel, xa, ya);\n\n      if (hasNode) {\n        if (plotinfo.layerClipId) {\n          Drawing.hideOutsideRangePoint(d, g, xa, ya, trace.xcalendar, trace.ycalendar);\n        }\n      } else {\n        g.remove();\n      }\n    });\n    join.selectAll('text').call(Drawing.textPointStyle, trace, gd).each(function (d) {\n      // This just *has* to be totally custom becuase of SVG text positioning :(\n      // It's obviously copied from translatePoint; we just can't use that\n      var x = xa.c2p(d.x);\n      var y = ya.c2p(d.y);\n      d3.select(this).selectAll('tspan.line').each(function () {\n        transition(d3.select(this)).attr({\n          x: x,\n          y: y\n        });\n      });\n    });\n    join.exit().remove();\n  }\n\n  points.datum(cdscatter);\n  text.datum(cdscatter);\n  makePoints(points, text, cdscatter); // lastly, clip points groups of `cliponaxis !== false` traces\n  // on `plotinfo._hasClipOnAxisFalse === true` subplots\n\n  var hasClipOnAxisFalse = trace.cliponaxis === false;\n  var clipUrl = hasClipOnAxisFalse ? null : plotinfo.layerClipId;\n  Drawing.setClipUrl(points, clipUrl, gd);\n  Drawing.setClipUrl(text, clipUrl, gd);\n}\n\nfunction selectMarkers(gd, idx, plotinfo, cdscatter, cdscatterAll) {\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  var xr = d3.extent(Lib.simpleMap(xa.range, xa.r2c));\n  var yr = d3.extent(Lib.simpleMap(ya.range, ya.r2c));\n  var trace = cdscatter[0].trace;\n  if (!subTypes.hasMarkers(trace)) return; // if marker.maxdisplayed is used, select a maximum of\n  // mnum markers to show, from the set that are in the viewport\n\n  var mnum = trace.marker.maxdisplayed; // TODO: remove some as we get away from the viewport?\n\n  if (mnum === 0) return;\n  var cd = cdscatter.filter(function (v) {\n    return v.x >= xr[0] && v.x <= xr[1] && v.y >= yr[0] && v.y <= yr[1];\n  });\n  var inc = Math.ceil(cd.length / mnum);\n  var tnum = 0;\n  cdscatterAll.forEach(function (cdj, j) {\n    var tracei = cdj[0].trace;\n\n    if (subTypes.hasMarkers(tracei) && tracei.marker.maxdisplayed > 0 && j < idx) {\n      tnum++;\n    }\n  }); // if multiple traces use maxdisplayed, stagger which markers we\n  // display this formula offsets successive traces by 1/3 of the\n  // increment, adding an extra small amount after each triplet so\n  // it's not quite periodic\n\n  var i0 = Math.round(tnum * inc / 3 + Math.floor(tnum / 3) * inc / 7.1); // for error bars: save in cd which markers to show\n  // so we don't have to repeat this\n\n  cdscatter.forEach(function (v) {\n    delete v.vis;\n  });\n  cd.forEach(function (v, i) {\n    if (Math.round((i + i0) % inc) === 0) v.vis = true;\n  });\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Color = require('../color');\n\nvar Template = require('../../plot_api/plot_template');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar attributes = require('./attributes');\n\nvar constants = require('./constants');\n\nmodule.exports = function handleDefaults(containerIn, containerOut, layout, counterAxes, calendar) {\n  var selectorIn = containerIn.rangeselector || {};\n  var selectorOut = Template.newContainer(containerOut, 'rangeselector');\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(selectorIn, selectorOut, attributes, attr, dflt);\n  }\n\n  var buttons = handleArrayContainerDefaults(selectorIn, selectorOut, {\n    name: 'buttons',\n    handleItemDefaults: buttonDefaults,\n    calendar: calendar\n  });\n  var visible = coerce('visible', buttons.length > 0);\n\n  if (visible) {\n    var posDflt = getPosDflt(containerOut, layout, counterAxes);\n    coerce('x', posDflt[0]);\n    coerce('y', posDflt[1]);\n    Lib.noneOrAll(containerIn, containerOut, ['x', 'y']);\n    coerce('xanchor');\n    coerce('yanchor');\n    Lib.coerceFont(coerce, 'font', layout.font);\n    var bgColor = coerce('bgcolor');\n    coerce('activecolor', Color.contrast(bgColor, constants.lightAmount, constants.darkAmount));\n    coerce('bordercolor');\n    coerce('borderwidth');\n  }\n};\n\nfunction buttonDefaults(buttonIn, buttonOut, selectorOut, opts) {\n  var calendar = opts.calendar;\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(buttonIn, buttonOut, attributes.buttons, attr, dflt);\n  }\n\n  var visible = coerce('visible');\n\n  if (visible) {\n    var step = coerce('step');\n\n    if (step !== 'all') {\n      if (calendar && calendar !== 'gregorian' && (step === 'month' || step === 'year')) {\n        buttonOut.stepmode = 'backward';\n      } else {\n        coerce('stepmode');\n      }\n\n      coerce('count');\n    }\n\n    coerce('label');\n  }\n}\n\nfunction getPosDflt(containerOut, layout, counterAxes) {\n  var anchoredList = counterAxes.filter(function (ax) {\n    return layout[ax].anchor === containerOut._id;\n  });\n  var posY = 0;\n\n  for (var i = 0; i < anchoredList.length; i++) {\n    var domain = layout[anchoredList[i]].domain;\n    if (domain) posY = Math.max(domain[1], posY);\n  }\n\n  return [containerOut.domain[0], posY + constants.yPad];\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar drawRaw = require('../annotations/draw').drawRaw;\n\nvar project = require('../../plots/gl3d/project');\n\nvar axLetters = ['x', 'y', 'z'];\n\nmodule.exports = function draw(scene) {\n  var fullSceneLayout = scene.fullSceneLayout;\n  var dataScale = scene.dataScale;\n  var anns = fullSceneLayout.annotations;\n\n  for (var i = 0; i < anns.length; i++) {\n    var ann = anns[i];\n    var annotationIsOffscreen = false;\n\n    for (var j = 0; j < 3; j++) {\n      var axLetter = axLetters[j];\n      var pos = ann[axLetter];\n      var ax = fullSceneLayout[axLetter + 'axis'];\n      var posFraction = ax.r2fraction(pos);\n\n      if (posFraction < 0 || posFraction > 1) {\n        annotationIsOffscreen = true;\n        break;\n      }\n    }\n\n    if (annotationIsOffscreen) {\n      scene.fullLayout._infolayer.select('.annotation-' + scene.id + '[data-index=\"' + i + '\"]').remove();\n    } else {\n      ann._pdata = project(scene.glplot.cameraParams, [fullSceneLayout.xaxis.r2l(ann.x) * dataScale[0], fullSceneLayout.yaxis.r2l(ann.y) * dataScale[1], fullSceneLayout.zaxis.r2l(ann.z) * dataScale[2]]);\n      drawRaw(scene.graphDiv, ann, i, scene.id, ann._xa, ann._ya);\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar LINKEDFILLS = {\n  tonextx: 1,\n  tonexty: 1,\n  tonext: 1\n};\n\nmodule.exports = function linkTraces(gd, plotinfo, cdscatter) {\n  var trace, i, group, prevtrace, groupIndex; // first sort traces to keep stacks & filled-together groups together\n\n  var groupIndices = {};\n  var needsSort = false;\n  var prevGroupIndex = -1;\n  var nextGroupIndex = 0;\n  var prevUnstackedGroupIndex = -1;\n\n  for (i = 0; i < cdscatter.length; i++) {\n    trace = cdscatter[i][0].trace;\n    group = trace.stackgroup || '';\n\n    if (group) {\n      if (group in groupIndices) {\n        groupIndex = groupIndices[group];\n      } else {\n        groupIndex = groupIndices[group] = nextGroupIndex;\n        nextGroupIndex++;\n      }\n    } else if (trace.fill in LINKEDFILLS && prevUnstackedGroupIndex >= 0) {\n      groupIndex = prevUnstackedGroupIndex;\n    } else {\n      groupIndex = prevUnstackedGroupIndex = nextGroupIndex;\n      nextGroupIndex++;\n    }\n\n    if (groupIndex < prevGroupIndex) needsSort = true;\n    trace._groupIndex = prevGroupIndex = groupIndex;\n  }\n\n  var cdscatterSorted = cdscatter.slice();\n\n  if (needsSort) {\n    cdscatterSorted.sort(function (a, b) {\n      var traceA = a[0].trace;\n      var traceB = b[0].trace;\n      return traceA._groupIndex - traceB._groupIndex || traceA.index - traceB.index;\n    });\n  } // now link traces to each other\n\n\n  var prevtraces = {};\n\n  for (i = 0; i < cdscatterSorted.length; i++) {\n    trace = cdscatterSorted[i][0].trace;\n    group = trace.stackgroup || ''; // Note: The check which ensures all cdscatter here are for the same axis and\n    // are either cartesian or scatterternary has been removed. This code assumes\n    // the passed scattertraces have been filtered to the proper plot types and\n    // the proper subplots.\n\n    if (trace.visible === true) {\n      trace._nexttrace = null;\n\n      if (trace.fill in LINKEDFILLS) {\n        prevtrace = prevtraces[group];\n        trace._prevtrace = prevtrace || null;\n\n        if (prevtrace) {\n          prevtrace._nexttrace = trace;\n        }\n      }\n\n      trace._ownfill = trace.fill && (trace.fill.substr(0, 6) === 'tozero' || trace.fill === 'toself' || trace.fill.substr(0, 2) === 'to' && !trace._prevtrace);\n      prevtraces[group] = trace;\n    } else {\n      trace._prevtrace = trace._nexttrace = trace._ownfill = null;\n    }\n  }\n\n  return cdscatterSorted;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict'; // remove opacity for any trace that has a fill or is filled to\n\nmodule.exports = function crossTraceDefaults(fullData) {\n  for (var i = 0; i < fullData.length; i++) {\n    var tracei = fullData[i];\n    if (tracei.type !== 'scatter') continue;\n    var filli = tracei.fill;\n    if (filli === 'none' || filli === 'toself') continue;\n    tracei.opacity = undefined;\n\n    if (filli === 'tonexty' || filli === 'tonextx') {\n      for (var j = i - 1; j >= 0; j--) {\n        var tracej = fullData[j];\n\n        if (tracej.type === 'scatter' && tracej.xaxis === tracei.xaxis && tracej.yaxis === tracei.yaxis) {\n          tracej.opacity = undefined;\n          break;\n        }\n      }\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Registry = require('../../registry');\n\nmodule.exports = function handleXYDefaults(traceIn, traceOut, layout, coerce) {\n  var x = coerce('x');\n  var y = coerce('y');\n  var len;\n  var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleTraceDefaults');\n  handleCalendarDefaults(traceIn, traceOut, ['x', 'y'], layout);\n\n  if (x) {\n    var xlen = Lib.minRowLength(x);\n\n    if (y) {\n      len = Math.min(xlen, Lib.minRowLength(y));\n    } else {\n      len = xlen;\n      coerce('y0');\n      coerce('dy');\n    }\n  } else {\n    if (!y) return 0;\n    len = Lib.minRowLength(y);\n    coerce('x0');\n    coerce('dx');\n  }\n\n  traceOut._length = len;\n  return len;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar Drawing = require('../../components/drawing');\n\nvar Axes = require('./axes');\n/**\n * transitionAxes\n *\n * transition axes from one set of ranges to another, using a svg\n * transformations, similar to during panning.\n *\n * @param {DOM element | object} gd\n * @param {array} edits : array of 'edits', each item with\n * - plotinfo {object} subplot object\n * - xr0 {array} initial x-range\n * - xr1 {array} end x-range\n * - yr0 {array} initial y-range\n * - yr1 {array} end y-range\n * @param {object} transitionOpts\n * @param {function} makeOnCompleteCallback\n */\n\n\nmodule.exports = function transitionAxes(gd, edits, transitionOpts, makeOnCompleteCallback) {\n  var fullLayout = gd._fullLayout; // special case for redraw:false Plotly.animate that relies on this\n  // to update axis-referenced layout components\n\n  if (edits.length === 0) {\n    Axes.redrawComponents(gd);\n    return;\n  }\n\n  function unsetSubplotTransform(subplot) {\n    var xa = subplot.xaxis;\n    var ya = subplot.yaxis;\n\n    fullLayout._defs.select('#' + subplot.clipId + '> rect').call(Drawing.setTranslate, 0, 0).call(Drawing.setScale, 1, 1);\n\n    subplot.plot.call(Drawing.setTranslate, xa._offset, ya._offset).call(Drawing.setScale, 1, 1);\n    var traceGroups = subplot.plot.selectAll('.scatterlayer .trace'); // This is specifically directed at scatter traces, applying an inverse\n    // scale to individual points to counteract the scale of the trace\n    // as a whole:\n\n    traceGroups.selectAll('.point').call(Drawing.setPointGroupScale, 1, 1);\n    traceGroups.selectAll('.textpoint').call(Drawing.setTextPointsScale, 1, 1);\n    traceGroups.call(Drawing.hideOutsideRangePoints, subplot);\n  }\n\n  function updateSubplot(edit, progress) {\n    var plotinfo = edit.plotinfo;\n    var xa = plotinfo.xaxis;\n    var ya = plotinfo.yaxis;\n    var xlen = xa._length;\n    var ylen = ya._length;\n    var editX = !!edit.xr1;\n    var editY = !!edit.yr1;\n    var viewBox = [];\n\n    if (editX) {\n      var xr0 = Lib.simpleMap(edit.xr0, xa.r2l);\n      var xr1 = Lib.simpleMap(edit.xr1, xa.r2l);\n      var dx0 = xr0[1] - xr0[0];\n      var dx1 = xr1[1] - xr1[0];\n      viewBox[0] = (xr0[0] * (1 - progress) + progress * xr1[0] - xr0[0]) / (xr0[1] - xr0[0]) * xlen;\n      viewBox[2] = xlen * (1 - progress + progress * dx1 / dx0);\n      xa.range[0] = xa.l2r(xr0[0] * (1 - progress) + progress * xr1[0]);\n      xa.range[1] = xa.l2r(xr0[1] * (1 - progress) + progress * xr1[1]);\n    } else {\n      viewBox[0] = 0;\n      viewBox[2] = xlen;\n    }\n\n    if (editY) {\n      var yr0 = Lib.simpleMap(edit.yr0, ya.r2l);\n      var yr1 = Lib.simpleMap(edit.yr1, ya.r2l);\n      var dy0 = yr0[1] - yr0[0];\n      var dy1 = yr1[1] - yr1[0];\n      viewBox[1] = (yr0[1] * (1 - progress) + progress * yr1[1] - yr0[1]) / (yr0[0] - yr0[1]) * ylen;\n      viewBox[3] = ylen * (1 - progress + progress * dy1 / dy0);\n      ya.range[0] = xa.l2r(yr0[0] * (1 - progress) + progress * yr1[0]);\n      ya.range[1] = ya.l2r(yr0[1] * (1 - progress) + progress * yr1[1]);\n    } else {\n      viewBox[1] = 0;\n      viewBox[3] = ylen;\n    }\n\n    Axes.drawOne(gd, xa, {\n      skipTitle: true\n    });\n    Axes.drawOne(gd, ya, {\n      skipTitle: true\n    });\n    Axes.redrawComponents(gd, [xa._id, ya._id]);\n    var xScaleFactor = editX ? xlen / viewBox[2] : 1;\n    var yScaleFactor = editY ? ylen / viewBox[3] : 1;\n    var clipDx = editX ? viewBox[0] : 0;\n    var clipDy = editY ? viewBox[1] : 0;\n    var fracDx = editX ? viewBox[0] / viewBox[2] * xlen : 0;\n    var fracDy = editY ? viewBox[1] / viewBox[3] * ylen : 0;\n    var plotDx = xa._offset - fracDx;\n    var plotDy = ya._offset - fracDy;\n    plotinfo.clipRect.call(Drawing.setTranslate, clipDx, clipDy).call(Drawing.setScale, 1 / xScaleFactor, 1 / yScaleFactor);\n    plotinfo.plot.call(Drawing.setTranslate, plotDx, plotDy).call(Drawing.setScale, xScaleFactor, yScaleFactor); // apply an inverse scale to individual points to counteract\n    // the scale of the trace group.\n\n    Drawing.setPointGroupScale(plotinfo.zoomScalePts, 1 / xScaleFactor, 1 / yScaleFactor);\n    Drawing.setTextPointsScale(plotinfo.zoomScaleTxt, 1 / xScaleFactor, 1 / yScaleFactor);\n  }\n\n  var onComplete;\n\n  if (makeOnCompleteCallback) {\n    // This module makes the choice whether or not it notifies Plotly.transition\n    // about completion:\n    onComplete = makeOnCompleteCallback();\n  }\n\n  function transitionComplete() {\n    var aobj = {};\n\n    for (var i = 0; i < edits.length; i++) {\n      var edit = edits[i];\n      var xa = edit.plotinfo.xaxis;\n      var ya = edit.plotinfo.yaxis;\n      if (edit.xr1) aobj[xa._name + '.range'] = edit.xr1.slice();\n      if (edit.yr1) aobj[ya._name + '.range'] = edit.yr1.slice();\n    } // Signal that this transition has completed:\n\n\n    onComplete && onComplete();\n    return Registry.call('relayout', gd, aobj).then(function () {\n      for (var i = 0; i < edits.length; i++) {\n        unsetSubplotTransform(edits[i].plotinfo);\n      }\n    });\n  }\n\n  function transitionInterrupt() {\n    var aobj = {};\n\n    for (var i = 0; i < edits.length; i++) {\n      var edit = edits[i];\n      var xa = edit.plotinfo.xaxis;\n      var ya = edit.plotinfo.yaxis;\n      if (edit.xr0) aobj[xa._name + '.range'] = edit.xr0.slice();\n      if (edit.yr0) aobj[ya._name + '.range'] = edit.yr0.slice();\n    }\n\n    return Registry.call('relayout', gd, aobj).then(function () {\n      for (var i = 0; i < edits.length; i++) {\n        unsetSubplotTransform(edits[i].plotinfo);\n      }\n    });\n  }\n\n  var t1, t2, raf;\n  var easeFn = d3.ease(transitionOpts.easing);\n\n  gd._transitionData._interruptCallbacks.push(function () {\n    window.cancelAnimationFrame(raf);\n    raf = null;\n    return transitionInterrupt();\n  });\n\n  function doFrame() {\n    t2 = Date.now();\n    var tInterp = Math.min(1, (t2 - t1) / transitionOpts.duration);\n    var progress = easeFn(tInterp);\n\n    for (var i = 0; i < edits.length; i++) {\n      updateSubplot(edits[i], progress);\n    }\n\n    if (t2 - t1 > transitionOpts.duration) {\n      transitionComplete();\n      raf = window.cancelAnimationFrame(doFrame);\n    } else {\n      raf = window.requestAnimationFrame(doFrame);\n    }\n  }\n\n  t1 = Date.now();\n  raf = window.requestAnimationFrame(doFrame);\n  return Promise.resolve();\n};","'use strict';\n\nvar Lib = require('../src/lib');\n\nvar rules = {\n  \"X,X div\": \"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;\",\n  \"X input,X button\": \"font-family:'Open Sans', verdana, arial, sans-serif;\",\n  \"X input:focus,X button:focus\": \"outline:none;\",\n  \"X a\": \"text-decoration:none;\",\n  \"X a:hover\": \"text-decoration:none;\",\n  \"X .crisp\": \"shape-rendering:crispEdges;\",\n  \"X .user-select-none\": \"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;\",\n  \"X svg\": \"overflow:hidden;\",\n  \"X svg a\": \"fill:#447adb;\",\n  \"X svg a:hover\": \"fill:#3c6dc5;\",\n  \"X .main-svg\": \"position:absolute;top:0;left:0;pointer-events:none;\",\n  \"X .main-svg .draglayer\": \"pointer-events:all;\",\n  \"X .cursor-default\": \"cursor:default;\",\n  \"X .cursor-pointer\": \"cursor:pointer;\",\n  \"X .cursor-crosshair\": \"cursor:crosshair;\",\n  \"X .cursor-move\": \"cursor:move;\",\n  \"X .cursor-col-resize\": \"cursor:col-resize;\",\n  \"X .cursor-row-resize\": \"cursor:row-resize;\",\n  \"X .cursor-ns-resize\": \"cursor:ns-resize;\",\n  \"X .cursor-ew-resize\": \"cursor:ew-resize;\",\n  \"X .cursor-sw-resize\": \"cursor:sw-resize;\",\n  \"X .cursor-s-resize\": \"cursor:s-resize;\",\n  \"X .cursor-se-resize\": \"cursor:se-resize;\",\n  \"X .cursor-w-resize\": \"cursor:w-resize;\",\n  \"X .cursor-e-resize\": \"cursor:e-resize;\",\n  \"X .cursor-nw-resize\": \"cursor:nw-resize;\",\n  \"X .cursor-n-resize\": \"cursor:n-resize;\",\n  \"X .cursor-ne-resize\": \"cursor:ne-resize;\",\n  \"X .cursor-grab\": \"cursor:-webkit-grab;cursor:grab;\",\n  \"X .modebar\": \"position:absolute;top:2px;right:2px;\",\n  \"X .ease-bg\": \"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;\",\n  \"X .modebar--hover>:not(.watermark)\": \"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;\",\n  \"X:hover .modebar--hover .modebar-group\": \"opacity:1;\",\n  \"X .modebar-group\": \"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;\",\n  \"X .modebar-btn\": \"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;\",\n  \"X .modebar-btn svg\": \"position:relative;top:2px;\",\n  \"X .modebar.vertical\": \"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;\",\n  \"X .modebar.vertical svg\": \"top:-1px;\",\n  \"X .modebar.vertical .modebar-group\": \"display:block;float:none;padding-left:0px;padding-bottom:8px;\",\n  \"X .modebar.vertical .modebar-group .modebar-btn\": \"display:block;text-align:center;\",\n  \"X [data-title]:before,X [data-title]:after\": \"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;\",\n  \"X [data-title]:hover:before,X [data-title]:hover:after\": \"display:block;opacity:1;\",\n  \"X [data-title]:before\": \"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;\",\n  \"X [data-title]:after\": \"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;\",\n  \"X .vertical [data-title]:before,X .vertical [data-title]:after\": \"top:0%;right:200%;\",\n  \"X .vertical [data-title]:before\": \"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;\",\n  \"X .select-outline\": \"fill:none;stroke-width:1;shape-rendering:crispEdges;\",\n  \"X .select-outline-1\": \"stroke:white;\",\n  \"X .select-outline-2\": \"stroke:black;stroke-dasharray:2px 2px;\",\n  Y: \"font-family:'Open Sans', verdana, arial, sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;\",\n  \"Y p\": \"margin:0;\",\n  \"Y .notifier-note\": \"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;\",\n  \"Y .notifier-close\": \"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;\",\n  \"Y .notifier-close:hover\": \"color:#444;text-decoration:none;cursor:pointer;\"\n};\n\nfor (var selector in rules) {\n  var fullSelector = selector.replace(/^,/, ' ,').replace(/X/g, '.js-plotly-plot .plotly').replace(/Y/g, '.plotly-notifier');\n  Lib.addStyleRule(fullSelector, rules[selector]);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'rangeselector',\n  schema: {\n    subplots: {\n      xaxis: {\n        rangeselector: require('./attributes')\n      }\n    }\n  },\n  layoutAttributes: require('./attributes'),\n  handleDefaults: require('./defaults'),\n  draw: require('./draw')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar hasColorscale = require('../../components/colorscale/helpers').hasColorscale;\n\nvar calcColorscale = require('../../components/colorscale/calc');\n\nvar subTypes = require('./subtypes');\n\nmodule.exports = function calcMarkerColorscale(gd, trace) {\n  if (subTypes.hasLines(trace) && hasColorscale(trace, 'line')) {\n    calcColorscale(gd, trace, {\n      vals: trace.line.color,\n      containerStr: 'line',\n      cLetter: 'c'\n    });\n  }\n\n  if (subTypes.hasMarkers(trace)) {\n    if (hasColorscale(trace, 'marker')) {\n      calcColorscale(gd, trace, {\n        vals: trace.marker.color,\n        containerStr: 'marker',\n        cLetter: 'c'\n      });\n    }\n\n    if (hasColorscale(trace, 'marker.line')) {\n      calcColorscale(gd, trace, {\n        vals: trace.marker.line.color,\n        containerStr: 'marker.line',\n        cLetter: 'c'\n      });\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Color = require('../../color');\n\nmodule.exports = function supplyDrawNewShapeDefaults(layoutIn, layoutOut, coerce) {\n  coerce('newshape.drawdirection');\n  coerce('newshape.layer');\n  coerce('newshape.fillcolor');\n  coerce('newshape.fillrule');\n  coerce('newshape.opacity');\n  var newshapeLineWidth = coerce('newshape.line.width');\n\n  if (newshapeLineWidth) {\n    var bgcolor = (layoutIn || {}).plot_bgcolor || '#FFF';\n    coerce('newshape.line.color', Color.contrast(bgcolor));\n    coerce('newshape.line.dash');\n  }\n\n  coerce('activeshape.fillcolor');\n  coerce('activeshape.opacity');\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Registry = require('../../registry');\n\nvar attributes = require('./attributes');\n\nvar constants = require('./constants');\n\nvar subTypes = require('./subtypes');\n\nvar handleXYDefaults = require('./xy_defaults');\n\nvar handleStackDefaults = require('./stack_defaults');\n\nvar handleMarkerDefaults = require('./marker_defaults');\n\nvar handleLineDefaults = require('./line_defaults');\n\nvar handleLineShapeDefaults = require('./line_shape_defaults');\n\nvar handleTextDefaults = require('./text_defaults');\n\nvar handleFillColorDefaults = require('./fillcolor_defaults');\n\nmodule.exports = function supplyDefaults(traceIn, traceOut, defaultColor, layout) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n  }\n\n  var len = handleXYDefaults(traceIn, traceOut, layout, coerce);\n  if (!len) traceOut.visible = false;\n  if (!traceOut.visible) return;\n  var stackGroupOpts = handleStackDefaults(traceIn, traceOut, layout, coerce);\n  var defaultMode = !stackGroupOpts && len < constants.PTS_LINESONLY ? 'lines+markers' : 'lines';\n  coerce('text');\n  coerce('hovertext');\n  coerce('mode', defaultMode);\n\n  if (subTypes.hasLines(traceOut)) {\n    handleLineDefaults(traceIn, traceOut, defaultColor, layout, coerce);\n    handleLineShapeDefaults(traceIn, traceOut, coerce);\n    coerce('connectgaps');\n    coerce('line.simplify');\n  }\n\n  if (subTypes.hasMarkers(traceOut)) {\n    handleMarkerDefaults(traceIn, traceOut, defaultColor, layout, coerce, {\n      gradient: true\n    });\n  }\n\n  if (subTypes.hasText(traceOut)) {\n    coerce('texttemplate');\n    handleTextDefaults(traceIn, traceOut, layout, coerce);\n  }\n\n  var dfltHoverOn = [];\n\n  if (subTypes.hasMarkers(traceOut) || subTypes.hasText(traceOut)) {\n    coerce('cliponaxis');\n    coerce('marker.maxdisplayed');\n    dfltHoverOn.push('points');\n  } // It's possible for this default to be changed by a later trace.\n  // We handle that case in some hacky code inside handleStackDefaults.\n\n\n  coerce('fill', stackGroupOpts ? stackGroupOpts.fillDflt : 'none');\n\n  if (traceOut.fill !== 'none') {\n    handleFillColorDefaults(traceIn, traceOut, defaultColor, coerce);\n    if (!subTypes.hasLines(traceOut)) handleLineShapeDefaults(traceIn, traceOut, coerce);\n  }\n\n  var lineColor = (traceOut.line || {}).color;\n  var markerColor = (traceOut.marker || {}).color;\n\n  if (traceOut.fill === 'tonext' || traceOut.fill === 'toself') {\n    dfltHoverOn.push('fills');\n  }\n\n  coerce('hoveron', dfltHoverOn.join('+') || 'points');\n  if (traceOut.hoveron !== 'fills') coerce('hovertemplate');\n  var errorBarsSupplyDefaults = Registry.getComponentMethod('errorbars', 'supplyDefaults');\n  errorBarsSupplyDefaults(traceIn, traceOut, lineColor || markerColor || defaultColor, {\n    axis: 'y'\n  });\n  errorBarsSupplyDefaults(traceIn, traceOut, lineColor || markerColor || defaultColor, {\n    axis: 'x',\n    inherit: 'y'\n  });\n  Lib.coerceSelectionMarkerOpacity(traceOut, coerce);\n};","require(\"core-js/modules/es.promise.finally\");\n\n/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.ES6Promise = factory();\n})(this, function () {\n  'use strict';\n\n  function objectOrFunction(x) {\n    var type = typeof x;\n    return x !== null && (type === 'object' || type === 'function');\n  }\n\n  function isFunction(x) {\n    return typeof x === 'function';\n  }\n\n  var _isArray = void 0;\n\n  if (Array.isArray) {\n    _isArray = Array.isArray;\n  } else {\n    _isArray = function _isArray(x) {\n      return Object.prototype.toString.call(x) === '[object Array]';\n    };\n  }\n\n  var isArray = _isArray;\n  var len = 0;\n  var vertxNext = void 0;\n  var customSchedulerFn = void 0;\n\n  var asap = function asap(callback, arg) {\n    queue[len] = callback;\n    queue[len + 1] = arg;\n    len += 2;\n\n    if (len === 2) {\n      // If len is 2, that means that we need to schedule an async flush.\n      // If additional callbacks are queued before the queue is flushed, they\n      // will be processed by this flush that we are scheduling.\n      if (customSchedulerFn) {\n        customSchedulerFn(flush);\n      } else {\n        scheduleFlush();\n      }\n    }\n  };\n\n  function setScheduler(scheduleFn) {\n    customSchedulerFn = scheduleFn;\n  }\n\n  function setAsap(asapFn) {\n    asap = asapFn;\n  }\n\n  var browserWindow = typeof window !== 'undefined' ? window : undefined;\n  var browserGlobal = browserWindow || {};\n  var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\n  var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]'; // test for web worker but not in IE10\n\n  var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined'; // node\n\n  function useNextTick() {\n    // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n    // see https://github.com/cujojs/when/issues/410 for details\n    return function () {\n      return process.nextTick(flush);\n    };\n  } // vertx\n\n\n  function useVertxTimer() {\n    if (typeof vertxNext !== 'undefined') {\n      return function () {\n        vertxNext(flush);\n      };\n    }\n\n    return useSetTimeout();\n  }\n\n  function useMutationObserver() {\n    var iterations = 0;\n    var observer = new BrowserMutationObserver(flush);\n    var node = document.createTextNode('');\n    observer.observe(node, {\n      characterData: true\n    });\n    return function () {\n      node.data = iterations = ++iterations % 2;\n    };\n  } // web worker\n\n\n  function useMessageChannel() {\n    var channel = new MessageChannel();\n    channel.port1.onmessage = flush;\n    return function () {\n      return channel.port2.postMessage(0);\n    };\n  }\n\n  function useSetTimeout() {\n    // Store setTimeout reference so es6-promise will be unaffected by\n    // other code modifying setTimeout (like sinon.useFakeTimers())\n    var globalSetTimeout = setTimeout;\n    return function () {\n      return globalSetTimeout(flush, 1);\n    };\n  }\n\n  var queue = new Array(1000);\n\n  function flush() {\n    for (var i = 0; i < len; i += 2) {\n      var callback = queue[i];\n      var arg = queue[i + 1];\n      callback(arg);\n      queue[i] = undefined;\n      queue[i + 1] = undefined;\n    }\n\n    len = 0;\n  }\n\n  function attemptVertx() {\n    try {\n      var vertx = Function('return this')().require('vertx');\n\n      vertxNext = vertx.runOnLoop || vertx.runOnContext;\n      return useVertxTimer();\n    } catch (e) {\n      return useSetTimeout();\n    }\n  }\n\n  var scheduleFlush = void 0; // Decide what async method to use to triggering processing of queued callbacks:\n\n  if (isNode) {\n    scheduleFlush = useNextTick();\n  } else if (BrowserMutationObserver) {\n    scheduleFlush = useMutationObserver();\n  } else if (isWorker) {\n    scheduleFlush = useMessageChannel();\n  } else if (browserWindow === undefined && typeof require === 'function') {\n    scheduleFlush = attemptVertx();\n  } else {\n    scheduleFlush = useSetTimeout();\n  }\n\n  function then(onFulfillment, onRejection) {\n    var parent = this;\n    var child = new this.constructor(noop);\n\n    if (child[PROMISE_ID] === undefined) {\n      makePromise(child);\n    }\n\n    var _state = parent._state;\n\n    if (_state) {\n      var callback = arguments[_state - 1];\n      asap(function () {\n        return invokeCallback(_state, child, callback, parent._result);\n      });\n    } else {\n      subscribe(parent, child, onFulfillment, onRejection);\n    }\n\n    return child;\n  }\n  /**\n    `Promise.resolve` returns a promise that will become resolved with the\n    passed `value`. It is shorthand for the following:\n  \n    ```javascript\n    let promise = new Promise(function(resolve, reject){\n      resolve(1);\n    });\n  \n    promise.then(function(value){\n      // value === 1\n    });\n    ```\n  \n    Instead of writing the above, your code now simply becomes the following:\n  \n    ```javascript\n    let promise = Promise.resolve(1);\n  \n    promise.then(function(value){\n      // value === 1\n    });\n    ```\n  \n    @method resolve\n    @static\n    @param {Any} value value that the returned promise will be resolved with\n    Useful for tooling.\n    @return {Promise} a promise that will become fulfilled with the given\n    `value`\n  */\n\n\n  function resolve$1(object) {\n    /*jshint validthis:true */\n    var Constructor = this;\n\n    if (object && typeof object === 'object' && object.constructor === Constructor) {\n      return object;\n    }\n\n    var promise = new Constructor(noop);\n    resolve(promise, object);\n    return promise;\n  }\n\n  var PROMISE_ID = Math.random().toString(36).substring(2);\n\n  function noop() {}\n\n  var PENDING = void 0;\n  var FULFILLED = 1;\n  var REJECTED = 2;\n\n  function selfFulfillment() {\n    return new TypeError(\"You cannot resolve a promise with itself\");\n  }\n\n  function cannotReturnOwn() {\n    return new TypeError('A promises callback cannot return that same promise.');\n  }\n\n  function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n    try {\n      then$$1.call(value, fulfillmentHandler, rejectionHandler);\n    } catch (e) {\n      return e;\n    }\n  }\n\n  function handleForeignThenable(promise, thenable, then$$1) {\n    asap(function (promise) {\n      var sealed = false;\n      var error = tryThen(then$$1, thenable, function (value) {\n        if (sealed) {\n          return;\n        }\n\n        sealed = true;\n\n        if (thenable !== value) {\n          resolve(promise, value);\n        } else {\n          fulfill(promise, value);\n        }\n      }, function (reason) {\n        if (sealed) {\n          return;\n        }\n\n        sealed = true;\n        reject(promise, reason);\n      }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n      if (!sealed && error) {\n        sealed = true;\n        reject(promise, error);\n      }\n    }, promise);\n  }\n\n  function handleOwnThenable(promise, thenable) {\n    if (thenable._state === FULFILLED) {\n      fulfill(promise, thenable._result);\n    } else if (thenable._state === REJECTED) {\n      reject(promise, thenable._result);\n    } else {\n      subscribe(thenable, undefined, function (value) {\n        return resolve(promise, value);\n      }, function (reason) {\n        return reject(promise, reason);\n      });\n    }\n  }\n\n  function handleMaybeThenable(promise, maybeThenable, then$$1) {\n    if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n      handleOwnThenable(promise, maybeThenable);\n    } else {\n      if (then$$1 === undefined) {\n        fulfill(promise, maybeThenable);\n      } else if (isFunction(then$$1)) {\n        handleForeignThenable(promise, maybeThenable, then$$1);\n      } else {\n        fulfill(promise, maybeThenable);\n      }\n    }\n  }\n\n  function resolve(promise, value) {\n    if (promise === value) {\n      reject(promise, selfFulfillment());\n    } else if (objectOrFunction(value)) {\n      var then$$1 = void 0;\n\n      try {\n        then$$1 = value.then;\n      } catch (error) {\n        reject(promise, error);\n        return;\n      }\n\n      handleMaybeThenable(promise, value, then$$1);\n    } else {\n      fulfill(promise, value);\n    }\n  }\n\n  function publishRejection(promise) {\n    if (promise._onerror) {\n      promise._onerror(promise._result);\n    }\n\n    publish(promise);\n  }\n\n  function fulfill(promise, value) {\n    if (promise._state !== PENDING) {\n      return;\n    }\n\n    promise._result = value;\n    promise._state = FULFILLED;\n\n    if (promise._subscribers.length !== 0) {\n      asap(publish, promise);\n    }\n  }\n\n  function reject(promise, reason) {\n    if (promise._state !== PENDING) {\n      return;\n    }\n\n    promise._state = REJECTED;\n    promise._result = reason;\n    asap(publishRejection, promise);\n  }\n\n  function subscribe(parent, child, onFulfillment, onRejection) {\n    var _subscribers = parent._subscribers;\n    var length = _subscribers.length;\n    parent._onerror = null;\n    _subscribers[length] = child;\n    _subscribers[length + FULFILLED] = onFulfillment;\n    _subscribers[length + REJECTED] = onRejection;\n\n    if (length === 0 && parent._state) {\n      asap(publish, parent);\n    }\n  }\n\n  function publish(promise) {\n    var subscribers = promise._subscribers;\n    var settled = promise._state;\n\n    if (subscribers.length === 0) {\n      return;\n    }\n\n    var child = void 0,\n        callback = void 0,\n        detail = promise._result;\n\n    for (var i = 0; i < subscribers.length; i += 3) {\n      child = subscribers[i];\n      callback = subscribers[i + settled];\n\n      if (child) {\n        invokeCallback(settled, child, callback, detail);\n      } else {\n        callback(detail);\n      }\n    }\n\n    promise._subscribers.length = 0;\n  }\n\n  function invokeCallback(settled, promise, callback, detail) {\n    var hasCallback = isFunction(callback),\n        value = void 0,\n        error = void 0,\n        succeeded = true;\n\n    if (hasCallback) {\n      try {\n        value = callback(detail);\n      } catch (e) {\n        succeeded = false;\n        error = e;\n      }\n\n      if (promise === value) {\n        reject(promise, cannotReturnOwn());\n        return;\n      }\n    } else {\n      value = detail;\n    }\n\n    if (promise._state !== PENDING) {// noop\n    } else if (hasCallback && succeeded) {\n      resolve(promise, value);\n    } else if (succeeded === false) {\n      reject(promise, error);\n    } else if (settled === FULFILLED) {\n      fulfill(promise, value);\n    } else if (settled === REJECTED) {\n      reject(promise, value);\n    }\n  }\n\n  function initializePromise(promise, resolver) {\n    try {\n      resolver(function resolvePromise(value) {\n        resolve(promise, value);\n      }, function rejectPromise(reason) {\n        reject(promise, reason);\n      });\n    } catch (e) {\n      reject(promise, e);\n    }\n  }\n\n  var id = 0;\n\n  function nextId() {\n    return id++;\n  }\n\n  function makePromise(promise) {\n    promise[PROMISE_ID] = id++;\n    promise._state = undefined;\n    promise._result = undefined;\n    promise._subscribers = [];\n  }\n\n  function validationError() {\n    return new Error('Array Methods must be provided an Array');\n  }\n\n  var Enumerator = function () {\n    function Enumerator(Constructor, input) {\n      this._instanceConstructor = Constructor;\n      this.promise = new Constructor(noop);\n\n      if (!this.promise[PROMISE_ID]) {\n        makePromise(this.promise);\n      }\n\n      if (isArray(input)) {\n        this.length = input.length;\n        this._remaining = input.length;\n        this._result = new Array(this.length);\n\n        if (this.length === 0) {\n          fulfill(this.promise, this._result);\n        } else {\n          this.length = this.length || 0;\n\n          this._enumerate(input);\n\n          if (this._remaining === 0) {\n            fulfill(this.promise, this._result);\n          }\n        }\n      } else {\n        reject(this.promise, validationError());\n      }\n    }\n\n    Enumerator.prototype._enumerate = function _enumerate(input) {\n      for (var i = 0; this._state === PENDING && i < input.length; i++) {\n        this._eachEntry(input[i], i);\n      }\n    };\n\n    Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n      var c = this._instanceConstructor;\n      var resolve$$1 = c.resolve;\n\n      if (resolve$$1 === resolve$1) {\n        var _then = void 0;\n\n        var error = void 0;\n        var didError = false;\n\n        try {\n          _then = entry.then;\n        } catch (e) {\n          didError = true;\n          error = e;\n        }\n\n        if (_then === then && entry._state !== PENDING) {\n          this._settledAt(entry._state, i, entry._result);\n        } else if (typeof _then !== 'function') {\n          this._remaining--;\n          this._result[i] = entry;\n        } else if (c === Promise$1) {\n          var promise = new c(noop);\n\n          if (didError) {\n            reject(promise, error);\n          } else {\n            handleMaybeThenable(promise, entry, _then);\n          }\n\n          this._willSettleAt(promise, i);\n        } else {\n          this._willSettleAt(new c(function (resolve$$1) {\n            return resolve$$1(entry);\n          }), i);\n        }\n      } else {\n        this._willSettleAt(resolve$$1(entry), i);\n      }\n    };\n\n    Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n      var promise = this.promise;\n\n      if (promise._state === PENDING) {\n        this._remaining--;\n\n        if (state === REJECTED) {\n          reject(promise, value);\n        } else {\n          this._result[i] = value;\n        }\n      }\n\n      if (this._remaining === 0) {\n        fulfill(promise, this._result);\n      }\n    };\n\n    Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n      var enumerator = this;\n      subscribe(promise, undefined, function (value) {\n        return enumerator._settledAt(FULFILLED, i, value);\n      }, function (reason) {\n        return enumerator._settledAt(REJECTED, i, reason);\n      });\n    };\n\n    return Enumerator;\n  }();\n  /**\n    `Promise.all` accepts an array of promises, and returns a new promise which\n    is fulfilled with an array of fulfillment values for the passed promises, or\n    rejected with the reason of the first passed promise to be rejected. It casts all\n    elements of the passed iterable to promises as it runs this algorithm.\n  \n    Example:\n  \n    ```javascript\n    let promise1 = resolve(1);\n    let promise2 = resolve(2);\n    let promise3 = resolve(3);\n    let promises = [ promise1, promise2, promise3 ];\n  \n    Promise.all(promises).then(function(array){\n      // The array here would be [ 1, 2, 3 ];\n    });\n    ```\n  \n    If any of the `promises` given to `all` are rejected, the first promise\n    that is rejected will be given as an argument to the returned promises's\n    rejection handler. For example:\n  \n    Example:\n  \n    ```javascript\n    let promise1 = resolve(1);\n    let promise2 = reject(new Error(\"2\"));\n    let promise3 = reject(new Error(\"3\"));\n    let promises = [ promise1, promise2, promise3 ];\n  \n    Promise.all(promises).then(function(array){\n      // Code here never runs because there are rejected promises!\n    }, function(error) {\n      // error.message === \"2\"\n    });\n    ```\n  \n    @method all\n    @static\n    @param {Array} entries array of promises\n    @param {String} label optional string for labeling the promise.\n    Useful for tooling.\n    @return {Promise} promise that is fulfilled when all `promises` have been\n    fulfilled, or rejected if any of them become rejected.\n    @static\n  */\n\n\n  function all(entries) {\n    return new Enumerator(this, entries).promise;\n  }\n  /**\n    `Promise.race` returns a new promise which is settled in the same way as the\n    first passed promise to settle.\n  \n    Example:\n  \n    ```javascript\n    let promise1 = new Promise(function(resolve, reject){\n      setTimeout(function(){\n        resolve('promise 1');\n      }, 200);\n    });\n  \n    let promise2 = new Promise(function(resolve, reject){\n      setTimeout(function(){\n        resolve('promise 2');\n      }, 100);\n    });\n  \n    Promise.race([promise1, promise2]).then(function(result){\n      // result === 'promise 2' because it was resolved before promise1\n      // was resolved.\n    });\n    ```\n  \n    `Promise.race` is deterministic in that only the state of the first\n    settled promise matters. For example, even if other promises given to the\n    `promises` array argument are resolved, but the first settled promise has\n    become rejected before the other promises became fulfilled, the returned\n    promise will become rejected:\n  \n    ```javascript\n    let promise1 = new Promise(function(resolve, reject){\n      setTimeout(function(){\n        resolve('promise 1');\n      }, 200);\n    });\n  \n    let promise2 = new Promise(function(resolve, reject){\n      setTimeout(function(){\n        reject(new Error('promise 2'));\n      }, 100);\n    });\n  \n    Promise.race([promise1, promise2]).then(function(result){\n      // Code here never runs\n    }, function(reason){\n      // reason.message === 'promise 2' because promise 2 became rejected before\n      // promise 1 became fulfilled\n    });\n    ```\n  \n    An example real-world use case is implementing timeouts:\n  \n    ```javascript\n    Promise.race([ajax('foo.json'), timeout(5000)])\n    ```\n  \n    @method race\n    @static\n    @param {Array} promises array of promises to observe\n    Useful for tooling.\n    @return {Promise} a promise which settles in the same way as the first passed\n    promise to settle.\n  */\n\n\n  function race(entries) {\n    /*jshint validthis:true */\n    var Constructor = this;\n\n    if (!isArray(entries)) {\n      return new Constructor(function (_, reject) {\n        return reject(new TypeError('You must pass an array to race.'));\n      });\n    } else {\n      return new Constructor(function (resolve, reject) {\n        var length = entries.length;\n\n        for (var i = 0; i < length; i++) {\n          Constructor.resolve(entries[i]).then(resolve, reject);\n        }\n      });\n    }\n  }\n  /**\n    `Promise.reject` returns a promise rejected with the passed `reason`.\n    It is shorthand for the following:\n  \n    ```javascript\n    let promise = new Promise(function(resolve, reject){\n      reject(new Error('WHOOPS'));\n    });\n  \n    promise.then(function(value){\n      // Code here doesn't run because the promise is rejected!\n    }, function(reason){\n      // reason.message === 'WHOOPS'\n    });\n    ```\n  \n    Instead of writing the above, your code now simply becomes the following:\n  \n    ```javascript\n    let promise = Promise.reject(new Error('WHOOPS'));\n  \n    promise.then(function(value){\n      // Code here doesn't run because the promise is rejected!\n    }, function(reason){\n      // reason.message === 'WHOOPS'\n    });\n    ```\n  \n    @method reject\n    @static\n    @param {Any} reason value that the returned promise will be rejected with.\n    Useful for tooling.\n    @return {Promise} a promise rejected with the given `reason`.\n  */\n\n\n  function reject$1(reason) {\n    /*jshint validthis:true */\n    var Constructor = this;\n    var promise = new Constructor(noop);\n    reject(promise, reason);\n    return promise;\n  }\n\n  function needsResolver() {\n    throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n  }\n\n  function needsNew() {\n    throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n  }\n  /**\n    Promise objects represent the eventual result of an asynchronous operation. The\n    primary way of interacting with a promise is through its `then` method, which\n    registers callbacks to receive either a promise's eventual value or the reason\n    why the promise cannot be fulfilled.\n  \n    Terminology\n    -----------\n  \n    - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n    - `thenable` is an object or function that defines a `then` method.\n    - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n    - `exception` is a value that is thrown using the throw statement.\n    - `reason` is a value that indicates why a promise was rejected.\n    - `settled` the final resting state of a promise, fulfilled or rejected.\n  \n    A promise can be in one of three states: pending, fulfilled, or rejected.\n  \n    Promises that are fulfilled have a fulfillment value and are in the fulfilled\n    state.  Promises that are rejected have a rejection reason and are in the\n    rejected state.  A fulfillment value is never a thenable.\n  \n    Promises can also be said to *resolve* a value.  If this value is also a\n    promise, then the original promise's settled state will match the value's\n    settled state.  So a promise that *resolves* a promise that rejects will\n    itself reject, and a promise that *resolves* a promise that fulfills will\n    itself fulfill.\n  \n  \n    Basic Usage:\n    ------------\n  \n    ```js\n    let promise = new Promise(function(resolve, reject) {\n      // on success\n      resolve(value);\n  \n      // on failure\n      reject(reason);\n    });\n  \n    promise.then(function(value) {\n      // on fulfillment\n    }, function(reason) {\n      // on rejection\n    });\n    ```\n  \n    Advanced Usage:\n    ---------------\n  \n    Promises shine when abstracting away asynchronous interactions such as\n    `XMLHttpRequest`s.\n  \n    ```js\n    function getJSON(url) {\n      return new Promise(function(resolve, reject){\n        let xhr = new XMLHttpRequest();\n  \n        xhr.open('GET', url);\n        xhr.onreadystatechange = handler;\n        xhr.responseType = 'json';\n        xhr.setRequestHeader('Accept', 'application/json');\n        xhr.send();\n  \n        function handler() {\n          if (this.readyState === this.DONE) {\n            if (this.status === 200) {\n              resolve(this.response);\n            } else {\n              reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n            }\n          }\n        };\n      });\n    }\n  \n    getJSON('/posts.json').then(function(json) {\n      // on fulfillment\n    }, function(reason) {\n      // on rejection\n    });\n    ```\n  \n    Unlike callbacks, promises are great composable primitives.\n  \n    ```js\n    Promise.all([\n      getJSON('/posts'),\n      getJSON('/comments')\n    ]).then(function(values){\n      values[0] // => postsJSON\n      values[1] // => commentsJSON\n  \n      return values;\n    });\n    ```\n  \n    @class Promise\n    @param {Function} resolver\n    Useful for tooling.\n    @constructor\n  */\n\n\n  var Promise$1 = function () {\n    function Promise(resolver) {\n      this[PROMISE_ID] = nextId();\n      this._result = this._state = undefined;\n      this._subscribers = [];\n\n      if (noop !== resolver) {\n        typeof resolver !== 'function' && needsResolver();\n        this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n      }\n    }\n    /**\n    The primary way of interacting with a promise is through its `then` method,\n    which registers callbacks to receive either a promise's eventual value or the\n    reason why the promise cannot be fulfilled.\n     ```js\n    findUser().then(function(user){\n      // user is available\n    }, function(reason){\n      // user is unavailable, and you are given the reason why\n    });\n    ```\n     Chaining\n    --------\n     The return value of `then` is itself a promise.  This second, 'downstream'\n    promise is resolved with the return value of the first promise's fulfillment\n    or rejection handler, or rejected if the handler throws an exception.\n     ```js\n    findUser().then(function (user) {\n      return user.name;\n    }, function (reason) {\n      return 'default name';\n    }).then(function (userName) {\n      // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n      // will be `'default name'`\n    });\n     findUser().then(function (user) {\n      throw new Error('Found user, but still unhappy');\n    }, function (reason) {\n      throw new Error('`findUser` rejected and we're unhappy');\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n      // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n    });\n    ```\n    If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n     ```js\n    findUser().then(function (user) {\n      throw new PedagogicalException('Upstream error');\n    }).then(function (value) {\n      // never reached\n    }).then(function (value) {\n      // never reached\n    }, function (reason) {\n      // The `PedgagocialException` is propagated all the way down to here\n    });\n    ```\n     Assimilation\n    ------------\n     Sometimes the value you want to propagate to a downstream promise can only be\n    retrieved asynchronously. This can be achieved by returning a promise in the\n    fulfillment or rejection handler. The downstream promise will then be pending\n    until the returned promise is settled. This is called *assimilation*.\n     ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // The user's comments are now available\n    });\n    ```\n     If the assimliated promise rejects, then the downstream promise will also reject.\n     ```js\n    findUser().then(function (user) {\n      return findCommentsByAuthor(user);\n    }).then(function (comments) {\n      // If `findCommentsByAuthor` fulfills, we'll have the value here\n    }, function (reason) {\n      // If `findCommentsByAuthor` rejects, we'll have the reason here\n    });\n    ```\n     Simple Example\n    --------------\n     Synchronous Example\n     ```javascript\n    let result;\n     try {\n      result = findResult();\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n     Errback Example\n     ```js\n    findResult(function(result, err){\n      if (err) {\n        // failure\n      } else {\n        // success\n      }\n    });\n    ```\n     Promise Example;\n     ```javascript\n    findResult().then(function(result){\n      // success\n    }, function(reason){\n      // failure\n    });\n    ```\n     Advanced Example\n    --------------\n     Synchronous Example\n     ```javascript\n    let author, books;\n     try {\n      author = findAuthor();\n      books  = findBooksByAuthor(author);\n      // success\n    } catch(reason) {\n      // failure\n    }\n    ```\n     Errback Example\n     ```js\n     function foundBooks(books) {\n     }\n     function failure(reason) {\n     }\n     findAuthor(function(author, err){\n      if (err) {\n        failure(err);\n        // failure\n      } else {\n        try {\n          findBoooksByAuthor(author, function(books, err) {\n            if (err) {\n              failure(err);\n            } else {\n              try {\n                foundBooks(books);\n              } catch(reason) {\n                failure(reason);\n              }\n            }\n          });\n        } catch(error) {\n          failure(err);\n        }\n        // success\n      }\n    });\n    ```\n     Promise Example;\n     ```javascript\n    findAuthor().\n      then(findBooksByAuthor).\n      then(function(books){\n        // found books\n    }).catch(function(reason){\n      // something went wrong\n    });\n    ```\n     @method then\n    @param {Function} onFulfilled\n    @param {Function} onRejected\n    Useful for tooling.\n    @return {Promise}\n    */\n\n    /**\n    `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n    as the catch block of a try/catch statement.\n    ```js\n    function findAuthor(){\n    throw new Error('couldn't find that author');\n    }\n    // synchronous\n    try {\n    findAuthor();\n    } catch(reason) {\n    // something went wrong\n    }\n    // async with promises\n    findAuthor().catch(function(reason){\n    // something went wrong\n    });\n    ```\n    @method catch\n    @param {Function} onRejection\n    Useful for tooling.\n    @return {Promise}\n    */\n\n\n    Promise.prototype.catch = function _catch(onRejection) {\n      return this.then(null, onRejection);\n    };\n    /**\n      `finally` will be invoked regardless of the promise's fate just as native\n      try/catch/finally behaves\n    \n      Synchronous example:\n    \n      ```js\n      findAuthor() {\n        if (Math.random() > 0.5) {\n          throw new Error();\n        }\n        return new Author();\n      }\n    \n      try {\n        return findAuthor(); // succeed or fail\n      } catch(error) {\n        return findOtherAuther();\n      } finally {\n        // always runs\n        // doesn't affect the return value\n      }\n      ```\n    \n      Asynchronous example:\n    \n      ```js\n      findAuthor().catch(function(reason){\n        return findOtherAuther();\n      }).finally(function(){\n        // author was either found, or not\n      });\n      ```\n    \n      @method finally\n      @param {Function} callback\n      @return {Promise}\n    */\n\n\n    Promise.prototype.finally = function _finally(callback) {\n      var promise = this;\n      var constructor = promise.constructor;\n\n      if (isFunction(callback)) {\n        return promise.then(function (value) {\n          return constructor.resolve(callback()).then(function () {\n            return value;\n          });\n        }, function (reason) {\n          return constructor.resolve(callback()).then(function () {\n            throw reason;\n          });\n        });\n      }\n\n      return promise.then(callback, callback);\n    };\n\n    return Promise;\n  }();\n\n  Promise$1.prototype.then = then;\n  Promise$1.all = all;\n  Promise$1.race = race;\n  Promise$1.resolve = resolve$1;\n  Promise$1.reject = reject$1;\n  Promise$1._setScheduler = setScheduler;\n  Promise$1._setAsap = setAsap;\n  Promise$1._asap = asap;\n  /*global self*/\n\n  function polyfill() {\n    var local = void 0;\n\n    if (typeof global !== 'undefined') {\n      local = global;\n    } else if (typeof self !== 'undefined') {\n      local = self;\n    } else {\n      try {\n        local = Function('return this')();\n      } catch (e) {\n        throw new Error('polyfill failed because global object is unavailable in this environment');\n      }\n    }\n\n    var P = local.Promise;\n\n    if (P) {\n      var promiseToString = null;\n\n      try {\n        promiseToString = Object.prototype.toString.call(P.resolve());\n      } catch (e) {// silently ignored\n      }\n\n      if (promiseToString === '[object Promise]' && !P.cast) {\n        return;\n      }\n    }\n\n    local.Promise = Promise$1;\n  } // Strange compat..\n\n\n  Promise$1.polyfill = polyfill;\n  Promise$1.Promise = Promise$1;\n  return Promise$1;\n});","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib'); // arrayOk attributes, merge them into calcdata array\n\n\nmodule.exports = function arraysToCalcdata(cd, trace) {\n  // so each point knows which index it originally came from\n  for (var i = 0; i < cd.length; i++) {\n    cd[i].i = i;\n  }\n\n  Lib.mergeArray(trace.text, cd, 'tx');\n  Lib.mergeArray(trace.texttemplate, cd, 'txt');\n  Lib.mergeArray(trace.hovertext, cd, 'htx');\n  Lib.mergeArray(trace.customdata, cd, 'data');\n  Lib.mergeArray(trace.textposition, cd, 'tp');\n\n  if (trace.textfont) {\n    Lib.mergeArrayCastPositive(trace.textfont.size, cd, 'ts');\n    Lib.mergeArray(trace.textfont.color, cd, 'tc');\n    Lib.mergeArray(trace.textfont.family, cd, 'tf');\n  }\n\n  var marker = trace.marker;\n\n  if (marker) {\n    Lib.mergeArrayCastPositive(marker.size, cd, 'ms');\n    Lib.mergeArrayCastPositive(marker.opacity, cd, 'mo');\n    Lib.mergeArray(marker.symbol, cd, 'mx');\n    Lib.mergeArray(marker.color, cd, 'mc');\n    var markerLine = marker.line;\n\n    if (marker.line) {\n      Lib.mergeArray(markerLine.color, cd, 'mlc');\n      Lib.mergeArrayCastPositive(markerLine.width, cd, 'mlw');\n    }\n\n    var markerGradient = marker.gradient;\n\n    if (markerGradient && markerGradient.type !== 'none') {\n      Lib.mergeArray(markerGradient.type, cd, 'mgt');\n      Lib.mergeArray(markerGradient.color, cd, 'mgc');\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict'; // Modified from https://github.com/ArthurClemens/Javascript-Undo-Manager\n// Copyright (c) 2010-2013 Arthur Clemens, arthur@visiblearea.com\n\nmodule.exports = function UndoManager() {\n  var undoCommands = [];\n  var index = -1;\n  var isExecuting = false;\n  var callback;\n\n  function execute(command, action) {\n    if (!command) return this;\n    isExecuting = true;\n    command[action]();\n    isExecuting = false;\n    return this;\n  }\n\n  return {\n    add: function add(command) {\n      if (isExecuting) return this;\n      undoCommands.splice(index + 1, undoCommands.length - index);\n      undoCommands.push(command);\n      index = undoCommands.length - 1;\n      return this;\n    },\n    setCallback: function setCallback(callbackFunc) {\n      callback = callbackFunc;\n    },\n    undo: function undo() {\n      var command = undoCommands[index];\n      if (!command) return this;\n      execute(command, 'undo');\n      index -= 1;\n      if (callback) callback(command.undo);\n      return this;\n    },\n    redo: function redo() {\n      var command = undoCommands[index + 1];\n      if (!command) return this;\n      execute(command, 'redo');\n      index += 1;\n      if (callback) callback(command.redo);\n      return this;\n    },\n    clear: function clear() {\n      undoCommands = [];\n      index = -1;\n    },\n    hasUndo: function hasUndo() {\n      return index !== -1;\n    },\n    hasRedo: function hasRedo() {\n      return index < undoCommands.length - 1;\n    },\n    getCommands: function getCommands() {\n      return undoCommands;\n    },\n    getPreviousCommand: function getPreviousCommand() {\n      return undoCommands[index - 1];\n    },\n    getIndex: function getIndex() {\n      return index;\n    }\n  };\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar annAttrs = require('../annotations/attributes');\n\nvar overrideAll = require('../../plot_api/edit_types').overrideAll;\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nmodule.exports = overrideAll(templatedArray('annotation', {\n  visible: annAttrs.visible,\n  x: {\n    valType: 'any',\n    role: 'info',\n    description: ['Sets the annotation\\'s x position.'].join(' ')\n  },\n  y: {\n    valType: 'any',\n    role: 'info',\n    description: ['Sets the annotation\\'s y position.'].join(' ')\n  },\n  z: {\n    valType: 'any',\n    role: 'info',\n    description: ['Sets the annotation\\'s z position.'].join(' ')\n  },\n  ax: {\n    valType: 'number',\n    role: 'info',\n    description: ['Sets the x component of the arrow tail about the arrow head (in pixels).'].join(' ')\n  },\n  ay: {\n    valType: 'number',\n    role: 'info',\n    description: ['Sets the y component of the arrow tail about the arrow head (in pixels).'].join(' ')\n  },\n  xanchor: annAttrs.xanchor,\n  xshift: annAttrs.xshift,\n  yanchor: annAttrs.yanchor,\n  yshift: annAttrs.yshift,\n  text: annAttrs.text,\n  textangle: annAttrs.textangle,\n  font: annAttrs.font,\n  width: annAttrs.width,\n  height: annAttrs.height,\n  opacity: annAttrs.opacity,\n  align: annAttrs.align,\n  valign: annAttrs.valign,\n  bgcolor: annAttrs.bgcolor,\n  bordercolor: annAttrs.bordercolor,\n  borderpad: annAttrs.borderpad,\n  borderwidth: annAttrs.borderwidth,\n  showarrow: annAttrs.showarrow,\n  arrowcolor: annAttrs.arrowcolor,\n  arrowhead: annAttrs.arrowhead,\n  startarrowhead: annAttrs.startarrowhead,\n  arrowside: annAttrs.arrowside,\n  arrowsize: annAttrs.arrowsize,\n  startarrowsize: annAttrs.startarrowsize,\n  arrowwidth: annAttrs.arrowwidth,\n  standoff: annAttrs.standoff,\n  startstandoff: annAttrs.startstandoff,\n  hovertext: annAttrs.hovertext,\n  hoverlabel: annAttrs.hoverlabel,\n  captureevents: annAttrs.captureevents // maybes later?\n  // clicktoshow: annAttrs.clicktoshow,\n  // xclick: annAttrs.xclick,\n  // yclick: annAttrs.yclick,\n  // not needed!\n  // axref: 'pixel'\n  // ayref: 'pixel'\n  // xref: 'x'\n  // yref: 'y\n  // zref: 'z'\n\n}), 'calc', 'from-root');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Color = require('../color'); // defaults common to 'annotations' and 'annotations3d'\n\n\nmodule.exports = function handleAnnotationCommonDefaults(annIn, annOut, fullLayout, coerce) {\n  coerce('opacity');\n  var bgColor = coerce('bgcolor');\n  var borderColor = coerce('bordercolor');\n  var borderOpacity = Color.opacity(borderColor);\n  coerce('borderpad');\n  var borderWidth = coerce('borderwidth');\n  var showArrow = coerce('showarrow');\n  coerce('text', showArrow ? ' ' : fullLayout._dfltTitle.annotation);\n  coerce('textangle');\n  Lib.coerceFont(coerce, 'font', fullLayout.font);\n  coerce('width');\n  coerce('align');\n  var h = coerce('height');\n  if (h) coerce('valign');\n\n  if (showArrow) {\n    var arrowside = coerce('arrowside');\n    var arrowhead;\n    var arrowsize;\n\n    if (arrowside.indexOf('end') !== -1) {\n      arrowhead = coerce('arrowhead');\n      arrowsize = coerce('arrowsize');\n    }\n\n    if (arrowside.indexOf('start') !== -1) {\n      coerce('startarrowhead', arrowhead);\n      coerce('startarrowsize', arrowsize);\n    }\n\n    coerce('arrowcolor', borderOpacity ? annOut.bordercolor : Color.defaultLine);\n    coerce('arrowwidth', (borderOpacity && borderWidth || 1) * 2);\n    coerce('standoff');\n    coerce('startstandoff');\n  }\n\n  var hoverText = coerce('hovertext');\n  var globalHoverLabel = fullLayout.hoverlabel || {};\n\n  if (hoverText) {\n    var hoverBG = coerce('hoverlabel.bgcolor', globalHoverLabel.bgcolor || (Color.opacity(bgColor) ? Color.rgb(bgColor) : Color.defaultLine));\n    var hoverBorder = coerce('hoverlabel.bordercolor', globalHoverLabel.bordercolor || Color.contrast(hoverBG));\n    Lib.coerceFont(coerce, 'hoverlabel.font', {\n      family: globalHoverLabel.font.family,\n      size: globalHoverLabel.font.size,\n      color: globalHoverLabel.font.color || hoverBorder\n    });\n  }\n\n  coerce('captureevents', !!hoverText);\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Fx = require('../../components/fx');\n\nvar dragElement = require('../../components/dragelement');\n\nvar setCursor = require('../../lib/setcursor');\n\nvar makeDragBox = require('./dragbox').makeDragBox;\n\nvar DRAGGERSIZE = require('./constants').DRAGGERSIZE;\n\nexports.initInteractions = function initInteractions(gd) {\n  var fullLayout = gd._fullLayout;\n\n  if (gd._context.staticPlot) {\n    // this sweeps up more than just cartesian drag elements...\n    d3.select(gd).selectAll('.drag').remove();\n    return;\n  }\n\n  if (!fullLayout._has('cartesian') && !fullLayout._has('splom')) return;\n  var subplots = Object.keys(fullLayout._plots || {}).sort(function (a, b) {\n    // sort overlays last, then by x axis number, then y axis number\n    if ((fullLayout._plots[a].mainplot && true) === (fullLayout._plots[b].mainplot && true)) {\n      var aParts = a.split('y');\n      var bParts = b.split('y');\n      return aParts[0] === bParts[0] ? Number(aParts[1] || 1) - Number(bParts[1] || 1) : Number(aParts[0] || 1) - Number(bParts[0] || 1);\n    }\n\n    return fullLayout._plots[a].mainplot ? 1 : -1;\n  });\n  subplots.forEach(function (subplot) {\n    var plotinfo = fullLayout._plots[subplot];\n    var xa = plotinfo.xaxis;\n    var ya = plotinfo.yaxis; // main and corner draggers need not be repeated for\n    // overlaid subplots - these draggers drag them all\n\n    if (!plotinfo.mainplot) {\n      // main dragger goes over the grids and data, so we use its\n      // mousemove events for all data hover effects\n      var maindrag = makeDragBox(gd, plotinfo, xa._offset, ya._offset, xa._length, ya._length, 'ns', 'ew');\n\n      maindrag.onmousemove = function (evt) {\n        // This is on `gd._fullLayout`, *not* fullLayout because the reference\n        // changes by the time this is called again.\n        gd._fullLayout._rehover = function () {\n          if (gd._fullLayout._hoversubplot === subplot && gd._fullLayout._plots[subplot]) {\n            Fx.hover(gd, evt, subplot);\n          }\n        };\n\n        Fx.hover(gd, evt, subplot); // Note that we have *not* used the cached fullLayout variable here\n        // since that may be outdated when this is called as a callback later on\n\n        gd._fullLayout._lasthover = maindrag;\n        gd._fullLayout._hoversubplot = subplot;\n      };\n      /*\n       * IMPORTANT:\n       * We must check for the presence of the drag cover here.\n       * If we don't, a 'mouseout' event is triggered on the\n       * maindrag before each 'click' event, which has the effect\n       * of clearing the hoverdata; thus, cancelling the click event.\n       */\n\n\n      maindrag.onmouseout = function (evt) {\n        if (gd._dragging) return; // When the mouse leaves this maindrag, unset the hovered subplot.\n        // This may cause problems if it leaves the subplot directly *onto*\n        // another subplot, but that's a tiny corner case at the moment.\n\n        gd._fullLayout._hoversubplot = null;\n        dragElement.unhover(gd, evt);\n      }; // corner draggers\n\n\n      if (gd._context.showAxisDragHandles) {\n        makeDragBox(gd, plotinfo, xa._offset - DRAGGERSIZE, ya._offset - DRAGGERSIZE, DRAGGERSIZE, DRAGGERSIZE, 'n', 'w');\n        makeDragBox(gd, plotinfo, xa._offset + xa._length, ya._offset - DRAGGERSIZE, DRAGGERSIZE, DRAGGERSIZE, 'n', 'e');\n        makeDragBox(gd, plotinfo, xa._offset - DRAGGERSIZE, ya._offset + ya._length, DRAGGERSIZE, DRAGGERSIZE, 's', 'w');\n        makeDragBox(gd, plotinfo, xa._offset + xa._length, ya._offset + ya._length, DRAGGERSIZE, DRAGGERSIZE, 's', 'e');\n      }\n    }\n\n    if (gd._context.showAxisDragHandles) {\n      // x axis draggers - if you have overlaid plots,\n      // these drag each axis separately\n      if (subplot === xa._mainSubplot) {\n        // the y position of the main x axis line\n        var y0 = xa._mainLinePosition;\n        if (xa.side === 'top') y0 -= DRAGGERSIZE;\n        makeDragBox(gd, plotinfo, xa._offset + xa._length * 0.1, y0, xa._length * 0.8, DRAGGERSIZE, '', 'ew');\n        makeDragBox(gd, plotinfo, xa._offset, y0, xa._length * 0.1, DRAGGERSIZE, '', 'w');\n        makeDragBox(gd, plotinfo, xa._offset + xa._length * 0.9, y0, xa._length * 0.1, DRAGGERSIZE, '', 'e');\n      } // y axis draggers\n\n\n      if (subplot === ya._mainSubplot) {\n        // the x position of the main y axis line\n        var x0 = ya._mainLinePosition;\n        if (ya.side !== 'right') x0 -= DRAGGERSIZE;\n        makeDragBox(gd, plotinfo, x0, ya._offset + ya._length * 0.1, DRAGGERSIZE, ya._length * 0.8, 'ns', '');\n        makeDragBox(gd, plotinfo, x0, ya._offset + ya._length * 0.9, DRAGGERSIZE, ya._length * 0.1, 's', '');\n        makeDragBox(gd, plotinfo, x0, ya._offset, DRAGGERSIZE, ya._length * 0.1, 'n', '');\n      }\n    }\n  }); // In case you mousemove over some hovertext, send it to Fx.hover too\n  // we do this so that we can put the hover text in front of everything,\n  // but still be able to interact with everything as if it isn't there\n\n  var hoverLayer = fullLayout._hoverlayer.node();\n\n  hoverLayer.onmousemove = function (evt) {\n    evt.target = gd._fullLayout._lasthover;\n    Fx.hover(gd, evt, fullLayout._hoversubplot);\n  };\n\n  hoverLayer.onclick = function (evt) {\n    evt.target = gd._fullLayout._lasthover;\n    Fx.click(gd, evt);\n  }; // also delegate mousedowns... TODO: does this actually work?\n\n\n  hoverLayer.onmousedown = function (evt) {\n    gd._fullLayout._lasthover.onmousedown(evt);\n  };\n\n  exports.updateFx(gd);\n}; // Minimal set of update needed on 'modebar' edits.\n// We only need to update the <g .draglayer> cursor style.\n//\n// Note that changing the axis configuration and/or the fixedrange attribute\n// should trigger a full initInteractions.\n\n\nexports.updateFx = function (gd) {\n  var fullLayout = gd._fullLayout;\n  var cursor = fullLayout.dragmode === 'pan' ? 'move' : 'crosshair';\n  setCursor(fullLayout._draggers, cursor);\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar attrs = require('./attributes');\n\nvar oppAxisAttrs = require('./oppaxis_attributes');\n\nvar helpers = require('./helpers');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'rangeslider',\n  schema: {\n    subplots: {\n      xaxis: {\n        rangeslider: Lib.extendFlat({}, attrs, {\n          yaxis: oppAxisAttrs\n        })\n      }\n    }\n  },\n  layoutAttributes: require('./attributes'),\n  handleDefaults: require('./defaults'),\n  calcAutorange: require('./calc_autorange'),\n  draw: require('./draw'),\n  isVisible: helpers.isVisible,\n  makeData: helpers.makeData,\n  autoMarginOpts: helpers.autoMarginOpts\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'locale',\n  name: 'en-US',\n  dictionary: {\n    'Click to enter Colorscale title': 'Click to enter Colorscale title'\n  },\n  format: {\n    date: '%m/%d/%Y'\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'locale',\n  name: 'en',\n  dictionary: {\n    'Click to enter Colorscale title': 'Click to enter Colourscale title'\n  },\n  format: {\n    days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    shortDays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    shortMonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    periods: ['AM', 'PM'],\n    dateTime: '%a %b %e %X %Y',\n    date: '%d/%m/%Y',\n    time: '%H:%M:%S',\n    decimal: '.',\n    thousands: ',',\n    grouping: [3],\n    currency: ['$', ''],\n    year: '%Y',\n    month: '%b %Y',\n    dayMonth: '%b %-d',\n    dayMonthYear: '%b %-d, %Y'\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n/* eslint-disable new-cap */\n'use strict';\n\nvar d3 = require('d3');\n\nvar Lib = require('../../../lib');\n\nvar Color = require('../../../components/color');\n\nvar micropolar = require('./micropolar');\n\nvar UndoManager = require('./undo_manager');\n\nvar extendDeepAll = Lib.extendDeepAll;\nvar manager = module.exports = {};\n\nmanager.framework = function (_gd) {\n  var config, previousConfigClone, plot, convertedInput, container;\n  var undoManager = new UndoManager();\n\n  function exports(_inputConfig, _container) {\n    if (_container) container = _container;\n    d3.select(d3.select(container).node().parentNode).selectAll('.svg-container>*:not(.chart-root)').remove();\n    config = !config ? _inputConfig : extendDeepAll(config, _inputConfig);\n    if (!plot) plot = micropolar.Axis();\n    convertedInput = micropolar.adapter.plotly().convert(config);\n    plot.config(convertedInput).render(container);\n    _gd.data = config.data;\n    _gd.layout = config.layout;\n    manager.fillLayout(_gd);\n    return config;\n  }\n\n  exports.isPolar = true;\n\n  exports.svg = function () {\n    return plot.svg();\n  };\n\n  exports.getConfig = function () {\n    return config;\n  };\n\n  exports.getLiveConfig = function () {\n    return micropolar.adapter.plotly().convert(plot.getLiveConfig(), true);\n  };\n\n  exports.getLiveScales = function () {\n    return {\n      t: plot.angularScale(),\n      r: plot.radialScale()\n    };\n  };\n\n  exports.setUndoPoint = function () {\n    var that = this;\n    var configClone = micropolar.util.cloneJson(config);\n\n    (function (_configClone, _previousConfigClone) {\n      undoManager.add({\n        undo: function undo() {\n          if (_previousConfigClone) that(_previousConfigClone);\n        },\n        redo: function redo() {\n          that(_configClone);\n        }\n      });\n    })(configClone, previousConfigClone);\n\n    previousConfigClone = micropolar.util.cloneJson(configClone);\n  };\n\n  exports.undo = function () {\n    undoManager.undo();\n  };\n\n  exports.redo = function () {\n    undoManager.redo();\n  };\n\n  return exports;\n};\n\nmanager.fillLayout = function (_gd) {\n  var container = d3.select(_gd).selectAll('.plot-container');\n  var paperDiv = container.selectAll('.svg-container');\n\n  var paper = _gd.framework && _gd.framework.svg && _gd.framework.svg();\n\n  var dflts = {\n    width: 800,\n    height: 600,\n    paper_bgcolor: Color.background,\n    _container: container,\n    _paperdiv: paperDiv,\n    _paper: paper\n  };\n  _gd._fullLayout = extendDeepAll(dflts, _gd.layout);\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar Template = require('../../plot_api/plot_template');\n\nvar attributes = require('./attributes');\n\nmodule.exports = function (traceIn, traceOut, defaultColor, opts) {\n  var objName = 'error_' + opts.axis;\n  var containerOut = Template.newContainer(traceOut, objName);\n  var containerIn = traceIn[objName] || {};\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(containerIn, containerOut, attributes, attr, dflt);\n  }\n\n  var hasErrorBars = containerIn.array !== undefined || containerIn.value !== undefined || containerIn.type === 'sqrt';\n  var visible = coerce('visible', hasErrorBars);\n  if (visible === false) return;\n  var type = coerce('type', 'array' in containerIn ? 'data' : 'percent');\n  var symmetric = true;\n\n  if (type !== 'sqrt') {\n    symmetric = coerce('symmetric', !((type === 'data' ? 'arrayminus' : 'valueminus') in containerIn));\n  }\n\n  if (type === 'data') {\n    coerce('array');\n    coerce('traceref');\n\n    if (!symmetric) {\n      coerce('arrayminus');\n      coerce('tracerefminus');\n    }\n  } else if (type === 'percent' || type === 'constant') {\n    coerce('value');\n    if (!symmetric) coerce('valueminus');\n  }\n\n  var copyAttr = 'copy_' + opts.inherit + 'style';\n\n  if (opts.inherit) {\n    var inheritObj = traceOut['error_' + opts.inherit];\n\n    if ((inheritObj || {}).visible) {\n      coerce(copyAttr, !(containerIn.color || isNumeric(containerIn.thickness) || isNumeric(containerIn.width)));\n    }\n  }\n\n  if (!opts.inherit || !containerOut[copyAttr]) {\n    coerce('color', defaultColor);\n    coerce('thickness');\n    coerce('width', Registry.traceIs(traceOut, 'gl3d') ? 0 : 4);\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar subtypes = require('./subtypes');\n\nmodule.exports = function selectPoints(searchInfo, selectionTester) {\n  var cd = searchInfo.cd;\n  var xa = searchInfo.xaxis;\n  var ya = searchInfo.yaxis;\n  var selection = [];\n  var trace = cd[0].trace;\n  var i;\n  var di;\n  var x;\n  var y;\n  var hasOnlyLines = !subtypes.hasMarkers(trace) && !subtypes.hasText(trace);\n  if (hasOnlyLines) return [];\n\n  if (selectionTester === false) {\n    // clear selection\n    for (i = 0; i < cd.length; i++) {\n      cd[i].selected = 0;\n    }\n  } else {\n    for (i = 0; i < cd.length; i++) {\n      di = cd[i];\n      x = xa.c2p(di.x);\n      y = ya.c2p(di.y);\n\n      if (di.i !== null && selectionTester.contains([x, y], false, i, searchInfo)) {\n        selection.push({\n          pointNumber: di.i,\n          x: xa.c2d(di.x),\n          y: ya.c2d(di.y)\n        });\n        di.selected = 1;\n      } else {\n        di.selected = 0;\n      }\n    }\n  }\n\n  return selection;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  // attribute container name\n  name: 'rangeslider',\n  // class names\n  containerClassName: 'rangeslider-container',\n  bgClassName: 'rangeslider-bg',\n  rangePlotClassName: 'rangeslider-rangeplot',\n  maskMinClassName: 'rangeslider-mask-min',\n  maskMaxClassName: 'rangeslider-mask-max',\n  slideBoxClassName: 'rangeslider-slidebox',\n  grabberMinClassName: 'rangeslider-grabber-min',\n  grabAreaMinClassName: 'rangeslider-grabarea-min',\n  handleMinClassName: 'rangeslider-handle-min',\n  grabberMaxClassName: 'rangeslider-grabber-max',\n  grabAreaMaxClassName: 'rangeslider-grabarea-max',\n  handleMaxClassName: 'rangeslider-handle-max',\n  maskMinOppAxisClassName: 'rangeslider-mask-min-opp-axis',\n  maskMaxOppAxisClassName: 'rangeslider-mask-max-opp-axis',\n  // style constants\n  maskColor: 'rgba(0,0,0,0.4)',\n  maskOppAxisColor: 'rgba(0,0,0,0.2)',\n  slideBoxFill: 'transparent',\n  slideBoxCursor: 'ew-resize',\n  grabAreaFill: 'transparent',\n  grabAreaCursor: 'col-resize',\n  grabAreaWidth: 10,\n  handleWidth: 4,\n  handleRadius: 1,\n  handleStrokeWidth: 1,\n  extraPad: 15\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Plots = require('../../plots/plots');\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar Color = require('../color');\n\nvar Drawing = require('../drawing');\n\nvar Fx = require('../fx');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar setCursor = require('../../lib/setcursor');\n\nvar dragElement = require('../dragelement');\n\nvar arrayEditor = require('../../plot_api/plot_template').arrayEditor;\n\nvar drawArrowHead = require('./draw_arrow_head'); // Annotations are stored in gd.layout.annotations, an array of objects\n// index can point to one item in this array,\n//  or non-numeric to simply add a new one\n//  or -1 to modify all existing\n// opt can be the full options object, or one key (to be set to value)\n//  or undefined to simply redraw\n// if opt is blank, val can be 'add' or a full options object to add a new\n//  annotation at that point in the array, or 'remove' to delete this one\n\n\nmodule.exports = {\n  draw: draw,\n  drawOne: drawOne,\n  drawRaw: drawRaw\n};\n/*\n * draw: draw all annotations without any new modifications\n */\n\nfunction draw(gd) {\n  var fullLayout = gd._fullLayout;\n\n  fullLayout._infolayer.selectAll('.annotation').remove();\n\n  for (var i = 0; i < fullLayout.annotations.length; i++) {\n    if (fullLayout.annotations[i].visible) {\n      drawOne(gd, i);\n    }\n  }\n\n  return Plots.previousPromises(gd);\n}\n/*\n * drawOne: draw a single cartesian or paper-ref annotation, potentially with modifications\n *\n * index (int): the annotation to draw\n */\n\n\nfunction drawOne(gd, index) {\n  var fullLayout = gd._fullLayout;\n  var options = fullLayout.annotations[index] || {};\n  var xa = Axes.getFromId(gd, options.xref);\n  var ya = Axes.getFromId(gd, options.yref);\n  if (xa) xa.setScale();\n  if (ya) ya.setScale();\n  drawRaw(gd, options, index, false, xa, ya);\n}\n/**\n * drawRaw: draw a single annotation, potentially with modifications\n *\n * @param {DOM element} gd\n * @param {object} options : this annotation's fullLayout options\n * @param {integer} index : index in 'annotations' container of the annotation to draw\n * @param {string} subplotId : id of the annotation's subplot\n *  - use false for 2d (i.e. cartesian or paper-ref) annotations\n * @param {object | undefined} xa : full x-axis object to compute subplot pos-to-px\n * @param {object | undefined} ya : ... y-axis\n */\n\n\nfunction drawRaw(gd, options, index, subplotId, xa, ya) {\n  var fullLayout = gd._fullLayout;\n  var gs = gd._fullLayout._size;\n  var edits = gd._context.edits;\n  var className, containerStr;\n\n  if (subplotId) {\n    className = 'annotation-' + subplotId;\n    containerStr = subplotId + '.annotations';\n  } else {\n    className = 'annotation';\n    containerStr = 'annotations';\n  }\n\n  var editHelpers = arrayEditor(gd.layout, containerStr, options);\n  var modifyBase = editHelpers.modifyBase;\n  var modifyItem = editHelpers.modifyItem;\n  var getUpdateObj = editHelpers.getUpdateObj; // remove the existing annotation if there is one\n\n  fullLayout._infolayer.selectAll('.' + className + '[data-index=\"' + index + '\"]').remove();\n\n  var annClipID = 'clip' + fullLayout._uid + '_ann' + index; // this annotation is gone - quit now after deleting it\n  // TODO: use d3 idioms instead of deleting and redrawing every time\n\n  if (!options._input || options.visible === false) {\n    d3.selectAll('#' + annClipID).remove();\n    return;\n  } // calculated pixel positions\n  // x & y each will get text, head, and tail as appropriate\n\n\n  var annPosPx = {\n    x: {},\n    y: {}\n  };\n  var textangle = +options.textangle || 0; // create the components\n  // made a single group to contain all, so opacity can work right\n  // with border/arrow together this could handle a whole bunch of\n  // cleanup at this point, but works for now\n\n  var annGroup = fullLayout._infolayer.append('g').classed(className, true).attr('data-index', String(index)).style('opacity', options.opacity); // another group for text+background so that they can rotate together\n\n\n  var annTextGroup = annGroup.append('g').classed('annotation-text-g', true);\n  var editTextPosition = edits[options.showarrow ? 'annotationTail' : 'annotationPosition'];\n  var textEvents = options.captureevents || edits.annotationText || editTextPosition;\n\n  function makeEventData(initialEvent) {\n    var eventData = {\n      index: index,\n      annotation: options._input,\n      fullAnnotation: options,\n      event: initialEvent\n    };\n\n    if (subplotId) {\n      eventData.subplotId = subplotId;\n    }\n\n    return eventData;\n  }\n\n  var annTextGroupInner = annTextGroup.append('g').style('pointer-events', textEvents ? 'all' : null).call(setCursor, 'pointer').on('click', function () {\n    gd._dragging = false;\n    gd.emit('plotly_clickannotation', makeEventData(d3.event));\n  });\n\n  if (options.hovertext) {\n    annTextGroupInner.on('mouseover', function () {\n      var hoverOptions = options.hoverlabel;\n      var hoverFont = hoverOptions.font;\n      var bBox = this.getBoundingClientRect();\n      var bBoxRef = gd.getBoundingClientRect();\n      Fx.loneHover({\n        x0: bBox.left - bBoxRef.left,\n        x1: bBox.right - bBoxRef.left,\n        y: (bBox.top + bBox.bottom) / 2 - bBoxRef.top,\n        text: options.hovertext,\n        color: hoverOptions.bgcolor,\n        borderColor: hoverOptions.bordercolor,\n        fontFamily: hoverFont.family,\n        fontSize: hoverFont.size,\n        fontColor: hoverFont.color\n      }, {\n        container: fullLayout._hoverlayer.node(),\n        outerContainer: fullLayout._paper.node(),\n        gd: gd\n      });\n    }).on('mouseout', function () {\n      Fx.loneUnhover(fullLayout._hoverlayer.node());\n    });\n  }\n\n  var borderwidth = options.borderwidth;\n  var borderpad = options.borderpad;\n  var borderfull = borderwidth + borderpad;\n  var annTextBG = annTextGroupInner.append('rect').attr('class', 'bg').style('stroke-width', borderwidth + 'px').call(Color.stroke, options.bordercolor).call(Color.fill, options.bgcolor);\n  var isSizeConstrained = options.width || options.height;\n\n  var annTextClip = fullLayout._topclips.selectAll('#' + annClipID).data(isSizeConstrained ? [0] : []);\n\n  annTextClip.enter().append('clipPath').classed('annclip', true).attr('id', annClipID).append('rect');\n  annTextClip.exit().remove();\n  var font = options.font;\n  var text = fullLayout._meta ? Lib.templateString(options.text, fullLayout._meta) : options.text;\n  var annText = annTextGroupInner.append('text').classed('annotation-text', true).text(text);\n\n  function textLayout(s) {\n    s.call(Drawing.font, font).attr({\n      'text-anchor': {\n        left: 'start',\n        right: 'end'\n      }[options.align] || 'middle'\n    });\n    svgTextUtils.convertToTspans(s, gd, drawGraphicalElements);\n    return s;\n  }\n\n  function drawGraphicalElements() {\n    // if the text has *only* a link, make the whole box into a link\n    var anchor3 = annText.selectAll('a');\n\n    if (anchor3.size() === 1 && anchor3.text() === annText.text()) {\n      var wholeLink = annTextGroupInner.insert('a', ':first-child').attr({\n        'xlink:xlink:href': anchor3.attr('xlink:href'),\n        'xlink:xlink:show': anchor3.attr('xlink:show')\n      }).style({\n        cursor: 'pointer'\n      });\n      wholeLink.node().appendChild(annTextBG.node());\n    }\n\n    var mathjaxGroup = annTextGroupInner.select('.annotation-text-math-group');\n    var hasMathjax = !mathjaxGroup.empty();\n    var anntextBB = Drawing.bBox((hasMathjax ? mathjaxGroup : annText).node());\n    var textWidth = anntextBB.width;\n    var textHeight = anntextBB.height;\n    var annWidth = options.width || textWidth;\n    var annHeight = options.height || textHeight;\n    var outerWidth = Math.round(annWidth + 2 * borderfull);\n    var outerHeight = Math.round(annHeight + 2 * borderfull);\n\n    function shiftFraction(v, anchor) {\n      if (anchor === 'auto') {\n        if (v < 1 / 3) anchor = 'left';else if (v > 2 / 3) anchor = 'right';else anchor = 'center';\n      }\n\n      return {\n        center: 0,\n        middle: 0,\n        left: 0.5,\n        bottom: -0.5,\n        right: -0.5,\n        top: 0.5\n      }[anchor];\n    }\n\n    var annotationIsOffscreen = false;\n    var letters = ['x', 'y'];\n\n    for (var i = 0; i < letters.length; i++) {\n      var axLetter = letters[i];\n      var axRef = options[axLetter + 'ref'] || axLetter;\n      var tailRef = options['a' + axLetter + 'ref'];\n      var ax = {\n        x: xa,\n        y: ya\n      }[axLetter];\n      var dimAngle = (textangle + (axLetter === 'x' ? 0 : -90)) * Math.PI / 180; // note that these two can be either positive or negative\n\n      var annSizeFromWidth = outerWidth * Math.cos(dimAngle);\n      var annSizeFromHeight = outerHeight * Math.sin(dimAngle); // but this one is the positive total size\n\n      var annSize = Math.abs(annSizeFromWidth) + Math.abs(annSizeFromHeight);\n      var anchor = options[axLetter + 'anchor'];\n      var overallShift = options[axLetter + 'shift'] * (axLetter === 'x' ? 1 : -1);\n      var posPx = annPosPx[axLetter];\n      var basePx;\n      var textPadShift;\n      var alignPosition;\n      var autoAlignFraction;\n      var textShift;\n      /*\n       * calculate the *primary* pixel position\n       * which is the arrowhead if there is one,\n       * otherwise the text anchor point\n       */\n\n      if (ax) {\n        // check if annotation is off screen, to bypass DOM manipulations\n        var posFraction = ax.r2fraction(options[axLetter]);\n\n        if (posFraction < 0 || posFraction > 1) {\n          if (tailRef === axRef) {\n            posFraction = ax.r2fraction(options['a' + axLetter]);\n\n            if (posFraction < 0 || posFraction > 1) {\n              annotationIsOffscreen = true;\n            }\n          } else {\n            annotationIsOffscreen = true;\n          }\n        }\n\n        basePx = ax._offset + ax.r2p(options[axLetter]);\n        autoAlignFraction = 0.5;\n      } else {\n        if (axLetter === 'x') {\n          alignPosition = options[axLetter];\n          basePx = gs.l + gs.w * alignPosition;\n        } else {\n          alignPosition = 1 - options[axLetter];\n          basePx = gs.t + gs.h * alignPosition;\n        }\n\n        autoAlignFraction = options.showarrow ? 0.5 : alignPosition;\n      } // now translate this into pixel positions of head, tail, and text\n      // as well as paddings for autorange\n\n\n      if (options.showarrow) {\n        posPx.head = basePx;\n        var arrowLength = options['a' + axLetter]; // with an arrow, the text rotates around the anchor point\n\n        textShift = annSizeFromWidth * shiftFraction(0.5, options.xanchor) - annSizeFromHeight * shiftFraction(0.5, options.yanchor);\n\n        if (tailRef === axRef) {\n          posPx.tail = ax._offset + ax.r2p(arrowLength); // tail is data-referenced: autorange pads the text in px from the tail\n\n          textPadShift = textShift;\n        } else {\n          posPx.tail = basePx + arrowLength; // tail is specified in px from head, so autorange also pads vs head\n\n          textPadShift = textShift + arrowLength;\n        }\n\n        posPx.text = posPx.tail + textShift; // constrain pixel/paper referenced so the draggers are at least\n        // partially visible\n\n        var maxPx = fullLayout[axLetter === 'x' ? 'width' : 'height'];\n\n        if (axRef === 'paper') {\n          posPx.head = Lib.constrain(posPx.head, 1, maxPx - 1);\n        }\n\n        if (tailRef === 'pixel') {\n          var shiftPlus = -Math.max(posPx.tail - 3, posPx.text);\n          var shiftMinus = Math.min(posPx.tail + 3, posPx.text) - maxPx;\n\n          if (shiftPlus > 0) {\n            posPx.tail += shiftPlus;\n            posPx.text += shiftPlus;\n          } else if (shiftMinus > 0) {\n            posPx.tail -= shiftMinus;\n            posPx.text -= shiftMinus;\n          }\n        }\n\n        posPx.tail += overallShift;\n        posPx.head += overallShift;\n      } else {\n        // with no arrow, the text rotates and *then* we put the anchor\n        // relative to the new bounding box\n        textShift = annSize * shiftFraction(autoAlignFraction, anchor);\n        textPadShift = textShift;\n        posPx.text = basePx + textShift;\n      }\n\n      posPx.text += overallShift;\n      textShift += overallShift;\n      textPadShift += overallShift; // padplus/minus are used by autorange\n\n      options['_' + axLetter + 'padplus'] = annSize / 2 + textPadShift;\n      options['_' + axLetter + 'padminus'] = annSize / 2 - textPadShift; // size/shift are used during dragging\n\n      options['_' + axLetter + 'size'] = annSize;\n      options['_' + axLetter + 'shift'] = textShift;\n    }\n\n    if (annotationIsOffscreen) {\n      annTextGroupInner.remove();\n      return;\n    }\n\n    var xShift = 0;\n    var yShift = 0;\n\n    if (options.align !== 'left') {\n      xShift = (annWidth - textWidth) * (options.align === 'center' ? 0.5 : 1);\n    }\n\n    if (options.valign !== 'top') {\n      yShift = (annHeight - textHeight) * (options.valign === 'middle' ? 0.5 : 1);\n    }\n\n    if (hasMathjax) {\n      mathjaxGroup.select('svg').attr({\n        x: borderfull + xShift - 1,\n        y: borderfull + yShift\n      }).call(Drawing.setClipUrl, isSizeConstrained ? annClipID : null, gd);\n    } else {\n      var texty = borderfull + yShift - anntextBB.top;\n      var textx = borderfull + xShift - anntextBB.left;\n      annText.call(svgTextUtils.positionText, textx, texty).call(Drawing.setClipUrl, isSizeConstrained ? annClipID : null, gd);\n    }\n\n    annTextClip.select('rect').call(Drawing.setRect, borderfull, borderfull, annWidth, annHeight);\n    annTextBG.call(Drawing.setRect, borderwidth / 2, borderwidth / 2, outerWidth - borderwidth, outerHeight - borderwidth);\n    annTextGroupInner.call(Drawing.setTranslate, Math.round(annPosPx.x.text - outerWidth / 2), Math.round(annPosPx.y.text - outerHeight / 2));\n    /*\n     * rotate text and background\n     * we already calculated the text center position *as rotated*\n     * because we needed that for autoranging anyway, so now whether\n     * we have an arrow or not, we rotate about the text center.\n     */\n\n    annTextGroup.attr({\n      transform: 'rotate(' + textangle + ',' + annPosPx.x.text + ',' + annPosPx.y.text + ')'\n    });\n    /*\n     * add the arrow\n     * uses options[arrowwidth,arrowcolor,arrowhead] for styling\n     * dx and dy are normally zero, but when you are dragging the textbox\n     * while the head stays put, dx and dy are the pixel offsets\n     */\n\n    var drawArrow = function drawArrow(dx, dy) {\n      annGroup.selectAll('.annotation-arrow-g').remove();\n      var headX = annPosPx.x.head;\n      var headY = annPosPx.y.head;\n      var tailX = annPosPx.x.tail + dx;\n      var tailY = annPosPx.y.tail + dy;\n      var textX = annPosPx.x.text + dx;\n      var textY = annPosPx.y.text + dy; // find the edge of the text box, where we'll start the arrow:\n      // create transform matrix to rotate the text box corners\n\n      var transform = Lib.rotationXYMatrix(textangle, textX, textY);\n      var applyTransform = Lib.apply2DTransform(transform);\n      var applyTransform2 = Lib.apply2DTransform2(transform); // calculate and transform bounding box\n\n      var width = +annTextBG.attr('width');\n      var height = +annTextBG.attr('height');\n      var xLeft = textX - 0.5 * width;\n      var xRight = xLeft + width;\n      var yTop = textY - 0.5 * height;\n      var yBottom = yTop + height;\n      var edges = [[xLeft, yTop, xLeft, yBottom], [xLeft, yBottom, xRight, yBottom], [xRight, yBottom, xRight, yTop], [xRight, yTop, xLeft, yTop]].map(applyTransform2); // Remove the line if it ends inside the box.  Use ray\n      // casting for rotated boxes: see which edges intersect a\n      // line from the arrowhead to far away and reduce with xor\n      // to get the parity of the number of intersections.\n\n      if (edges.reduce(function (a, x) {\n        return a ^ !!Lib.segmentsIntersect(headX, headY, headX + 1e6, headY + 1e6, x[0], x[1], x[2], x[3]);\n      }, false)) {\n        // no line or arrow - so quit drawArrow now\n        return;\n      }\n\n      edges.forEach(function (x) {\n        var p = Lib.segmentsIntersect(tailX, tailY, headX, headY, x[0], x[1], x[2], x[3]);\n\n        if (p) {\n          tailX = p.x;\n          tailY = p.y;\n        }\n      });\n      var strokewidth = options.arrowwidth;\n      var arrowColor = options.arrowcolor;\n      var arrowSide = options.arrowside;\n      var arrowGroup = annGroup.append('g').style({\n        opacity: Color.opacity(arrowColor)\n      }).classed('annotation-arrow-g', true);\n      var arrow = arrowGroup.append('path').attr('d', 'M' + tailX + ',' + tailY + 'L' + headX + ',' + headY).style('stroke-width', strokewidth + 'px').call(Color.stroke, Color.rgb(arrowColor));\n      drawArrowHead(arrow, arrowSide, options); // the arrow dragger is a small square right at the head, then a line to the tail,\n      // all expanded by a stroke width of 6px plus the arrow line width\n\n      if (edits.annotationPosition && arrow.node().parentNode && !subplotId) {\n        var arrowDragHeadX = headX;\n        var arrowDragHeadY = headY;\n\n        if (options.standoff) {\n          var arrowLength = Math.sqrt(Math.pow(headX - tailX, 2) + Math.pow(headY - tailY, 2));\n          arrowDragHeadX += options.standoff * (tailX - headX) / arrowLength;\n          arrowDragHeadY += options.standoff * (tailY - headY) / arrowLength;\n        }\n\n        var arrowDrag = arrowGroup.append('path').classed('annotation-arrow', true).classed('anndrag', true).classed('cursor-move', true).attr({\n          d: 'M3,3H-3V-3H3ZM0,0L' + (tailX - arrowDragHeadX) + ',' + (tailY - arrowDragHeadY),\n          transform: 'translate(' + arrowDragHeadX + ',' + arrowDragHeadY + ')'\n        }).style('stroke-width', strokewidth + 6 + 'px').call(Color.stroke, 'rgba(0,0,0,0)').call(Color.fill, 'rgba(0,0,0,0)');\n        var annx0, anny0; // dragger for the arrow & head: translates the whole thing\n        // (head/tail/text) all together\n\n        dragElement.init({\n          element: arrowDrag.node(),\n          gd: gd,\n          prepFn: function prepFn() {\n            var pos = Drawing.getTranslate(annTextGroupInner);\n            annx0 = pos.x;\n            anny0 = pos.y;\n\n            if (xa && xa.autorange) {\n              modifyBase(xa._name + '.autorange', true);\n            }\n\n            if (ya && ya.autorange) {\n              modifyBase(ya._name + '.autorange', true);\n            }\n          },\n          moveFn: function moveFn(dx, dy) {\n            var annxy0 = applyTransform(annx0, anny0);\n            var xcenter = annxy0[0] + dx;\n            var ycenter = annxy0[1] + dy;\n            annTextGroupInner.call(Drawing.setTranslate, xcenter, ycenter);\n            modifyItem('x', xa ? xa.p2r(xa.r2p(options.x) + dx) : options.x + dx / gs.w);\n            modifyItem('y', ya ? ya.p2r(ya.r2p(options.y) + dy) : options.y - dy / gs.h);\n\n            if (options.axref === options.xref) {\n              modifyItem('ax', xa.p2r(xa.r2p(options.ax) + dx));\n            }\n\n            if (options.ayref === options.yref) {\n              modifyItem('ay', ya.p2r(ya.r2p(options.ay) + dy));\n            }\n\n            arrowGroup.attr('transform', 'translate(' + dx + ',' + dy + ')');\n            annTextGroup.attr({\n              transform: 'rotate(' + textangle + ',' + xcenter + ',' + ycenter + ')'\n            });\n          },\n          doneFn: function doneFn() {\n            Registry.call('_guiRelayout', gd, getUpdateObj());\n            var notesBox = document.querySelector('.js-notes-box-panel');\n            if (notesBox) notesBox.redraw(notesBox.selectedObj);\n          }\n        });\n      }\n    };\n\n    if (options.showarrow) drawArrow(0, 0); // user dragging the annotation (text, not arrow)\n\n    if (editTextPosition) {\n      var baseTextTransform; // dragger for the textbox: if there's an arrow, just drag the\n      // textbox and tail, leave the head untouched\n\n      dragElement.init({\n        element: annTextGroupInner.node(),\n        gd: gd,\n        prepFn: function prepFn() {\n          baseTextTransform = annTextGroup.attr('transform');\n        },\n        moveFn: function moveFn(dx, dy) {\n          var csr = 'pointer';\n\n          if (options.showarrow) {\n            if (options.axref === options.xref) {\n              modifyItem('ax', xa.p2r(xa.r2p(options.ax) + dx));\n            } else {\n              modifyItem('ax', options.ax + dx);\n            }\n\n            if (options.ayref === options.yref) {\n              modifyItem('ay', ya.p2r(ya.r2p(options.ay) + dy));\n            } else {\n              modifyItem('ay', options.ay + dy);\n            }\n\n            drawArrow(dx, dy);\n          } else if (!subplotId) {\n            var xUpdate, yUpdate;\n\n            if (xa) {\n              xUpdate = xa.p2r(xa.r2p(options.x) + dx);\n            } else {\n              var widthFraction = options._xsize / gs.w;\n              var xLeft = options.x + (options._xshift - options.xshift) / gs.w - widthFraction / 2;\n              xUpdate = dragElement.align(xLeft + dx / gs.w, widthFraction, 0, 1, options.xanchor);\n            }\n\n            if (ya) {\n              yUpdate = ya.p2r(ya.r2p(options.y) + dy);\n            } else {\n              var heightFraction = options._ysize / gs.h;\n              var yBottom = options.y - (options._yshift + options.yshift) / gs.h - heightFraction / 2;\n              yUpdate = dragElement.align(yBottom - dy / gs.h, heightFraction, 0, 1, options.yanchor);\n            }\n\n            modifyItem('x', xUpdate);\n            modifyItem('y', yUpdate);\n\n            if (!xa || !ya) {\n              csr = dragElement.getCursor(xa ? 0.5 : xUpdate, ya ? 0.5 : yUpdate, options.xanchor, options.yanchor);\n            }\n          } else return;\n\n          annTextGroup.attr({\n            transform: 'translate(' + dx + ',' + dy + ')' + baseTextTransform\n          });\n          setCursor(annTextGroupInner, csr);\n        },\n        clickFn: function clickFn(_, initialEvent) {\n          if (options.captureevents) {\n            gd.emit('plotly_clickannotation', makeEventData(initialEvent));\n          }\n        },\n        doneFn: function doneFn() {\n          setCursor(annTextGroupInner);\n          Registry.call('_guiRelayout', gd, getUpdateObj());\n          var notesBox = document.querySelector('.js-notes-box-panel');\n          if (notesBox) notesBox.redraw(notesBox.selectedObj);\n        }\n      });\n    }\n  }\n\n  if (edits.annotationText) {\n    annText.call(svgTextUtils.makeEditable, {\n      delegate: annTextGroupInner,\n      gd: gd\n    }).call(textLayout).on('edit', function (_text) {\n      options.text = _text;\n      this.call(textLayout);\n      modifyItem('text', _text);\n\n      if (xa && xa.autorange) {\n        modifyBase(xa._name + '.autorange', true);\n      }\n\n      if (ya && ya.autorange) {\n        modifyBase(ya._name + '.autorange', true);\n      }\n\n      Registry.call('_guiRelayout', gd, getUpdateObj());\n    });\n  } else annText.call(textLayout);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar isPlainObject = Lib.isPlainObject;\n\nvar PlotSchema = require('./plot_schema');\n\nvar Plots = require('../plots/plots');\n\nvar plotAttributes = require('../plots/attributes');\n\nvar Template = require('./plot_template');\n\nvar dfltConfig = require('./plot_config').dfltConfig;\n/**\n * Plotly.makeTemplate: create a template off an existing figure to reuse\n * style attributes on other figures.\n *\n * Note: separated from the rest of templates because otherwise we get circular\n * references due to PlotSchema.\n *\n * @param {object|DOM element|string} figure: The figure to base the template on\n *     should contain a trace array `figure.data`\n *     and a layout object `figure.layout`\n * @returns {object} template: the extracted template - can then be used as\n *     `layout.template` in another figure.\n */\n\n\nexports.makeTemplate = function (figure) {\n  figure = Lib.isPlainObject(figure) ? figure : Lib.getGraphDiv(figure);\n  figure = Lib.extendDeep({\n    _context: dfltConfig\n  }, {\n    data: figure.data,\n    layout: figure.layout\n  });\n  Plots.supplyDefaults(figure);\n  var data = figure.data || [];\n  var layout = figure.layout || {}; // copy over a few items to help follow the schema\n\n  layout._basePlotModules = figure._fullLayout._basePlotModules;\n  layout._modules = figure._fullLayout._modules;\n  var template = {\n    data: {},\n    layout: {}\n  };\n  /*\n   * Note: we do NOT validate template values, we just take what's in the\n   * user inputs data and layout, not the validated values in fullData and\n   * fullLayout. Even if we were to validate here, there's no guarantee that\n   * these values would still be valid when applied to a new figure, which\n   * may contain different trace modes, different axes, etc. So it's\n   * important that when applying a template we still validate the template\n   * values, rather than just using them as defaults.\n   */\n\n  data.forEach(function (trace) {\n    // TODO: What if no style info is extracted for this trace. We may\n    // not want an empty object as the null value.\n    // TODO: allow transforms to contribute to templates?\n    // as it stands they are ignored, which may be for the best...\n    var traceTemplate = {};\n    walkStyleKeys(trace, traceTemplate, getTraceInfo.bind(null, trace));\n    var traceType = Lib.coerce(trace, {}, plotAttributes, 'type');\n    var typeTemplates = template.data[traceType];\n    if (!typeTemplates) typeTemplates = template.data[traceType] = [];\n    typeTemplates.push(traceTemplate);\n  });\n  walkStyleKeys(layout, template.layout, getLayoutInfo.bind(null, layout));\n  /*\n   * Compose the new template with an existing one to the same effect\n   *\n   * NOTE: there's a possibility of slightly different behavior: if the plot\n   * has an invalid value and the old template has a valid value for the same\n   * attribute, the plot will use the old template value but this routine\n   * will pull the invalid value (resulting in the original default).\n   * In the general case it's not possible to solve this with a single value,\n   * since valid options can be context-dependent. It could be solved with\n   * a *list* of values, but that would be huge complexity for little gain.\n   */\n\n  delete template.layout.template;\n  var oldTemplate = layout.template;\n\n  if (isPlainObject(oldTemplate)) {\n    var oldLayoutTemplate = oldTemplate.layout;\n    var i, traceType, oldTypeTemplates, oldTypeLen, typeTemplates, typeLen;\n\n    if (isPlainObject(oldLayoutTemplate)) {\n      mergeTemplates(oldLayoutTemplate, template.layout);\n    }\n\n    var oldDataTemplate = oldTemplate.data;\n\n    if (isPlainObject(oldDataTemplate)) {\n      for (traceType in template.data) {\n        oldTypeTemplates = oldDataTemplate[traceType];\n\n        if (Array.isArray(oldTypeTemplates)) {\n          typeTemplates = template.data[traceType];\n          typeLen = typeTemplates.length;\n          oldTypeLen = oldTypeTemplates.length;\n\n          for (i = 0; i < typeLen; i++) {\n            mergeTemplates(oldTypeTemplates[i % oldTypeLen], typeTemplates[i]);\n          }\n\n          for (i = typeLen; i < oldTypeLen; i++) {\n            typeTemplates.push(Lib.extendDeep({}, oldTypeTemplates[i]));\n          }\n        }\n      }\n\n      for (traceType in oldDataTemplate) {\n        if (!(traceType in template.data)) {\n          template.data[traceType] = Lib.extendDeep([], oldDataTemplate[traceType]);\n        }\n      }\n    }\n  }\n\n  return template;\n};\n\nfunction mergeTemplates(oldTemplate, newTemplate) {\n  // we don't care about speed here, just make sure we have a totally\n  // distinct object from the previous template\n  oldTemplate = Lib.extendDeep({}, oldTemplate); // sort keys so we always get annotationdefaults before annotations etc\n  // so arrayTemplater will work right\n\n  var oldKeys = Object.keys(oldTemplate).sort();\n  var i, j;\n\n  function mergeOne(oldVal, newVal, key) {\n    if (isPlainObject(newVal) && isPlainObject(oldVal)) {\n      mergeTemplates(oldVal, newVal);\n    } else if (Array.isArray(newVal) && Array.isArray(oldVal)) {\n      // Note: omitted `inclusionAttr` from arrayTemplater here,\n      // it's irrelevant as we only want the resulting `_template`.\n      var templater = Template.arrayTemplater({\n        _template: oldTemplate\n      }, key);\n\n      for (j = 0; j < newVal.length; j++) {\n        var item = newVal[j];\n\n        var oldItem = templater.newItem(item)._template;\n\n        if (oldItem) mergeTemplates(oldItem, item);\n      }\n\n      var defaultItems = templater.defaultItems();\n\n      for (j = 0; j < defaultItems.length; j++) {\n        newVal.push(defaultItems[j]._template);\n      } // templateitemname only applies to receiving plots\n\n\n      for (j = 0; j < newVal.length; j++) {\n        delete newVal[j].templateitemname;\n      }\n    }\n  }\n\n  for (i = 0; i < oldKeys.length; i++) {\n    var key = oldKeys[i];\n    var oldVal = oldTemplate[key];\n\n    if (key in newTemplate) {\n      mergeOne(oldVal, newTemplate[key], key);\n    } else newTemplate[key] = oldVal; // if this is a base key from the old template (eg xaxis), look for\n    // extended keys (eg xaxis2) in the new template to merge into\n\n\n    if (getBaseKey(key) === key) {\n      for (var key2 in newTemplate) {\n        var baseKey2 = getBaseKey(key2);\n\n        if (key2 !== baseKey2 && baseKey2 === key && !(key2 in oldTemplate)) {\n          mergeOne(oldVal, newTemplate[key2], key);\n        }\n      }\n    }\n  }\n}\n\nfunction getBaseKey(key) {\n  return key.replace(/[0-9]+$/, '');\n}\n\nfunction walkStyleKeys(parent, templateOut, getAttributeInfo, path, basePath) {\n  var pathAttr = basePath && getAttributeInfo(basePath);\n\n  for (var key in parent) {\n    var child = parent[key];\n    var nextPath = getNextPath(parent, key, path);\n    var nextBasePath = getNextPath(parent, key, basePath);\n    var attr = getAttributeInfo(nextBasePath);\n\n    if (!attr) {\n      var baseKey = getBaseKey(key);\n\n      if (baseKey !== key) {\n        nextBasePath = getNextPath(parent, baseKey, basePath);\n        attr = getAttributeInfo(nextBasePath);\n      }\n    } // we'll get an attr if path starts with a valid part, then has an\n    // invalid ending. Make sure we got all the way to the end.\n\n\n    if (pathAttr && pathAttr === attr) continue;\n\n    if (!attr || attr._noTemplating || attr.valType === 'data_array' || attr.arrayOk && Array.isArray(child)) {\n      continue;\n    }\n\n    if (!attr.valType && isPlainObject(child)) {\n      walkStyleKeys(child, templateOut, getAttributeInfo, nextPath, nextBasePath);\n    } else if (attr._isLinkedToArray && Array.isArray(child)) {\n      var dfltDone = false;\n      var namedIndex = 0;\n      var usedNames = {};\n\n      for (var i = 0; i < child.length; i++) {\n        var item = child[i];\n\n        if (isPlainObject(item)) {\n          var name = item.name;\n\n          if (name) {\n            if (!usedNames[name]) {\n              // named array items: allow all attributes except data arrays\n              walkStyleKeys(item, templateOut, getAttributeInfo, getNextPath(child, namedIndex, nextPath), getNextPath(child, namedIndex, nextBasePath));\n              namedIndex++;\n              usedNames[name] = 1;\n            }\n          } else if (!dfltDone) {\n            var dfltKey = Template.arrayDefaultKey(key);\n            var dfltPath = getNextPath(parent, dfltKey, path); // getAttributeInfo will fail if we try to use dfltKey directly.\n            // Instead put this item into the next array element, then\n            // pull it out and move it to dfltKey.\n\n            var pathInArray = getNextPath(child, namedIndex, nextPath);\n            walkStyleKeys(item, templateOut, getAttributeInfo, pathInArray, getNextPath(child, namedIndex, nextBasePath));\n            var itemPropInArray = Lib.nestedProperty(templateOut, pathInArray);\n            var dfltProp = Lib.nestedProperty(templateOut, dfltPath);\n            dfltProp.set(itemPropInArray.get());\n            itemPropInArray.set(null);\n            dfltDone = true;\n          }\n        }\n      }\n    } else {\n      var templateProp = Lib.nestedProperty(templateOut, nextPath);\n      templateProp.set(child);\n    }\n  }\n}\n\nfunction getLayoutInfo(layout, path) {\n  return PlotSchema.getLayoutValObject(layout, Lib.nestedProperty({}, path).parts);\n}\n\nfunction getTraceInfo(trace, path) {\n  return PlotSchema.getTraceValObject(trace, Lib.nestedProperty({}, path).parts);\n}\n\nfunction getNextPath(parent, key, path) {\n  var nextPath;\n  if (!path) nextPath = key;else if (Array.isArray(parent)) nextPath = path + '[' + key + ']';else nextPath = path + '.' + key;\n  return nextPath;\n}\n/**\n * validateTemplate: Test for consistency between the given figure and\n * a template, either already included in the figure or given separately.\n * Note that not every issue we identify here is necessarily a problem,\n * it depends on what you're using the template for.\n *\n * @param {object|DOM element} figure: the plot, with {data, layout} members,\n *     to test the template against\n * @param {Optional(object)} template: the template, with its own {data, layout},\n *     to test. If omitted, we will look for a template already attached as the\n *     plot's `layout.template` attribute.\n *\n * @returns {array} array of error objects each containing:\n *  - {string} code\n *      error code ('missing', 'unused', 'reused', 'noLayout', 'noData')\n *  - {string} msg\n *      a full readable description of the issue.\n */\n\n\nexports.validateTemplate = function (figureIn, template) {\n  var figure = Lib.extendDeep({}, {\n    _context: dfltConfig,\n    data: figureIn.data,\n    layout: figureIn.layout\n  });\n  var layout = figure.layout || {};\n  if (!isPlainObject(template)) template = layout.template || {};\n  var layoutTemplate = template.layout;\n  var dataTemplate = template.data;\n  var errorList = [];\n  figure.layout = layout;\n  figure.layout.template = template;\n  Plots.supplyDefaults(figure);\n  var fullLayout = figure._fullLayout;\n  var fullData = figure._fullData;\n  var layoutPaths = {};\n\n  function crawlLayoutForContainers(obj, paths) {\n    for (var key in obj) {\n      if (key.charAt(0) !== '_' && isPlainObject(obj[key])) {\n        var baseKey = getBaseKey(key);\n        var nextPaths = [];\n        var i;\n\n        for (i = 0; i < paths.length; i++) {\n          nextPaths.push(getNextPath(obj, key, paths[i]));\n          if (baseKey !== key) nextPaths.push(getNextPath(obj, baseKey, paths[i]));\n        }\n\n        for (i = 0; i < nextPaths.length; i++) {\n          layoutPaths[nextPaths[i]] = 1;\n        }\n\n        crawlLayoutForContainers(obj[key], nextPaths);\n      }\n    }\n  }\n\n  function crawlLayoutTemplateForContainers(obj, path) {\n    for (var key in obj) {\n      if (key.indexOf('defaults') === -1 && isPlainObject(obj[key])) {\n        var nextPath = getNextPath(obj, key, path);\n\n        if (layoutPaths[nextPath]) {\n          crawlLayoutTemplateForContainers(obj[key], nextPath);\n        } else {\n          errorList.push({\n            code: 'unused',\n            path: nextPath\n          });\n        }\n      }\n    }\n  }\n\n  if (!isPlainObject(layoutTemplate)) {\n    errorList.push({\n      code: 'layout'\n    });\n  } else {\n    crawlLayoutForContainers(fullLayout, ['layout']);\n    crawlLayoutTemplateForContainers(layoutTemplate, 'layout');\n  }\n\n  if (!isPlainObject(dataTemplate)) {\n    errorList.push({\n      code: 'data'\n    });\n  } else {\n    var typeCount = {};\n    var traceType;\n\n    for (var i = 0; i < fullData.length; i++) {\n      var fullTrace = fullData[i];\n      traceType = fullTrace.type;\n      typeCount[traceType] = (typeCount[traceType] || 0) + 1;\n\n      if (!fullTrace._fullInput._template) {\n        // this takes care of the case of traceType in the data but not\n        // the template\n        errorList.push({\n          code: 'missing',\n          index: fullTrace._fullInput.index,\n          traceType: traceType\n        });\n      }\n    }\n\n    for (traceType in dataTemplate) {\n      var templateCount = dataTemplate[traceType].length;\n      var dataCount = typeCount[traceType] || 0;\n\n      if (templateCount > dataCount) {\n        errorList.push({\n          code: 'unused',\n          traceType: traceType,\n          templateCount: templateCount,\n          dataCount: dataCount\n        });\n      } else if (dataCount > templateCount) {\n        errorList.push({\n          code: 'reused',\n          traceType: traceType,\n          templateCount: templateCount,\n          dataCount: dataCount\n        });\n      }\n    }\n  } // _template: false is when someone tried to modify an array item\n  // but there was no template with matching name\n\n\n  function crawlForMissingTemplates(obj, path) {\n    for (var key in obj) {\n      if (key.charAt(0) === '_') continue;\n      var val = obj[key];\n      var nextPath = getNextPath(obj, key, path);\n\n      if (isPlainObject(val)) {\n        if (Array.isArray(obj) && val._template === false && val.templateitemname) {\n          errorList.push({\n            code: 'missing',\n            path: nextPath,\n            templateitemname: val.templateitemname\n          });\n        }\n\n        crawlForMissingTemplates(val, nextPath);\n      } else if (Array.isArray(val) && hasPlainObject(val)) {\n        crawlForMissingTemplates(val, nextPath);\n      }\n    }\n  }\n\n  crawlForMissingTemplates({\n    data: fullData,\n    layout: fullLayout\n  }, '');\n  if (errorList.length) return errorList.map(format);\n};\n\nfunction hasPlainObject(arr) {\n  for (var i = 0; i < arr.length; i++) {\n    if (isPlainObject(arr[i])) return true;\n  }\n}\n\nfunction format(opts) {\n  var msg;\n\n  switch (opts.code) {\n    case 'data':\n      msg = 'The template has no key data.';\n      break;\n\n    case 'layout':\n      msg = 'The template has no key layout.';\n      break;\n\n    case 'missing':\n      if (opts.path) {\n        msg = 'There are no templates for item ' + opts.path + ' with name ' + opts.templateitemname;\n      } else {\n        msg = 'There are no templates for trace ' + opts.index + ', of type ' + opts.traceType + '.';\n      }\n\n      break;\n\n    case 'unused':\n      if (opts.path) {\n        msg = 'The template item at ' + opts.path + ' was not used in constructing the plot.';\n      } else if (opts.dataCount) {\n        msg = 'Some of the templates of type ' + opts.traceType + ' were not used. The template has ' + opts.templateCount + ' traces, the data only has ' + opts.dataCount + ' of this type.';\n      } else {\n        msg = 'The template has ' + opts.templateCount + ' traces of type ' + opts.traceType + ' but there are none in the data.';\n      }\n\n      break;\n\n    case 'reused':\n      msg = 'Some of the templates of type ' + opts.traceType + ' were used more than once. The template has ' + opts.templateCount + ' traces, the data has ' + opts.dataCount + ' of this type.';\n      break;\n  }\n\n  opts.msg = msg;\n  return opts;\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar drawModule = require('./draw');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'shapes',\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  supplyDrawNewShapeDefaults: require('./draw_newshape/defaults'),\n  includeBasePlot: require('../../plots/cartesian/include_components')('shapes'),\n  calcAutorange: require('./calc_autorange'),\n  draw: drawModule.draw,\n  drawOne: drawModule.drawOne\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n/**\n * Factory function for checking component arrays for subplot references.\n *\n * @param {string} containerArrayName: the top-level array in gd.layout to check\n *   If an item in this container is found that references a cartesian x and/or y axis,\n *   ensure cartesian is marked as a base plot module and record the axes (and subplot\n *   if both refs are axes) in gd._fullLayout\n *\n * @return {function}: with args layoutIn (gd.layout) and layoutOut (gd._fullLayout)\n * as expected of a component includeBasePlot method\n */\n\n\nmodule.exports = function makeIncludeComponents(containerArrayName) {\n  return function includeComponents(layoutIn, layoutOut) {\n    var array = layoutIn[containerArrayName];\n    if (!Array.isArray(array)) return;\n    var Cartesian = Registry.subplotsRegistry.cartesian;\n    var idRegex = Cartesian.idRegex;\n    var subplots = layoutOut._subplots;\n    var xaList = subplots.xaxis;\n    var yaList = subplots.yaxis;\n    var cartesianList = subplots.cartesian;\n\n    var hasCartesianOrGL2D = layoutOut._has('cartesian') || layoutOut._has('gl2d');\n\n    for (var i = 0; i < array.length; i++) {\n      var itemi = array[i];\n      if (!Lib.isPlainObject(itemi)) continue;\n      var xref = itemi.xref;\n      var yref = itemi.yref;\n      var hasXref = idRegex.x.test(xref);\n      var hasYref = idRegex.y.test(yref);\n\n      if (hasXref || hasYref) {\n        if (!hasCartesianOrGL2D) Lib.pushUnique(layoutOut._basePlotModules, Cartesian);\n        var newAxis = false;\n\n        if (hasXref && xaList.indexOf(xref) === -1) {\n          xaList.push(xref);\n          newAxis = true;\n        }\n\n        if (hasYref && yaList.indexOf(yref) === -1) {\n          yaList.push(yref);\n          newAxis = true;\n        }\n        /*\n         * Notice the logic here: only add a subplot for a component if\n         * it's referencing both x and y axes AND it's creating a new axis\n         * so for example if your plot already has xy and x2y2, an annotation\n         * on x2y or xy2 will not create a new subplot.\n         */\n\n\n        if (newAxis && hasXref && hasYref) {\n          cartesianList.push(xref + yref);\n        }\n      }\n    }\n  };\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Registry = require('../../registry');\n\nvar arrayEditor = require('../../plot_api/plot_template').arrayEditor;\n\nmodule.exports = {\n  hasClickToShow: hasClickToShow,\n  onClick: onClick\n};\n/*\n * hasClickToShow: does the given hoverData have ANY annotations which will\n * turn ON if we click here? (used by hover events to set cursor)\n *\n * gd: graphDiv\n * hoverData: a hoverData array, as included with the *plotly_hover* or\n *     *plotly_click* events in the `points` attribute\n *\n * returns: boolean\n */\n\nfunction hasClickToShow(gd, hoverData) {\n  var sets = getToggleSets(gd, hoverData);\n  return sets.on.length > 0 || sets.explicitOff.length > 0;\n}\n/*\n * onClick: perform the toggling (via Plotly.update) implied by clicking\n * at this hoverData\n *\n * gd: graphDiv\n * hoverData: a hoverData array, as included with the *plotly_hover* or\n *     *plotly_click* events in the `points` attribute\n *\n * returns: Promise that the update is complete\n */\n\n\nfunction onClick(gd, hoverData) {\n  var toggleSets = getToggleSets(gd, hoverData);\n  var onSet = toggleSets.on;\n  var offSet = toggleSets.off.concat(toggleSets.explicitOff);\n  var update = {};\n  var annotationsOut = gd._fullLayout.annotations;\n  var i, editHelpers;\n  if (!(onSet.length || offSet.length)) return;\n\n  for (i = 0; i < onSet.length; i++) {\n    editHelpers = arrayEditor(gd.layout, 'annotations', annotationsOut[onSet[i]]);\n    editHelpers.modifyItem('visible', true);\n    Lib.extendFlat(update, editHelpers.getUpdateObj());\n  }\n\n  for (i = 0; i < offSet.length; i++) {\n    editHelpers = arrayEditor(gd.layout, 'annotations', annotationsOut[offSet[i]]);\n    editHelpers.modifyItem('visible', false);\n    Lib.extendFlat(update, editHelpers.getUpdateObj());\n  }\n\n  return Registry.call('update', gd, {}, update);\n}\n/*\n * getToggleSets: find the annotations which will turn on or off at this\n * hoverData\n *\n * gd: graphDiv\n * hoverData: a hoverData array, as included with the *plotly_hover* or\n *     *plotly_click* events in the `points` attribute\n *\n * returns: {\n *   on: Array (indices of annotations to turn on),\n *   off: Array (indices to turn off because you're not hovering on them),\n *   explicitOff: Array (indices to turn off because you *are* hovering on them)\n * }\n */\n\n\nfunction getToggleSets(gd, hoverData) {\n  var annotations = gd._fullLayout.annotations;\n  var onSet = [];\n  var offSet = [];\n  var explicitOffSet = [];\n  var hoverLen = (hoverData || []).length;\n  var i, j, anni, showMode, pointj, xa, ya, toggleType;\n\n  for (i = 0; i < annotations.length; i++) {\n    anni = annotations[i];\n    showMode = anni.clicktoshow;\n\n    if (showMode) {\n      for (j = 0; j < hoverLen; j++) {\n        pointj = hoverData[j];\n        xa = pointj.xaxis;\n        ya = pointj.yaxis;\n\n        if (xa._id === anni.xref && ya._id === anni.yref && xa.d2r(pointj.x) === clickData2r(anni._xclick, xa) && ya.d2r(pointj.y) === clickData2r(anni._yclick, ya)) {\n          // match! toggle this annotation\n          // regardless of its clicktoshow mode\n          // but if it's onout mode, off is implicit\n          if (anni.visible) {\n            if (showMode === 'onout') toggleType = offSet;else toggleType = explicitOffSet;\n          } else {\n            toggleType = onSet;\n          }\n\n          toggleType.push(i);\n          break;\n        }\n      }\n\n      if (j === hoverLen) {\n        // no match - only turn this annotation OFF, and only if\n        // showmode is 'onout'\n        if (anni.visible && showMode === 'onout') offSet.push(i);\n      }\n    }\n  }\n\n  return {\n    on: onSet,\n    off: offSet,\n    explicitOff: explicitOffSet\n  };\n} // to handle log axes until v2\n\n\nfunction clickData2r(d, ax) {\n  return ax.type === 'log' ? ax.l2r(d) : ax.d2r(d);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar toLogRange = require('../../lib/to_log_range');\n/*\n * convertCoords: when converting an axis between log and linear\n * you need to alter any annotations on that axis to keep them\n * pointing at the same data point.\n * In v2.0 this will become obsolete\n *\n * gd: the plot div\n * ax: the axis being changed\n * newType: the type it's getting\n * doExtra: function(attr, val) from inside relayout that sets the attribute.\n *     Use this to make the changes as it's aware if any other changes in the\n *     same relayout call should override this conversion.\n */\n\n\nmodule.exports = function convertCoords(gd, ax, newType, doExtra) {\n  ax = ax || {};\n  var toLog = newType === 'log' && ax.type === 'linear';\n  var fromLog = newType === 'linear' && ax.type === 'log';\n  if (!(toLog || fromLog)) return;\n  var annotations = gd._fullLayout.annotations;\n\n  var axLetter = ax._id.charAt(0);\n\n  var ann;\n  var attrPrefix;\n\n  function convert(attr) {\n    var currentVal = ann[attr];\n    var newVal = null;\n    if (toLog) newVal = toLogRange(currentVal, ax.range);else newVal = Math.pow(10, currentVal); // if conversion failed, delete the value so it gets a default value\n\n    if (!isNumeric(newVal)) newVal = null;\n    doExtra(attrPrefix + attr, newVal);\n  }\n\n  for (var i = 0; i < annotations.length; i++) {\n    ann = annotations[i];\n    attrPrefix = 'annotations[' + i + '].';\n    if (ann[axLetter + 'ref'] === ax._id) convert(axLetter);\n    if (ann['a' + axLetter + 'ref'] === ax._id) convert('a' + axLetter);\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Color = require('../../components/color');\n\nvar isArrayOrTypedArray = require('../../lib').isArrayOrTypedArray;\n\nmodule.exports = function fillColorDefaults(traceIn, traceOut, defaultColor, coerce) {\n  var inheritColorFromMarker = false;\n\n  if (traceOut.marker) {\n    // don't try to inherit a color array\n    var markerColor = traceOut.marker.color;\n    var markerLineColor = (traceOut.marker.line || {}).color;\n\n    if (markerColor && !isArrayOrTypedArray(markerColor)) {\n      inheritColorFromMarker = markerColor;\n    } else if (markerLineColor && !isArrayOrTypedArray(markerLineColor)) {\n      inheritColorFromMarker = markerLineColor;\n    }\n  }\n\n  coerce('fillcolor', Color.addOpacity((traceOut.line || {}).color || inheritColorFromMarker || defaultColor, 0.5));\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Fx = require('../../components/fx');\n\nvar Registry = require('../../registry');\n\nvar getTraceColor = require('./get_trace_color');\n\nvar Color = require('../../components/color');\n\nvar fillText = Lib.fillText;\n\nmodule.exports = function hoverPoints(pointData, xval, yval, hovermode) {\n  var cd = pointData.cd;\n  var trace = cd[0].trace;\n  var xa = pointData.xa;\n  var ya = pointData.ya;\n  var xpx = xa.c2p(xval);\n  var ypx = ya.c2p(yval);\n  var pt = [xpx, ypx];\n  var hoveron = trace.hoveron || '';\n  var minRad = trace.mode.indexOf('markers') !== -1 ? 3 : 0.5; // look for points to hover on first, then take fills only if we\n  // didn't find a point\n\n  if (hoveron.indexOf('points') !== -1) {\n    var dx = function dx(di) {\n      // dx and dy are used in compare modes - here we want to always\n      // prioritize the closest data point, at least as long as markers are\n      // the same size or nonexistent, but still try to prioritize small markers too.\n      var rad = Math.max(3, di.mrc || 0);\n      var kink = 1 - 1 / rad;\n      var dxRaw = Math.abs(xa.c2p(di.x) - xpx);\n      var d = dxRaw < rad ? kink * dxRaw / rad : dxRaw - rad + kink;\n      return d;\n    };\n\n    var dy = function dy(di) {\n      var rad = Math.max(3, di.mrc || 0);\n      var kink = 1 - 1 / rad;\n      var dyRaw = Math.abs(ya.c2p(di.y) - ypx);\n      return dyRaw < rad ? kink * dyRaw / rad : dyRaw - rad + kink;\n    };\n\n    var dxy = function dxy(di) {\n      // scatter points: d.mrc is the calculated marker radius\n      // adjust the distance so if you're inside the marker it\n      // always will show up regardless of point size, but\n      // prioritize smaller points\n      var rad = Math.max(minRad, di.mrc || 0);\n      var dx = xa.c2p(di.x) - xpx;\n      var dy = ya.c2p(di.y) - ypx;\n      return Math.max(Math.sqrt(dx * dx + dy * dy) - rad, 1 - minRad / rad);\n    };\n\n    var distfn = Fx.getDistanceFunction(hovermode, dx, dy, dxy);\n    Fx.getClosest(cd, distfn, pointData); // skip the rest (for this trace) if we didn't find a close point\n\n    if (pointData.index !== false) {\n      // the closest data point\n      var di = cd[pointData.index];\n      var xc = xa.c2p(di.x, true);\n      var yc = ya.c2p(di.y, true);\n      var rad = di.mrc || 1; // now we're done using the whole `calcdata` array, replace the\n      // index with the original index (in case of inserted point from\n      // stacked area)\n\n      pointData.index = di.i;\n      var orientation = cd[0].t.orientation; // TODO: for scatter and bar, option to show (sub)totals and\n      // raw data? Currently stacked and/or normalized bars just show\n      // the normalized individual sizes, so that's what I'm doing here\n      // for now.\n\n      var sizeVal = orientation && (di.sNorm || di.s);\n      var xLabelVal = orientation === 'h' ? sizeVal : di.x;\n      var yLabelVal = orientation === 'v' ? sizeVal : di.y;\n      Lib.extendFlat(pointData, {\n        color: getTraceColor(trace, di),\n        x0: xc - rad,\n        x1: xc + rad,\n        xLabelVal: xLabelVal,\n        y0: yc - rad,\n        y1: yc + rad,\n        yLabelVal: yLabelVal,\n        spikeDistance: dxy(di),\n        hovertemplate: trace.hovertemplate\n      });\n      fillText(di, trace, pointData);\n      Registry.getComponentMethod('errorbars', 'hoverInfo')(di, trace, pointData);\n      return [pointData];\n    }\n  } // even if hoveron is 'fills', only use it if we have polygons too\n\n\n  if (hoveron.indexOf('fills') !== -1 && trace._polygons) {\n    var polygons = trace._polygons;\n    var polygonsIn = [];\n    var inside = false;\n    var xmin = Infinity;\n    var xmax = -Infinity;\n    var ymin = Infinity;\n    var ymax = -Infinity;\n    var i, j, polygon, pts, xCross, x0, x1, y0, y1;\n\n    for (i = 0; i < polygons.length; i++) {\n      polygon = polygons[i]; // TODO: this is not going to work right for curved edges, it will\n      // act as though they're straight. That's probably going to need\n      // the elements themselves to capture the events. Worth it?\n\n      if (polygon.contains(pt)) {\n        inside = !inside; // TODO: need better than just the overall bounding box\n\n        polygonsIn.push(polygon);\n        ymin = Math.min(ymin, polygon.ymin);\n        ymax = Math.max(ymax, polygon.ymax);\n      }\n    }\n\n    if (inside) {\n      // constrain ymin/max to the visible plot, so the label goes\n      // at the middle of the piece you can see\n      ymin = Math.max(ymin, 0);\n      ymax = Math.min(ymax, ya._length); // find the overall left-most and right-most points of the\n      // polygon(s) we're inside at their combined vertical midpoint.\n      // This is where we will draw the hover label.\n      // Note that this might not be the vertical midpoint of the\n      // whole trace, if it's disjoint.\n\n      var yAvg = (ymin + ymax) / 2;\n\n      for (i = 0; i < polygonsIn.length; i++) {\n        pts = polygonsIn[i].pts;\n\n        for (j = 1; j < pts.length; j++) {\n          y0 = pts[j - 1][1];\n          y1 = pts[j][1];\n\n          if (y0 > yAvg !== y1 >= yAvg) {\n            x0 = pts[j - 1][0];\n            x1 = pts[j][0];\n\n            if (y1 - y0) {\n              xCross = x0 + (x1 - x0) * (yAvg - y0) / (y1 - y0);\n              xmin = Math.min(xmin, xCross);\n              xmax = Math.max(xmax, xCross);\n            }\n          }\n        }\n      } // constrain xmin/max to the visible plot now too\n\n\n      xmin = Math.max(xmin, 0);\n      xmax = Math.min(xmax, xa._length); // get only fill or line color for the hover color\n\n      var color = Color.defaultLine;\n      if (Color.opacity(trace.fillcolor)) color = trace.fillcolor;else if (Color.opacity((trace.line || {}).color)) {\n        color = trace.line.color;\n      }\n      Lib.extendFlat(pointData, {\n        // never let a 2D override 1D type as closest point\n        // also: no spikeDistance, it's not allowed for fills\n        distance: pointData.maxHoverDistance,\n        x0: xmin,\n        x1: xmax,\n        y0: yAvg,\n        y1: yAvg,\n        color: color,\n        hovertemplate: false\n      });\n      delete pointData.index;\n\n      if (trace.text && !Array.isArray(trace.text)) {\n        pointData.text = String(trace.text);\n      } else pointData.text = trace.name;\n\n      return [pointData];\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\nvar d3 = require('d3');\n\nvar Lib = require('../../../lib');\n\nvar extendDeepAll = Lib.extendDeepAll;\n\nvar MID_SHIFT = require('../../../constants/alignment').MID_SHIFT;\n\nvar µ = module.exports = {\n  version: '0.2.2'\n};\n\nµ.Axis = function module() {\n  var config = {\n    data: [],\n    layout: {}\n  },\n      inputConfig = {},\n      liveConfig = {};\n  var svg,\n      container,\n      dispatch = d3.dispatch('hover'),\n      radialScale,\n      angularScale;\n  var exports = {};\n\n  function render(_container) {\n    container = _container || container;\n    var data = config.data;\n    var axisConfig = config.layout;\n    if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n    container.datum(data).each(function (_data, _index) {\n      var dataOriginal = _data.slice();\n\n      liveConfig = {\n        data: µ.util.cloneJson(dataOriginal),\n        layout: µ.util.cloneJson(axisConfig)\n      };\n      var colorIndex = 0;\n      dataOriginal.forEach(function (d, i) {\n        if (!d.color) {\n          d.color = axisConfig.defaultColorRange[colorIndex];\n          colorIndex = (colorIndex + 1) % axisConfig.defaultColorRange.length;\n        }\n\n        if (!d.strokeColor) {\n          d.strokeColor = d.geometry === 'LinePlot' ? d.color : d3.rgb(d.color).darker().toString();\n        }\n\n        liveConfig.data[i].color = d.color;\n        liveConfig.data[i].strokeColor = d.strokeColor;\n        liveConfig.data[i].strokeDash = d.strokeDash;\n        liveConfig.data[i].strokeSize = d.strokeSize;\n      });\n      var data = dataOriginal.filter(function (d, i) {\n        var visible = d.visible;\n        return typeof visible === 'undefined' || visible === true;\n      });\n      var isStacked = false;\n      var dataWithGroupId = data.map(function (d, i) {\n        isStacked = isStacked || typeof d.groupId !== 'undefined';\n        return d;\n      });\n\n      if (isStacked) {\n        var grouped = d3.nest().key(function (d, i) {\n          return typeof d.groupId != 'undefined' ? d.groupId : 'unstacked';\n        }).entries(dataWithGroupId);\n        var dataYStack = [];\n        var stacked = grouped.map(function (d, i) {\n          if (d.key === 'unstacked') return d.values;else {\n            var prevArray = d.values[0].r.map(function (d, i) {\n              return 0;\n            });\n            d.values.forEach(function (d, i, a) {\n              d.yStack = [prevArray];\n              dataYStack.push(prevArray);\n              prevArray = µ.util.sumArrays(d.r, prevArray);\n            });\n            return d.values;\n          }\n        });\n        data = d3.merge(stacked);\n      }\n\n      data.forEach(function (d, i) {\n        d.t = Array.isArray(d.t[0]) ? d.t : [d.t];\n        d.r = Array.isArray(d.r[0]) ? d.r : [d.r];\n      });\n      var radius = Math.min(axisConfig.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n      radius = Math.max(10, radius);\n      var chartCenter = [axisConfig.margin.left + radius, axisConfig.margin.top + radius];\n      var extent;\n\n      if (isStacked) {\n        var highestStackedValue = d3.max(µ.util.sumArrays(µ.util.arrayLast(data).r[0], µ.util.arrayLast(dataYStack)));\n        extent = [0, highestStackedValue];\n      } else extent = d3.extent(µ.util.flattenArray(data.map(function (d, i) {\n        return d.r;\n      })));\n\n      if (axisConfig.radialAxis.domain != µ.DATAEXTENT) extent[0] = 0;\n      radialScale = d3.scale.linear().domain(axisConfig.radialAxis.domain != µ.DATAEXTENT && axisConfig.radialAxis.domain ? axisConfig.radialAxis.domain : extent).range([0, radius]);\n      liveConfig.layout.radialAxis.domain = radialScale.domain();\n      var angularDataMerged = µ.util.flattenArray(data.map(function (d, i) {\n        return d.t;\n      }));\n      var isOrdinal = typeof angularDataMerged[0] === 'string';\n      var ticks;\n\n      if (isOrdinal) {\n        angularDataMerged = µ.util.deduplicate(angularDataMerged);\n        ticks = angularDataMerged.slice();\n        angularDataMerged = d3.range(angularDataMerged.length);\n        data = data.map(function (d, i) {\n          var result = d;\n          d.t = [angularDataMerged];\n          if (isStacked) result.yStack = d.yStack;\n          return result;\n        });\n      }\n\n      var hasOnlyLineOrDotPlot = data.filter(function (d, i) {\n        return d.geometry === 'LinePlot' || d.geometry === 'DotPlot';\n      }).length === data.length;\n      var needsEndSpacing = axisConfig.needsEndSpacing === null ? isOrdinal || !hasOnlyLineOrDotPlot : axisConfig.needsEndSpacing;\n      var useProvidedDomain = axisConfig.angularAxis.domain && axisConfig.angularAxis.domain != µ.DATAEXTENT && !isOrdinal && axisConfig.angularAxis.domain[0] >= 0;\n      var angularDomain = useProvidedDomain ? axisConfig.angularAxis.domain : d3.extent(angularDataMerged);\n      var angularDomainStep = Math.abs(angularDataMerged[1] - angularDataMerged[0]);\n      if (hasOnlyLineOrDotPlot && !isOrdinal) angularDomainStep = 0;\n      var angularDomainWithPadding = angularDomain.slice();\n      if (needsEndSpacing && isOrdinal) angularDomainWithPadding[1] += angularDomainStep;\n      var tickCount = axisConfig.angularAxis.ticksCount || 4;\n      if (tickCount > 8) tickCount = tickCount / (tickCount / 8) + tickCount % 8;\n\n      if (axisConfig.angularAxis.ticksStep) {\n        tickCount = (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / tickCount;\n      }\n\n      var angularTicksStep = axisConfig.angularAxis.ticksStep || (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / (tickCount * (axisConfig.minorTicks + 1));\n      if (ticks) angularTicksStep = Math.max(Math.round(angularTicksStep), 1);\n      if (!angularDomainWithPadding[2]) angularDomainWithPadding[2] = angularTicksStep;\n      var angularAxisRange = d3.range.apply(this, angularDomainWithPadding);\n      angularAxisRange = angularAxisRange.map(function (d, i) {\n        return parseFloat(d.toPrecision(12));\n      });\n      angularScale = d3.scale.linear().domain(angularDomainWithPadding.slice(0, 2)).range(axisConfig.direction === 'clockwise' ? [0, 360] : [360, 0]);\n      liveConfig.layout.angularAxis.domain = angularScale.domain();\n      liveConfig.layout.angularAxis.endPadding = needsEndSpacing ? angularDomainStep : 0;\n      svg = d3.select(this).select('svg.chart-root');\n\n      if (typeof svg === 'undefined' || svg.empty()) {\n        var skeleton = \"<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>\";\n        var doc = new DOMParser().parseFromString(skeleton, 'application/xml');\n        var newSvg = this.appendChild(this.ownerDocument.importNode(doc.documentElement, true));\n        svg = d3.select(newSvg);\n      }\n\n      svg.select('.guides-group').style({\n        'pointer-events': 'none'\n      });\n      svg.select('.angular.axis-group').style({\n        'pointer-events': 'none'\n      });\n      svg.select('.radial.axis-group').style({\n        'pointer-events': 'none'\n      });\n      var chartGroup = svg.select('.chart-group');\n      var lineStyle = {\n        fill: 'none',\n        stroke: axisConfig.tickColor\n      };\n      var fontStyle = {\n        'font-size': axisConfig.font.size,\n        'font-family': axisConfig.font.family,\n        fill: axisConfig.font.color,\n        'text-shadow': ['-1px 0px', '1px -1px', '-1px 1px', '1px 1px'].map(function (d, i) {\n          return ' ' + d + ' 0 ' + axisConfig.font.outlineColor;\n        }).join(',')\n      };\n      var legendContainer;\n\n      if (axisConfig.showLegend) {\n        legendContainer = svg.select('.legend-group').attr({\n          transform: 'translate(' + [radius, axisConfig.margin.top] + ')'\n        }).style({\n          display: 'block'\n        });\n        var elements = data.map(function (d, i) {\n          var datumClone = µ.util.cloneJson(d);\n          datumClone.symbol = d.geometry === 'DotPlot' ? d.dotType || 'circle' : d.geometry != 'LinePlot' ? 'square' : 'line';\n          datumClone.visibleInLegend = typeof d.visibleInLegend === 'undefined' || d.visibleInLegend;\n          datumClone.color = d.geometry === 'LinePlot' ? d.strokeColor : d.color;\n          return datumClone;\n        });\n        µ.Legend().config({\n          data: data.map(function (d, i) {\n            return d.name || 'Element' + i;\n          }),\n          legendConfig: extendDeepAll({}, µ.Legend.defaultConfig().legendConfig, {\n            container: legendContainer,\n            elements: elements,\n            reverseOrder: axisConfig.legend.reverseOrder\n          })\n        })();\n        var legendBBox = legendContainer.node().getBBox();\n        radius = Math.min(axisConfig.width - legendBBox.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n        radius = Math.max(10, radius);\n        chartCenter = [axisConfig.margin.left + radius, axisConfig.margin.top + radius];\n        radialScale.range([0, radius]);\n        liveConfig.layout.radialAxis.domain = radialScale.domain();\n        legendContainer.attr('transform', 'translate(' + [chartCenter[0] + radius, chartCenter[1] - radius] + ')');\n      } else {\n        legendContainer = svg.select('.legend-group').style({\n          display: 'none'\n        });\n      }\n\n      svg.attr({\n        width: axisConfig.width,\n        height: axisConfig.height\n      }).style({\n        opacity: axisConfig.opacity\n      });\n      chartGroup.attr('transform', 'translate(' + chartCenter + ')').style({\n        cursor: 'crosshair'\n      });\n      var centeringOffset = [(axisConfig.width - (axisConfig.margin.left + axisConfig.margin.right + radius * 2 + (legendBBox ? legendBBox.width : 0))) / 2, (axisConfig.height - (axisConfig.margin.top + axisConfig.margin.bottom + radius * 2)) / 2];\n      centeringOffset[0] = Math.max(0, centeringOffset[0]);\n      centeringOffset[1] = Math.max(0, centeringOffset[1]);\n      svg.select('.outer-group').attr('transform', 'translate(' + centeringOffset + ')');\n\n      if (axisConfig.title && axisConfig.title.text) {\n        var title = svg.select('g.title-group text').style(fontStyle).text(axisConfig.title.text);\n        var titleBBox = title.node().getBBox();\n        title.attr({\n          x: chartCenter[0] - titleBBox.width / 2,\n          y: chartCenter[1] - radius - 20\n        });\n      }\n\n      var radialAxis = svg.select('.radial.axis-group');\n\n      if (axisConfig.radialAxis.gridLinesVisible) {\n        var gridCircles = radialAxis.selectAll('circle.grid-circle').data(radialScale.ticks(5));\n        gridCircles.enter().append('circle').attr({\n          'class': 'grid-circle'\n        }).style(lineStyle);\n        gridCircles.attr('r', radialScale);\n        gridCircles.exit().remove();\n      }\n\n      radialAxis.select('circle.outside-circle').attr({\n        r: radius\n      }).style(lineStyle);\n      var backgroundCircle = svg.select('circle.background-circle').attr({\n        r: radius\n      }).style({\n        fill: axisConfig.backgroundColor,\n        stroke: axisConfig.stroke\n      });\n\n      function currentAngle(d, i) {\n        return angularScale(d) % 360 + axisConfig.orientation;\n      }\n\n      if (axisConfig.radialAxis.visible) {\n        var axis = d3.svg.axis().scale(radialScale).ticks(5).tickSize(5);\n        radialAxis.call(axis).attr({\n          transform: 'rotate(' + axisConfig.radialAxis.orientation + ')'\n        });\n        radialAxis.selectAll('.domain').style(lineStyle);\n        radialAxis.selectAll('g>text').text(function (d, i) {\n          return this.textContent + axisConfig.radialAxis.ticksSuffix;\n        }).style(fontStyle).style({\n          'text-anchor': 'start'\n        }).attr({\n          x: 0,\n          y: 0,\n          dx: 0,\n          dy: 0,\n          transform: function transform(d, i) {\n            if (axisConfig.radialAxis.tickOrientation === 'horizontal') {\n              return 'rotate(' + -axisConfig.radialAxis.orientation + ') translate(' + [0, fontStyle['font-size']] + ')';\n            } else return 'translate(' + [0, fontStyle['font-size']] + ')';\n          }\n        });\n        radialAxis.selectAll('g>line').style({\n          stroke: 'black'\n        });\n      }\n\n      var angularAxis = svg.select('.angular.axis-group').selectAll('g.angular-tick').data(angularAxisRange);\n      var angularAxisEnter = angularAxis.enter().append('g').classed('angular-tick', true);\n      angularAxis.attr({\n        transform: function transform(d, i) {\n          return 'rotate(' + currentAngle(d, i) + ')';\n        }\n      }).style({\n        display: axisConfig.angularAxis.visible ? 'block' : 'none'\n      });\n      angularAxis.exit().remove();\n      angularAxisEnter.append('line').classed('grid-line', true).classed('major', function (d, i) {\n        return i % (axisConfig.minorTicks + 1) == 0;\n      }).classed('minor', function (d, i) {\n        return !(i % (axisConfig.minorTicks + 1) == 0);\n      }).style(lineStyle);\n      angularAxisEnter.selectAll('.minor').style({\n        stroke: axisConfig.minorTickColor\n      });\n      angularAxis.select('line.grid-line').attr({\n        x1: axisConfig.tickLength ? radius - axisConfig.tickLength : 0,\n        x2: radius\n      }).style({\n        display: axisConfig.angularAxis.gridLinesVisible ? 'block' : 'none'\n      });\n      angularAxisEnter.append('text').classed('axis-text', true).style(fontStyle);\n      var ticksText = angularAxis.select('text.axis-text').attr({\n        x: radius + axisConfig.labelOffset,\n        dy: MID_SHIFT + 'em',\n        transform: function transform(d, i) {\n          var angle = currentAngle(d, i);\n          var rad = radius + axisConfig.labelOffset;\n          var orient = axisConfig.angularAxis.tickOrientation;\n          if (orient == 'horizontal') return 'rotate(' + -angle + ' ' + rad + ' 0)';else if (orient == 'radial') return angle < 270 && angle > 90 ? 'rotate(180 ' + rad + ' 0)' : null;else return 'rotate(' + (angle <= 180 && angle > 0 ? -90 : 90) + ' ' + rad + ' 0)';\n        }\n      }).style({\n        'text-anchor': 'middle',\n        display: axisConfig.angularAxis.labelsVisible ? 'block' : 'none'\n      }).text(function (d, i) {\n        if (i % (axisConfig.minorTicks + 1) != 0) return '';\n\n        if (ticks) {\n          return ticks[d] + axisConfig.angularAxis.ticksSuffix;\n        } else return d + axisConfig.angularAxis.ticksSuffix;\n      }).style(fontStyle);\n      if (axisConfig.angularAxis.rewriteTicks) ticksText.text(function (d, i) {\n        if (i % (axisConfig.minorTicks + 1) != 0) return '';\n        return axisConfig.angularAxis.rewriteTicks(this.textContent, i);\n      });\n      var rightmostTickEndX = d3.max(chartGroup.selectAll('.angular-tick text')[0].map(function (d, i) {\n        return d.getCTM().e + d.getBBox().width;\n      }));\n      legendContainer.attr({\n        transform: 'translate(' + [radius + rightmostTickEndX, axisConfig.margin.top] + ')'\n      });\n      var hasGeometry = svg.select('g.geometry-group').selectAll('g').size() > 0;\n      var geometryContainer = svg.select('g.geometry-group').selectAll('g.geometry').data(data);\n      geometryContainer.enter().append('g').attr({\n        'class': function _class(d, i) {\n          return 'geometry geometry' + i;\n        }\n      });\n      geometryContainer.exit().remove();\n\n      if (data[0] || hasGeometry) {\n        var geometryConfigs = [];\n        data.forEach(function (d, i) {\n          var geometryConfig = {};\n          geometryConfig.radialScale = radialScale;\n          geometryConfig.angularScale = angularScale;\n          geometryConfig.container = geometryContainer.filter(function (dB, iB) {\n            return iB == i;\n          });\n          geometryConfig.geometry = d.geometry;\n          geometryConfig.orientation = axisConfig.orientation;\n          geometryConfig.direction = axisConfig.direction;\n          geometryConfig.index = i;\n          geometryConfigs.push({\n            data: d,\n            geometryConfig: geometryConfig\n          });\n        });\n        var geometryConfigsGrouped = d3.nest().key(function (d, i) {\n          return typeof d.data.groupId != 'undefined' || 'unstacked';\n        }).entries(geometryConfigs);\n        var geometryConfigsGrouped2 = [];\n        geometryConfigsGrouped.forEach(function (d, i) {\n          if (d.key === 'unstacked') geometryConfigsGrouped2 = geometryConfigsGrouped2.concat(d.values.map(function (d, i) {\n            return [d];\n          }));else geometryConfigsGrouped2.push(d.values);\n        });\n        geometryConfigsGrouped2.forEach(function (d, i) {\n          var geometry;\n          if (Array.isArray(d)) geometry = d[0].geometryConfig.geometry;else geometry = d.geometryConfig.geometry;\n          var finalGeometryConfig = d.map(function (dB, iB) {\n            return extendDeepAll(µ[geometry].defaultConfig(), dB);\n          });\n          µ[geometry]().config(finalGeometryConfig)();\n        });\n      }\n\n      var guides = svg.select('.guides-group');\n      var tooltipContainer = svg.select('.tooltips-group');\n      var angularTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        fontSize: 8\n      })();\n      var radialTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        fontSize: 8\n      })();\n      var geometryTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        hasTick: true\n      })();\n      var angularValue, radialValue;\n\n      if (!isOrdinal) {\n        var angularGuideLine = guides.select('line').attr({\n          x1: 0,\n          y1: 0,\n          y2: 0\n        }).style({\n          stroke: 'grey',\n          'pointer-events': 'none'\n        });\n        chartGroup.on('mousemove.angular-guide', function (d, i) {\n          var mouseAngle = µ.util.getMousePos(backgroundCircle).angle;\n          angularGuideLine.attr({\n            x2: -radius,\n            transform: 'rotate(' + mouseAngle + ')'\n          }).style({\n            opacity: .5\n          });\n          var angleWithOriginOffset = (mouseAngle + 180 + 360 - axisConfig.orientation) % 360;\n          angularValue = angularScale.invert(angleWithOriginOffset);\n          var pos = µ.util.convertToCartesian(radius + 12, mouseAngle + 180);\n          angularTooltip.text(µ.util.round(angularValue)).move([pos[0] + chartCenter[0], pos[1] + chartCenter[1]]);\n        }).on('mouseout.angular-guide', function (d, i) {\n          guides.select('line').style({\n            opacity: 0\n          });\n        });\n      }\n\n      var angularGuideCircle = guides.select('circle').style({\n        stroke: 'grey',\n        fill: 'none'\n      });\n      chartGroup.on('mousemove.radial-guide', function (d, i) {\n        var r = µ.util.getMousePos(backgroundCircle).radius;\n        angularGuideCircle.attr({\n          r: r\n        }).style({\n          opacity: .5\n        });\n        radialValue = radialScale.invert(µ.util.getMousePos(backgroundCircle).radius);\n        var pos = µ.util.convertToCartesian(r, axisConfig.radialAxis.orientation);\n        radialTooltip.text(µ.util.round(radialValue)).move([pos[0] + chartCenter[0], pos[1] + chartCenter[1]]);\n      }).on('mouseout.radial-guide', function (d, i) {\n        angularGuideCircle.style({\n          opacity: 0\n        });\n        geometryTooltip.hide();\n        angularTooltip.hide();\n        radialTooltip.hide();\n      });\n      svg.selectAll('.geometry-group .mark').on('mouseover.tooltip', function (d, i) {\n        var el = d3.select(this);\n        var color = this.style.fill;\n        var newColor = 'black';\n        var opacity = this.style.opacity || 1;\n        el.attr({\n          'data-opacity': opacity\n        });\n\n        if (color && color !== 'none') {\n          el.attr({\n            'data-fill': color\n          });\n          newColor = d3.hsl(color).darker().toString();\n          el.style({\n            fill: newColor,\n            opacity: 1\n          });\n          var textData = {\n            t: µ.util.round(d[0]),\n            r: µ.util.round(d[1])\n          };\n          if (isOrdinal) textData.t = ticks[d[0]];\n          var text = 't: ' + textData.t + ', r: ' + textData.r;\n          var bbox = this.getBoundingClientRect();\n          var svgBBox = svg.node().getBoundingClientRect();\n          var pos = [bbox.left + bbox.width / 2 - centeringOffset[0] - svgBBox.left, bbox.top + bbox.height / 2 - centeringOffset[1] - svgBBox.top];\n          geometryTooltip.config({\n            color: newColor\n          }).text(text);\n          geometryTooltip.move(pos);\n        } else {\n          color = this.style.stroke || 'black';\n          el.attr({\n            'data-stroke': color\n          });\n          newColor = d3.hsl(color).darker().toString();\n          el.style({\n            stroke: newColor,\n            opacity: 1\n          });\n        }\n      }).on('mousemove.tooltip', function (d, i) {\n        if (d3.event.which != 0) return false;\n        if (d3.select(this).attr('data-fill')) geometryTooltip.show();\n      }).on('mouseout.tooltip', function (d, i) {\n        geometryTooltip.hide();\n        var el = d3.select(this);\n        var fillColor = el.attr('data-fill');\n        if (fillColor) el.style({\n          fill: fillColor,\n          opacity: el.attr('data-opacity')\n        });else el.style({\n          stroke: el.attr('data-stroke'),\n          opacity: el.attr('data-opacity')\n        });\n      });\n    });\n    return exports;\n  }\n\n  exports.render = function (_container) {\n    render(_container);\n    return this;\n  };\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n    var xClone = µ.util.cloneJson(_x);\n    xClone.data.forEach(function (d, i) {\n      if (!config.data[i]) config.data[i] = {};\n      extendDeepAll(config.data[i], µ.Axis.defaultConfig().data[0]);\n      extendDeepAll(config.data[i], d);\n    });\n    extendDeepAll(config.layout, µ.Axis.defaultConfig().layout);\n    extendDeepAll(config.layout, xClone.layout);\n    return this;\n  };\n\n  exports.getLiveConfig = function () {\n    return liveConfig;\n  };\n\n  exports.getinputConfig = function () {\n    return inputConfig;\n  };\n\n  exports.radialScale = function (_x) {\n    return radialScale;\n  };\n\n  exports.angularScale = function (_x) {\n    return angularScale;\n  };\n\n  exports.svg = function () {\n    return svg;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.Axis.defaultConfig = function (d, i) {\n  var config = {\n    data: [{\n      t: [1, 2, 3, 4],\n      r: [10, 11, 12, 13],\n      name: 'Line1',\n      geometry: 'LinePlot',\n      color: null,\n      strokeDash: 'solid',\n      strokeColor: null,\n      strokeSize: '1',\n      visibleInLegend: true,\n      opacity: 1\n    }],\n    layout: {\n      defaultColorRange: d3.scale.category10().range(),\n      title: null,\n      height: 450,\n      width: 500,\n      margin: {\n        top: 40,\n        right: 40,\n        bottom: 40,\n        left: 40\n      },\n      font: {\n        size: 12,\n        color: 'gray',\n        outlineColor: 'white',\n        family: 'Tahoma, sans-serif'\n      },\n      direction: 'clockwise',\n      orientation: 0,\n      labelOffset: 10,\n      radialAxis: {\n        domain: null,\n        orientation: -45,\n        ticksSuffix: '',\n        visible: true,\n        gridLinesVisible: true,\n        tickOrientation: 'horizontal',\n        rewriteTicks: null\n      },\n      angularAxis: {\n        domain: [0, 360],\n        ticksSuffix: '',\n        visible: true,\n        gridLinesVisible: true,\n        labelsVisible: true,\n        tickOrientation: 'horizontal',\n        rewriteTicks: null,\n        ticksCount: null,\n        ticksStep: null\n      },\n      minorTicks: 0,\n      tickLength: null,\n      tickColor: 'silver',\n      minorTickColor: '#eee',\n      backgroundColor: 'none',\n      needsEndSpacing: null,\n      showLegend: true,\n      legend: {\n        reverseOrder: false\n      },\n      opacity: 1\n    }\n  };\n  return config;\n};\n\nµ.util = {};\nµ.DATAEXTENT = 'dataExtent';\nµ.AREA = 'AreaChart';\nµ.LINE = 'LinePlot';\nµ.DOT = 'DotPlot';\nµ.BAR = 'BarChart';\n\nµ.util._override = function (_objA, _objB) {\n  for (var x in _objA) {\n    if (x in _objB) _objB[x] = _objA[x];\n  }\n};\n\nµ.util._extend = function (_objA, _objB) {\n  for (var x in _objA) {\n    _objB[x] = _objA[x];\n  }\n};\n\nµ.util._rndSnd = function () {\n  return Math.random() * 2 - 1 + (Math.random() * 2 - 1) + (Math.random() * 2 - 1);\n};\n\nµ.util.dataFromEquation2 = function (_equation, _step) {\n  var step = _step || 6;\n  var data = d3.range(0, 360 + step, step).map(function (deg, index) {\n    var theta = deg * Math.PI / 180;\n\n    var radius = _equation(theta);\n\n    return [deg, radius];\n  });\n  return data;\n};\n\nµ.util.dataFromEquation = function (_equation, _step, _name) {\n  var step = _step || 6;\n  var t = [],\n      r = [];\n  d3.range(0, 360 + step, step).forEach(function (deg, index) {\n    var theta = deg * Math.PI / 180;\n\n    var radius = _equation(theta);\n\n    t.push(deg);\n    r.push(radius);\n  });\n  var result = {\n    t: t,\n    r: r\n  };\n  if (_name) result.name = _name;\n  return result;\n};\n\nµ.util.ensureArray = function (_val, _count) {\n  if (typeof _val === 'undefined') return null;\n  var arr = [].concat(_val);\n  return d3.range(_count).map(function (d, i) {\n    return arr[i] || arr[0];\n  });\n};\n\nµ.util.fillArrays = function (_obj, _valueNames, _count) {\n  _valueNames.forEach(function (d, i) {\n    _obj[d] = µ.util.ensureArray(_obj[d], _count);\n  });\n\n  return _obj;\n};\n\nµ.util.cloneJson = function (json) {\n  return JSON.parse(JSON.stringify(json));\n};\n\nµ.util.validateKeys = function (obj, keys) {\n  if (typeof keys === 'string') keys = keys.split('.');\n  var next = keys.shift();\n  return obj[next] && (!keys.length || objHasKeys(obj[next], keys));\n};\n\nµ.util.sumArrays = function (a, b) {\n  return d3.zip(a, b).map(function (d, i) {\n    return d3.sum(d);\n  });\n};\n\nµ.util.arrayLast = function (a) {\n  return a[a.length - 1];\n};\n\nµ.util.arrayEqual = function (a, b) {\n  var i = Math.max(a.length, b.length, 1);\n\n  while (i-- >= 0 && a[i] === b[i]) {\n    ;\n  }\n\n  return i === -2;\n};\n\nµ.util.flattenArray = function (arr) {\n  var r = [];\n\n  while (!µ.util.arrayEqual(r, arr)) {\n    r = arr;\n    arr = [].concat.apply([], arr);\n  }\n\n  return arr;\n};\n\nµ.util.deduplicate = function (arr) {\n  return arr.filter(function (v, i, a) {\n    return a.indexOf(v) == i;\n  });\n};\n\nµ.util.convertToCartesian = function (radius, theta) {\n  var thetaRadians = theta * Math.PI / 180;\n  var x = radius * Math.cos(thetaRadians);\n  var y = radius * Math.sin(thetaRadians);\n  return [x, y];\n};\n\nµ.util.round = function (_value, _digits) {\n  var digits = _digits || 2;\n  var mult = Math.pow(10, digits);\n  return Math.round(_value * mult) / mult;\n};\n\nµ.util.getMousePos = function (_referenceElement) {\n  var mousePos = d3.mouse(_referenceElement.node());\n  var mouseX = mousePos[0];\n  var mouseY = mousePos[1];\n  var mouse = {};\n  mouse.x = mouseX;\n  mouse.y = mouseY;\n  mouse.pos = mousePos;\n  mouse.angle = (Math.atan2(mouseY, mouseX) + Math.PI) * 180 / Math.PI;\n  mouse.radius = Math.sqrt(mouseX * mouseX + mouseY * mouseY);\n  return mouse;\n};\n\nµ.util.duplicatesCount = function (arr) {\n  var uniques = {},\n      val;\n  var dups = {};\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    val = arr[i];\n\n    if (val in uniques) {\n      uniques[val]++;\n      dups[val] = uniques[val];\n    } else {\n      uniques[val] = 1;\n    }\n  }\n\n  return dups;\n};\n\nµ.util.duplicates = function (arr) {\n  return Object.keys(µ.util.duplicatesCount(arr));\n};\n\nµ.util.translator = function (obj, sourceBranch, targetBranch, reverse) {\n  if (reverse) {\n    var targetBranchCopy = targetBranch.slice();\n    targetBranch = sourceBranch;\n    sourceBranch = targetBranchCopy;\n  }\n\n  var value = sourceBranch.reduce(function (previousValue, currentValue) {\n    if (typeof previousValue != 'undefined') return previousValue[currentValue];\n  }, obj);\n  if (typeof value === 'undefined') return;\n  sourceBranch.reduce(function (previousValue, currentValue, index) {\n    if (typeof previousValue == 'undefined') return;\n    if (index === sourceBranch.length - 1) delete previousValue[currentValue];\n    return previousValue[currentValue];\n  }, obj);\n  targetBranch.reduce(function (previousValue, currentValue, index) {\n    if (typeof previousValue[currentValue] === 'undefined') previousValue[currentValue] = {};\n    if (index === targetBranch.length - 1) previousValue[currentValue] = value;\n    return previousValue[currentValue];\n  }, obj);\n};\n\nµ.PolyChart = function module() {\n  var config = [µ.PolyChart.defaultConfig()];\n  var dispatch = d3.dispatch('hover');\n  var dashArray = {\n    solid: 'none',\n    dash: [5, 2],\n    dot: [2, 5]\n  };\n  var colorScale;\n\n  function exports() {\n    var geometryConfig = config[0].geometryConfig;\n    var container = geometryConfig.container;\n    if (typeof container == 'string') container = d3.select(container);\n    container.datum(config).each(function (_config, _index) {\n      var isStack = !!_config[0].data.yStack;\n\n      var data = _config.map(function (d, i) {\n        if (isStack) return d3.zip(d.data.t[0], d.data.r[0], d.data.yStack[0]);else return d3.zip(d.data.t[0], d.data.r[0]);\n      });\n\n      var angularScale = geometryConfig.angularScale;\n      var domainMin = geometryConfig.radialScale.domain()[0];\n      var generator = {};\n\n      generator.bar = function (d, i, pI) {\n        var dataConfig = _config[pI].data;\n        var h = geometryConfig.radialScale(d[1]) - geometryConfig.radialScale(0);\n        var stackTop = geometryConfig.radialScale(d[2] || 0);\n        var w = dataConfig.barWidth;\n        d3.select(this).attr({\n          'class': 'mark bar',\n          d: 'M' + [[h + stackTop, -w / 2], [h + stackTop, w / 2], [stackTop, w / 2], [stackTop, -w / 2]].join('L') + 'Z',\n          transform: function transform(d, i) {\n            return 'rotate(' + (geometryConfig.orientation + angularScale(d[0])) + ')';\n          }\n        });\n      };\n\n      generator.dot = function (d, i, pI) {\n        var stackedData = d[2] ? [d[0], d[1] + d[2]] : d;\n        var symbol = d3.svg.symbol().size(_config[pI].data.dotSize).type(_config[pI].data.dotType)(d, i);\n        d3.select(this).attr({\n          'class': 'mark dot',\n          d: symbol,\n          transform: function transform(d, i) {\n            var coord = convertToCartesian(getPolarCoordinates(stackedData));\n            return 'translate(' + [coord.x, coord.y] + ')';\n          }\n        });\n      };\n\n      var line = d3.svg.line.radial().interpolate(_config[0].data.lineInterpolation).radius(function (d) {\n        return geometryConfig.radialScale(d[1]);\n      }).angle(function (d) {\n        return geometryConfig.angularScale(d[0]) * Math.PI / 180;\n      });\n\n      generator.line = function (d, i, pI) {\n        var lineData = d[2] ? data[pI].map(function (d, i) {\n          return [d[0], d[1] + d[2]];\n        }) : data[pI];\n        d3.select(this).each(generator['dot']).style({\n          opacity: function opacity(dB, iB) {\n            return +_config[pI].data.dotVisible;\n          },\n          fill: markStyle.stroke(d, i, pI)\n        }).attr({\n          'class': 'mark dot'\n        });\n        if (i > 0) return;\n        var lineSelection = d3.select(this.parentNode).selectAll('path.line').data([0]);\n        lineSelection.enter().insert('path');\n        lineSelection.attr({\n          'class': 'line',\n          d: line(lineData),\n          transform: function transform(dB, iB) {\n            return 'rotate(' + (geometryConfig.orientation + 90) + ')';\n          },\n          'pointer-events': 'none'\n        }).style({\n          fill: function fill(dB, iB) {\n            return markStyle.fill(d, i, pI);\n          },\n          'fill-opacity': 0,\n          stroke: function stroke(dB, iB) {\n            return markStyle.stroke(d, i, pI);\n          },\n          'stroke-width': function strokeWidth(dB, iB) {\n            return markStyle['stroke-width'](d, i, pI);\n          },\n          'stroke-dasharray': function strokeDasharray(dB, iB) {\n            return markStyle['stroke-dasharray'](d, i, pI);\n          },\n          opacity: function opacity(dB, iB) {\n            return markStyle.opacity(d, i, pI);\n          },\n          display: function display(dB, iB) {\n            return markStyle.display(d, i, pI);\n          }\n        });\n      };\n\n      var angularRange = geometryConfig.angularScale.range();\n      var triangleAngle = Math.abs(angularRange[1] - angularRange[0]) / data[0].length * Math.PI / 180;\n      var arc = d3.svg.arc().startAngle(function (d) {\n        return -triangleAngle / 2;\n      }).endAngle(function (d) {\n        return triangleAngle / 2;\n      }).innerRadius(function (d) {\n        return geometryConfig.radialScale(domainMin + (d[2] || 0));\n      }).outerRadius(function (d) {\n        return geometryConfig.radialScale(domainMin + (d[2] || 0)) + geometryConfig.radialScale(d[1]);\n      });\n\n      generator.arc = function (d, i, pI) {\n        d3.select(this).attr({\n          'class': 'mark arc',\n          d: arc,\n          transform: function transform(d, i) {\n            return 'rotate(' + (geometryConfig.orientation + angularScale(d[0]) + 90) + ')';\n          }\n        });\n      };\n\n      var markStyle = {\n        fill: function fill(d, i, pI) {\n          return _config[pI].data.color;\n        },\n        stroke: function stroke(d, i, pI) {\n          return _config[pI].data.strokeColor;\n        },\n        'stroke-width': function strokeWidth(d, i, pI) {\n          return _config[pI].data.strokeSize + 'px';\n        },\n        'stroke-dasharray': function strokeDasharray(d, i, pI) {\n          return dashArray[_config[pI].data.strokeDash];\n        },\n        opacity: function opacity(d, i, pI) {\n          return _config[pI].data.opacity;\n        },\n        display: function display(d, i, pI) {\n          return typeof _config[pI].data.visible === 'undefined' || _config[pI].data.visible ? 'block' : 'none';\n        }\n      };\n      var geometryLayer = d3.select(this).selectAll('g.layer').data(data);\n      geometryLayer.enter().append('g').attr({\n        'class': 'layer'\n      });\n      var geometry = geometryLayer.selectAll('path.mark').data(function (d, i) {\n        return d;\n      });\n      geometry.enter().append('path').attr({\n        'class': 'mark'\n      });\n      geometry.style(markStyle).each(generator[geometryConfig.geometryType]);\n      geometry.exit().remove();\n      geometryLayer.exit().remove();\n\n      function getPolarCoordinates(d, i) {\n        var r = geometryConfig.radialScale(d[1]);\n        var t = (geometryConfig.angularScale(d[0]) + geometryConfig.orientation) * Math.PI / 180;\n        return {\n          r: r,\n          t: t\n        };\n      }\n\n      function convertToCartesian(polarCoordinates) {\n        var x = polarCoordinates.r * Math.cos(polarCoordinates.t);\n        var y = polarCoordinates.r * Math.sin(polarCoordinates.t);\n        return {\n          x: x,\n          y: y\n        };\n      }\n    });\n  }\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n\n    _x.forEach(function (d, i) {\n      if (!config[i]) config[i] = {};\n      extendDeepAll(config[i], µ.PolyChart.defaultConfig());\n      extendDeepAll(config[i], d);\n    });\n\n    return this;\n  };\n\n  exports.getColorScale = function () {\n    return colorScale;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.PolyChart.defaultConfig = function () {\n  var config = {\n    data: {\n      name: 'geom1',\n      t: [[1, 2, 3, 4]],\n      r: [[1, 2, 3, 4]],\n      dotType: 'circle',\n      dotSize: 64,\n      dotVisible: false,\n      barWidth: 20,\n      color: '#ffa500',\n      strokeSize: 1,\n      strokeColor: 'silver',\n      strokeDash: 'solid',\n      opacity: 1,\n      index: 0,\n      visible: true,\n      visibleInLegend: true\n    },\n    geometryConfig: {\n      geometry: 'LinePlot',\n      geometryType: 'arc',\n      direction: 'clockwise',\n      orientation: 0,\n      container: 'body',\n      radialScale: null,\n      angularScale: null,\n      colorScale: d3.scale.category20()\n    }\n  };\n  return config;\n};\n\nµ.BarChart = function module() {\n  return µ.PolyChart();\n};\n\nµ.BarChart.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'bar'\n    }\n  };\n  return config;\n};\n\nµ.AreaChart = function module() {\n  return µ.PolyChart();\n};\n\nµ.AreaChart.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'arc'\n    }\n  };\n  return config;\n};\n\nµ.DotPlot = function module() {\n  return µ.PolyChart();\n};\n\nµ.DotPlot.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'dot',\n      dotType: 'circle'\n    }\n  };\n  return config;\n};\n\nµ.LinePlot = function module() {\n  return µ.PolyChart();\n};\n\nµ.LinePlot.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'line'\n    }\n  };\n  return config;\n};\n\nµ.Legend = function module() {\n  var config = µ.Legend.defaultConfig();\n  var dispatch = d3.dispatch('hover');\n\n  function exports() {\n    var legendConfig = config.legendConfig;\n    var flattenData = config.data.map(function (d, i) {\n      return [].concat(d).map(function (dB, iB) {\n        var element = extendDeepAll({}, legendConfig.elements[i]);\n        element.name = dB;\n        element.color = [].concat(legendConfig.elements[i].color)[iB];\n        return element;\n      });\n    });\n    var data = d3.merge(flattenData);\n    data = data.filter(function (d, i) {\n      return legendConfig.elements[i] && (legendConfig.elements[i].visibleInLegend || typeof legendConfig.elements[i].visibleInLegend === 'undefined');\n    });\n    if (legendConfig.reverseOrder) data = data.reverse();\n    var container = legendConfig.container;\n    if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n    var colors = data.map(function (d, i) {\n      return d.color;\n    });\n    var lineHeight = legendConfig.fontSize;\n    var isContinuous = legendConfig.isContinuous == null ? typeof data[0] === 'number' : legendConfig.isContinuous;\n    var height = isContinuous ? legendConfig.height : lineHeight * data.length;\n    var legendContainerGroup = container.classed('legend-group', true);\n    var svg = legendContainerGroup.selectAll('svg').data([0]);\n    var svgEnter = svg.enter().append('svg').attr({\n      width: 300,\n      height: height + lineHeight,\n      xmlns: 'http://www.w3.org/2000/svg',\n      'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n      version: '1.1'\n    });\n    svgEnter.append('g').classed('legend-axis', true);\n    svgEnter.append('g').classed('legend-marks', true);\n    var dataNumbered = d3.range(data.length);\n    var colorScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered).range(colors);\n    var dataScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered)[isContinuous ? 'range' : 'rangePoints']([0, height]);\n\n    var shapeGenerator = function shapeGenerator(_type, _size) {\n      var squareSize = _size * 3;\n\n      if (_type === 'line') {\n        return 'M' + [[-_size / 2, -_size / 12], [_size / 2, -_size / 12], [_size / 2, _size / 12], [-_size / 2, _size / 12]] + 'Z';\n      } else if (d3.svg.symbolTypes.indexOf(_type) != -1) return d3.svg.symbol().type(_type).size(squareSize)();else return d3.svg.symbol().type('square').size(squareSize)();\n    };\n\n    if (isContinuous) {\n      var gradient = svg.select('.legend-marks').append('defs').append('linearGradient').attr({\n        id: 'grad1',\n        x1: '0%',\n        y1: '0%',\n        x2: '0%',\n        y2: '100%'\n      }).selectAll('stop').data(colors);\n      gradient.enter().append('stop');\n      gradient.attr({\n        offset: function offset(d, i) {\n          return i / (colors.length - 1) * 100 + '%';\n        }\n      }).style({\n        'stop-color': function stopColor(d, i) {\n          return d;\n        }\n      });\n      svg.append('rect').classed('legend-mark', true).attr({\n        height: legendConfig.height,\n        width: legendConfig.colorBandWidth,\n        fill: 'url(#grad1)'\n      });\n    } else {\n      var legendElement = svg.select('.legend-marks').selectAll('path.legend-mark').data(data);\n      legendElement.enter().append('path').classed('legend-mark', true);\n      legendElement.attr({\n        transform: function transform(d, i) {\n          return 'translate(' + [lineHeight / 2, dataScale(i) + lineHeight / 2] + ')';\n        },\n        d: function d(_d, i) {\n          var symbolType = _d.symbol;\n          return shapeGenerator(symbolType, lineHeight);\n        },\n        fill: function fill(d, i) {\n          return colorScale(i);\n        }\n      });\n      legendElement.exit().remove();\n    }\n\n    var legendAxis = d3.svg.axis().scale(dataScale).orient('right');\n    var axis = svg.select('g.legend-axis').attr({\n      transform: 'translate(' + [isContinuous ? legendConfig.colorBandWidth : lineHeight, lineHeight / 2] + ')'\n    }).call(legendAxis);\n    axis.selectAll('.domain').style({\n      fill: 'none',\n      stroke: 'none'\n    });\n    axis.selectAll('line').style({\n      fill: 'none',\n      stroke: isContinuous ? legendConfig.textColor : 'none'\n    });\n    axis.selectAll('text').style({\n      fill: legendConfig.textColor,\n      'font-size': legendConfig.fontSize\n    }).text(function (d, i) {\n      return data[i].name;\n    });\n    return exports;\n  }\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n    extendDeepAll(config, _x);\n    return this;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.Legend.defaultConfig = function (d, i) {\n  var config = {\n    data: ['a', 'b', 'c'],\n    legendConfig: {\n      elements: [{\n        symbol: 'line',\n        color: 'red'\n      }, {\n        symbol: 'square',\n        color: 'yellow'\n      }, {\n        symbol: 'diamond',\n        color: 'limegreen'\n      }],\n      height: 150,\n      colorBandWidth: 30,\n      fontSize: 12,\n      container: 'body',\n      isContinuous: null,\n      textColor: 'grey',\n      reverseOrder: false\n    }\n  };\n  return config;\n};\n\nµ.tooltipPanel = function () {\n  var tooltipEl, tooltipTextEl, backgroundEl;\n  var config = {\n    container: null,\n    hasTick: false,\n    fontSize: 12,\n    color: 'white',\n    padding: 5\n  };\n  var id = 'tooltip-' + µ.tooltipPanel.uid++;\n  var tickSize = 10;\n\n  var exports = function exports() {\n    tooltipEl = config.container.selectAll('g.' + id).data([0]);\n    var tooltipEnter = tooltipEl.enter().append('g').classed(id, true).style({\n      'pointer-events': 'none',\n      display: 'none'\n    });\n    backgroundEl = tooltipEnter.append('path').style({\n      fill: 'white',\n      'fill-opacity': .9\n    }).attr({\n      d: 'M0 0'\n    });\n    tooltipTextEl = tooltipEnter.append('text').attr({\n      dx: config.padding + tickSize,\n      dy: +config.fontSize * .3\n    });\n    return exports;\n  };\n\n  exports.text = function (_text) {\n    var l = d3.hsl(config.color).l;\n    var strokeColor = l >= .5 ? '#aaa' : 'white';\n    var fillColor = l >= .5 ? 'black' : 'white';\n    var text = _text || '';\n    tooltipTextEl.style({\n      fill: fillColor,\n      'font-size': config.fontSize + 'px'\n    }).text(text);\n    var padding = config.padding;\n    var bbox = tooltipTextEl.node().getBBox();\n    var boxStyle = {\n      fill: config.color,\n      stroke: strokeColor,\n      'stroke-width': '2px'\n    };\n    var backGroundW = bbox.width + padding * 2 + tickSize;\n    var backGroundH = bbox.height + padding * 2;\n    backgroundEl.attr({\n      d: 'M' + [[tickSize, -backGroundH / 2], [tickSize, -backGroundH / 4], [config.hasTick ? 0 : tickSize, 0], [tickSize, backGroundH / 4], [tickSize, backGroundH / 2], [backGroundW, backGroundH / 2], [backGroundW, -backGroundH / 2]].join('L') + 'Z'\n    }).style(boxStyle);\n    tooltipEl.attr({\n      transform: 'translate(' + [tickSize, -backGroundH / 2 + padding * 2] + ')'\n    });\n    tooltipEl.style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.move = function (_pos) {\n    if (!tooltipEl) return;\n    tooltipEl.attr({\n      transform: 'translate(' + [_pos[0], _pos[1]] + ')'\n    }).style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.hide = function () {\n    if (!tooltipEl) return;\n    tooltipEl.style({\n      display: 'none'\n    });\n    return exports;\n  };\n\n  exports.show = function () {\n    if (!tooltipEl) return;\n    tooltipEl.style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.config = function (_x) {\n    extendDeepAll(config, _x);\n    return exports;\n  };\n\n  return exports;\n};\n\nµ.tooltipPanel.uid = 1;\nµ.adapter = {};\n\nµ.adapter.plotly = function module() {\n  var exports = {};\n\n  exports.convert = function (_inputConfig, reverse) {\n    var outputConfig = {};\n\n    if (_inputConfig.data) {\n      outputConfig.data = _inputConfig.data.map(function (d, i) {\n        var r = extendDeepAll({}, d);\n        var toTranslate = [[r, ['marker', 'color'], ['color']], [r, ['marker', 'opacity'], ['opacity']], [r, ['marker', 'line', 'color'], ['strokeColor']], [r, ['marker', 'line', 'dash'], ['strokeDash']], [r, ['marker', 'line', 'width'], ['strokeSize']], [r, ['marker', 'symbol'], ['dotType']], [r, ['marker', 'size'], ['dotSize']], [r, ['marker', 'barWidth'], ['barWidth']], [r, ['line', 'interpolation'], ['lineInterpolation']], [r, ['showlegend'], ['visibleInLegend']]];\n        toTranslate.forEach(function (d, i) {\n          µ.util.translator.apply(null, d.concat(reverse));\n        });\n        if (!reverse) delete r.marker;\n        if (reverse) delete r.groupId;\n\n        if (!reverse) {\n          if (r.type === 'scatter') {\n            if (r.mode === 'lines') r.geometry = 'LinePlot';else if (r.mode === 'markers') r.geometry = 'DotPlot';else if (r.mode === 'lines+markers') {\n              r.geometry = 'LinePlot';\n              r.dotVisible = true;\n            }\n          } else if (r.type === 'area') r.geometry = 'AreaChart';else if (r.type === 'bar') r.geometry = 'BarChart';\n\n          delete r.mode;\n          delete r.type;\n        } else {\n          if (r.geometry === 'LinePlot') {\n            r.type = 'scatter';\n\n            if (r.dotVisible === true) {\n              delete r.dotVisible;\n              r.mode = 'lines+markers';\n            } else r.mode = 'lines';\n          } else if (r.geometry === 'DotPlot') {\n            r.type = 'scatter';\n            r.mode = 'markers';\n          } else if (r.geometry === 'AreaChart') r.type = 'area';else if (r.geometry === 'BarChart') r.type = 'bar';\n\n          delete r.geometry;\n        }\n\n        return r;\n      });\n\n      if (!reverse && _inputConfig.layout && _inputConfig.layout.barmode === 'stack') {\n        var duplicates = µ.util.duplicates(outputConfig.data.map(function (d, i) {\n          return d.geometry;\n        }));\n        outputConfig.data.forEach(function (d, i) {\n          var idx = duplicates.indexOf(d.geometry);\n          if (idx != -1) outputConfig.data[i].groupId = idx;\n        });\n      }\n    }\n\n    if (_inputConfig.layout) {\n      var r = extendDeepAll({}, _inputConfig.layout);\n      var toTranslate = [[r, ['plot_bgcolor'], ['backgroundColor']], [r, ['showlegend'], ['showLegend']], [r, ['radialaxis'], ['radialAxis']], [r, ['angularaxis'], ['angularAxis']], [r.angularaxis, ['showline'], ['gridLinesVisible']], [r.angularaxis, ['showticklabels'], ['labelsVisible']], [r.angularaxis, ['nticks'], ['ticksCount']], [r.angularaxis, ['tickorientation'], ['tickOrientation']], [r.angularaxis, ['ticksuffix'], ['ticksSuffix']], [r.angularaxis, ['range'], ['domain']], [r.angularaxis, ['endpadding'], ['endPadding']], [r.radialaxis, ['showline'], ['gridLinesVisible']], [r.radialaxis, ['tickorientation'], ['tickOrientation']], [r.radialaxis, ['ticksuffix'], ['ticksSuffix']], [r.radialaxis, ['range'], ['domain']], [r.angularAxis, ['showline'], ['gridLinesVisible']], [r.angularAxis, ['showticklabels'], ['labelsVisible']], [r.angularAxis, ['nticks'], ['ticksCount']], [r.angularAxis, ['tickorientation'], ['tickOrientation']], [r.angularAxis, ['ticksuffix'], ['ticksSuffix']], [r.angularAxis, ['range'], ['domain']], [r.angularAxis, ['endpadding'], ['endPadding']], [r.radialAxis, ['showline'], ['gridLinesVisible']], [r.radialAxis, ['tickorientation'], ['tickOrientation']], [r.radialAxis, ['ticksuffix'], ['ticksSuffix']], [r.radialAxis, ['range'], ['domain']], [r.font, ['outlinecolor'], ['outlineColor']], [r.legend, ['traceorder'], ['reverseOrder']], [r, ['labeloffset'], ['labelOffset']], [r, ['defaultcolorrange'], ['defaultColorRange']]];\n      toTranslate.forEach(function (d, i) {\n        µ.util.translator.apply(null, d.concat(reverse));\n      });\n\n      if (!reverse) {\n        if (r.angularAxis && typeof r.angularAxis.ticklen !== 'undefined') r.tickLength = r.angularAxis.ticklen;\n        if (r.angularAxis && typeof r.angularAxis.tickcolor !== 'undefined') r.tickColor = r.angularAxis.tickcolor;\n      } else {\n        if (typeof r.tickLength !== 'undefined') {\n          r.angularaxis.ticklen = r.tickLength;\n          delete r.tickLength;\n        }\n\n        if (r.tickColor) {\n          r.angularaxis.tickcolor = r.tickColor;\n          delete r.tickColor;\n        }\n      }\n\n      if (r.legend && typeof r.legend.reverseOrder != 'boolean') {\n        r.legend.reverseOrder = r.legend.reverseOrder != 'normal';\n      }\n\n      if (r.legend && typeof r.legend.traceorder == 'boolean') {\n        r.legend.traceorder = r.legend.traceorder ? 'reversed' : 'normal';\n        delete r.legend.reverseOrder;\n      }\n\n      if (r.margin && typeof r.margin.t != 'undefined') {\n        var source = ['t', 'r', 'b', 'l', 'pad'];\n        var target = ['top', 'right', 'bottom', 'left', 'pad'];\n        var margin = {};\n        d3.entries(r.margin).forEach(function (dB, iB) {\n          margin[target[source.indexOf(dB.key)]] = dB.value;\n        });\n        r.margin = margin;\n      }\n\n      if (reverse) {\n        delete r.needsEndSpacing;\n        delete r.minorTickColor;\n        delete r.minorTicks;\n        delete r.angularaxis.ticksCount;\n        delete r.angularaxis.ticksCount;\n        delete r.angularaxis.ticksStep;\n        delete r.angularaxis.rewriteTicks;\n        delete r.angularaxis.nticks;\n        delete r.radialaxis.ticksCount;\n        delete r.radialaxis.ticksCount;\n        delete r.radialaxis.ticksStep;\n        delete r.radialaxis.rewriteTicks;\n        delete r.radialaxis.nticks;\n      }\n\n      outputConfig.layout = r;\n    }\n\n    return outputConfig;\n  };\n\n  return exports;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  xaxis: {\n    valType: 'subplotid',\n    role: 'info',\n    dflt: 'x',\n    editType: 'calc+clearAxisTypes',\n    description: ['Sets a reference between this trace\\'s x coordinates and', 'a 2D cartesian x axis.', 'If *x* (the default value), the x coordinates refer to', '`layout.xaxis`.', 'If *x2*, the x coordinates refer to `layout.xaxis2`, and so on.'].join(' ')\n  },\n  yaxis: {\n    valType: 'subplotid',\n    role: 'info',\n    dflt: 'y',\n    editType: 'calc+clearAxisTypes',\n    description: ['Sets a reference between this trace\\'s y coordinates and', 'a 2D cartesian y axis.', 'If *y* (the default value), the y coordinates refer to', '`layout.yaxis`.', 'If *y2*, the y coordinates refer to `layout.yaxis2`, and so on.'].join(' ')\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar Plots = require('../plots/plots');\n\nvar PlotSchema = require('./plot_schema');\n\nvar dfltConfig = require('./plot_config').dfltConfig;\n\nvar isPlainObject = Lib.isPlainObject;\nvar isArray = Array.isArray;\nvar isArrayOrTypedArray = Lib.isArrayOrTypedArray;\n/**\n * Validate a data array and layout object.\n *\n * @param {array} data\n * @param {object} layout\n *\n * @return {array} array of error objects each containing:\n *  - {string} code\n *      error code ('object', 'array', 'schema', 'unused', 'invisible' or 'value')\n *  - {string} container\n *      container where the error occurs ('data' or 'layout')\n *  - {number} trace\n *      trace index of the 'data' container where the error occurs\n *  - {array} path\n *      nested path to the key that causes the error\n *  - {string} astr\n *      attribute string variant of 'path' compatible with Plotly.restyle and\n *      Plotly.relayout.\n *  - {string} msg\n *      error message (shown in console in logger config argument is enable)\n */\n\nmodule.exports = function validate(data, layout) {\n  if (data === undefined) data = [];\n  if (layout === undefined) layout = {};\n  var schema = PlotSchema.get();\n  var errorList = [];\n  var gd = {\n    _context: Lib.extendFlat({}, dfltConfig)\n  };\n  var dataIn, layoutIn;\n\n  if (isArray(data)) {\n    gd.data = Lib.extendDeep([], data);\n    dataIn = data;\n  } else {\n    gd.data = [];\n    dataIn = [];\n    errorList.push(format('array', 'data'));\n  }\n\n  if (isPlainObject(layout)) {\n    gd.layout = Lib.extendDeep({}, layout);\n    layoutIn = layout;\n  } else {\n    gd.layout = {};\n    layoutIn = {};\n\n    if (arguments.length > 1) {\n      errorList.push(format('object', 'layout'));\n    }\n  } // N.B. dataIn and layoutIn are in general not the same as\n  // gd.data and gd.layout after supplyDefaults as some attributes\n  // in gd.data and gd.layout (still) get mutated during this step.\n\n\n  Plots.supplyDefaults(gd);\n  var dataOut = gd._fullData;\n  var len = dataIn.length;\n\n  for (var i = 0; i < len; i++) {\n    var traceIn = dataIn[i];\n    var base = ['data', i];\n\n    if (!isPlainObject(traceIn)) {\n      errorList.push(format('object', base));\n      continue;\n    }\n\n    var traceOut = dataOut[i];\n    var traceType = traceOut.type;\n    var traceSchema = schema.traces[traceType].attributes; // PlotSchema does something fancy with trace 'type', reset it here\n    // to make the trace schema compatible with Lib.validate.\n\n    traceSchema.type = {\n      valType: 'enumerated',\n      values: [traceType]\n    };\n\n    if (traceOut.visible === false && traceIn.visible !== false) {\n      errorList.push(format('invisible', base));\n    }\n\n    crawl(traceIn, traceOut, traceSchema, errorList, base);\n    var transformsIn = traceIn.transforms;\n    var transformsOut = traceOut.transforms;\n\n    if (transformsIn) {\n      if (!isArray(transformsIn)) {\n        errorList.push(format('array', base, ['transforms']));\n      }\n\n      base.push('transforms');\n\n      for (var j = 0; j < transformsIn.length; j++) {\n        var path = ['transforms', j];\n        var transformType = transformsIn[j].type;\n\n        if (!isPlainObject(transformsIn[j])) {\n          errorList.push(format('object', base, path));\n          continue;\n        }\n\n        var transformSchema = schema.transforms[transformType] ? schema.transforms[transformType].attributes : {}; // add 'type' to transform schema to validate the transform type\n\n        transformSchema.type = {\n          valType: 'enumerated',\n          values: Object.keys(schema.transforms)\n        };\n        crawl(transformsIn[j], transformsOut[j], transformSchema, errorList, base, path);\n      }\n    }\n  }\n\n  var layoutOut = gd._fullLayout;\n  var layoutSchema = fillLayoutSchema(schema, dataOut);\n  crawl(layoutIn, layoutOut, layoutSchema, errorList, 'layout'); // return undefined if no validation errors were found\n\n  return errorList.length === 0 ? void 0 : errorList;\n};\n\nfunction crawl(objIn, objOut, schema, list, base, path) {\n  path = path || [];\n  var keys = Object.keys(objIn);\n\n  for (var i = 0; i < keys.length; i++) {\n    var k = keys[i]; // transforms are handled separately\n\n    if (k === 'transforms') continue;\n    var p = path.slice();\n    p.push(k);\n    var valIn = objIn[k];\n    var valOut = objOut[k];\n    var nestedSchema = getNestedSchema(schema, k);\n    var nestedValType = (nestedSchema || {}).valType;\n    var isInfoArray = nestedValType === 'info_array';\n    var isColorscale = nestedValType === 'colorscale';\n    var items = (nestedSchema || {}).items;\n\n    if (!isInSchema(schema, k)) {\n      list.push(format('schema', base, p));\n    } else if (isPlainObject(valIn) && isPlainObject(valOut) && nestedValType !== 'any') {\n      crawl(valIn, valOut, nestedSchema, list, base, p);\n    } else if (isInfoArray && isArray(valIn)) {\n      if (valIn.length > valOut.length) {\n        list.push(format('unused', base, p.concat(valOut.length)));\n      }\n\n      var len = valOut.length;\n      var arrayItems = Array.isArray(items);\n      if (arrayItems) len = Math.min(len, items.length);\n      var m, n, item, valInPart, valOutPart;\n\n      if (nestedSchema.dimensions === 2) {\n        for (n = 0; n < len; n++) {\n          if (isArray(valIn[n])) {\n            if (valIn[n].length > valOut[n].length) {\n              list.push(format('unused', base, p.concat(n, valOut[n].length)));\n            }\n\n            var len2 = valOut[n].length;\n\n            for (m = 0; m < (arrayItems ? Math.min(len2, items[n].length) : len2); m++) {\n              item = arrayItems ? items[n][m] : items;\n              valInPart = valIn[n][m];\n              valOutPart = valOut[n][m];\n\n              if (!Lib.validate(valInPart, item)) {\n                list.push(format('value', base, p.concat(n, m), valInPart));\n              } else if (valOutPart !== valInPart && valOutPart !== +valInPart) {\n                list.push(format('dynamic', base, p.concat(n, m), valInPart, valOutPart));\n              }\n            }\n          } else {\n            list.push(format('array', base, p.concat(n), valIn[n]));\n          }\n        }\n      } else {\n        for (n = 0; n < len; n++) {\n          item = arrayItems ? items[n] : items;\n          valInPart = valIn[n];\n          valOutPart = valOut[n];\n\n          if (!Lib.validate(valInPart, item)) {\n            list.push(format('value', base, p.concat(n), valInPart));\n          } else if (valOutPart !== valInPart && valOutPart !== +valInPart) {\n            list.push(format('dynamic', base, p.concat(n), valInPart, valOutPart));\n          }\n        }\n      }\n    } else if (nestedSchema.items && !isInfoArray && isArray(valIn)) {\n      var _nestedSchema = items[Object.keys(items)[0]];\n      var indexList = [];\n\n      var j, _p; // loop over valOut items while keeping track of their\n      // corresponding input container index (given by _index)\n\n\n      for (j = 0; j < valOut.length; j++) {\n        var _index = valOut[j]._index || j;\n\n        _p = p.slice();\n\n        _p.push(_index);\n\n        if (isPlainObject(valIn[_index]) && isPlainObject(valOut[j])) {\n          indexList.push(_index);\n          var valInj = valIn[_index];\n          var valOutj = valOut[j];\n\n          if (isPlainObject(valInj) && valInj.visible !== false && valOutj.visible === false) {\n            list.push(format('invisible', base, _p));\n          } else crawl(valInj, valOutj, _nestedSchema, list, base, _p);\n        }\n      } // loop over valIn to determine where it went wrong for some items\n\n\n      for (j = 0; j < valIn.length; j++) {\n        _p = p.slice();\n\n        _p.push(j);\n\n        if (!isPlainObject(valIn[j])) {\n          list.push(format('object', base, _p, valIn[j]));\n        } else if (indexList.indexOf(j) === -1) {\n          list.push(format('unused', base, _p));\n        }\n      }\n    } else if (!isPlainObject(valIn) && isPlainObject(valOut)) {\n      list.push(format('object', base, p, valIn));\n    } else if (!isArrayOrTypedArray(valIn) && isArrayOrTypedArray(valOut) && !isInfoArray && !isColorscale) {\n      list.push(format('array', base, p, valIn));\n    } else if (!(k in objOut)) {\n      list.push(format('unused', base, p, valIn));\n    } else if (!Lib.validate(valIn, nestedSchema)) {\n      list.push(format('value', base, p, valIn));\n    } else if (nestedSchema.valType === 'enumerated' && (nestedSchema.coerceNumber && valIn !== +valOut || valIn !== valOut)) {\n      list.push(format('dynamic', base, p, valIn, valOut));\n    }\n  }\n\n  return list;\n} // the 'full' layout schema depends on the traces types presents\n\n\nfunction fillLayoutSchema(schema, dataOut) {\n  var layoutSchema = schema.layout.layoutAttributes;\n\n  for (var i = 0; i < dataOut.length; i++) {\n    var traceOut = dataOut[i];\n    var traceSchema = schema.traces[traceOut.type];\n    var traceLayoutAttr = traceSchema.layoutAttributes;\n\n    if (traceLayoutAttr) {\n      if (traceOut.subplot) {\n        Lib.extendFlat(layoutSchema[traceSchema.attributes.subplot.dflt], traceLayoutAttr);\n      } else {\n        Lib.extendFlat(layoutSchema, traceLayoutAttr);\n      }\n    }\n  }\n\n  return layoutSchema;\n} // validation error codes\n\n\nvar code2msgFunc = {\n  object: function object(base, astr) {\n    var prefix;\n    if (base === 'layout' && astr === '') prefix = 'The layout argument';else if (base[0] === 'data' && astr === '') {\n      prefix = 'Trace ' + base[1] + ' in the data argument';\n    } else prefix = inBase(base) + 'key ' + astr;\n    return prefix + ' must be linked to an object container';\n  },\n  array: function array(base, astr) {\n    var prefix;\n    if (base === 'data') prefix = 'The data argument';else prefix = inBase(base) + 'key ' + astr;\n    return prefix + ' must be linked to an array container';\n  },\n  schema: function schema(base, astr) {\n    return inBase(base) + 'key ' + astr + ' is not part of the schema';\n  },\n  unused: function unused(base, astr, valIn) {\n    var target = isPlainObject(valIn) ? 'container' : 'key';\n    return inBase(base) + target + ' ' + astr + ' did not get coerced';\n  },\n  dynamic: function dynamic(base, astr, valIn, valOut) {\n    return [inBase(base) + 'key', astr, '(set to \\'' + valIn + '\\')', 'got reset to', '\\'' + valOut + '\\'', 'during defaults.'].join(' ');\n  },\n  invisible: function invisible(base, astr) {\n    return (astr ? inBase(base) + 'item ' + astr : 'Trace ' + base[1]) + ' got defaulted to be not visible';\n  },\n  value: function value(base, astr, valIn) {\n    return [inBase(base) + 'key ' + astr, 'is set to an invalid value (' + valIn + ')'].join(' ');\n  }\n};\n\nfunction inBase(base) {\n  if (isArray(base)) return 'In data trace ' + base[1] + ', ';\n  return 'In ' + base + ', ';\n}\n\nfunction format(code, base, path, valIn, valOut) {\n  path = path || '';\n  var container, trace; // container is either 'data' or 'layout\n  // trace is the trace index if 'data', null otherwise\n\n  if (isArray(base)) {\n    container = base[0];\n    trace = base[1];\n  } else {\n    container = base;\n    trace = null;\n  }\n\n  var astr = convertPathToAttributeString(path);\n  var msg = code2msgFunc[code](base, astr, valIn, valOut); // log to console if logger config option is enabled\n\n  Lib.log(msg);\n  return {\n    code: code,\n    container: container,\n    trace: trace,\n    path: path,\n    astr: astr,\n    msg: msg\n  };\n}\n\nfunction isInSchema(schema, key) {\n  var parts = splitKey(key);\n  var keyMinusId = parts.keyMinusId;\n  var id = parts.id;\n\n  if (keyMinusId in schema && schema[keyMinusId]._isSubplotObj && id) {\n    return true;\n  }\n\n  return key in schema;\n}\n\nfunction getNestedSchema(schema, key) {\n  if (key in schema) return schema[key];\n  var parts = splitKey(key);\n  return schema[parts.keyMinusId];\n}\n\nvar idRegex = Lib.counterRegex('([a-z]+)');\n\nfunction splitKey(key) {\n  var idMatch = key.match(idRegex);\n  return {\n    keyMinusId: idMatch && idMatch[1],\n    id: idMatch && idMatch[2]\n  };\n}\n\nfunction convertPathToAttributeString(path) {\n  if (!isArray(path)) return String(path);\n  var astr = '';\n\n  for (var i = 0; i < path.length; i++) {\n    var p = path[i];\n\n    if (typeof p === 'number') {\n      astr = astr.substr(0, astr.length - 1) + '[' + p + ']';\n    } else {\n      astr += p;\n    }\n\n    if (i < path.length - 1) astr += '.';\n  }\n\n  return astr;\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n/**\n * Error bar computing function generator\n *\n * N.B. The generated function does not clean the dataPt entries. Non-numeric\n * entries result in undefined error magnitudes.\n *\n * @param {object} opts error bar attributes\n *\n * @return {function} :\n *      @param {numeric} dataPt data point from where to compute the error magnitude\n *      @param {number} index index of dataPt in its corresponding data array\n *      @return {array}\n *        - error[0] : error magnitude in the negative direction\n *        - error[1] : \" \" \" \" positive \"\n */\n\nmodule.exports = function makeComputeError(opts) {\n  var type = opts.type;\n  var symmetric = opts.symmetric;\n\n  if (type === 'data') {\n    var array = opts.array || [];\n\n    if (symmetric) {\n      return function computeError(dataPt, index) {\n        var val = +array[index];\n        return [val, val];\n      };\n    } else {\n      var arrayminus = opts.arrayminus || [];\n      return function computeError(dataPt, index) {\n        var val = +array[index];\n        var valMinus = +arrayminus[index]; // in case one is present and the other is missing, fill in 0\n        // so we still see the present one. Mostly useful during manual\n        // data entry.\n\n        if (!isNaN(val) || !isNaN(valMinus)) {\n          return [valMinus || 0, val || 0];\n        }\n\n        return [NaN, NaN];\n      };\n    }\n  } else {\n    var computeErrorValue = makeComputeErrorValue(type, opts.value);\n    var computeErrorValueMinus = makeComputeErrorValue(type, opts.valueminus);\n\n    if (symmetric || opts.valueminus === undefined) {\n      return function computeError(dataPt) {\n        var val = computeErrorValue(dataPt);\n        return [val, val];\n      };\n    } else {\n      return function computeError(dataPt) {\n        return [computeErrorValueMinus(dataPt), computeErrorValue(dataPt)];\n      };\n    }\n  }\n};\n/**\n * Compute error bar magnitude (for all types except data)\n *\n * @param {string} type error bar type\n * @param {numeric} value error bar value\n *\n * @return {function} :\n *      @param {numeric} dataPt\n */\n\n\nfunction makeComputeErrorValue(type, value) {\n  if (type === 'percent') {\n    return function (dataPt) {\n      return Math.abs(dataPt * value / 100);\n    };\n  }\n\n  if (type === 'constant') {\n    return function () {\n      return Math.abs(value);\n    };\n  }\n\n  if (type === 'sqrt') {\n    return function (dataPt) {\n      return Math.sqrt(Math.abs(dataPt));\n    };\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  // layout attribute name\n  name: 'updatemenus',\n  // class names\n  containerClassName: 'updatemenu-container',\n  headerGroupClassName: 'updatemenu-header-group',\n  headerClassName: 'updatemenu-header',\n  headerArrowClassName: 'updatemenu-header-arrow',\n  dropdownButtonGroupClassName: 'updatemenu-dropdown-button-group',\n  dropdownButtonClassName: 'updatemenu-dropdown-button',\n  buttonClassName: 'updatemenu-button',\n  itemRectClassName: 'updatemenu-item-rect',\n  itemTextClassName: 'updatemenu-item-text',\n  // DOM attribute name in button group keeping track\n  // of active update menu\n  menuIndexAttrName: 'updatemenu-active-index',\n  // id root pass to Plots.autoMargin\n  autoMarginIdRoot: 'updatemenu-',\n  // options when 'active: -1'\n  blankHeaderOpts: {\n    label: '  '\n  },\n  // min item width / height\n  minWidth: 30,\n  minHeight: 30,\n  // padding around item text\n  textPadX: 24,\n  arrowPadX: 16,\n  // item rect radii\n  rx: 2,\n  ry: 2,\n  // item  text x offset off left edge\n  textOffsetX: 12,\n  // item  text y offset (w.r.t. middle)\n  textOffsetY: 3,\n  // arrow offset off right edge\n  arrowOffsetX: 4,\n  // gap between header and buttons\n  gapButtonHeader: 5,\n  // gap between between buttons\n  gapButton: 2,\n  // color given to active buttons\n  activeColor: '#F4FAFF',\n  // color given to hovered buttons\n  hoverColor: '#F4FAFF',\n  // symbol for menu open arrow\n  arrowSymbol: {\n    left: '◄',\n    right: '►',\n    up: '▲',\n    down: '▼'\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nmodule.exports = function calcSelection(cd, trace) {\n  if (Lib.isArrayOrTypedArray(trace.selectedpoints)) {\n    Lib.tagSelected(cd, trace);\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Registry = require('../registry');\n\nexports.getDelay = function (fullLayout) {\n  if (!fullLayout._has) return 0;\n  return fullLayout._has('gl3d') || fullLayout._has('gl2d') || fullLayout._has('mapbox') ? 500 : 0;\n};\n\nexports.getRedrawFunc = function (gd) {\n  return function () {\n    var fullLayout = gd._fullLayout || {};\n\n    var hasPolar = fullLayout._has && fullLayout._has('polar');\n\n    var hasLegacyPolar = !hasPolar && gd.data && gd.data[0] && gd.data[0].r;\n\n    if (!hasLegacyPolar) {\n      Registry.getComponentMethod('colorbar', 'draw')(gd);\n    }\n  };\n};\n\nexports.encodeSVG = function (svg) {\n  return 'data:image/svg+xml,' + encodeURIComponent(svg);\n};\n\nexports.encodeJSON = function (json) {\n  return 'data:application/json,' + encodeURIComponent(json);\n};\n\nvar DOM_URL = window.URL || window.webkitURL;\n\nexports.createObjectURL = function (blob) {\n  return DOM_URL.createObjectURL(blob);\n};\n\nexports.revokeObjectURL = function (url) {\n  return DOM_URL.revokeObjectURL(url);\n};\n\nexports.createBlob = function (url, format) {\n  if (format === 'svg') {\n    return new window.Blob([url], {\n      type: 'image/svg+xml;charset=utf-8'\n    });\n  } else if (format === 'full-json') {\n    return new window.Blob([url], {\n      type: 'application/json;charset=utf-8'\n    });\n  } else {\n    var binary = fixBinary(window.atob(url));\n    return new window.Blob([binary], {\n      type: 'image/' + format\n    });\n  }\n};\n\nexports.octetStream = function (s) {\n  document.location.href = 'data:application/octet-stream' + s;\n}; // Taken from https://bl.ocks.org/nolanlawson/0eac306e4dac2114c752\n\n\nfunction fixBinary(b) {\n  var len = b.length;\n  var buf = new ArrayBuffer(len);\n  var arr = new Uint8Array(buf);\n\n  for (var i = 0; i < len; i++) {\n    arr[i] = b.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nexports.IMAGE_URL_PREFIX = /^data:image\\/\\w+;base64,/;\nexports.MSG_IE_BAD_FORMAT = 'Sorry IE does not support downloading from canvas. Try {format:\\'svg\\'} instead.';","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar fontAttrs = require('../../plots/font_attributes');\n\nvar colorAttrs = require('../color/attributes');\n\nvar extendFlat = require('../../lib/extend').extendFlat;\n\nvar overrideAll = require('../../plot_api/edit_types').overrideAll;\n\nvar padAttrs = require('../../plots/pad_attributes');\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nvar buttonsAttrs = templatedArray('button', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    description: 'Determines whether or not this button is visible.'\n  },\n  method: {\n    valType: 'enumerated',\n    values: ['restyle', 'relayout', 'animate', 'update', 'skip'],\n    dflt: 'restyle',\n    role: 'info',\n    description: ['Sets the Plotly method to be called on click.', 'If the `skip` method is used, the API updatemenu will function as normal', 'but will perform no API calls and will not bind automatically to state', 'updates. This may be used to create a component interface and attach to', 'updatemenu events manually via JavaScript.'].join(' ')\n  },\n  args: {\n    valType: 'info_array',\n    role: 'info',\n    freeLength: true,\n    items: [{\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }],\n    description: ['Sets the arguments values to be passed to the Plotly', 'method set in `method` on click.'].join(' ')\n  },\n  args2: {\n    valType: 'info_array',\n    role: 'info',\n    freeLength: true,\n    items: [{\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }],\n    description: ['Sets a 2nd set of `args`,', 'these arguments values are passed to the Plotly', 'method set in `method` when clicking this button while in the active state.', 'Use this to create toggle buttons.'].join(' ')\n  },\n  label: {\n    valType: 'string',\n    role: 'info',\n    dflt: '',\n    description: 'Sets the text label to appear on the button.'\n  },\n  execute: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    description: ['When true, the API method is executed. When false, all other behaviors are the same', 'and command execution is skipped. This may be useful when hooking into, for example,', 'the `plotly_buttonclicked` method and executing the API command manually without losing', 'the benefit of the updatemenu automatically binding to the state of the plot through the', 'specification of `method` and `args`.'].join(' ')\n  }\n});\nmodule.exports = overrideAll(templatedArray('updatemenu', {\n  _arrayAttrRegexps: [/^updatemenus\\[(0|[1-9][0-9]+)\\]\\.buttons/],\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    description: ['Determines whether or not the update menu is visible.'].join(' ')\n  },\n  type: {\n    valType: 'enumerated',\n    values: ['dropdown', 'buttons'],\n    dflt: 'dropdown',\n    role: 'info',\n    description: ['Determines whether the buttons are accessible via a dropdown menu', 'or whether the buttons are stacked horizontally or vertically'].join(' ')\n  },\n  direction: {\n    valType: 'enumerated',\n    values: ['left', 'right', 'up', 'down'],\n    dflt: 'down',\n    role: 'info',\n    description: ['Determines the direction in which the buttons are laid out, whether', 'in a dropdown menu or a row/column of buttons. For `left` and `up`,', 'the buttons will still appear in left-to-right or top-to-bottom order', 'respectively.'].join(' ')\n  },\n  active: {\n    valType: 'integer',\n    role: 'info',\n    min: -1,\n    dflt: 0,\n    description: ['Determines which button (by index starting from 0) is', 'considered active.'].join(' ')\n  },\n  showactive: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    description: 'Highlights active dropdown item or active button if true.'\n  },\n  buttons: buttonsAttrs,\n  x: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    dflt: -0.05,\n    role: 'style',\n    description: 'Sets the x position (in normalized coordinates) of the update menu.'\n  },\n  xanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'left', 'center', 'right'],\n    dflt: 'right',\n    role: 'info',\n    description: ['Sets the update menu\\'s horizontal position anchor.', 'This anchor binds the `x` position to the *left*, *center*', 'or *right* of the range selector.'].join(' ')\n  },\n  y: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    dflt: 1,\n    role: 'style',\n    description: 'Sets the y position (in normalized coordinates) of the update menu.'\n  },\n  yanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'top', 'middle', 'bottom'],\n    dflt: 'top',\n    role: 'info',\n    description: ['Sets the update menu\\'s vertical position anchor', 'This anchor binds the `y` position to the *top*, *middle*', 'or *bottom* of the range selector.'].join(' ')\n  },\n  pad: extendFlat(padAttrs({\n    editType: 'arraydraw'\n  }), {\n    description: 'Sets the padding around the buttons or dropdown menu.'\n  }),\n  font: fontAttrs({\n    description: 'Sets the font of the update menu button text.'\n  }),\n  bgcolor: {\n    valType: 'color',\n    role: 'style',\n    description: 'Sets the background color of the update menu buttons.'\n  },\n  bordercolor: {\n    valType: 'color',\n    dflt: colorAttrs.borderLine,\n    role: 'style',\n    description: 'Sets the color of the border enclosing the update menu.'\n  },\n  borderwidth: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the width (in px) of the border enclosing the update menu.'\n  }\n}), 'arraydraw', 'from-root');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar calc = require('./calc');\n/*\n * Scatter stacking & normalization calculations\n * runs per subplot, and can handle multiple stacking groups\n */\n\n\nmodule.exports = function crossTraceCalc(gd, plotinfo) {\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  var subplot = xa._id + ya._id;\n  var subplotStackOpts = gd._fullLayout._scatterStackOpts[subplot];\n  if (!subplotStackOpts) return;\n  var calcTraces = gd.calcdata;\n  var i, j, k, i2, cd, cd0, posj, sumj, norm;\n  var groupOpts, interpolate, groupnorm, posAttr, valAttr;\n  var hasAnyBlanks;\n\n  for (var stackGroup in subplotStackOpts) {\n    groupOpts = subplotStackOpts[stackGroup];\n    var indices = groupOpts.traceIndices; // can get here with no indices if the stack axis is non-numeric\n\n    if (!indices.length) continue;\n    interpolate = groupOpts.stackgaps === 'interpolate';\n    groupnorm = groupOpts.groupnorm;\n\n    if (groupOpts.orientation === 'v') {\n      posAttr = 'x';\n      valAttr = 'y';\n    } else {\n      posAttr = 'y';\n      valAttr = 'x';\n    }\n\n    hasAnyBlanks = new Array(indices.length);\n\n    for (i = 0; i < hasAnyBlanks.length; i++) {\n      hasAnyBlanks[i] = false;\n    } // Collect the complete set of all positions across ALL traces.\n    // Start with the first trace, then interleave items from later traces\n    // as needed.\n    // Fill in mising items as we go.\n\n\n    cd0 = calcTraces[indices[0]];\n    var allPositions = new Array(cd0.length);\n\n    for (i = 0; i < cd0.length; i++) {\n      allPositions[i] = cd0[i][posAttr];\n    }\n\n    for (i = 1; i < indices.length; i++) {\n      cd = calcTraces[indices[i]];\n\n      for (j = k = 0; j < cd.length; j++) {\n        posj = cd[j][posAttr];\n\n        for (; posj > allPositions[k] && k < allPositions.length; k++) {\n          // the current trace is missing a position from some previous trace(s)\n          insertBlank(cd, j, allPositions[k], i, hasAnyBlanks, interpolate, posAttr);\n          j++;\n        }\n\n        if (posj !== allPositions[k]) {\n          // previous trace(s) are missing a position from the current trace\n          for (i2 = 0; i2 < i; i2++) {\n            insertBlank(calcTraces[indices[i2]], k, posj, i2, hasAnyBlanks, interpolate, posAttr);\n          }\n\n          allPositions.splice(k, 0, posj);\n        }\n\n        k++;\n      }\n\n      for (; k < allPositions.length; k++) {\n        insertBlank(cd, j, allPositions[k], i, hasAnyBlanks, interpolate, posAttr);\n        j++;\n      }\n    }\n\n    var serieslen = allPositions.length; // stack (and normalize)!\n\n    for (j = 0; j < cd0.length; j++) {\n      sumj = cd0[j][valAttr] = cd0[j].s;\n\n      for (i = 1; i < indices.length; i++) {\n        cd = calcTraces[indices[i]];\n        cd[0].trace._rawLength = cd[0].trace._length;\n        cd[0].trace._length = serieslen;\n        sumj += cd[j].s;\n        cd[j][valAttr] = sumj;\n      }\n\n      if (groupnorm) {\n        norm = (groupnorm === 'fraction' ? sumj : sumj / 100) || 1;\n\n        for (i = 0; i < indices.length; i++) {\n          var cdj = calcTraces[indices[i]][j];\n          cdj[valAttr] /= norm;\n          cdj.sNorm = cdj.s / norm;\n        }\n      }\n    } // autorange\n\n\n    for (i = 0; i < indices.length; i++) {\n      cd = calcTraces[indices[i]];\n      var trace = cd[0].trace;\n      var ppad = calc.calcMarkerSize(trace, trace._rawLength);\n      var arrayPad = Array.isArray(ppad);\n\n      if (ppad && hasAnyBlanks[i] || arrayPad) {\n        var ppadRaw = ppad;\n        ppad = new Array(serieslen);\n\n        for (j = 0; j < serieslen; j++) {\n          ppad[j] = cd[j].gap ? 0 : arrayPad ? ppadRaw[cd[j].i] : ppadRaw;\n        }\n      }\n\n      var x = new Array(serieslen);\n      var y = new Array(serieslen);\n\n      for (j = 0; j < serieslen; j++) {\n        x[j] = cd[j].x;\n        y[j] = cd[j].y;\n      }\n\n      calc.calcAxisExpansion(gd, trace, xa, ya, x, y, ppad); // while we're here (in a loop over all traces in the stack)\n      // record the orientation, so hover can find it easily\n\n      cd[0].t.orientation = groupOpts.orientation;\n    }\n  }\n};\n\nfunction insertBlank(calcTrace, index, position, traceIndex, hasAnyBlanks, interpolate, posAttr) {\n  hasAnyBlanks[traceIndex] = true;\n  var newEntry = {\n    i: null,\n    gap: true,\n    s: 0\n  };\n  newEntry[posAttr] = position;\n  calcTrace.splice(index, 0, newEntry); // Even if we're not interpolating, if one trace has multiple\n  // values at the same position and this trace only has one value there,\n  // we just duplicate that one value rather than insert a zero.\n  // We also make it look like a real point - because it's ambiguous which\n  // one really is the real one!\n\n  if (index && position === calcTrace[index - 1][posAttr]) {\n    var prevEntry = calcTrace[index - 1];\n    newEntry.s = prevEntry.s; // TODO is it going to cause any problems to have multiple\n    // calcdata points with the same index?\n\n    newEntry.i = prevEntry.i;\n    newEntry.gap = prevEntry.gap;\n  } else if (interpolate) {\n    newEntry.s = getInterp(calcTrace, index, position, posAttr);\n  }\n\n  if (!index) {\n    // t and trace need to stay on the first cd entry\n    calcTrace[0].t = calcTrace[1].t;\n    calcTrace[0].trace = calcTrace[1].trace;\n    delete calcTrace[1].t;\n    delete calcTrace[1].trace;\n  }\n}\n\nfunction getInterp(calcTrace, index, position, posAttr) {\n  var pt0 = calcTrace[index - 1];\n  var pt1 = calcTrace[index + 1];\n  if (!pt1) return pt0.s;\n  if (!pt0) return pt1.s;\n  return pt0.s + (pt1.s - pt0.s) * (position - pt0[posAttr]) / (pt1[posAttr] - pt0[posAttr]);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar main = require('./plot_api');\n\nexports.plot = main.plot;\nexports.newPlot = main.newPlot;\nexports.restyle = main.restyle;\nexports.relayout = main.relayout;\nexports.redraw = main.redraw;\nexports.update = main.update;\nexports._guiRestyle = main._guiRestyle;\nexports._guiRelayout = main._guiRelayout;\nexports._guiUpdate = main._guiUpdate;\nexports._storeDirectGUIEdit = main._storeDirectGUIEdit;\nexports.react = main.react;\nexports.extendTraces = main.extendTraces;\nexports.prependTraces = main.prependTraces;\nexports.addTraces = main.addTraces;\nexports.deleteTraces = main.deleteTraces;\nexports.moveTraces = main.moveTraces;\nexports.purge = main.purge;\nexports.addFrames = main.addFrames;\nexports.deleteFrames = main.deleteFrames;\nexports.animate = main.animate;\nexports.setPlotConfig = main.setPlotConfig;\nexports.toImage = require('./to_image');\nexports.validate = require('./validate');\nexports.downloadImage = require('../snapshot/download');\n\nvar templateApi = require('./template_api');\n\nexports.makeTemplate = templateApi.makeTemplate;\nexports.validateTemplate = templateApi.validateTemplate;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar attributes = require('./attributes');\n\nvar name = 'images';\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut) {\n  var opts = {\n    name: name,\n    handleItemDefaults: imageDefaults\n  };\n  handleArrayContainerDefaults(layoutIn, layoutOut, opts);\n};\n\nfunction imageDefaults(imageIn, imageOut, fullLayout) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(imageIn, imageOut, attributes, attr, dflt);\n  }\n\n  var source = coerce('source');\n  var visible = coerce('visible', !!source);\n  if (!visible) return imageOut;\n  coerce('layer');\n  coerce('xanchor');\n  coerce('yanchor');\n  coerce('sizex');\n  coerce('sizey');\n  coerce('sizing');\n  coerce('opacity');\n  var gdMock = {\n    _fullLayout: fullLayout\n  };\n  var axLetters = ['x', 'y'];\n\n  for (var i = 0; i < 2; i++) {\n    // 'paper' is the fallback axref\n    var axLetter = axLetters[i];\n    var axRef = Axes.coerceRef(imageIn, imageOut, gdMock, axLetter, 'paper');\n\n    if (axRef !== 'paper') {\n      var ax = Axes.getFromId(gdMock, axRef);\n\n      ax._imgIndices.push(imageOut._index);\n    }\n\n    Axes.coercePosition(imageOut, gdMock, coerce, axRef, axLetter, 0);\n  }\n\n  return imageOut;\n}","var anObject = require('../internals/an-object');\nvar aFunction = require('../internals/a-function');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.github.io/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar axisIDs = require('../../plots/cartesian/axis_ids');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar constants = require('./constants');\n\nvar LINE_SPACING = require('../../constants/alignment').LINE_SPACING;\n\nvar name = constants.name;\n\nfunction isVisible(ax) {\n  var rangeSlider = ax && ax[name];\n  return rangeSlider && rangeSlider.visible;\n}\n\nexports.isVisible = isVisible;\n\nexports.makeData = function (fullLayout) {\n  var axes = axisIDs.list({\n    _fullLayout: fullLayout\n  }, 'x', true);\n  var margin = fullLayout.margin;\n  var rangeSliderData = [];\n\n  if (!fullLayout._has('gl2d')) {\n    for (var i = 0; i < axes.length; i++) {\n      var ax = axes[i];\n\n      if (isVisible(ax)) {\n        rangeSliderData.push(ax);\n        var opts = ax[name];\n        opts._id = name + ax._id;\n        opts._height = (fullLayout.height - margin.b - margin.t) * opts.thickness;\n        opts._offsetShift = Math.floor(opts.borderwidth / 2);\n      }\n    }\n  }\n\n  fullLayout._rangeSliderData = rangeSliderData;\n};\n\nexports.autoMarginOpts = function (gd, ax) {\n  var fullLayout = gd._fullLayout;\n  var opts = ax[name];\n\n  var axLetter = ax._id.charAt(0);\n\n  var bottomDepth = 0;\n  var titleHeight = 0;\n\n  if (ax.side === 'bottom') {\n    bottomDepth = ax._depth;\n\n    if (ax.title.text !== fullLayout._dfltTitle[axLetter]) {\n      // as in rangeslider/draw.js\n      titleHeight = 1.5 * ax.title.font.size + 10 + opts._offsetShift; // multi-line extra bump\n\n      var extraLines = (ax.title.text.match(svgTextUtils.BR_TAG_ALL) || []).length;\n      titleHeight += extraLines * ax.title.font.size * LINE_SPACING;\n    }\n  }\n\n  return {\n    x: 0,\n    y: ax._counterDomainMin,\n    l: 0,\n    r: 0,\n    t: 0,\n    b: opts._height + bottomDepth + Math.max(fullLayout.margin.b, titleHeight),\n    pad: constants.extraPad + opts._offsetShift * 2\n  };\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar listAxes = require('../../plots/cartesian/axis_ids').list;\n\nvar getAutoRange = require('../../plots/cartesian/autorange').getAutoRange;\n\nvar constants = require('./constants');\n\nmodule.exports = function calcAutorange(gd) {\n  var axes = listAxes(gd, 'x', true); // Compute new slider range using axis autorange if necessary.\n  //\n  // Copy back range to input range slider container to skip\n  // this step in subsequent draw calls.\n\n  for (var i = 0; i < axes.length; i++) {\n    var ax = axes[i];\n    var opts = ax[constants.name];\n\n    if (opts && opts.visible && opts.autorange) {\n      opts._input.autorange = true;\n      opts._input.range = opts.range = getAutoRange(gd, ax);\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar helpers = require('./helpers');\n\nfunction svgToImg(opts) {\n  var ev = opts.emitter || new EventEmitter();\n  var promise = new Promise(function (resolve, reject) {\n    var Image = window.Image;\n    var svg = opts.svg;\n    var format = opts.format || 'png'; // IE only support svg\n\n    if (Lib.isIE() && format !== 'svg') {\n      var ieSvgError = new Error(helpers.MSG_IE_BAD_FORMAT);\n      reject(ieSvgError); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        return ev.emit('error', ieSvgError);\n      } else {\n        return promise;\n      }\n    }\n\n    var canvas = opts.canvas;\n    var scale = opts.scale || 1;\n    var w0 = opts.width || 300;\n    var h0 = opts.height || 150;\n    var w1 = scale * w0;\n    var h1 = scale * h0;\n    var ctx = canvas.getContext('2d');\n    var img = new Image();\n    var svgBlob, url;\n\n    if (format === 'svg' || Lib.isIE9orBelow() || Lib.isSafari()) {\n      url = helpers.encodeSVG(svg);\n    } else {\n      svgBlob = helpers.createBlob(svg, 'svg');\n      url = helpers.createObjectURL(svgBlob);\n    }\n\n    canvas.width = w1;\n    canvas.height = h1;\n\n    img.onload = function () {\n      var imgData;\n      svgBlob = null;\n      helpers.revokeObjectURL(url); // don't need to draw to canvas if svg\n      //  save some time and also avoid failure on IE\n\n      if (format !== 'svg') {\n        ctx.drawImage(img, 0, 0, w1, h1);\n      }\n\n      switch (format) {\n        case 'jpeg':\n          imgData = canvas.toDataURL('image/jpeg');\n          break;\n\n        case 'png':\n          imgData = canvas.toDataURL('image/png');\n          break;\n\n        case 'webp':\n          imgData = canvas.toDataURL('image/webp');\n          break;\n\n        case 'svg':\n          imgData = url;\n          break;\n\n        default:\n          var errorMsg = 'Image format is not jpeg, png, svg or webp.';\n          reject(new Error(errorMsg)); // eventually remove the ev\n          //  in favor of promises\n\n          if (!opts.promise) {\n            return ev.emit('error', errorMsg);\n          }\n\n      }\n\n      resolve(imgData); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        ev.emit('success', imgData);\n      }\n    };\n\n    img.onerror = function (err) {\n      svgBlob = null;\n      helpers.revokeObjectURL(url);\n      reject(err); // eventually remove the ev\n      //  in favor of promises\n\n      if (!opts.promise) {\n        return ev.emit('error', err);\n      }\n    };\n\n    img.src = url;\n  }); // temporary for backward compatibility\n  //  move to only Promise in 2.0.0\n  //  and eliminate the EventEmitter\n\n  if (opts.promise) {\n    return promise;\n  }\n\n  return ev;\n}\n\nmodule.exports = svgToImg;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Color = require('../../components/color');\n\nvar hasColorscale = require('../../components/colorscale/helpers').hasColorscale;\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\n\nvar subTypes = require('./subtypes');\n/*\n * opts: object of flags to control features not all marker users support\n *   noLine: caller does not support marker lines\n *   gradient: caller supports gradients\n *   noSelect: caller does not support selected/unselected attribute containers\n */\n\n\nmodule.exports = function markerDefaults(traceIn, traceOut, defaultColor, layout, coerce, opts) {\n  var isBubble = subTypes.isBubble(traceIn);\n  var lineColor = (traceIn.line || {}).color;\n  var defaultMLC;\n  opts = opts || {}; // marker.color inherit from line.color (even if line.color is an array)\n\n  if (lineColor) defaultColor = lineColor;\n  coerce('marker.symbol');\n  coerce('marker.opacity', isBubble ? 0.7 : 1);\n  coerce('marker.size');\n  coerce('marker.color', defaultColor);\n\n  if (hasColorscale(traceIn, 'marker')) {\n    colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n      prefix: 'marker.',\n      cLetter: 'c'\n    });\n  }\n\n  if (!opts.noSelect) {\n    coerce('selected.marker.color');\n    coerce('unselected.marker.color');\n    coerce('selected.marker.size');\n    coerce('unselected.marker.size');\n  }\n\n  if (!opts.noLine) {\n    // if there's a line with a different color than the marker, use\n    // that line color as the default marker line color\n    // (except when it's an array)\n    // mostly this is for transparent markers to behave nicely\n    if (lineColor && !Array.isArray(lineColor) && traceOut.marker.color !== lineColor) {\n      defaultMLC = lineColor;\n    } else if (isBubble) defaultMLC = Color.background;else defaultMLC = Color.defaultLine;\n\n    coerce('marker.line.color', defaultMLC);\n\n    if (hasColorscale(traceIn, 'marker.line')) {\n      colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n        prefix: 'marker.line.',\n        cLetter: 'c'\n      });\n    }\n\n    coerce('marker.line.width', isBubble ? 1 : 0);\n  }\n\n  if (isBubble) {\n    coerce('marker.sizeref');\n    coerce('marker.sizemin');\n    coerce('marker.sizemode');\n  }\n\n  if (opts.gradient) {\n    var gradientType = coerce('marker.gradient.type');\n\n    if (gradientType !== 'none') {\n      coerce('marker.gradient.color');\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Drawing = require('../../components/drawing');\n\nvar Registry = require('../../registry');\n\nfunction style(gd) {\n  var s = d3.select(gd).selectAll('g.trace.scatter');\n  s.style('opacity', function (d) {\n    return d[0].trace.opacity;\n  });\n  s.selectAll('g.points').each(function (d) {\n    var sel = d3.select(this);\n    var trace = d.trace || d[0].trace;\n    stylePoints(sel, trace, gd);\n  });\n  s.selectAll('g.text').each(function (d) {\n    var sel = d3.select(this);\n    var trace = d.trace || d[0].trace;\n    styleText(sel, trace, gd);\n  });\n  s.selectAll('g.trace path.js-line').call(Drawing.lineGroupStyle);\n  s.selectAll('g.trace path.js-fill').call(Drawing.fillGroupStyle);\n  Registry.getComponentMethod('errorbars', 'style')(s);\n}\n\nfunction stylePoints(sel, trace, gd) {\n  Drawing.pointStyle(sel.selectAll('path.point'), trace, gd);\n}\n\nfunction styleText(sel, trace, gd) {\n  Drawing.textPointStyle(sel.selectAll('text'), trace, gd);\n}\n\nfunction styleOnSelect(gd, cd, sel) {\n  var trace = cd[0].trace;\n\n  if (trace.selectedpoints) {\n    Drawing.selectedPointStyle(sel.selectAll('path.point'), trace);\n    Drawing.selectedTextStyle(sel.selectAll('text'), trace);\n  } else {\n    stylePoints(sel, trace, gd);\n    styleText(sel, trace, gd);\n  }\n}\n\nmodule.exports = {\n  style: style,\n  stylePoints: stylePoints,\n  styleText: styleText,\n  styleOnSelect: styleOnSelect\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Polar = module.exports = require('./micropolar');\n\nPolar.manager = require('./micropolar_manager');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Drawing = require('../drawing');\n\nvar subTypes = require('../../traces/scatter/subtypes');\n\nmodule.exports = function plot(gd, traces, plotinfo, transitionOpts) {\n  var isNew;\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  var hasAnimation = transitionOpts && transitionOpts.duration > 0;\n  traces.each(function (d) {\n    var trace = d[0].trace; // || {} is in case the trace (specifically scatterternary)\n    // doesn't support error bars at all, but does go through\n    // the scatter.plot mechanics, which calls ErrorBars.plot\n    // internally\n\n    var xObj = trace.error_x || {};\n    var yObj = trace.error_y || {};\n    var keyFunc;\n\n    if (trace.ids) {\n      keyFunc = function keyFunc(d) {\n        return d.id;\n      };\n    }\n\n    var sparse = subTypes.hasMarkers(trace) && trace.marker.maxdisplayed > 0;\n    if (!yObj.visible && !xObj.visible) d = [];\n    var errorbars = d3.select(this).selectAll('g.errorbar').data(d, keyFunc);\n    errorbars.exit().remove();\n    if (!d.length) return;\n    if (!xObj.visible) errorbars.selectAll('path.xerror').remove();\n    if (!yObj.visible) errorbars.selectAll('path.yerror').remove();\n    errorbars.style('opacity', 1);\n    var enter = errorbars.enter().append('g').classed('errorbar', true);\n\n    if (hasAnimation) {\n      enter.style('opacity', 0).transition().duration(transitionOpts.duration).style('opacity', 1);\n    }\n\n    Drawing.setClipUrl(errorbars, plotinfo.layerClipId, gd);\n    errorbars.each(function (d) {\n      var errorbar = d3.select(this);\n      var coords = errorCoords(d, xa, ya);\n      if (sparse && !d.vis) return;\n      var path;\n      var yerror = errorbar.select('path.yerror');\n\n      if (yObj.visible && isNumeric(coords.x) && isNumeric(coords.yh) && isNumeric(coords.ys)) {\n        var yw = yObj.width;\n        path = 'M' + (coords.x - yw) + ',' + coords.yh + 'h' + 2 * yw + // hat\n        'm-' + yw + ',0V' + coords.ys; // bar\n\n        if (!coords.noYS) path += 'm-' + yw + ',0h' + 2 * yw; // shoe\n\n        isNew = !yerror.size();\n\n        if (isNew) {\n          yerror = errorbar.append('path').style('vector-effect', 'non-scaling-stroke').classed('yerror', true);\n        } else if (hasAnimation) {\n          yerror = yerror.transition().duration(transitionOpts.duration).ease(transitionOpts.easing);\n        }\n\n        yerror.attr('d', path);\n      } else yerror.remove();\n\n      var xerror = errorbar.select('path.xerror');\n\n      if (xObj.visible && isNumeric(coords.y) && isNumeric(coords.xh) && isNumeric(coords.xs)) {\n        var xw = (xObj.copy_ystyle ? yObj : xObj).width;\n        path = 'M' + coords.xh + ',' + (coords.y - xw) + 'v' + 2 * xw + // hat\n        'm0,-' + xw + 'H' + coords.xs; // bar\n\n        if (!coords.noXS) path += 'm0,-' + xw + 'v' + 2 * xw; // shoe\n\n        isNew = !xerror.size();\n\n        if (isNew) {\n          xerror = errorbar.append('path').style('vector-effect', 'non-scaling-stroke').classed('xerror', true);\n        } else if (hasAnimation) {\n          xerror = xerror.transition().duration(transitionOpts.duration).ease(transitionOpts.easing);\n        }\n\n        xerror.attr('d', path);\n      } else xerror.remove();\n    });\n  });\n}; // compute the coordinates of the error-bar objects\n\n\nfunction errorCoords(d, xa, ya) {\n  var out = {\n    x: xa.c2p(d.x),\n    y: ya.c2p(d.y)\n  }; // calculate the error bar size and hat and shoe locations\n\n  if (d.yh !== undefined) {\n    out.yh = ya.c2p(d.yh);\n    out.ys = ya.c2p(d.ys); // if the shoes go off-scale (ie log scale, error bars past zero)\n    // clip the bar and hide the shoes\n\n    if (!isNumeric(out.ys)) {\n      out.noYS = true;\n      out.ys = ya.c2p(d.ys, true);\n    }\n  }\n\n  if (d.xh !== undefined) {\n    out.xh = xa.c2p(d.xh);\n    out.xs = xa.c2p(d.xs);\n\n    if (!isNumeric(out.xs)) {\n      out.noXS = true;\n      out.xs = xa.c2p(d.xs, true);\n    }\n  }\n\n  return out;\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar attributes = require('./attributes');\n\nvar helpers = require('./helpers');\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut) {\n  handleArrayContainerDefaults(layoutIn, layoutOut, {\n    name: 'shapes',\n    handleItemDefaults: handleShapeDefaults\n  });\n};\n\nfunction handleShapeDefaults(shapeIn, shapeOut, fullLayout) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(shapeIn, shapeOut, attributes, attr, dflt);\n  }\n\n  var visible = coerce('visible');\n  if (!visible) return;\n  var path = coerce('path');\n  var dfltType = path ? 'path' : 'rect';\n  var shapeType = coerce('type', dfltType);\n  if (shapeOut.type !== 'path') delete shapeOut.path;\n  coerce('editable');\n  coerce('layer');\n  coerce('opacity');\n  coerce('fillcolor');\n  coerce('fillrule');\n  var lineWidth = coerce('line.width');\n\n  if (lineWidth) {\n    coerce('line.color');\n    coerce('line.dash');\n  }\n\n  var xSizeMode = coerce('xsizemode');\n  var ySizeMode = coerce('ysizemode'); // positioning\n\n  var axLetters = ['x', 'y'];\n\n  for (var i = 0; i < 2; i++) {\n    var axLetter = axLetters[i];\n    var attrAnchor = axLetter + 'anchor';\n    var sizeMode = axLetter === 'x' ? xSizeMode : ySizeMode;\n    var gdMock = {\n      _fullLayout: fullLayout\n    };\n    var ax;\n    var pos2r;\n    var r2pos; // xref, yref\n\n    var axRef = Axes.coerceRef(shapeIn, shapeOut, gdMock, axLetter, '', 'paper');\n\n    if (axRef !== 'paper') {\n      ax = Axes.getFromId(gdMock, axRef);\n\n      ax._shapeIndices.push(shapeOut._index);\n\n      r2pos = helpers.rangeToShapePosition(ax);\n      pos2r = helpers.shapePositionToRange(ax);\n    } else {\n      pos2r = r2pos = Lib.identity;\n    } // Coerce x0, x1, y0, y1\n\n\n    if (shapeType !== 'path') {\n      var dflt0 = 0.25;\n      var dflt1 = 0.75; // hack until V2.0 when log has regular range behavior - make it look like other\n      // ranges to send to coerce, then put it back after\n      // this is all to give reasonable default position behavior on log axes, which is\n      // a pretty unimportant edge case so we could just ignore this.\n\n      var attr0 = axLetter + '0';\n      var attr1 = axLetter + '1';\n      var in0 = shapeIn[attr0];\n      var in1 = shapeIn[attr1];\n      shapeIn[attr0] = pos2r(shapeIn[attr0], true);\n      shapeIn[attr1] = pos2r(shapeIn[attr1], true);\n\n      if (sizeMode === 'pixel') {\n        coerce(attr0, 0);\n        coerce(attr1, 10);\n      } else {\n        Axes.coercePosition(shapeOut, gdMock, coerce, axRef, attr0, dflt0);\n        Axes.coercePosition(shapeOut, gdMock, coerce, axRef, attr1, dflt1);\n      } // hack part 2\n\n\n      shapeOut[attr0] = r2pos(shapeOut[attr0]);\n      shapeOut[attr1] = r2pos(shapeOut[attr1]);\n      shapeIn[attr0] = in0;\n      shapeIn[attr1] = in1;\n    } // Coerce xanchor and yanchor\n\n\n    if (sizeMode === 'pixel') {\n      // Hack for log axis described above\n      var inAnchor = shapeIn[attrAnchor];\n      shapeIn[attrAnchor] = pos2r(shapeIn[attrAnchor], true);\n      Axes.coercePosition(shapeOut, gdMock, coerce, axRef, attrAnchor, 0.25); // Hack part 2\n\n      shapeOut[attrAnchor] = r2pos(shapeOut[attrAnchor]);\n      shapeIn[attrAnchor] = inAnchor;\n    }\n  }\n\n  if (shapeType === 'path') {\n    coerce('path');\n  } else {\n    Lib.noneOrAll(shapeIn, shapeOut, ['x0', 'x1', 'y0', 'y1']);\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict'; // package version injected by `npm run preprocess`\n\nexports.version = '1.54.7';","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  // not really a 'subplot' attribute container,\n  // but this is the flag we use to denote attributes that\n  // support yaxis, yaxis2, yaxis3, ... counters\n  _isSubplotObj: true,\n  rangemode: {\n    valType: 'enumerated',\n    values: ['auto', 'fixed', 'match'],\n    dflt: 'match',\n    role: 'style',\n    editType: 'calc',\n    description: ['Determines whether or not the range of this axis in', 'the rangeslider use the same value than in the main plot', 'when zooming in/out.', 'If *auto*, the autorange will be used.', 'If *fixed*, the `range` is used.', 'If *match*, the current range of the corresponding y-axis on the main subplot is used.'].join(' ')\n  },\n  range: {\n    valType: 'info_array',\n    role: 'style',\n    items: [{\n      valType: 'any',\n      editType: 'plot'\n    }, {\n      valType: 'any',\n      editType: 'plot'\n    }],\n    editType: 'plot',\n    description: ['Sets the range of this axis for the rangeslider.'].join(' ')\n  },\n  editType: 'calc'\n};","module.exports = fromQuat;\n/**\n * Creates a matrix from a quaternion rotation.\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @returns {mat4} out\n */\n\nfunction fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3],\n      x2 = x + x,\n      y2 = y + y,\n      z2 = z + z,\n      xx = x * x2,\n      yx = y * x2,\n      yy = y * y2,\n      zx = z * x2,\n      zy = z * y2,\n      zz = z * z2,\n      wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isArrayOrTypedArray = require('../../lib').isArrayOrTypedArray;\n\nvar hasColorscale = require('../../components/colorscale/helpers').hasColorscale;\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\n\nmodule.exports = function lineDefaults(traceIn, traceOut, defaultColor, layout, coerce, opts) {\n  var markerColor = (traceIn.marker || {}).color;\n  coerce('line.color', defaultColor);\n\n  if (hasColorscale(traceIn, 'line')) {\n    colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n      prefix: 'line.',\n      cLetter: 'c'\n    });\n  } else {\n    var lineColorDflt = (isArrayOrTypedArray(markerColor) ? false : markerColor) || defaultColor;\n    coerce('line.color', lineColorDflt);\n  }\n\n  coerce('line.width');\n  if (!(opts || {}).noDash) coerce('line.dash');\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Color = require('../color');\n\nvar ARROWPATHS = require('./arrow_paths');\n/**\n * Add arrowhead(s) to a path or line element\n *\n * @param {d3.selection} el3: a d3-selected line or path element\n *\n * @param {string} ends: 'none', 'start', 'end', or 'start+end' for which ends get arrowheads\n *\n * @param {object} options: style information. Must have all the following:\n * @param {number} options.arrowhead: end head style - see ./arrow_paths\n * @param {number} options.startarrowhead: start head style - see ./arrow_paths\n * @param {number} options.arrowsize: relative size of the end head vs line width\n * @param {number} options.startarrowsize: relative size of the start head vs line width\n * @param {number} options.standoff: distance in px to move the end arrow point from its target\n * @param {number} options.startstandoff: distance in px to move the start arrow point from its target\n * @param {number} options.arrowwidth: width of the arrow line\n * @param {string} options.arrowcolor: color of the arrow line, for the head to match\n *     Note that the opacity of this color is ignored, as it's assumed the container\n *     of both the line and head has opacity applied to it so there isn't greater opacity\n *     where they overlap.\n */\n\n\nmodule.exports = function drawArrowHead(el3, ends, options) {\n  var el = el3.node();\n  var headStyle = ARROWPATHS[options.arrowhead || 0];\n  var startHeadStyle = ARROWPATHS[options.startarrowhead || 0];\n  var scale = (options.arrowwidth || 1) * (options.arrowsize || 1);\n  var startScale = (options.arrowwidth || 1) * (options.startarrowsize || 1);\n  var doStart = ends.indexOf('start') >= 0;\n  var doEnd = ends.indexOf('end') >= 0;\n  var backOff = headStyle.backoff * scale + options.standoff;\n  var startBackOff = startHeadStyle.backoff * startScale + options.startstandoff;\n  var start, end, startRot, endRot;\n\n  if (el.nodeName === 'line') {\n    start = {\n      x: +el3.attr('x1'),\n      y: +el3.attr('y1')\n    };\n    end = {\n      x: +el3.attr('x2'),\n      y: +el3.attr('y2')\n    };\n    var dx = start.x - end.x;\n    var dy = start.y - end.y;\n    startRot = Math.atan2(dy, dx);\n    endRot = startRot + Math.PI;\n\n    if (backOff && startBackOff) {\n      if (backOff + startBackOff > Math.sqrt(dx * dx + dy * dy)) {\n        hideLine();\n        return;\n      }\n    }\n\n    if (backOff) {\n      if (backOff * backOff > dx * dx + dy * dy) {\n        hideLine();\n        return;\n      }\n\n      var backOffX = backOff * Math.cos(startRot);\n      var backOffY = backOff * Math.sin(startRot);\n      end.x += backOffX;\n      end.y += backOffY;\n      el3.attr({\n        x2: end.x,\n        y2: end.y\n      });\n    }\n\n    if (startBackOff) {\n      if (startBackOff * startBackOff > dx * dx + dy * dy) {\n        hideLine();\n        return;\n      }\n\n      var startBackOffX = startBackOff * Math.cos(startRot);\n      var startbackOffY = startBackOff * Math.sin(startRot);\n      start.x -= startBackOffX;\n      start.y -= startbackOffY;\n      el3.attr({\n        x1: start.x,\n        y1: start.y\n      });\n    }\n  } else if (el.nodeName === 'path') {\n    var pathlen = el.getTotalLength(); // using dash to hide the backOff region of the path.\n    // if we ever allow dash for the arrow we'll have to\n    // do better than this hack... maybe just manually\n    // combine the two\n\n    var dashArray = '';\n\n    if (pathlen < backOff + startBackOff) {\n      hideLine();\n      return;\n    }\n\n    var start0 = el.getPointAtLength(0);\n    var dstart = el.getPointAtLength(0.1);\n    startRot = Math.atan2(start0.y - dstart.y, start0.x - dstart.x);\n    start = el.getPointAtLength(Math.min(startBackOff, pathlen));\n    dashArray = '0px,' + startBackOff + 'px,';\n    var end0 = el.getPointAtLength(pathlen);\n    var dend = el.getPointAtLength(pathlen - 0.1);\n    endRot = Math.atan2(end0.y - dend.y, end0.x - dend.x);\n    end = el.getPointAtLength(Math.max(0, pathlen - backOff));\n    var shortening = dashArray ? startBackOff + backOff : backOff;\n    dashArray += pathlen - shortening + 'px,' + pathlen + 'px';\n    el3.style('stroke-dasharray', dashArray);\n  }\n\n  function hideLine() {\n    el3.style('stroke-dasharray', '0px,100px');\n  }\n\n  function drawhead(arrowHeadStyle, p, rot, arrowScale) {\n    if (!arrowHeadStyle.path) return;\n    if (arrowHeadStyle.noRotate) rot = 0;\n    d3.select(el.parentNode).append('path').attr({\n      'class': el3.attr('class'),\n      d: arrowHeadStyle.path,\n      transform: 'translate(' + p.x + ',' + p.y + ')' + (rot ? 'rotate(' + rot * 180 / Math.PI + ')' : '') + 'scale(' + arrowScale + ')'\n    }).style({\n      fill: Color.rgb(options.arrowcolor),\n      'stroke-width': 0\n    });\n  }\n\n  if (doStart) drawhead(startHeadStyle, start, startRot, startScale);\n  if (doEnd) drawhead(headStyle, end, endRot, scale);\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar subtypes = require('./subtypes');\n\nmodule.exports = {\n  hasLines: subtypes.hasLines,\n  hasMarkers: subtypes.hasMarkers,\n  hasText: subtypes.hasText,\n  isBubble: subtypes.isBubble,\n  attributes: require('./attributes'),\n  supplyDefaults: require('./defaults'),\n  crossTraceDefaults: require('./cross_trace_defaults'),\n  calc: require('./calc').calc,\n  crossTraceCalc: require('./cross_trace_calc'),\n  arraysToCalcdata: require('./arrays_to_calcdata'),\n  plot: require('./plot'),\n  colorbar: require('./marker_colorbar'),\n  formatLabels: require('./format_labels'),\n  style: require('./style').style,\n  styleOnSelect: require('./style').styleOnSelect,\n  hoverPoints: require('./hover'),\n  selectPoints: require('./select'),\n  animatable: true,\n  moduleType: 'trace',\n  name: 'scatter',\n  basePlotModule: require('../../plots/cartesian'),\n  categories: ['cartesian', 'svg', 'symbols', 'errorBarsOK', 'showLegend', 'scatter-like', 'zoomScale'],\n  meta: {\n    description: ['The scatter trace type encompasses line charts, scatter charts, text charts, and bubble charts.', 'The data visualized as scatter point or lines is set in `x` and `y`.', 'Text (appearing either on the chart or on hover only) is via `text`.', 'Bubble charts are achieved by setting `marker.size` and/or `marker.color`', 'to numerical arrays.'].join(' ')\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar toLogRange = require('../../lib/to_log_range');\n/*\n * convertCoords: when converting an axis between log and linear\n * you need to alter any images on that axis to keep them\n * pointing at the same data point.\n * In v2.0 this will become obsolete (or perhaps size will still need conversion?)\n * we convert size by declaring that the maximum extent *in data units* should be\n * the same, assuming the image is anchored by its center (could remove that restriction\n * if we think it's important) even though the actual left and right values will not be\n * quite the same since the scale becomes nonlinear (and central anchor means the pixel\n * center of the image, not the data units center)\n *\n * gd: the plot div\n * ax: the axis being changed\n * newType: the type it's getting\n * doExtra: function(attr, val) from inside relayout that sets the attribute.\n *     Use this to make the changes as it's aware if any other changes in the\n *     same relayout call should override this conversion.\n */\n\n\nmodule.exports = function convertCoords(gd, ax, newType, doExtra) {\n  ax = ax || {};\n  var toLog = newType === 'log' && ax.type === 'linear';\n  var fromLog = newType === 'linear' && ax.type === 'log';\n  if (!(toLog || fromLog)) return;\n  var images = gd._fullLayout.images;\n\n  var axLetter = ax._id.charAt(0);\n\n  var image;\n  var attrPrefix;\n\n  for (var i = 0; i < images.length; i++) {\n    image = images[i];\n    attrPrefix = 'images[' + i + '].';\n\n    if (image[axLetter + 'ref'] === ax._id) {\n      var currentPos = image[axLetter];\n      var currentSize = image['size' + axLetter];\n      var newPos = null;\n      var newSize = null;\n\n      if (toLog) {\n        newPos = toLogRange(currentPos, ax.range); // this is the inverse of the conversion we do in fromLog below\n        // so that the conversion is reversible (notice the fromLog conversion\n        // is like sinh, and this one looks like arcsinh)\n\n        var dx = currentSize / Math.pow(10, newPos) / 2;\n        newSize = 2 * Math.log(dx + Math.sqrt(1 + dx * dx)) / Math.LN10;\n      } else {\n        newPos = Math.pow(10, currentPos);\n        newSize = newPos * (Math.pow(10, currentSize / 2) - Math.pow(10, -currentSize / 2));\n      } // if conversion failed, delete the value so it can get a default later on\n\n\n      if (!isNumeric(newPos)) {\n        newPos = null;\n        newSize = null;\n      } else if (!isNumeric(newSize)) newSize = null;\n\n      doExtra(attrPrefix + axLetter, newPos);\n      doExtra(attrPrefix + 'size' + axLetter, newSize);\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar perStackAttrs = ['orientation', 'groupnorm', 'stackgaps'];\n\nmodule.exports = function handleStackDefaults(traceIn, traceOut, layout, coerce) {\n  var stackOpts = layout._scatterStackOpts;\n  var stackGroup = coerce('stackgroup');\n\n  if (stackGroup) {\n    // use independent stacking options per subplot\n    var subplot = traceOut.xaxis + traceOut.yaxis;\n    var subplotStackOpts = stackOpts[subplot];\n    if (!subplotStackOpts) subplotStackOpts = stackOpts[subplot] = {};\n    var groupOpts = subplotStackOpts[stackGroup];\n    var firstTrace = false;\n\n    if (groupOpts) {\n      groupOpts.traces.push(traceOut);\n    } else {\n      groupOpts = subplotStackOpts[stackGroup] = {\n        // keep track of trace indices for use during stacking calculations\n        // this will be filled in during `calc` and used during `crossTraceCalc`\n        // so it's OK if we don't recreate it during a non-calc edit\n        traceIndices: [],\n        // Hold on to the whole set of prior traces\n        // First one is most important, so we can clear defaults\n        // there if we find explicit values only in later traces.\n        // We're only going to *use* the values stored in groupOpts,\n        // but for the editor and validate we want things self-consistent\n        // The full set of traces is used only to fix `fill` default if\n        // we find `orientation: 'h'` beyond the first trace\n        traces: [traceOut]\n      };\n      firstTrace = true;\n    } // TODO: how is this going to work with groupby transforms?\n    // in principle it should be OK I guess, as long as explicit group styles\n    // don't override explicit base-trace styles?\n\n\n    var dflts = {\n      orientation: traceOut.x && !traceOut.y ? 'h' : 'v'\n    };\n\n    for (var i = 0; i < perStackAttrs.length; i++) {\n      var attr = perStackAttrs[i];\n      var attrFound = attr + 'Found';\n\n      if (!groupOpts[attrFound]) {\n        var traceHasAttr = traceIn[attr] !== undefined;\n        var isOrientation = attr === 'orientation';\n\n        if (traceHasAttr || firstTrace) {\n          groupOpts[attr] = coerce(attr, dflts[attr]);\n\n          if (isOrientation) {\n            groupOpts.fillDflt = groupOpts[attr] === 'h' ? 'tonextx' : 'tonexty';\n          }\n\n          if (traceHasAttr) {\n            // Note: this will show a value here even if it's invalid\n            // in which case it will revert to default.\n            groupOpts[attrFound] = true; // Note: only one trace in the stack will get a _fullData\n            // entry for a given stack-wide attribute. If no traces\n            // (or the first trace) specify that attribute, the\n            // first trace will get it. If the first trace does NOT\n            // specify it but some later trace does, then it gets\n            // removed from the first trace and only included in the\n            // one that specified it. This is mostly important for\n            // editors (that want to see the full values to know\n            // what settings are available) and Plotly.react diffing.\n            // Editors may want to use fullLayout._scatterStackOpts\n            // directly and make these settings available from all\n            // traces in the stack... then set the new value into\n            // the first trace, and clear all later traces.\n\n            if (!firstTrace) {\n              delete groupOpts.traces[0][attr]; // orientation can affect default fill of previous traces\n\n              if (isOrientation) {\n                for (var j = 0; j < groupOpts.traces.length - 1; j++) {\n                  var trace2 = groupOpts.traces[j];\n\n                  if (trace2._input.fill !== trace2.fill) {\n                    trace2.fill = groupOpts.fillDflt;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return groupOpts;\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Template = require('../../plot_api/plot_template');\n\nvar axisIds = require('../../plots/cartesian/axis_ids');\n\nvar attributes = require('./attributes');\n\nvar oppAxisAttrs = require('./oppaxis_attributes');\n\nmodule.exports = function handleDefaults(layoutIn, layoutOut, axName) {\n  var axIn = layoutIn[axName];\n  var axOut = layoutOut[axName];\n  if (!(axIn.rangeslider || layoutOut._requestRangeslider[axOut._id])) return; // not super proud of this (maybe store _ in axis object instead\n\n  if (!Lib.isPlainObject(axIn.rangeslider)) {\n    axIn.rangeslider = {};\n  }\n\n  var containerIn = axIn.rangeslider;\n  var containerOut = Template.newContainer(axOut, 'rangeslider');\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(containerIn, containerOut, attributes, attr, dflt);\n  }\n\n  var rangeContainerIn, rangeContainerOut;\n\n  function coerceRange(attr, dflt) {\n    return Lib.coerce(rangeContainerIn, rangeContainerOut, oppAxisAttrs, attr, dflt);\n  }\n\n  var visible = coerce('visible');\n  if (!visible) return;\n  coerce('bgcolor', layoutOut.plot_bgcolor);\n  coerce('bordercolor');\n  coerce('borderwidth');\n  coerce('thickness');\n  coerce('autorange', !axOut.isValidRange(containerIn.range));\n  coerce('range');\n  var subplots = layoutOut._subplots;\n\n  if (subplots) {\n    var yIds = subplots.cartesian.filter(function (subplotId) {\n      return subplotId.substr(0, subplotId.indexOf('y')) === axisIds.name2id(axName);\n    }).map(function (subplotId) {\n      return subplotId.substr(subplotId.indexOf('y'), subplotId.length);\n    });\n    var yNames = Lib.simpleMap(yIds, axisIds.id2name);\n\n    for (var i = 0; i < yNames.length; i++) {\n      var yName = yNames[i];\n      rangeContainerIn = containerIn[yName] || {};\n      rangeContainerOut = Template.newContainer(containerOut, yName, 'yaxis');\n      var yAxOut = layoutOut[yName];\n      var rangemodeDflt;\n\n      if (rangeContainerIn.range && yAxOut.isValidRange(rangeContainerIn.range)) {\n        rangemodeDflt = 'fixed';\n      }\n\n      var rangeMode = coerceRange('rangemode', rangemodeDflt);\n\n      if (rangeMode !== 'match') {\n        coerceRange('range', yAxOut.range.slice());\n      }\n    }\n  } // to map back range slider (auto) range\n\n\n  containerOut._input = containerIn;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar BADNUM = require('../../constants/numerical').BADNUM;\n\nvar subTypes = require('./subtypes');\n\nvar calcColorscale = require('./colorscale_calc');\n\nvar arraysToCalcdata = require('./arrays_to_calcdata');\n\nvar calcSelection = require('./calc_selection');\n\nfunction calc(gd, trace) {\n  var fullLayout = gd._fullLayout;\n  var xa = Axes.getFromId(gd, trace.xaxis || 'x');\n  var ya = Axes.getFromId(gd, trace.yaxis || 'y');\n  var x = xa.makeCalcdata(trace, 'x');\n  var y = ya.makeCalcdata(trace, 'y');\n  var serieslen = trace._length;\n  var cd = new Array(serieslen);\n  var ids = trace.ids;\n  var stackGroupOpts = getStackOpts(trace, fullLayout, xa, ya);\n  var interpolateGaps = false;\n  var isV, i, j, k, interpolate, vali;\n  setFirstScatter(fullLayout, trace);\n  var xAttr = 'x';\n  var yAttr = 'y';\n  var posAttr;\n\n  if (stackGroupOpts) {\n    Lib.pushUnique(stackGroupOpts.traceIndices, trace._expandedIndex);\n    isV = stackGroupOpts.orientation === 'v'; // size, like we use for bar\n\n    if (isV) {\n      yAttr = 's';\n      posAttr = 'x';\n    } else {\n      xAttr = 's';\n      posAttr = 'y';\n    }\n\n    interpolate = stackGroupOpts.stackgaps === 'interpolate';\n  } else {\n    var ppad = calcMarkerSize(trace, serieslen);\n    calcAxisExpansion(gd, trace, xa, ya, x, y, ppad);\n  }\n\n  for (i = 0; i < serieslen; i++) {\n    var cdi = cd[i] = {};\n    var xValid = isNumeric(x[i]);\n    var yValid = isNumeric(y[i]);\n\n    if (xValid && yValid) {\n      cdi[xAttr] = x[i];\n      cdi[yAttr] = y[i];\n    } else if (stackGroupOpts && (isV ? xValid : yValid)) {\n      // if we're stacking we need to hold on to all valid positions\n      // even with invalid sizes\n      cdi[posAttr] = isV ? x[i] : y[i];\n      cdi.gap = true;\n\n      if (interpolate) {\n        cdi.s = BADNUM;\n        interpolateGaps = true;\n      } else {\n        cdi.s = 0;\n      }\n    } else {\n      cdi[xAttr] = cdi[yAttr] = BADNUM;\n    }\n\n    if (ids) {\n      cdi.id = String(ids[i]);\n    }\n  }\n\n  arraysToCalcdata(cd, trace);\n  calcColorscale(gd, trace);\n  calcSelection(cd, trace);\n\n  if (stackGroupOpts) {\n    // remove bad positions and sort\n    // note that original indices get added to cd in arraysToCalcdata\n    i = 0;\n\n    while (i < cd.length) {\n      if (cd[i][posAttr] === BADNUM) {\n        cd.splice(i, 1);\n      } else i++;\n    }\n\n    Lib.sort(cd, function (a, b) {\n      return a[posAttr] - b[posAttr] || a.i - b.i;\n    });\n\n    if (interpolateGaps) {\n      // first fill the beginning with constant from the first point\n      i = 0;\n\n      while (i < cd.length - 1 && cd[i].gap) {\n        i++;\n      }\n\n      vali = cd[i].s;\n      if (!vali) vali = cd[i].s = 0; // in case of no data AT ALL in this trace - use 0\n\n      for (j = 0; j < i; j++) {\n        cd[j].s = vali;\n      } // then fill the end with constant from the last point\n\n\n      k = cd.length - 1;\n\n      while (k > i && cd[k].gap) {\n        k--;\n      }\n\n      vali = cd[k].s;\n\n      for (j = cd.length - 1; j > k; j--) {\n        cd[j].s = vali;\n      } // now interpolate internal gaps linearly\n\n\n      while (i < k) {\n        i++;\n\n        if (cd[i].gap) {\n          j = i + 1;\n\n          while (cd[j].gap) {\n            j++;\n          }\n\n          var pos0 = cd[i - 1][posAttr];\n          var size0 = cd[i - 1].s;\n          var m = (cd[j].s - size0) / (cd[j][posAttr] - pos0);\n\n          while (i < j) {\n            cd[i].s = size0 + (cd[i][posAttr] - pos0) * m;\n            i++;\n          }\n        }\n      }\n    }\n  }\n\n  return cd;\n}\n\nfunction calcAxisExpansion(gd, trace, xa, ya, x, y, ppad) {\n  var serieslen = trace._length;\n  var fullLayout = gd._fullLayout;\n  var xId = xa._id;\n  var yId = ya._id;\n  var firstScatter = fullLayout._firstScatter[firstScatterGroup(trace)] === trace.uid;\n  var stackOrientation = (getStackOpts(trace, fullLayout, xa, ya) || {}).orientation;\n  var fill = trace.fill; // cancel minimum tick spacings (only applies to bars and boxes)\n\n  xa._minDtick = 0;\n  ya._minDtick = 0; // check whether bounds should be tight, padded, extended to zero...\n  // most cases both should be padded on both ends, so start with that.\n\n  var xOptions = {\n    padded: true\n  };\n  var yOptions = {\n    padded: true\n  };\n\n  if (ppad) {\n    xOptions.ppad = yOptions.ppad = ppad;\n  } // TODO: text size\n\n\n  var openEnded = serieslen < 2 || x[0] !== x[serieslen - 1] || y[0] !== y[serieslen - 1];\n\n  if (openEnded && (fill === 'tozerox' || fill === 'tonextx' && (firstScatter || stackOrientation === 'h'))) {\n    // include zero (tight) and extremes (padded) if fill to zero\n    // (unless the shape is closed, then it's just filling the shape regardless)\n    xOptions.tozero = true;\n  } else if (!(trace.error_y || {}).visible && ( // if no error bars, markers or text, or fill to y=0 remove x padding\n  fill === 'tonexty' || fill === 'tozeroy' || !subTypes.hasMarkers(trace) && !subTypes.hasText(trace))) {\n    xOptions.padded = false;\n    xOptions.ppad = 0;\n  }\n\n  if (openEnded && (fill === 'tozeroy' || fill === 'tonexty' && (firstScatter || stackOrientation === 'v'))) {\n    // now check for y - rather different logic, though still mostly padded both ends\n    // include zero (tight) and extremes (padded) if fill to zero\n    // (unless the shape is closed, then it's just filling the shape regardless)\n    yOptions.tozero = true;\n  } else if (fill === 'tonextx' || fill === 'tozerox') {\n    // tight y: any x fill\n    yOptions.padded = false;\n  } // N.B. asymmetric splom traces call this with blank {} xa or ya\n\n\n  if (xId) trace._extremes[xId] = Axes.findExtremes(xa, x, xOptions);\n  if (yId) trace._extremes[yId] = Axes.findExtremes(ya, y, yOptions);\n}\n\nfunction calcMarkerSize(trace, serieslen) {\n  if (!subTypes.hasMarkers(trace)) return; // Treat size like x or y arrays --- Run d2c\n  // this needs to go before ppad computation\n\n  var marker = trace.marker;\n  var sizeref = 1.6 * (trace.marker.sizeref || 1);\n  var markerTrans;\n\n  if (trace.marker.sizemode === 'area') {\n    markerTrans = function markerTrans(v) {\n      return Math.max(Math.sqrt((v || 0) / sizeref), 3);\n    };\n  } else {\n    markerTrans = function markerTrans(v) {\n      return Math.max((v || 0) / sizeref, 3);\n    };\n  }\n\n  if (Lib.isArrayOrTypedArray(marker.size)) {\n    // I tried auto-type but category and dates dont make much sense.\n    var ax = {\n      type: 'linear'\n    };\n    Axes.setConvert(ax);\n    var s = ax.makeCalcdata(trace.marker, 'size');\n    var sizeOut = new Array(serieslen);\n\n    for (var i = 0; i < serieslen; i++) {\n      sizeOut[i] = markerTrans(s[i]);\n    }\n\n    return sizeOut;\n  } else {\n    return markerTrans(marker.size);\n  }\n}\n/**\n * mark the first scatter trace for each subplot\n * note that scatter and scattergl each get their own first trace\n * note also that I'm doing this during calc rather than supplyDefaults\n * so I don't need to worry about transforms, but if we ever do\n * per-trace calc this will get confused.\n */\n\n\nfunction setFirstScatter(fullLayout, trace) {\n  var group = firstScatterGroup(trace);\n  var firstScatter = fullLayout._firstScatter;\n  if (!firstScatter[group]) firstScatter[group] = trace.uid;\n}\n\nfunction firstScatterGroup(trace) {\n  var stackGroup = trace.stackgroup;\n  return trace.xaxis + trace.yaxis + trace.type + (stackGroup ? '-' + stackGroup : '');\n}\n\nfunction getStackOpts(trace, fullLayout, xa, ya) {\n  var stackGroup = trace.stackgroup;\n  if (!stackGroup) return;\n  var stackOpts = fullLayout._scatterStackOpts[xa._id + ya._id][stackGroup];\n  var stackAx = stackOpts.orientation === 'v' ? ya : xa; // Allow stacking only on numeric axes\n  // calc is a little late to be figuring this out, but during supplyDefaults\n  // we don't know the axis type yet\n\n  if (stackAx.type === 'linear' || stackAx.type === 'log') return stackOpts;\n}\n\nmodule.exports = {\n  calc: calc,\n  calcMarkerSize: calcMarkerSize,\n  calcAxisExpansion: calcAxisExpansion,\n  setFirstScatter: setFirstScatter,\n  getStackOpts: getStackOpts\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar drawModule = require('./draw');\n\nvar clickModule = require('./click');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'annotations',\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  includeBasePlot: require('../../plots/cartesian/include_components')('annotations'),\n  calcAutorange: require('./calc_autorange'),\n  draw: drawModule.draw,\n  drawOne: drawModule.drawOne,\n  drawRaw: drawModule.drawRaw,\n  hasClickToShow: clickModule.hasClickToShow,\n  onClick: clickModule.onClick,\n  convertCoords: require('./convert_coords')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar handleArrayContainerDefaults = require('../array_container_defaults');\n\nvar layoutAttributes = require('./layout_attributes');\n\nvar handleTickValueDefaults = require('./tick_value_defaults');\n\nvar handleTickMarkDefaults = require('./tick_mark_defaults');\n\nvar handleTickLabelDefaults = require('./tick_label_defaults');\n\nvar handleCategoryOrderDefaults = require('./category_order_defaults');\n\nvar handleLineGridDefaults = require('./line_grid_defaults');\n\nvar setConvert = require('./set_convert');\n\nvar DAY_OF_WEEK = require('./constants').WEEKDAY_PATTERN;\n\nvar HOUR = require('./constants').HOUR_PATTERN;\n/**\n * options: object containing:\n *\n *  letter: 'x' or 'y'\n *  title: name of the axis (ie 'Colorbar') to go in default title\n *  font: the default font to inherit\n *  outerTicks: boolean, should ticks default to outside?\n *  showGrid: boolean, should gridlines be shown by default?\n *  noHover: boolean, this axis doesn't support hover effects?\n *  noTickson: boolean, this axis doesn't support 'tickson'\n *  data: the plot data, used to manage categories\n *  bgColor: the plot background color, to calculate default gridline colors\n *  calendar:\n *  splomStash:\n *  visibleDflt: boolean\n *  reverseDflt: boolean\n *  automargin: boolean\n */\n\n\nmodule.exports = function handleAxisDefaults(containerIn, containerOut, coerce, options, layoutOut) {\n  var letter = options.letter;\n  var font = options.font || {};\n  var splomStash = options.splomStash || {};\n  var visible = coerce('visible', !options.visibleDflt);\n  var axTemplate = containerOut._template || {};\n  var axType = containerOut.type || axTemplate.type || '-';\n\n  if (axType === 'date') {\n    var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleDefaults');\n    handleCalendarDefaults(containerIn, containerOut, 'calendar', options.calendar);\n  }\n\n  setConvert(containerOut, layoutOut);\n  var autorangeDflt = !containerOut.isValidRange(containerIn.range);\n  if (autorangeDflt && options.reverseDflt) autorangeDflt = 'reversed';\n  var autoRange = coerce('autorange', autorangeDflt);\n  if (autoRange && (axType === 'linear' || axType === '-')) coerce('rangemode');\n  coerce('range');\n  containerOut.cleanRange();\n  handleCategoryOrderDefaults(containerIn, containerOut, coerce, options);\n  if (axType !== 'category' && !options.noHover) coerce('hoverformat');\n  var dfltColor = coerce('color'); // if axis.color was provided, use it for fonts too; otherwise,\n  // inherit from global font color in case that was provided.\n  // Compare to dflt rather than to containerIn, so we can provide color via\n  // template too.\n\n  var dfltFontColor = dfltColor !== layoutAttributes.color.dflt ? dfltColor : font.color; // try to get default title from splom trace, fallback to graph-wide value\n\n  var dfltTitle = splomStash.label || layoutOut._dfltTitle[letter];\n  handleTickLabelDefaults(containerIn, containerOut, coerce, axType, options, {\n    pass: 1\n  });\n  if (!visible) return containerOut;\n  coerce('title.text', dfltTitle);\n  Lib.coerceFont(coerce, 'title.font', {\n    family: font.family,\n    size: Math.round(font.size * 1.2),\n    color: dfltFontColor\n  });\n  handleTickValueDefaults(containerIn, containerOut, coerce, axType);\n  handleTickLabelDefaults(containerIn, containerOut, coerce, axType, options, {\n    pass: 2\n  });\n  handleTickMarkDefaults(containerIn, containerOut, coerce, options);\n  handleLineGridDefaults(containerIn, containerOut, coerce, {\n    dfltColor: dfltColor,\n    bgColor: options.bgColor,\n    showGrid: options.showGrid,\n    attributes: layoutAttributes\n  });\n  if (containerOut.showline || containerOut.ticks) coerce('mirror');\n  if (options.automargin) coerce('automargin');\n  var isMultiCategory = axType === 'multicategory';\n\n  if (!options.noTickson && (axType === 'category' || isMultiCategory) && (containerOut.ticks || containerOut.showgrid)) {\n    var ticksonDflt;\n    if (isMultiCategory) ticksonDflt = 'boundaries';\n    coerce('tickson', ticksonDflt);\n  }\n\n  if (isMultiCategory) {\n    var showDividers = coerce('showdividers');\n\n    if (showDividers) {\n      coerce('dividercolor');\n      coerce('dividerwidth');\n    }\n  }\n\n  if (axType === 'date') {\n    handleArrayContainerDefaults(containerIn, containerOut, {\n      name: 'rangebreaks',\n      inclusionAttr: 'enabled',\n      handleItemDefaults: rangebreaksDefaults\n    });\n\n    if (!containerOut.rangebreaks.length) {\n      delete containerOut.rangebreaks;\n    } else {\n      for (var k = 0; k < containerOut.rangebreaks.length; k++) {\n        if (containerOut.rangebreaks[k].pattern === DAY_OF_WEEK) {\n          containerOut._hasDayOfWeekBreaks = true;\n          break;\n        }\n      }\n\n      setConvert(containerOut, layoutOut);\n\n      if (layoutOut._has('scattergl') || layoutOut._has('splom')) {\n        for (var i = 0; i < options.data.length; i++) {\n          var trace = options.data[i];\n\n          if (trace.type === 'scattergl' || trace.type === 'splom') {\n            trace.visible = false;\n            Lib.warn(trace.type + ' traces do not work on axes with rangebreaks.' + ' Setting trace ' + trace.index + ' to `visible: false`.');\n          }\n        }\n      }\n    }\n  }\n\n  return containerOut;\n};\n\nfunction rangebreaksDefaults(itemIn, itemOut, containerOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(itemIn, itemOut, layoutAttributes.rangebreaks, attr, dflt);\n  }\n\n  var enabled = coerce('enabled');\n\n  if (enabled) {\n    var bnds = coerce('bounds');\n\n    if (bnds && bnds.length >= 2) {\n      var dfltPattern = '';\n      var i, q;\n\n      if (bnds.length === 2) {\n        for (i = 0; i < 2; i++) {\n          q = indexOfDay(bnds[i]);\n\n          if (q) {\n            dfltPattern = DAY_OF_WEEK;\n            break;\n          }\n        }\n      }\n\n      var pattern = coerce('pattern', dfltPattern);\n\n      if (pattern === DAY_OF_WEEK) {\n        for (i = 0; i < 2; i++) {\n          q = indexOfDay(bnds[i]);\n\n          if (q) {\n            // convert to integers i.e 'Sunday' --> 0\n            itemOut.bounds[i] = bnds[i] = q - 1;\n          }\n        }\n      }\n\n      if (pattern) {\n        // ensure types and ranges\n        for (i = 0; i < 2; i++) {\n          q = bnds[i];\n\n          switch (pattern) {\n            case DAY_OF_WEEK:\n              if (!isNumeric(q)) {\n                itemOut.enabled = false;\n                return;\n              }\n\n              q = +q;\n\n              if (q !== Math.floor(q) || // don't accept fractional days for mow\n              q < 0 || q >= 7) {\n                itemOut.enabled = false;\n                return;\n              } // use number\n\n\n              itemOut.bounds[i] = bnds[i] = q;\n              break;\n\n            case HOUR:\n              if (!isNumeric(q)) {\n                itemOut.enabled = false;\n                return;\n              }\n\n              q = +q;\n\n              if (q < 0 || q > 24) {\n                // accept 24\n                itemOut.enabled = false;\n                return;\n              } // use number\n\n\n              itemOut.bounds[i] = bnds[i] = q;\n              break;\n          }\n        }\n      }\n\n      if (containerOut.autorange === false) {\n        var rng = containerOut.range; // if bounds are bigger than the (set) range, disable break\n\n        if (rng[0] < rng[1]) {\n          if (bnds[0] < rng[0] && bnds[1] > rng[1]) {\n            itemOut.enabled = false;\n            return;\n          }\n        } else if (bnds[0] > rng[0] && bnds[1] < rng[1]) {\n          itemOut.enabled = false;\n          return;\n        }\n      }\n    } else {\n      var values = coerce('values');\n\n      if (values && values.length) {\n        coerce('dvalue');\n      } else {\n        itemOut.enabled = false;\n        return;\n      }\n    }\n  }\n} // these numbers are one more than what bounds would be mapped to\n\n\nvar dayStrToNum = {\n  sun: 1,\n  mon: 2,\n  tue: 3,\n  wed: 4,\n  thu: 5,\n  fri: 6,\n  sat: 7\n};\n\nfunction indexOfDay(v) {\n  if (typeof v !== 'string') return;\n  return dayStrToNum[v.substr(0, 3).toLowerCase()];\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar attributes = require('./attributes');\n\nvar constants = require('./constants');\n\nvar name = constants.name;\nvar stepAttrs = attributes.steps;\n\nmodule.exports = function slidersDefaults(layoutIn, layoutOut) {\n  handleArrayContainerDefaults(layoutIn, layoutOut, {\n    name: name,\n    handleItemDefaults: sliderDefaults\n  });\n};\n\nfunction sliderDefaults(sliderIn, sliderOut, layoutOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(sliderIn, sliderOut, attributes, attr, dflt);\n  }\n\n  var steps = handleArrayContainerDefaults(sliderIn, sliderOut, {\n    name: 'steps',\n    handleItemDefaults: stepDefaults\n  });\n  var stepCount = 0;\n\n  for (var i = 0; i < steps.length; i++) {\n    if (steps[i].visible) stepCount++;\n  }\n\n  var visible; // If it has fewer than two options, it's not really a slider\n\n  if (stepCount < 2) visible = sliderOut.visible = false;else visible = coerce('visible');\n  if (!visible) return;\n  sliderOut._stepCount = stepCount;\n  var visSteps = sliderOut._visibleSteps = Lib.filterVisible(steps);\n  var active = coerce('active');\n  if (!(steps[active] || {}).visible) sliderOut.active = visSteps[0]._index;\n  coerce('x');\n  coerce('y');\n  Lib.noneOrAll(sliderIn, sliderOut, ['x', 'y']);\n  coerce('xanchor');\n  coerce('yanchor');\n  coerce('len');\n  coerce('lenmode');\n  coerce('pad.t');\n  coerce('pad.r');\n  coerce('pad.b');\n  coerce('pad.l');\n  Lib.coerceFont(coerce, 'font', layoutOut.font);\n  var currentValueIsVisible = coerce('currentvalue.visible');\n\n  if (currentValueIsVisible) {\n    coerce('currentvalue.xanchor');\n    coerce('currentvalue.prefix');\n    coerce('currentvalue.suffix');\n    coerce('currentvalue.offset');\n    Lib.coerceFont(coerce, 'currentvalue.font', sliderOut.font);\n  }\n\n  coerce('transition.duration');\n  coerce('transition.easing');\n  coerce('bgcolor');\n  coerce('activebgcolor');\n  coerce('bordercolor');\n  coerce('borderwidth');\n  coerce('ticklen');\n  coerce('tickwidth');\n  coerce('tickcolor');\n  coerce('minorticklen');\n}\n\nfunction stepDefaults(valueIn, valueOut) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(valueIn, valueOut, stepAttrs, attr, dflt);\n  }\n\n  var visible;\n\n  if (valueIn.method !== 'skip' && !Array.isArray(valueIn.args)) {\n    visible = valueOut.visible = false;\n  } else visible = coerce('visible');\n\n  if (visible) {\n    coerce('method');\n    coerce('args');\n    var label = coerce('label', 'step-' + valueOut._index);\n    coerce('value', label);\n    coerce('execute');\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar colorMix = require('tinycolor2').mix;\n\nvar lightFraction = require('../../components/color/attributes').lightFraction;\n\nvar Lib = require('../../lib');\n/**\n * @param {object} opts :\n *   - dfltColor {string} : default axis color\n *   - bgColor {string} : combined subplot bg color\n *   - blend {number, optional} : blend percentage (to compute dflt grid color)\n *   - showLine {boolean} : show line by default\n *   - showGrid {boolean} : show grid by default\n *   - noZeroLine {boolean} : don't coerce zeroline* attributes\n *   - attributes {object} : attribute object associated with input containers\n */\n\n\nmodule.exports = function handleLineGridDefaults(containerIn, containerOut, coerce, opts) {\n  opts = opts || {};\n  var dfltColor = opts.dfltColor;\n\n  function coerce2(attr, dflt) {\n    return Lib.coerce2(containerIn, containerOut, opts.attributes, attr, dflt);\n  }\n\n  var lineColor = coerce2('linecolor', dfltColor);\n  var lineWidth = coerce2('linewidth');\n  var showLine = coerce('showline', opts.showLine || !!lineColor || !!lineWidth);\n\n  if (!showLine) {\n    delete containerOut.linecolor;\n    delete containerOut.linewidth;\n  }\n\n  var gridColorDflt = colorMix(dfltColor, opts.bgColor, opts.blend || lightFraction).toRgbString();\n  var gridColor = coerce2('gridcolor', gridColorDflt);\n  var gridWidth = coerce2('gridwidth');\n  var showGridLines = coerce('showgrid', opts.showGrid || !!gridColor || !!gridWidth);\n\n  if (!showGridLines) {\n    delete containerOut.gridcolor;\n    delete containerOut.gridwidth;\n  }\n\n  if (!opts.noZeroLine) {\n    var zeroLineColor = coerce2('zerolinecolor', dfltColor);\n    var zeroLineWidth = coerce2('zerolinewidth');\n    var showZeroLine = coerce('zeroline', opts.showGrid || !!zeroLineColor || !!zeroLineWidth);\n\n    if (!showZeroLine) {\n      delete containerOut.zerolinecolor;\n      delete containerOut.zerolinewidth;\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n/* global MathJax:false */\n\nmodule.exports = function () {\n  if (typeof MathJax !== 'undefined') {\n    var globalConfig = (window.PlotlyConfig || {}).MathJaxConfig !== 'local';\n\n    if (globalConfig) {\n      MathJax.Hub.Config({\n        messageStyle: 'none',\n        skipStartupTypeset: true,\n        displayAlign: 'left',\n        tex2jax: {\n          inlineMath: [['$', '$'], ['\\\\(', '\\\\)']]\n        }\n      });\n      MathJax.Hub.Configured();\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar counterRegex = require('../../lib/regex').counter;\n\nvar domainAttrs = require('../../plots/domain').attributes;\n\nvar cartesianIdRegex = require('../../plots/cartesian/constants').idRegex;\n\nvar Template = require('../../plot_api/plot_template');\n\nvar gridAttrs = {\n  rows: {\n    valType: 'integer',\n    min: 1,\n    role: 'info',\n    editType: 'plot',\n    description: ['The number of rows in the grid. If you provide a 2D `subplots`', 'array or a `yaxes` array, its length is used as the default.', 'But it\\'s also possible to have a different length, if you', 'want to leave a row at the end for non-cartesian subplots.'].join(' ')\n  },\n  roworder: {\n    valType: 'enumerated',\n    values: ['top to bottom', 'bottom to top'],\n    dflt: 'top to bottom',\n    role: 'info',\n    editType: 'plot',\n    description: ['Is the first row the top or the bottom? Note that columns', 'are always enumerated from left to right.'].join(' ')\n  },\n  columns: {\n    valType: 'integer',\n    min: 1,\n    role: 'info',\n    editType: 'plot',\n    description: ['The number of columns in the grid. If you provide a 2D `subplots`', 'array, the length of its longest row is used as the default.', 'If you give an `xaxes` array, its length is used as the default.', 'But it\\'s also possible to have a different length, if you', 'want to leave a row at the end for non-cartesian subplots.'].join(' ')\n  },\n  subplots: {\n    valType: 'info_array',\n    freeLength: true,\n    dimensions: 2,\n    items: {\n      valType: 'enumerated',\n      values: [counterRegex('xy').toString(), ''],\n      editType: 'plot'\n    },\n    role: 'info',\n    editType: 'plot',\n    description: ['Used for freeform grids, where some axes may be shared across subplots', 'but others are not. Each entry should be a cartesian subplot id, like', '*xy* or *x3y2*, or ** to leave that cell empty. You may reuse x axes', 'within the same column, and y axes within the same row.', 'Non-cartesian subplots and traces that support `domain` can place themselves', 'in this grid separately using the `gridcell` attribute.'].join(' ')\n  },\n  xaxes: {\n    valType: 'info_array',\n    freeLength: true,\n    items: {\n      valType: 'enumerated',\n      values: [cartesianIdRegex.x.toString(), ''],\n      editType: 'plot'\n    },\n    role: 'info',\n    editType: 'plot',\n    description: ['Used with `yaxes` when the x and y axes are shared across columns and rows.', 'Each entry should be an x axis id like *x*, *x2*, etc., or ** to', 'not put an x axis in that column. Entries other than ** must be unique.', 'Ignored if `subplots` is present. If missing but `yaxes` is present,', 'will generate consecutive IDs.'].join(' ')\n  },\n  yaxes: {\n    valType: 'info_array',\n    freeLength: true,\n    items: {\n      valType: 'enumerated',\n      values: [cartesianIdRegex.y.toString(), ''],\n      editType: 'plot'\n    },\n    role: 'info',\n    editType: 'plot',\n    description: ['Used with `yaxes` when the x and y axes are shared across columns and rows.', 'Each entry should be an y axis id like *y*, *y2*, etc., or ** to', 'not put a y axis in that row. Entries other than ** must be unique.', 'Ignored if `subplots` is present. If missing but `xaxes` is present,', 'will generate consecutive IDs.'].join(' ')\n  },\n  pattern: {\n    valType: 'enumerated',\n    values: ['independent', 'coupled'],\n    dflt: 'coupled',\n    role: 'info',\n    editType: 'plot',\n    description: ['If no `subplots`, `xaxes`, or `yaxes` are given but we do have `rows` and `columns`,', 'we can generate defaults using consecutive axis IDs, in two ways:', '*coupled* gives one x axis per column and one y axis per row.', '*independent* uses a new xy pair for each cell, left-to-right across each row', 'then iterating rows according to `roworder`.'].join(' ')\n  },\n  xgap: {\n    valType: 'number',\n    min: 0,\n    max: 1,\n    role: 'info',\n    editType: 'plot',\n    description: ['Horizontal space between grid cells, expressed as a fraction', 'of the total width available to one cell. Defaults to 0.1', 'for coupled-axes grids and 0.2 for independent grids.'].join(' ')\n  },\n  ygap: {\n    valType: 'number',\n    min: 0,\n    max: 1,\n    role: 'info',\n    editType: 'plot',\n    description: ['Vertical space between grid cells, expressed as a fraction', 'of the total height available to one cell. Defaults to 0.1', 'for coupled-axes grids and 0.3 for independent grids.'].join(' ')\n  },\n  domain: domainAttrs({\n    name: 'grid',\n    editType: 'plot',\n    noGridCell: true\n  }, {\n    description: ['The first and last cells end exactly at the domain', 'edges, with no grout around the edges.'].join(' ')\n  }),\n  xside: {\n    valType: 'enumerated',\n    values: ['bottom', 'bottom plot', 'top plot', 'top'],\n    dflt: 'bottom plot',\n    role: 'info',\n    editType: 'plot',\n    description: ['Sets where the x axis labels and titles go. *bottom* means', 'the very bottom of the grid. *bottom plot* is the lowest plot', 'that each x axis is used in. *top* and *top plot* are similar.'].join(' ')\n  },\n  yside: {\n    valType: 'enumerated',\n    values: ['left', 'left plot', 'right plot', 'right'],\n    dflt: 'left plot',\n    role: 'info',\n    editType: 'plot',\n    description: ['Sets where the y axis labels and titles go. *left* means', 'the very left edge of the grid. *left plot* is the leftmost plot', 'that each y axis is used in. *right* and *right plot* are similar.'].join(' ')\n  },\n  editType: 'plot'\n};\n\nfunction getAxes(layout, grid, axLetter) {\n  var gridVal = grid[axLetter + 'axes'];\n  var splomVal = Object.keys((layout._splomAxes || {})[axLetter] || {});\n  if (Array.isArray(gridVal)) return gridVal;\n  if (splomVal.length) return splomVal;\n} // the shape of the grid - this needs to be done BEFORE supplyDataDefaults\n// so that non-subplot traces can place themselves in the grid\n\n\nfunction sizeDefaults(layoutIn, layoutOut) {\n  var gridIn = layoutIn.grid || {};\n  var xAxes = getAxes(layoutOut, gridIn, 'x');\n  var yAxes = getAxes(layoutOut, gridIn, 'y');\n  if (!layoutIn.grid && !xAxes && !yAxes) return;\n  var hasSubplotGrid = Array.isArray(gridIn.subplots) && Array.isArray(gridIn.subplots[0]);\n  var hasXaxes = Array.isArray(xAxes);\n  var hasYaxes = Array.isArray(yAxes);\n  var isSplomGenerated = hasXaxes && xAxes !== gridIn.xaxes && hasYaxes && yAxes !== gridIn.yaxes;\n  var dfltRows, dfltColumns;\n\n  if (hasSubplotGrid) {\n    dfltRows = gridIn.subplots.length;\n    dfltColumns = gridIn.subplots[0].length;\n  } else {\n    if (hasYaxes) dfltRows = yAxes.length;\n    if (hasXaxes) dfltColumns = xAxes.length;\n  }\n\n  var gridOut = Template.newContainer(layoutOut, 'grid');\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(gridIn, gridOut, gridAttrs, attr, dflt);\n  }\n\n  var rows = coerce('rows', dfltRows);\n  var columns = coerce('columns', dfltColumns);\n\n  if (!(rows * columns > 1)) {\n    delete layoutOut.grid;\n    return;\n  }\n\n  if (!hasSubplotGrid && !hasXaxes && !hasYaxes) {\n    var useDefaultSubplots = coerce('pattern') === 'independent';\n    if (useDefaultSubplots) hasSubplotGrid = true;\n  }\n\n  gridOut._hasSubplotGrid = hasSubplotGrid;\n  var rowOrder = coerce('roworder');\n  var reversed = rowOrder === 'top to bottom';\n  var dfltGapX = hasSubplotGrid ? 0.2 : 0.1;\n  var dfltGapY = hasSubplotGrid ? 0.3 : 0.1;\n  var dfltSideX, dfltSideY;\n\n  if (isSplomGenerated && layoutOut._splomGridDflt) {\n    dfltSideX = layoutOut._splomGridDflt.xside;\n    dfltSideY = layoutOut._splomGridDflt.yside;\n  }\n\n  gridOut._domains = {\n    x: fillGridPositions('x', coerce, dfltGapX, dfltSideX, columns),\n    y: fillGridPositions('y', coerce, dfltGapY, dfltSideY, rows, reversed)\n  };\n} // coerce x or y sizing attributes and return an array of domains for this direction\n\n\nfunction fillGridPositions(axLetter, coerce, dfltGap, dfltSide, len, reversed) {\n  var dirGap = coerce(axLetter + 'gap', dfltGap);\n  var domain = coerce('domain.' + axLetter);\n  coerce(axLetter + 'side', dfltSide);\n  var out = new Array(len);\n  var start = domain[0];\n  var step = (domain[1] - start) / (len - dirGap);\n  var cellDomain = step * (1 - dirGap);\n\n  for (var i = 0; i < len; i++) {\n    var cellStart = start + step * i;\n    out[reversed ? len - 1 - i : i] = [cellStart, cellStart + cellDomain];\n  }\n\n  return out;\n} // the (cartesian) contents of the grid - this needs to happen AFTER supplyDataDefaults\n// so that we know what cartesian subplots are available\n\n\nfunction contentDefaults(layoutIn, layoutOut) {\n  var gridOut = layoutOut.grid; // make sure we got to the end of handleGridSizing\n\n  if (!gridOut || !gridOut._domains) return;\n  var gridIn = layoutIn.grid || {};\n  var subplots = layoutOut._subplots;\n  var hasSubplotGrid = gridOut._hasSubplotGrid;\n  var rows = gridOut.rows;\n  var columns = gridOut.columns;\n  var useDefaultSubplots = gridOut.pattern === 'independent';\n  var i, j, xId, yId, subplotId, subplotsOut, yPos;\n  var axisMap = gridOut._axisMap = {};\n\n  if (hasSubplotGrid) {\n    var subplotsIn = gridIn.subplots || [];\n    subplotsOut = gridOut.subplots = new Array(rows);\n    var index = 1;\n\n    for (i = 0; i < rows; i++) {\n      var rowOut = subplotsOut[i] = new Array(columns);\n      var rowIn = subplotsIn[i] || [];\n\n      for (j = 0; j < columns; j++) {\n        if (useDefaultSubplots) {\n          subplotId = index === 1 ? 'xy' : 'x' + index + 'y' + index;\n          index++;\n        } else subplotId = rowIn[j];\n\n        rowOut[j] = '';\n\n        if (subplots.cartesian.indexOf(subplotId) !== -1) {\n          yPos = subplotId.indexOf('y');\n          xId = subplotId.slice(0, yPos);\n          yId = subplotId.slice(yPos);\n\n          if (axisMap[xId] !== undefined && axisMap[xId] !== j || axisMap[yId] !== undefined && axisMap[yId] !== i) {\n            continue;\n          }\n\n          rowOut[j] = subplotId;\n          axisMap[xId] = j;\n          axisMap[yId] = i;\n        }\n      }\n    }\n  } else {\n    var xAxes = getAxes(layoutOut, gridIn, 'x');\n    var yAxes = getAxes(layoutOut, gridIn, 'y');\n    gridOut.xaxes = fillGridAxes(xAxes, subplots.xaxis, columns, axisMap, 'x');\n    gridOut.yaxes = fillGridAxes(yAxes, subplots.yaxis, rows, axisMap, 'y');\n  }\n\n  var anchors = gridOut._anchors = {};\n  var reversed = gridOut.roworder === 'top to bottom';\n\n  for (var axisId in axisMap) {\n    var axLetter = axisId.charAt(0);\n    var side = gridOut[axLetter + 'side'];\n    var i0, inc, iFinal;\n\n    if (side.length < 8) {\n      // grid edge -  ie not \"* plot\" - make these as free axes\n      // since we're not guaranteed to have a subplot there at all\n      anchors[axisId] = 'free';\n    } else if (axLetter === 'x') {\n      if (side.charAt(0) === 't' === reversed) {\n        i0 = 0;\n        inc = 1;\n        iFinal = rows;\n      } else {\n        i0 = rows - 1;\n        inc = -1;\n        iFinal = -1;\n      }\n\n      if (hasSubplotGrid) {\n        var column = axisMap[axisId];\n\n        for (i = i0; i !== iFinal; i += inc) {\n          subplotId = subplotsOut[i][column];\n          if (!subplotId) continue;\n          yPos = subplotId.indexOf('y');\n\n          if (subplotId.slice(0, yPos) === axisId) {\n            anchors[axisId] = subplotId.slice(yPos);\n            break;\n          }\n        }\n      } else {\n        for (i = i0; i !== iFinal; i += inc) {\n          yId = gridOut.yaxes[i];\n\n          if (subplots.cartesian.indexOf(axisId + yId) !== -1) {\n            anchors[axisId] = yId;\n            break;\n          }\n        }\n      }\n    } else {\n      if (side.charAt(0) === 'l') {\n        i0 = 0;\n        inc = 1;\n        iFinal = columns;\n      } else {\n        i0 = columns - 1;\n        inc = -1;\n        iFinal = -1;\n      }\n\n      if (hasSubplotGrid) {\n        var row = axisMap[axisId];\n\n        for (i = i0; i !== iFinal; i += inc) {\n          subplotId = subplotsOut[row][i];\n          if (!subplotId) continue;\n          yPos = subplotId.indexOf('y');\n\n          if (subplotId.slice(yPos) === axisId) {\n            anchors[axisId] = subplotId.slice(0, yPos);\n            break;\n          }\n        }\n      } else {\n        for (i = i0; i !== iFinal; i += inc) {\n          xId = gridOut.xaxes[i];\n\n          if (subplots.cartesian.indexOf(xId + axisId) !== -1) {\n            anchors[axisId] = xId;\n            break;\n          }\n        }\n      }\n    }\n  }\n}\n\nfunction fillGridAxes(axesIn, axesAllowed, len, axisMap, axLetter) {\n  var out = new Array(len);\n  var i;\n\n  function fillOneAxis(i, axisId) {\n    if (axesAllowed.indexOf(axisId) !== -1 && axisMap[axisId] === undefined) {\n      out[i] = axisId;\n      axisMap[axisId] = i;\n    } else out[i] = '';\n  }\n\n  if (Array.isArray(axesIn)) {\n    for (i = 0; i < len; i++) {\n      fillOneAxis(i, axesIn[i]);\n    }\n  } else {\n    // default axis list is the first `len` axis ids\n    fillOneAxis(0, axLetter);\n\n    for (i = 1; i < len; i++) {\n      fillOneAxis(i, axLetter + (i + 1));\n    }\n  }\n\n  return out;\n}\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'grid',\n  schema: {\n    layout: {\n      grid: gridAttrs\n    }\n  },\n  layoutAttributes: gridAttrs,\n  sizeDefaults: sizeDefaults,\n  contentDefaults: contentDefaults\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'images',\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  includeBasePlot: require('../../plots/cartesian/include_components')('images'),\n  draw: require('./draw'),\n  convertCoords: require('./convert_coords')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Axes = require('../../plots/cartesian/axes');\n\nmodule.exports = function formatLabels(cdi, trace, fullLayout) {\n  var labels = {};\n  var mockGd = {\n    _fullLayout: fullLayout\n  };\n  var xa = Axes.getFromTrace(mockGd, trace, 'x');\n  var ya = Axes.getFromTrace(mockGd, trace, 'y');\n  labels.xLabel = Axes.tickText(xa, cdi.x, true).text;\n  labels.yLabel = Axes.tickText(ya, cdi.y, true).text;\n  return labels;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar overrideAll = require('../../plot_api/edit_types').overrideAll;\n\nvar attributes = require('./attributes');\n\nvar xyAttrs = {\n  error_x: Lib.extendFlat({}, attributes),\n  error_y: Lib.extendFlat({}, attributes)\n};\ndelete xyAttrs.error_x.copy_zstyle;\ndelete xyAttrs.error_y.copy_zstyle;\ndelete xyAttrs.error_y.copy_ystyle;\nvar xyzAttrs = {\n  error_x: Lib.extendFlat({}, attributes),\n  error_y: Lib.extendFlat({}, attributes),\n  error_z: Lib.extendFlat({}, attributes)\n};\ndelete xyzAttrs.error_x.copy_ystyle;\ndelete xyzAttrs.error_y.copy_ystyle;\ndelete xyzAttrs.error_z.copy_ystyle;\ndelete xyzAttrs.error_z.copy_zstyle;\nmodule.exports = {\n  moduleType: 'component',\n  name: 'errorbars',\n  schema: {\n    traces: {\n      scatter: xyAttrs,\n      bar: xyAttrs,\n      histogram: xyAttrs,\n      scatter3d: overrideAll(xyzAttrs, 'calc', 'nested'),\n      scattergl: overrideAll(xyAttrs, 'calc', 'nested')\n    }\n  },\n  supplyDefaults: require('./defaults'),\n  calc: require('./calc'),\n  makeComputeError: require('./compute_error'),\n  plot: require('./plot'),\n  style: require('./style'),\n  hoverInfo: hoverInfo\n};\n\nfunction hoverInfo(calcPoint, trace, hoverPoint) {\n  if ((trace.error_y || {}).visible) {\n    hoverPoint.yerr = calcPoint.yh - calcPoint.y;\n    if (!trace.error_y.symmetric) hoverPoint.yerrneg = calcPoint.y - calcPoint.ys;\n  }\n\n  if ((trace.error_x || {}).visible) {\n    hoverPoint.xerr = calcPoint.xh - calcPoint.x;\n    if (!trace.error_x.symmetric) hoverPoint.xerrneg = calcPoint.x - calcPoint.xs;\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Color = require('../../components/color');\n\nvar isUnifiedHover = require('../../components/fx/helpers').isUnifiedHover;\n\nvar handleHoverModeDefaults = require('../../components/fx/hovermode_defaults');\n\nvar Template = require('../../plot_api/plot_template');\n\nvar basePlotLayoutAttributes = require('../layout_attributes');\n\nvar layoutAttributes = require('./layout_attributes');\n\nvar handleTypeDefaults = require('./type_defaults');\n\nvar handleAxisDefaults = require('./axis_defaults');\n\nvar handleConstraintDefaults = require('./constraints').handleConstraintDefaults;\n\nvar handlePositionDefaults = require('./position_defaults');\n\nvar axisIds = require('./axis_ids');\n\nvar id2name = axisIds.id2name;\nvar name2id = axisIds.name2id;\n\nvar AX_ID_PATTERN = require('./constants').AX_ID_PATTERN;\n\nvar Registry = require('../../registry');\n\nvar traceIs = Registry.traceIs;\nvar getComponentMethod = Registry.getComponentMethod;\n\nfunction appendList(cont, k, item) {\n  if (Array.isArray(cont[k])) cont[k].push(item);else cont[k] = [item];\n}\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut, fullData) {\n  var ax2traces = {};\n  var xaMayHide = {};\n  var yaMayHide = {};\n  var xaMustDisplay = {};\n  var yaMustDisplay = {};\n  var yaMustNotReverse = {};\n  var yaMayReverse = {};\n  var axHasImage = {};\n  var outerTicks = {};\n  var noGrids = {};\n  var i, j; // look for axes in the data\n\n  for (i = 0; i < fullData.length; i++) {\n    var trace = fullData[i];\n    if (!traceIs(trace, 'cartesian') && !traceIs(trace, 'gl2d')) continue;\n    var xaName;\n\n    if (trace.xaxis) {\n      xaName = id2name(trace.xaxis);\n      appendList(ax2traces, xaName, trace);\n    } else if (trace.xaxes) {\n      for (j = 0; j < trace.xaxes.length; j++) {\n        appendList(ax2traces, id2name(trace.xaxes[j]), trace);\n      }\n    }\n\n    var yaName;\n\n    if (trace.yaxis) {\n      yaName = id2name(trace.yaxis);\n      appendList(ax2traces, yaName, trace);\n    } else if (trace.yaxes) {\n      for (j = 0; j < trace.yaxes.length; j++) {\n        appendList(ax2traces, id2name(trace.yaxes[j]), trace);\n      }\n    } // logic for funnels\n\n\n    if (trace.type === 'funnel') {\n      if (trace.orientation === 'h') {\n        if (xaName) xaMayHide[xaName] = true;\n        if (yaName) yaMayReverse[yaName] = true;\n      } else {\n        if (yaName) yaMayHide[yaName] = true;\n      }\n    } else if (trace.type === 'image') {\n      if (yaName) axHasImage[yaName] = true;\n      if (xaName) axHasImage[xaName] = true;\n    } else {\n      if (yaName) {\n        yaMustDisplay[yaName] = true;\n        yaMustNotReverse[yaName] = true;\n      }\n\n      if (!traceIs(trace, 'carpet') || trace.type === 'carpet' && !trace._cheater) {\n        if (xaName) xaMustDisplay[xaName] = true;\n      }\n    } // Two things trigger axis visibility:\n    // 1. is not carpet\n    // 2. carpet that's not cheater\n    // The above check for definitely-not-cheater is not adequate. This\n    // second list tracks which axes *could* be a cheater so that the\n    // full condition triggering hiding is:\n    //   *could* be a cheater and *is not definitely visible*\n\n\n    if (trace.type === 'carpet' && trace._cheater) {\n      if (xaName) xaMayHide[xaName] = true;\n    } // check for default formatting tweaks\n\n\n    if (traceIs(trace, '2dMap')) {\n      outerTicks[xaName] = true;\n      outerTicks[yaName] = true;\n    }\n\n    if (traceIs(trace, 'oriented')) {\n      var positionAxis = trace.orientation === 'h' ? yaName : xaName;\n      noGrids[positionAxis] = true;\n    }\n  }\n\n  var subplots = layoutOut._subplots;\n  var xIds = subplots.xaxis;\n  var yIds = subplots.yaxis;\n  var xNames = Lib.simpleMap(xIds, id2name);\n  var yNames = Lib.simpleMap(yIds, id2name);\n  var axNames = xNames.concat(yNames); // plot_bgcolor only makes sense if there's a (2D) plot!\n  // TODO: bgcolor for each subplot, to inherit from the main one\n\n  var plotBgColor = Color.background;\n\n  if (xIds.length && yIds.length) {\n    plotBgColor = Lib.coerce(layoutIn, layoutOut, basePlotLayoutAttributes, 'plot_bgcolor');\n  }\n\n  var bgColor = Color.combine(plotBgColor, layoutOut.paper_bgcolor); // name of single axis (e.g. 'xaxis', 'yaxis2')\n\n  var axName; // id of single axis (e.g. 'y', 'x5')\n\n  var axId; // 'x' or 'y'\n\n  var axLetter; // input layout axis container\n\n  var axLayoutIn; // full layout axis container\n\n  var axLayoutOut;\n\n  function newAxLayoutOut() {\n    var traces = ax2traces[axName] || [];\n    axLayoutOut._traceIndices = traces.map(function (t) {\n      return t._expandedIndex;\n    });\n    axLayoutOut._annIndices = [];\n    axLayoutOut._shapeIndices = [];\n    axLayoutOut._imgIndices = [];\n    axLayoutOut._subplotsWith = [];\n    axLayoutOut._counterAxes = [];\n    axLayoutOut._name = axLayoutOut._attr = axName;\n    axLayoutOut._id = axId;\n  }\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(axLayoutIn, axLayoutOut, layoutAttributes, attr, dflt);\n  }\n\n  function coerce2(attr, dflt) {\n    return Lib.coerce2(axLayoutIn, axLayoutOut, layoutAttributes, attr, dflt);\n  }\n\n  function getCounterAxes(axLetter) {\n    return axLetter === 'x' ? yIds : xIds;\n  }\n\n  function getOverlayableAxes(axLetter, axName) {\n    var list = axLetter === 'x' ? xNames : yNames;\n    var out = [];\n\n    for (var j = 0; j < list.length; j++) {\n      var axName2 = list[j];\n\n      if (axName2 !== axName && !(layoutIn[axName2] || {}).overlaying) {\n        out.push(name2id(axName2));\n      }\n    }\n\n    return out;\n  } // list of available counter axis names\n\n\n  var counterAxes = {\n    x: getCounterAxes('x'),\n    y: getCounterAxes('y')\n  }; // list of all x AND y axis ids\n\n  var allAxisIds = counterAxes.x.concat(counterAxes.y); // lookup and list of axis ids that axes in axNames have a reference to,\n  // even though they are missing from allAxisIds\n\n  var missingMatchedAxisIdsLookup = {};\n  var missingMatchedAxisIds = []; // fill in 'missing' axis lookup when an axis is set to match an axis\n  // not part of the allAxisIds list, save axis type so that we can propagate\n  // it to the missing axes\n\n  function addMissingMatchedAxis() {\n    var matchesIn = axLayoutIn.matches;\n\n    if (AX_ID_PATTERN.test(matchesIn) && allAxisIds.indexOf(matchesIn) === -1) {\n      missingMatchedAxisIdsLookup[matchesIn] = axLayoutIn.type;\n      missingMatchedAxisIds = Object.keys(missingMatchedAxisIdsLookup);\n    }\n  }\n\n  var hovermode = handleHoverModeDefaults(layoutIn, layoutOut, fullData);\n  var unifiedHover = isUnifiedHover(hovermode); // first pass creates the containers, determines types, and handles most of the settings\n\n  for (i = 0; i < axNames.length; i++) {\n    axName = axNames[i];\n    axId = name2id(axName);\n    axLetter = axName.charAt(0);\n\n    if (!Lib.isPlainObject(layoutIn[axName])) {\n      layoutIn[axName] = {};\n    }\n\n    axLayoutIn = layoutIn[axName];\n    axLayoutOut = Template.newContainer(layoutOut, axName, axLetter + 'axis');\n    newAxLayoutOut();\n    var visibleDflt = axLetter === 'x' && !xaMustDisplay[axName] && xaMayHide[axName] || axLetter === 'y' && !yaMustDisplay[axName] && yaMayHide[axName];\n    var reverseDflt = axLetter === 'y' && (!yaMustNotReverse[axName] && yaMayReverse[axName] || axHasImage[axName]);\n    var defaultOptions = {\n      letter: axLetter,\n      font: layoutOut.font,\n      outerTicks: outerTicks[axName],\n      showGrid: !noGrids[axName],\n      data: ax2traces[axName] || [],\n      bgColor: bgColor,\n      calendar: layoutOut.calendar,\n      automargin: true,\n      visibleDflt: visibleDflt,\n      reverseDflt: reverseDflt,\n      splomStash: ((layoutOut._splomAxes || {})[axLetter] || {})[axId]\n    };\n    coerce('uirevision', layoutOut.uirevision);\n    handleTypeDefaults(axLayoutIn, axLayoutOut, coerce, defaultOptions);\n    handleAxisDefaults(axLayoutIn, axLayoutOut, coerce, defaultOptions, layoutOut);\n    var unifiedSpike = unifiedHover && axLetter === hovermode.charAt(0);\n    var spikecolor = coerce2('spikecolor', unifiedHover ? axLayoutOut.color : undefined);\n    var spikethickness = coerce2('spikethickness', unifiedHover ? 1.5 : undefined);\n    var spikedash = coerce2('spikedash', unifiedHover ? 'dot' : undefined);\n    var spikemode = coerce2('spikemode', unifiedHover ? 'across' : undefined);\n    var spikesnap = coerce2('spikesnap', unifiedHover ? 'hovered data' : undefined);\n    var showSpikes = coerce('showspikes', !!unifiedSpike || !!spikecolor || !!spikethickness || !!spikedash || !!spikemode || !!spikesnap);\n\n    if (!showSpikes) {\n      delete axLayoutOut.spikecolor;\n      delete axLayoutOut.spikethickness;\n      delete axLayoutOut.spikedash;\n      delete axLayoutOut.spikemode;\n      delete axLayoutOut.spikesnap;\n    }\n\n    handlePositionDefaults(axLayoutIn, axLayoutOut, coerce, {\n      letter: axLetter,\n      counterAxes: counterAxes[axLetter],\n      overlayableAxes: getOverlayableAxes(axLetter, axName),\n      grid: layoutOut.grid\n    });\n    coerce('title.standoff');\n    addMissingMatchedAxis();\n    axLayoutOut._input = axLayoutIn;\n  } // coerce the 'missing' axes\n\n\n  i = 0;\n\n  while (i < missingMatchedAxisIds.length) {\n    axId = missingMatchedAxisIds[i++];\n    axName = id2name(axId);\n    axLetter = axName.charAt(0);\n\n    if (!Lib.isPlainObject(layoutIn[axName])) {\n      layoutIn[axName] = {};\n    }\n\n    axLayoutIn = layoutIn[axName];\n    axLayoutOut = Template.newContainer(layoutOut, axName, axLetter + 'axis');\n    newAxLayoutOut();\n    var defaultOptions2 = {\n      letter: axLetter,\n      font: layoutOut.font,\n      outerTicks: outerTicks[axName],\n      showGrid: !noGrids[axName],\n      data: [],\n      bgColor: bgColor,\n      calendar: layoutOut.calendar,\n      automargin: true,\n      visibleDflt: false,\n      reverseDflt: false,\n      splomStash: ((layoutOut._splomAxes || {})[axLetter] || {})[axId]\n    };\n    coerce('uirevision', layoutOut.uirevision);\n    axLayoutOut.type = missingMatchedAxisIdsLookup[axId] || 'linear';\n    handleAxisDefaults(axLayoutIn, axLayoutOut, coerce, defaultOptions2, layoutOut);\n    handlePositionDefaults(axLayoutIn, axLayoutOut, coerce, {\n      letter: axLetter,\n      counterAxes: counterAxes[axLetter],\n      overlayableAxes: getOverlayableAxes(axLetter, axName),\n      grid: layoutOut.grid\n    });\n    coerce('fixedrange');\n    addMissingMatchedAxis();\n    axLayoutOut._input = axLayoutIn;\n  } // quick second pass for range slider and selector defaults\n\n\n  var rangeSliderDefaults = getComponentMethod('rangeslider', 'handleDefaults');\n  var rangeSelectorDefaults = getComponentMethod('rangeselector', 'handleDefaults');\n\n  for (i = 0; i < xNames.length; i++) {\n    axName = xNames[i];\n    axLayoutIn = layoutIn[axName];\n    axLayoutOut = layoutOut[axName];\n    rangeSliderDefaults(layoutIn, layoutOut, axName);\n\n    if (axLayoutOut.type === 'date') {\n      rangeSelectorDefaults(axLayoutIn, axLayoutOut, layoutOut, yNames, axLayoutOut.calendar);\n    }\n\n    coerce('fixedrange');\n  }\n\n  for (i = 0; i < yNames.length; i++) {\n    axName = yNames[i];\n    axLayoutIn = layoutIn[axName];\n    axLayoutOut = layoutOut[axName];\n    var anchoredAxis = layoutOut[id2name(axLayoutOut.anchor)];\n    var fixedRangeDflt = getComponentMethod('rangeslider', 'isVisible')(anchoredAxis);\n    coerce('fixedrange', fixedRangeDflt);\n  } // Finally, handle scale constraints and matching axes.\n  //\n  // We need to do this after all axes have coerced both `type`\n  // (so we link only axes of the same type) and\n  // `fixedrange` (so we can avoid linking from OR TO a fixed axis).\n  // sets of axes linked by `scaleanchor` along with the scaleratios compounded\n  // together, populated in handleConstraintDefaults\n\n\n  var constraintGroups = layoutOut._axisConstraintGroups = []; // similar to _axisConstraintGroups, but for matching axes\n\n  var matchGroups = layoutOut._axisMatchGroups = []; // make sure to include 'missing' axes here\n\n  var allAxisIdsIncludingMissing = allAxisIds.concat(missingMatchedAxisIds);\n  var axNamesIncludingMissing = axNames.concat(Lib.simpleMap(missingMatchedAxisIds, id2name));\n\n  for (i = 0; i < axNamesIncludingMissing.length; i++) {\n    axName = axNamesIncludingMissing[i];\n    axLetter = axName.charAt(0);\n    axLayoutIn = layoutIn[axName];\n    axLayoutOut = layoutOut[axName];\n    var scaleanchorDflt;\n\n    if (axLetter === 'y' && !axLayoutIn.hasOwnProperty('scaleanchor') && axHasImage[axName]) {\n      scaleanchorDflt = axLayoutOut.anchor;\n    } else {\n      scaleanchorDflt = undefined;\n    }\n\n    var constrainDflt;\n\n    if (!axLayoutIn.hasOwnProperty('constrain') && axHasImage[axName]) {\n      constrainDflt = 'domain';\n    } else {\n      constrainDflt = undefined;\n    }\n\n    handleConstraintDefaults(axLayoutIn, axLayoutOut, coerce, {\n      allAxisIds: allAxisIdsIncludingMissing,\n      layoutOut: layoutOut,\n      scaleanchorDflt: scaleanchorDflt,\n      constrainDflt: constrainDflt\n    });\n  }\n\n  for (i = 0; i < matchGroups.length; i++) {\n    var group = matchGroups[i];\n    var rng = null;\n    var autorange = null; // find 'matching' range attrs\n\n    for (axId in group) {\n      axLayoutOut = layoutOut[id2name(axId)];\n\n      if (!axLayoutOut.matches) {\n        rng = axLayoutOut.range;\n        autorange = axLayoutOut.autorange;\n      }\n    } // if `ax.matches` values are reciprocal,\n    // pick values of first axis in group\n\n\n    if (rng === null || autorange === null) {\n      for (axId in group) {\n        axLayoutOut = layoutOut[id2name(axId)];\n        rng = axLayoutOut.range;\n        autorange = axLayoutOut.autorange;\n        break;\n      }\n    } // apply matching range attrs\n\n\n    for (axId in group) {\n      axLayoutOut = layoutOut[id2name(axId)];\n\n      if (axLayoutOut.matches) {\n        axLayoutOut.range = rng.slice();\n        axLayoutOut.autorange = autorange;\n      }\n\n      axLayoutOut._matchGroup = group;\n    } // remove matching axis from scaleanchor constraint groups (for now)\n\n\n    if (constraintGroups.length) {\n      for (axId in group) {\n        for (j = 0; j < constraintGroups.length; j++) {\n          var group2 = constraintGroups[j];\n\n          for (var axId2 in group2) {\n            if (axId === axId2) {\n              Lib.warn('Axis ' + axId2 + ' is set with both ' + 'a *scaleanchor* and *matches* constraint; ' + 'ignoring the scale constraint.');\n              delete group2[axId2];\n\n              if (Object.keys(group2).length < 2) {\n                constraintGroups.splice(j, 1);\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Plots = require('../../plots/plots');\n\nvar Color = require('../color');\n\nvar Drawing = require('../drawing');\n\nvar Lib = require('../../lib');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar axisIds = require('../../plots/cartesian/axis_ids');\n\nvar alignmentConstants = require('../../constants/alignment');\n\nvar LINE_SPACING = alignmentConstants.LINE_SPACING;\nvar FROM_TL = alignmentConstants.FROM_TL;\nvar FROM_BR = alignmentConstants.FROM_BR;\n\nvar constants = require('./constants');\n\nvar getUpdateObject = require('./get_update_object');\n\nmodule.exports = function draw(gd) {\n  var fullLayout = gd._fullLayout;\n\n  var selectors = fullLayout._infolayer.selectAll('.rangeselector').data(makeSelectorData(gd), selectorKeyFunc);\n\n  selectors.enter().append('g').classed('rangeselector', true);\n  selectors.exit().remove();\n  selectors.style({\n    cursor: 'pointer',\n    'pointer-events': 'all'\n  });\n  selectors.each(function (d) {\n    var selector = d3.select(this);\n    var axisLayout = d;\n    var selectorLayout = axisLayout.rangeselector;\n    var buttons = selector.selectAll('g.button').data(Lib.filterVisible(selectorLayout.buttons));\n    buttons.enter().append('g').classed('button', true);\n    buttons.exit().remove();\n    buttons.each(function (d) {\n      var button = d3.select(this);\n      var update = getUpdateObject(axisLayout, d);\n      d._isActive = isActive(axisLayout, d, update);\n      button.call(drawButtonRect, selectorLayout, d);\n      button.call(drawButtonText, selectorLayout, d, gd);\n      button.on('click', function () {\n        if (gd._dragged) return;\n        Registry.call('_guiRelayout', gd, update);\n      });\n      button.on('mouseover', function () {\n        d._isHovered = true;\n        button.call(drawButtonRect, selectorLayout, d);\n      });\n      button.on('mouseout', function () {\n        d._isHovered = false;\n        button.call(drawButtonRect, selectorLayout, d);\n      });\n    });\n    reposition(gd, buttons, selectorLayout, axisLayout._name, selector);\n  });\n};\n\nfunction makeSelectorData(gd) {\n  var axes = axisIds.list(gd, 'x', true);\n  var data = [];\n\n  for (var i = 0; i < axes.length; i++) {\n    var axis = axes[i];\n\n    if (axis.rangeselector && axis.rangeselector.visible) {\n      data.push(axis);\n    }\n  }\n\n  return data;\n}\n\nfunction selectorKeyFunc(d) {\n  return d._id;\n}\n\nfunction isActive(axisLayout, opts, update) {\n  if (opts.step === 'all') {\n    return axisLayout.autorange === true;\n  } else {\n    var keys = Object.keys(update);\n    return axisLayout.range[0] === update[keys[0]] && axisLayout.range[1] === update[keys[1]];\n  }\n}\n\nfunction drawButtonRect(button, selectorLayout, d) {\n  var rect = Lib.ensureSingle(button, 'rect', 'selector-rect', function (s) {\n    s.attr('shape-rendering', 'crispEdges');\n  });\n  rect.attr({\n    'rx': constants.rx,\n    'ry': constants.ry\n  });\n  rect.call(Color.stroke, selectorLayout.bordercolor).call(Color.fill, getFillColor(selectorLayout, d)).style('stroke-width', selectorLayout.borderwidth + 'px');\n}\n\nfunction getFillColor(selectorLayout, d) {\n  return d._isActive || d._isHovered ? selectorLayout.activecolor : selectorLayout.bgcolor;\n}\n\nfunction drawButtonText(button, selectorLayout, d, gd) {\n  function textLayout(s) {\n    svgTextUtils.convertToTspans(s, gd);\n  }\n\n  var text = Lib.ensureSingle(button, 'text', 'selector-text', function (s) {\n    s.classed('user-select-none', true).attr('text-anchor', 'middle');\n  });\n  text.call(Drawing.font, selectorLayout.font).text(getLabel(d, gd._fullLayout._meta)).call(textLayout);\n}\n\nfunction getLabel(opts, _meta) {\n  if (opts.label) {\n    return _meta ? Lib.templateString(opts.label, _meta) : opts.label;\n  }\n\n  if (opts.step === 'all') return 'all';\n  return opts.count + opts.step.charAt(0);\n}\n\nfunction reposition(gd, buttons, opts, axName, selector) {\n  var width = 0;\n  var height = 0;\n  var borderWidth = opts.borderwidth;\n  buttons.each(function () {\n    var button = d3.select(this);\n    var text = button.select('.selector-text');\n    var tHeight = opts.font.size * LINE_SPACING;\n    var hEff = Math.max(tHeight * svgTextUtils.lineCount(text), 16) + 3;\n    height = Math.max(height, hEff);\n  });\n  buttons.each(function () {\n    var button = d3.select(this);\n    var rect = button.select('.selector-rect');\n    var text = button.select('.selector-text');\n    var tWidth = text.node() && Drawing.bBox(text.node()).width;\n    var tHeight = opts.font.size * LINE_SPACING;\n    var tLines = svgTextUtils.lineCount(text);\n    var wEff = Math.max(tWidth + 10, constants.minButtonWidth); // TODO add MathJax support\n    // TODO add buttongap attribute\n\n    button.attr('transform', 'translate(' + (borderWidth + width) + ',' + borderWidth + ')');\n    rect.attr({\n      x: 0,\n      y: 0,\n      width: wEff,\n      height: height\n    });\n    svgTextUtils.positionText(text, wEff / 2, height / 2 - (tLines - 1) * tHeight / 2 + 3);\n    width += wEff + 5;\n  });\n  var graphSize = gd._fullLayout._size;\n  var lx = graphSize.l + graphSize.w * opts.x;\n  var ly = graphSize.t + graphSize.h * (1 - opts.y);\n  var xanchor = 'left';\n\n  if (Lib.isRightAnchor(opts)) {\n    lx -= width;\n    xanchor = 'right';\n  }\n\n  if (Lib.isCenterAnchor(opts)) {\n    lx -= width / 2;\n    xanchor = 'center';\n  }\n\n  var yanchor = 'top';\n\n  if (Lib.isBottomAnchor(opts)) {\n    ly -= height;\n    yanchor = 'bottom';\n  }\n\n  if (Lib.isMiddleAnchor(opts)) {\n    ly -= height / 2;\n    yanchor = 'middle';\n  }\n\n  width = Math.ceil(width);\n  height = Math.ceil(height);\n  lx = Math.round(lx);\n  ly = Math.round(ly);\n  Plots.autoMargin(gd, axName + '-range-selector', {\n    x: opts.x,\n    y: opts.y,\n    l: width * FROM_TL[xanchor],\n    r: width * FROM_BR[xanchor],\n    b: height * FROM_BR[yanchor],\n    t: height * FROM_TL[yanchor]\n  });\n  selector.attr('transform', 'translate(' + lx + ',' + ly + ')');\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Plots = require('../../plots/plots');\n\nvar Lib = require('../../lib');\n\nvar Drawing = require('../drawing');\n\nvar Color = require('../color');\n\nvar Titles = require('../titles');\n\nvar Cartesian = require('../../plots/cartesian');\n\nvar axisIDs = require('../../plots/cartesian/axis_ids');\n\nvar dragElement = require('../dragelement');\n\nvar setCursor = require('../../lib/setcursor');\n\nvar constants = require('./constants');\n\nmodule.exports = function (gd) {\n  var fullLayout = gd._fullLayout;\n  var rangeSliderData = fullLayout._rangeSliderData;\n\n  for (var i = 0; i < rangeSliderData.length; i++) {\n    var opts = rangeSliderData[i][constants.name]; // fullLayout._uid may not exist when we call makeData\n\n    opts._clipId = opts._id + '-' + fullLayout._uid;\n  }\n  /*\n   * <g container />\n   *  <rect bg />\n   *  < .... range plot />\n   *  <rect mask-min />\n   *  <rect mask-max />\n   *  <rect slidebox />\n   *  <g grabber-min />\n   *      <rect handle-min />\n   *      <rect grabare-min />\n   *  <g grabber-max />\n   *      <rect handle-max />\n   *      <rect grabare-max />\n   *\n   *  ...\n   */\n\n\n  function keyFunction(axisOpts) {\n    return axisOpts._name;\n  }\n\n  var rangeSliders = fullLayout._infolayer.selectAll('g.' + constants.containerClassName).data(rangeSliderData, keyFunction); // remove exiting sliders and their corresponding clip paths\n\n\n  rangeSliders.exit().each(function (axisOpts) {\n    var opts = axisOpts[constants.name];\n\n    fullLayout._topdefs.select('#' + opts._clipId).remove();\n  }).remove(); // return early if no range slider is visible\n\n  if (rangeSliderData.length === 0) return;\n  rangeSliders.enter().append('g').classed(constants.containerClassName, true).attr('pointer-events', 'all'); // for all present range sliders\n\n  rangeSliders.each(function (axisOpts) {\n    var rangeSlider = d3.select(this);\n    var opts = axisOpts[constants.name];\n    var oppAxisOpts = fullLayout[axisIDs.id2name(axisOpts.anchor)];\n    var oppAxisRangeOpts = opts[axisIDs.id2name(axisOpts.anchor)]; // update range\n    // Expand slider range to the axis range\n\n    if (opts.range) {\n      var rng = Lib.simpleMap(opts.range, axisOpts.r2l);\n      var axRng = Lib.simpleMap(axisOpts.range, axisOpts.r2l);\n      var newRng;\n\n      if (axRng[0] < axRng[1]) {\n        newRng = [Math.min(rng[0], axRng[0]), Math.max(rng[1], axRng[1])];\n      } else {\n        newRng = [Math.max(rng[0], axRng[0]), Math.min(rng[1], axRng[1])];\n      }\n\n      opts.range = opts._input.range = Lib.simpleMap(newRng, axisOpts.l2r);\n    }\n\n    axisOpts.cleanRange('rangeslider.range'); // update range slider dimensions\n\n    var gs = fullLayout._size;\n    var domain = axisOpts.domain;\n    opts._width = gs.w * (domain[1] - domain[0]);\n    var x = Math.round(gs.l + gs.w * domain[0]);\n    var y = Math.round(gs.t + gs.h * (1 - axisOpts._counterDomainMin) + (axisOpts.side === 'bottom' ? axisOpts._depth : 0) + opts._offsetShift + constants.extraPad);\n    rangeSlider.attr('transform', 'translate(' + x + ',' + y + ')'); // update data <--> pixel coordinate conversion methods\n\n    opts._rl = Lib.simpleMap(opts.range, axisOpts.r2l);\n    var rl0 = opts._rl[0];\n    var rl1 = opts._rl[1];\n    var drl = rl1 - rl0;\n\n    opts.p2d = function (v) {\n      return v / opts._width * drl + rl0;\n    };\n\n    opts.d2p = function (v) {\n      return (v - rl0) / drl * opts._width;\n    };\n\n    if (axisOpts.rangebreaks) {\n      var rsBreaks = axisOpts.locateBreaks(rl0, rl1);\n\n      if (rsBreaks.length) {\n        var j, brk;\n        var lBreaks = 0;\n\n        for (j = 0; j < rsBreaks.length; j++) {\n          brk = rsBreaks[j];\n          lBreaks += brk.max - brk.min;\n        } // TODO fix for reversed-range axes !!!\n        // compute slope and piecewise offsets\n\n\n        var m2 = opts._width / (rl1 - rl0 - lBreaks);\n        var _B = [-m2 * rl0];\n\n        for (j = 0; j < rsBreaks.length; j++) {\n          brk = rsBreaks[j];\n\n          _B.push(_B[_B.length - 1] - m2 * (brk.max - brk.min));\n        }\n\n        opts.d2p = function (v) {\n          var b = _B[0];\n\n          for (var j = 0; j < rsBreaks.length; j++) {\n            var brk = rsBreaks[j];\n            if (v >= brk.max) b = _B[j + 1];else if (v < brk.min) break;\n          }\n\n          return b + m2 * v;\n        }; // fill pixel (i.e. 'p') min/max here,\n        // to not have to loop through the _rangebreaks twice during `p2d`\n\n\n        for (j = 0; j < rsBreaks.length; j++) {\n          brk = rsBreaks[j];\n          brk.pmin = opts.d2p(brk.min);\n          brk.pmax = opts.d2p(brk.max);\n        }\n\n        opts.p2d = function (v) {\n          var b = _B[0];\n\n          for (var j = 0; j < rsBreaks.length; j++) {\n            var brk = rsBreaks[j];\n            if (v >= brk.pmax) b = _B[j + 1];else if (v < brk.pmin) break;\n          }\n\n          return (v - b) / m2;\n        };\n      }\n    }\n\n    if (oppAxisRangeOpts.rangemode !== 'match') {\n      var range0OppAxis = oppAxisOpts.r2l(oppAxisRangeOpts.range[0]);\n      var range1OppAxis = oppAxisOpts.r2l(oppAxisRangeOpts.range[1]);\n      var distOppAxis = range1OppAxis - range0OppAxis;\n\n      opts.d2pOppAxis = function (v) {\n        return (v - range0OppAxis) / distOppAxis * opts._height;\n      };\n    } // update inner nodes\n\n\n    rangeSlider.call(drawBg, gd, axisOpts, opts).call(addClipPath, gd, axisOpts, opts).call(drawRangePlot, gd, axisOpts, opts).call(drawMasks, gd, axisOpts, opts, oppAxisRangeOpts).call(drawSlideBox, gd, axisOpts, opts).call(drawGrabbers, gd, axisOpts, opts); // setup drag element\n\n    setupDragElement(rangeSlider, gd, axisOpts, opts); // update current range\n\n    setPixelRange(rangeSlider, gd, axisOpts, opts, oppAxisOpts, oppAxisRangeOpts); // title goes next to range slider instead of tick labels, so\n    // just take it over and draw it from here\n\n    if (axisOpts.side === 'bottom') {\n      Titles.draw(gd, axisOpts._id + 'title', {\n        propContainer: axisOpts,\n        propName: axisOpts._name + '.title',\n        placeholder: fullLayout._dfltTitle.x,\n        attributes: {\n          x: axisOpts._offset + axisOpts._length / 2,\n          y: y + opts._height + opts._offsetShift + 10 + 1.5 * axisOpts.title.font.size,\n          'text-anchor': 'middle'\n        }\n      });\n    }\n  });\n};\n\nfunction setupDragElement(rangeSlider, gd, axisOpts, opts) {\n  var slideBox = rangeSlider.select('rect.' + constants.slideBoxClassName).node();\n  var grabAreaMin = rangeSlider.select('rect.' + constants.grabAreaMinClassName).node();\n  var grabAreaMax = rangeSlider.select('rect.' + constants.grabAreaMaxClassName).node();\n  rangeSlider.on('mousedown', function () {\n    var event = d3.event;\n    var target = event.target;\n    var startX = event.clientX;\n    var offsetX = startX - rangeSlider.node().getBoundingClientRect().left;\n    var minVal = opts.d2p(axisOpts._rl[0]);\n    var maxVal = opts.d2p(axisOpts._rl[1]);\n    var dragCover = dragElement.coverSlip();\n    dragCover.addEventListener('mousemove', mouseMove);\n    dragCover.addEventListener('mouseup', mouseUp);\n\n    function mouseMove(e) {\n      var delta = +e.clientX - startX;\n      var pixelMin, pixelMax, cursor;\n\n      switch (target) {\n        case slideBox:\n          cursor = 'ew-resize';\n          pixelMin = minVal + delta;\n          pixelMax = maxVal + delta;\n          break;\n\n        case grabAreaMin:\n          cursor = 'col-resize';\n          pixelMin = minVal + delta;\n          pixelMax = maxVal;\n          break;\n\n        case grabAreaMax:\n          cursor = 'col-resize';\n          pixelMin = minVal;\n          pixelMax = maxVal + delta;\n          break;\n\n        default:\n          cursor = 'ew-resize';\n          pixelMin = offsetX;\n          pixelMax = offsetX + delta;\n          break;\n      }\n\n      if (pixelMax < pixelMin) {\n        var tmp = pixelMax;\n        pixelMax = pixelMin;\n        pixelMin = tmp;\n      }\n\n      opts._pixelMin = pixelMin;\n      opts._pixelMax = pixelMax;\n      setCursor(d3.select(dragCover), cursor);\n      setDataRange(rangeSlider, gd, axisOpts, opts);\n    }\n\n    function mouseUp() {\n      dragCover.removeEventListener('mousemove', mouseMove);\n      dragCover.removeEventListener('mouseup', mouseUp);\n      Lib.removeElement(dragCover);\n    }\n  });\n}\n\nfunction setDataRange(rangeSlider, gd, axisOpts, opts) {\n  function clamp(v) {\n    return axisOpts.l2r(Lib.constrain(v, opts._rl[0], opts._rl[1]));\n  }\n\n  var dataMin = clamp(opts.p2d(opts._pixelMin));\n  var dataMax = clamp(opts.p2d(opts._pixelMax));\n  window.requestAnimationFrame(function () {\n    Registry.call('_guiRelayout', gd, axisOpts._name + '.range', [dataMin, dataMax]);\n  });\n}\n\nfunction setPixelRange(rangeSlider, gd, axisOpts, opts, oppAxisOpts, oppAxisRangeOpts) {\n  var hw2 = constants.handleWidth / 2;\n\n  function clamp(v) {\n    return Lib.constrain(v, 0, opts._width);\n  }\n\n  function clampOppAxis(v) {\n    return Lib.constrain(v, 0, opts._height);\n  }\n\n  function clampHandle(v) {\n    return Lib.constrain(v, -hw2, opts._width + hw2);\n  }\n\n  var pixelMin = clamp(opts.d2p(axisOpts._rl[0]));\n  var pixelMax = clamp(opts.d2p(axisOpts._rl[1]));\n  rangeSlider.select('rect.' + constants.slideBoxClassName).attr('x', pixelMin).attr('width', pixelMax - pixelMin);\n  rangeSlider.select('rect.' + constants.maskMinClassName).attr('width', pixelMin);\n  rangeSlider.select('rect.' + constants.maskMaxClassName).attr('x', pixelMax).attr('width', opts._width - pixelMax);\n\n  if (oppAxisRangeOpts.rangemode !== 'match') {\n    var pixelMinOppAxis = opts._height - clampOppAxis(opts.d2pOppAxis(oppAxisOpts._rl[1]));\n    var pixelMaxOppAxis = opts._height - clampOppAxis(opts.d2pOppAxis(oppAxisOpts._rl[0]));\n    rangeSlider.select('rect.' + constants.maskMinOppAxisClassName).attr('x', pixelMin).attr('height', pixelMinOppAxis).attr('width', pixelMax - pixelMin);\n    rangeSlider.select('rect.' + constants.maskMaxOppAxisClassName).attr('x', pixelMin).attr('y', pixelMaxOppAxis).attr('height', opts._height - pixelMaxOppAxis).attr('width', pixelMax - pixelMin);\n    rangeSlider.select('rect.' + constants.slideBoxClassName).attr('y', pixelMinOppAxis).attr('height', pixelMaxOppAxis - pixelMinOppAxis);\n  } // add offset for crispier corners\n  // https://github.com/plotly/plotly.js/pull/1409\n\n\n  var offset = 0.5;\n  var xMin = Math.round(clampHandle(pixelMin - hw2)) - offset;\n  var xMax = Math.round(clampHandle(pixelMax - hw2)) + offset;\n  rangeSlider.select('g.' + constants.grabberMinClassName).attr('transform', 'translate(' + xMin + ',' + offset + ')');\n  rangeSlider.select('g.' + constants.grabberMaxClassName).attr('transform', 'translate(' + xMax + ',' + offset + ')');\n}\n\nfunction drawBg(rangeSlider, gd, axisOpts, opts) {\n  var bg = Lib.ensureSingle(rangeSlider, 'rect', constants.bgClassName, function (s) {\n    s.attr({\n      x: 0,\n      y: 0,\n      'shape-rendering': 'crispEdges'\n    });\n  });\n  var borderCorrect = opts.borderwidth % 2 === 0 ? opts.borderwidth : opts.borderwidth - 1;\n  var offsetShift = -opts._offsetShift;\n  var lw = Drawing.crispRound(gd, opts.borderwidth);\n  bg.attr({\n    width: opts._width + borderCorrect,\n    height: opts._height + borderCorrect,\n    transform: 'translate(' + offsetShift + ',' + offsetShift + ')',\n    fill: opts.bgcolor,\n    stroke: opts.bordercolor,\n    'stroke-width': lw\n  });\n}\n\nfunction addClipPath(rangeSlider, gd, axisOpts, opts) {\n  var fullLayout = gd._fullLayout;\n  var clipPath = Lib.ensureSingleById(fullLayout._topdefs, 'clipPath', opts._clipId, function (s) {\n    s.append('rect').attr({\n      x: 0,\n      y: 0\n    });\n  });\n  clipPath.select('rect').attr({\n    width: opts._width,\n    height: opts._height\n  });\n}\n\nfunction drawRangePlot(rangeSlider, gd, axisOpts, opts) {\n  var calcData = gd.calcdata;\n  var rangePlots = rangeSlider.selectAll('g.' + constants.rangePlotClassName).data(axisOpts._subplotsWith, Lib.identity);\n  rangePlots.enter().append('g').attr('class', function (id) {\n    return constants.rangePlotClassName + ' ' + id;\n  }).call(Drawing.setClipUrl, opts._clipId, gd);\n  rangePlots.order();\n  rangePlots.exit().remove();\n  var mainplotinfo;\n  rangePlots.each(function (id, i) {\n    var plotgroup = d3.select(this);\n    var isMainPlot = i === 0;\n    var oppAxisOpts = axisIDs.getFromId(gd, id, 'y');\n    var oppAxisName = oppAxisOpts._name;\n    var oppAxisRangeOpts = opts[oppAxisName];\n    var mockFigure = {\n      data: [],\n      layout: {\n        xaxis: {\n          type: axisOpts.type,\n          domain: [0, 1],\n          range: opts.range.slice(),\n          calendar: axisOpts.calendar\n        },\n        width: opts._width,\n        height: opts._height,\n        margin: {\n          t: 0,\n          b: 0,\n          l: 0,\n          r: 0\n        }\n      },\n      _context: gd._context\n    };\n\n    if (axisOpts.rangebreaks) {\n      mockFigure.layout.xaxis.rangebreaks = axisOpts.rangebreaks;\n    }\n\n    mockFigure.layout[oppAxisName] = {\n      type: oppAxisOpts.type,\n      domain: [0, 1],\n      range: oppAxisRangeOpts.rangemode !== 'match' ? oppAxisRangeOpts.range.slice() : oppAxisOpts.range.slice(),\n      calendar: oppAxisOpts.calendar\n    };\n\n    if (oppAxisOpts.rangebreaks) {\n      mockFigure.layout[oppAxisName].rangebreaks = oppAxisOpts.rangebreaks;\n    }\n\n    Plots.supplyDefaults(mockFigure);\n    var xa = mockFigure._fullLayout.xaxis;\n    var ya = mockFigure._fullLayout[oppAxisName];\n    xa.clearCalc();\n    xa.setScale();\n    ya.clearCalc();\n    ya.setScale();\n    var plotinfo = {\n      id: id,\n      plotgroup: plotgroup,\n      xaxis: xa,\n      yaxis: ya,\n      isRangePlot: true\n    };\n    if (isMainPlot) mainplotinfo = plotinfo;else {\n      plotinfo.mainplot = 'xy';\n      plotinfo.mainplotinfo = mainplotinfo;\n    }\n    Cartesian.rangePlot(gd, plotinfo, filterRangePlotCalcData(calcData, id));\n  });\n}\n\nfunction filterRangePlotCalcData(calcData, subplotId) {\n  var out = [];\n\n  for (var i = 0; i < calcData.length; i++) {\n    var calcTrace = calcData[i];\n    var trace = calcTrace[0].trace;\n\n    if (trace.xaxis + trace.yaxis === subplotId) {\n      out.push(calcTrace);\n    }\n  }\n\n  return out;\n}\n\nfunction drawMasks(rangeSlider, gd, axisOpts, opts, oppAxisRangeOpts) {\n  var maskMin = Lib.ensureSingle(rangeSlider, 'rect', constants.maskMinClassName, function (s) {\n    s.attr({\n      x: 0,\n      y: 0,\n      'shape-rendering': 'crispEdges'\n    });\n  });\n  maskMin.attr('height', opts._height).call(Color.fill, constants.maskColor);\n  var maskMax = Lib.ensureSingle(rangeSlider, 'rect', constants.maskMaxClassName, function (s) {\n    s.attr({\n      y: 0,\n      'shape-rendering': 'crispEdges'\n    });\n  });\n  maskMax.attr('height', opts._height).call(Color.fill, constants.maskColor); // masks used for oppAxis zoom\n\n  if (oppAxisRangeOpts.rangemode !== 'match') {\n    var maskMinOppAxis = Lib.ensureSingle(rangeSlider, 'rect', constants.maskMinOppAxisClassName, function (s) {\n      s.attr({\n        y: 0,\n        'shape-rendering': 'crispEdges'\n      });\n    });\n    maskMinOppAxis.attr('width', opts._width).call(Color.fill, constants.maskOppAxisColor);\n    var maskMaxOppAxis = Lib.ensureSingle(rangeSlider, 'rect', constants.maskMaxOppAxisClassName, function (s) {\n      s.attr({\n        y: 0,\n        'shape-rendering': 'crispEdges'\n      });\n    });\n    maskMaxOppAxis.attr('width', opts._width).style('border-top', constants.maskOppBorder).call(Color.fill, constants.maskOppAxisColor);\n  }\n}\n\nfunction drawSlideBox(rangeSlider, gd, axisOpts, opts) {\n  if (gd._context.staticPlot) return;\n  var slideBox = Lib.ensureSingle(rangeSlider, 'rect', constants.slideBoxClassName, function (s) {\n    s.attr({\n      y: 0,\n      cursor: constants.slideBoxCursor,\n      'shape-rendering': 'crispEdges'\n    });\n  });\n  slideBox.attr({\n    height: opts._height,\n    fill: constants.slideBoxFill\n  });\n}\n\nfunction drawGrabbers(rangeSlider, gd, axisOpts, opts) {\n  // <g grabber />\n  var grabberMin = Lib.ensureSingle(rangeSlider, 'g', constants.grabberMinClassName);\n  var grabberMax = Lib.ensureSingle(rangeSlider, 'g', constants.grabberMaxClassName); // <g handle />\n\n  var handleFixAttrs = {\n    x: 0,\n    width: constants.handleWidth,\n    rx: constants.handleRadius,\n    fill: Color.background,\n    stroke: Color.defaultLine,\n    'stroke-width': constants.handleStrokeWidth,\n    'shape-rendering': 'crispEdges'\n  };\n  var handleDynamicAttrs = {\n    y: Math.round(opts._height / 4),\n    height: Math.round(opts._height / 2)\n  };\n  var handleMin = Lib.ensureSingle(grabberMin, 'rect', constants.handleMinClassName, function (s) {\n    s.attr(handleFixAttrs);\n  });\n  handleMin.attr(handleDynamicAttrs);\n  var handleMax = Lib.ensureSingle(grabberMax, 'rect', constants.handleMaxClassName, function (s) {\n    s.attr(handleFixAttrs);\n  });\n  handleMax.attr(handleDynamicAttrs); // <g grabarea />\n\n  if (gd._context.staticPlot) return;\n  var grabAreaFixAttrs = {\n    width: constants.grabAreaWidth,\n    x: 0,\n    y: 0,\n    fill: constants.grabAreaFill,\n    cursor: constants.grabAreaCursor\n  };\n  var grabAreaMin = Lib.ensureSingle(grabberMin, 'rect', constants.grabAreaMinClassName, function (s) {\n    s.attr(grabAreaFixAttrs);\n  });\n  grabAreaMin.attr('height', opts._height);\n  var grabAreaMax = Lib.ensureSingle(grabberMax, 'rect', constants.grabAreaMaxClassName, function (s) {\n    s.attr(grabAreaFixAttrs);\n  });\n  grabAreaMax.attr('height', opts._height);\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = ScrollBox;\n\nvar d3 = require('d3');\n\nvar Color = require('../color');\n\nvar Drawing = require('../drawing');\n\nvar Lib = require('../../lib');\n/**\n * Helper class to setup a scroll box\n *\n * @class\n * @param           gd          Plotly's graph div\n * @param           container   Container to be scroll-boxed (as a D3 selection)\n * @param {string}  id          Id for the clip path to implement the scroll box\n */\n\n\nfunction ScrollBox(gd, container, id) {\n  this.gd = gd;\n  this.container = container;\n  this.id = id; // See ScrollBox.prototype.enable for further definition\n\n  this.position = null; // scrollbox position\n\n  this.translateX = null; // scrollbox horizontal translation\n\n  this.translateY = null; // scrollbox vertical translation\n\n  this.hbar = null; // horizontal scrollbar D3 selection\n\n  this.vbar = null; // vertical scrollbar D3 selection\n  // <rect> element to capture pointer events\n\n  this.bg = this.container.selectAll('rect.scrollbox-bg').data([0]);\n  this.bg.exit().on('.drag', null).on('wheel', null).remove();\n  this.bg.enter().append('rect').classed('scrollbox-bg', true).style('pointer-events', 'all').attr({\n    opacity: 0,\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n  });\n} // scroll bar dimensions\n\n\nScrollBox.barWidth = 2;\nScrollBox.barLength = 20;\nScrollBox.barRadius = 2;\nScrollBox.barPad = 1;\nScrollBox.barColor = '#808BA4';\n/**\n * If needed, setup a clip path and scrollbars\n *\n * @method\n * @param {Object}  position\n * @param {number}  position.l  Left side position (in pixels)\n * @param {number}  position.t  Top side (in pixels)\n * @param {number}  position.w  Width (in pixels)\n * @param {number}  position.h  Height (in pixels)\n * @param {string}  [position.direction='down']\n *                  Either 'down', 'left', 'right' or 'up'\n * @param {number}  [translateX=0]  Horizontal offset (in pixels)\n * @param {number}  [translateY=0]  Vertical offset (in pixels)\n */\n\nScrollBox.prototype.enable = function enable(position, translateX, translateY) {\n  var fullLayout = this.gd._fullLayout;\n  var fullWidth = fullLayout.width;\n  var fullHeight = fullLayout.height; // compute position of scrollbox\n\n  this.position = position;\n  var l = this.position.l;\n  var w = this.position.w;\n  var t = this.position.t;\n  var h = this.position.h;\n  var direction = this.position.direction;\n  var isDown = direction === 'down';\n  var isLeft = direction === 'left';\n  var isRight = direction === 'right';\n  var isUp = direction === 'up';\n  var boxW = w;\n  var boxH = h;\n  var boxL, boxR;\n  var boxT, boxB;\n\n  if (!isDown && !isLeft && !isRight && !isUp) {\n    this.position.direction = 'down';\n    isDown = true;\n  }\n\n  var isVertical = isDown || isUp;\n\n  if (isVertical) {\n    boxL = l;\n    boxR = boxL + boxW;\n\n    if (isDown) {\n      // anchor to top side\n      boxT = t;\n      boxB = Math.min(boxT + boxH, fullHeight);\n      boxH = boxB - boxT;\n    } else {\n      // anchor to bottom side\n      boxB = t + boxH;\n      boxT = Math.max(boxB - boxH, 0);\n      boxH = boxB - boxT;\n    }\n  } else {\n    boxT = t;\n    boxB = boxT + boxH;\n\n    if (isLeft) {\n      // anchor to right side\n      boxR = l + boxW;\n      boxL = Math.max(boxR - boxW, 0);\n      boxW = boxR - boxL;\n    } else {\n      // anchor to left side\n      boxL = l;\n      boxR = Math.min(boxL + boxW, fullWidth);\n      boxW = boxR - boxL;\n    }\n  }\n\n  this._box = {\n    l: boxL,\n    t: boxT,\n    w: boxW,\n    h: boxH\n  }; // compute position of horizontal scroll bar\n\n  var needsHorizontalScrollBar = w > boxW;\n  var hbarW = ScrollBox.barLength + 2 * ScrollBox.barPad;\n  var hbarH = ScrollBox.barWidth + 2 * ScrollBox.barPad; // draw horizontal scrollbar on the bottom side\n\n  var hbarL = l;\n  var hbarT = t + h;\n  if (hbarT + hbarH > fullHeight) hbarT = fullHeight - hbarH;\n  var hbar = this.container.selectAll('rect.scrollbar-horizontal').data(needsHorizontalScrollBar ? [0] : []);\n  hbar.exit().on('.drag', null).remove();\n  hbar.enter().append('rect').classed('scrollbar-horizontal', true).call(Color.fill, ScrollBox.barColor);\n\n  if (needsHorizontalScrollBar) {\n    this.hbar = hbar.attr({\n      'rx': ScrollBox.barRadius,\n      'ry': ScrollBox.barRadius,\n      'x': hbarL,\n      'y': hbarT,\n      'width': hbarW,\n      'height': hbarH\n    }); // hbar center moves between hbarXMin and hbarXMin + hbarTranslateMax\n\n    this._hbarXMin = hbarL + hbarW / 2;\n    this._hbarTranslateMax = boxW - hbarW;\n  } else {\n    delete this.hbar;\n    delete this._hbarXMin;\n    delete this._hbarTranslateMax;\n  } // compute position of vertical scroll bar\n\n\n  var needsVerticalScrollBar = h > boxH;\n  var vbarW = ScrollBox.barWidth + 2 * ScrollBox.barPad;\n  var vbarH = ScrollBox.barLength + 2 * ScrollBox.barPad; // draw vertical scrollbar on the right side\n\n  var vbarL = l + w;\n  var vbarT = t;\n  if (vbarL + vbarW > fullWidth) vbarL = fullWidth - vbarW;\n  var vbar = this.container.selectAll('rect.scrollbar-vertical').data(needsVerticalScrollBar ? [0] : []);\n  vbar.exit().on('.drag', null).remove();\n  vbar.enter().append('rect').classed('scrollbar-vertical', true).call(Color.fill, ScrollBox.barColor);\n\n  if (needsVerticalScrollBar) {\n    this.vbar = vbar.attr({\n      'rx': ScrollBox.barRadius,\n      'ry': ScrollBox.barRadius,\n      'x': vbarL,\n      'y': vbarT,\n      'width': vbarW,\n      'height': vbarH\n    }); // vbar center moves between vbarYMin and vbarYMin + vbarTranslateMax\n\n    this._vbarYMin = vbarT + vbarH / 2;\n    this._vbarTranslateMax = boxH - vbarH;\n  } else {\n    delete this.vbar;\n    delete this._vbarYMin;\n    delete this._vbarTranslateMax;\n  } // setup a clip path (if scroll bars are needed)\n\n\n  var clipId = this.id;\n  var clipL = boxL - 0.5;\n  var clipR = needsVerticalScrollBar ? boxR + vbarW + 0.5 : boxR + 0.5;\n  var clipT = boxT - 0.5;\n  var clipB = needsHorizontalScrollBar ? boxB + hbarH + 0.5 : boxB + 0.5;\n\n  var clipPath = fullLayout._topdefs.selectAll('#' + clipId).data(needsHorizontalScrollBar || needsVerticalScrollBar ? [0] : []);\n\n  clipPath.exit().remove();\n  clipPath.enter().append('clipPath').attr('id', clipId).append('rect');\n\n  if (needsHorizontalScrollBar || needsVerticalScrollBar) {\n    this._clipRect = clipPath.select('rect').attr({\n      x: Math.floor(clipL),\n      y: Math.floor(clipT),\n      width: Math.ceil(clipR) - Math.floor(clipL),\n      height: Math.ceil(clipB) - Math.floor(clipT)\n    });\n    this.container.call(Drawing.setClipUrl, clipId, this.gd);\n    this.bg.attr({\n      x: l,\n      y: t,\n      width: w,\n      height: h\n    });\n  } else {\n    this.bg.attr({\n      width: 0,\n      height: 0\n    });\n    this.container.on('wheel', null).on('.drag', null).call(Drawing.setClipUrl, null);\n    delete this._clipRect;\n  } // set up drag listeners (if scroll bars are needed)\n\n\n  if (needsHorizontalScrollBar || needsVerticalScrollBar) {\n    var onBoxDrag = d3.behavior.drag().on('dragstart', function () {\n      d3.event.sourceEvent.preventDefault();\n    }).on('drag', this._onBoxDrag.bind(this));\n    this.container.on('wheel', null).on('wheel', this._onBoxWheel.bind(this)).on('.drag', null).call(onBoxDrag);\n    var onBarDrag = d3.behavior.drag().on('dragstart', function () {\n      d3.event.sourceEvent.preventDefault();\n      d3.event.sourceEvent.stopPropagation();\n    }).on('drag', this._onBarDrag.bind(this));\n\n    if (needsHorizontalScrollBar) {\n      this.hbar.on('.drag', null).call(onBarDrag);\n    }\n\n    if (needsVerticalScrollBar) {\n      this.vbar.on('.drag', null).call(onBarDrag);\n    }\n  } // set scrollbox translation\n\n\n  this.setTranslate(translateX, translateY);\n};\n/**\n * If present, remove clip-path and scrollbars\n *\n * @method\n */\n\n\nScrollBox.prototype.disable = function disable() {\n  if (this.hbar || this.vbar) {\n    this.bg.attr({\n      width: 0,\n      height: 0\n    });\n    this.container.on('wheel', null).on('.drag', null).call(Drawing.setClipUrl, null);\n    delete this._clipRect;\n  }\n\n  if (this.hbar) {\n    this.hbar.on('.drag', null);\n    this.hbar.remove();\n    delete this.hbar;\n    delete this._hbarXMin;\n    delete this._hbarTranslateMax;\n  }\n\n  if (this.vbar) {\n    this.vbar.on('.drag', null);\n    this.vbar.remove();\n    delete this.vbar;\n    delete this._vbarYMin;\n    delete this._vbarTranslateMax;\n  }\n};\n/**\n * Handles scroll box drag events\n *\n * @method\n */\n\n\nScrollBox.prototype._onBoxDrag = function _onBoxDrag() {\n  var translateX = this.translateX;\n  var translateY = this.translateY;\n\n  if (this.hbar) {\n    translateX -= d3.event.dx;\n  }\n\n  if (this.vbar) {\n    translateY -= d3.event.dy;\n  }\n\n  this.setTranslate(translateX, translateY);\n};\n/**\n * Handles scroll box wheel events\n *\n * @method\n */\n\n\nScrollBox.prototype._onBoxWheel = function _onBoxWheel() {\n  var translateX = this.translateX;\n  var translateY = this.translateY;\n\n  if (this.hbar) {\n    translateX += d3.event.deltaY;\n  }\n\n  if (this.vbar) {\n    translateY += d3.event.deltaY;\n  }\n\n  this.setTranslate(translateX, translateY);\n};\n/**\n * Handles scroll bar drag events\n *\n * @method\n */\n\n\nScrollBox.prototype._onBarDrag = function _onBarDrag() {\n  var translateX = this.translateX;\n  var translateY = this.translateY;\n\n  if (this.hbar) {\n    var xMin = translateX + this._hbarXMin;\n    var xMax = xMin + this._hbarTranslateMax;\n    var x = Lib.constrain(d3.event.x, xMin, xMax);\n    var xf = (x - xMin) / (xMax - xMin);\n    var translateXMax = this.position.w - this._box.w;\n    translateX = xf * translateXMax;\n  }\n\n  if (this.vbar) {\n    var yMin = translateY + this._vbarYMin;\n    var yMax = yMin + this._vbarTranslateMax;\n    var y = Lib.constrain(d3.event.y, yMin, yMax);\n    var yf = (y - yMin) / (yMax - yMin);\n    var translateYMax = this.position.h - this._box.h;\n    translateY = yf * translateYMax;\n  }\n\n  this.setTranslate(translateX, translateY);\n};\n/**\n * Set clip path and scroll bar translate transform\n *\n * @method\n * @param {number}  [translateX=0]  Horizontal offset (in pixels)\n * @param {number}  [translateY=0]  Vertical offset (in pixels)\n */\n\n\nScrollBox.prototype.setTranslate = function setTranslate(translateX, translateY) {\n  // store translateX and translateY (needed by mouse event handlers)\n  var translateXMax = this.position.w - this._box.w;\n  var translateYMax = this.position.h - this._box.h;\n  translateX = Lib.constrain(translateX || 0, 0, translateXMax);\n  translateY = Lib.constrain(translateY || 0, 0, translateYMax);\n  this.translateX = translateX;\n  this.translateY = translateY;\n  this.container.call(Drawing.setTranslate, this._box.l - this.position.l - translateX, this._box.t - this.position.t - translateY);\n\n  if (this._clipRect) {\n    this._clipRect.attr({\n      x: Math.floor(this.position.l + translateX - 0.5),\n      y: Math.floor(this.position.t + translateY - 0.5)\n    });\n  }\n\n  if (this.hbar) {\n    var xf = translateX / translateXMax;\n    this.hbar.call(Drawing.setTranslate, translateX + xf * this._hbarTranslateMax, translateY);\n  }\n\n  if (this.vbar) {\n    var yf = translateY / translateYMax;\n    this.vbar.call(Drawing.setTranslate, translateX, translateY + yf * this._vbarTranslateMax);\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    editType: 'calc',\n    description: ['Determines whether or not this set of error bars is visible.'].join(' ')\n  },\n  type: {\n    valType: 'enumerated',\n    values: ['percent', 'constant', 'sqrt', 'data'],\n    role: 'info',\n    editType: 'calc',\n    description: ['Determines the rule used to generate the error bars.', 'If *constant`, the bar lengths are of a constant value.', 'Set this constant in `value`.', 'If *percent*, the bar lengths correspond to a percentage of', 'underlying data. Set this percentage in `value`.', 'If *sqrt*, the bar lengths correspond to the sqaure of the', 'underlying data.', 'If *data*, the bar lengths are set with data set `array`.'].join(' ')\n  },\n  symmetric: {\n    valType: 'boolean',\n    role: 'info',\n    editType: 'calc',\n    description: ['Determines whether or not the error bars have the same length', 'in both direction', '(top/bottom for vertical bars, left/right for horizontal bars.'].join(' ')\n  },\n  array: {\n    valType: 'data_array',\n    editType: 'calc',\n    description: ['Sets the data corresponding the length of each error bar.', 'Values are plotted relative to the underlying data.'].join(' ')\n  },\n  arrayminus: {\n    valType: 'data_array',\n    editType: 'calc',\n    description: ['Sets the data corresponding the length of each error bar in the', 'bottom (left) direction for vertical (horizontal) bars', 'Values are plotted relative to the underlying data.'].join(' ')\n  },\n  value: {\n    valType: 'number',\n    min: 0,\n    dflt: 10,\n    role: 'info',\n    editType: 'calc',\n    description: ['Sets the value of either the percentage', '(if `type` is set to *percent*) or the constant', '(if `type` is set to *constant*) corresponding to the lengths of', 'the error bars.'].join(' ')\n  },\n  valueminus: {\n    valType: 'number',\n    min: 0,\n    dflt: 10,\n    role: 'info',\n    editType: 'calc',\n    description: ['Sets the value of either the percentage', '(if `type` is set to *percent*) or the constant', '(if `type` is set to *constant*) corresponding to the lengths of', 'the error bars in the', 'bottom (left) direction for vertical (horizontal) bars'].join(' ')\n  },\n  traceref: {\n    valType: 'integer',\n    min: 0,\n    dflt: 0,\n    role: 'info',\n    editType: 'style'\n  },\n  tracerefminus: {\n    valType: 'integer',\n    min: 0,\n    dflt: 0,\n    role: 'info',\n    editType: 'style'\n  },\n  copy_ystyle: {\n    valType: 'boolean',\n    role: 'style',\n    editType: 'plot'\n  },\n  copy_zstyle: {\n    valType: 'boolean',\n    role: 'style',\n    editType: 'style'\n  },\n  color: {\n    valType: 'color',\n    role: 'style',\n    editType: 'style',\n    description: 'Sets the stoke color of the error bars.'\n  },\n  thickness: {\n    valType: 'number',\n    min: 0,\n    dflt: 2,\n    role: 'style',\n    editType: 'style',\n    description: 'Sets the thickness (in px) of the error bars.'\n  },\n  width: {\n    valType: 'number',\n    min: 0,\n    role: 'style',\n    editType: 'plot',\n    description: ['Sets the width (in px) of the cross-bar at both ends', 'of the error bars.'].join(' ')\n  },\n  editType: 'calc',\n  _deprecated: {\n    opacity: {\n      valType: 'number',\n      role: 'style',\n      editType: 'style',\n      description: ['Obsolete.', 'Use the alpha channel in error bar `color` to set the opacity.'].join(' ')\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar tinycolor = require('tinycolor2');\n\nvar Plots = require('../../plots/plots');\n\nvar Registry = require('../../registry');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar dragElement = require('../dragelement');\n\nvar Lib = require('../../lib');\n\nvar extendFlat = require('../../lib/extend').extendFlat;\n\nvar setCursor = require('../../lib/setcursor');\n\nvar Drawing = require('../drawing');\n\nvar Color = require('../color');\n\nvar Titles = require('../titles');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar flipScale = require('../colorscale/helpers').flipScale;\n\nvar handleAxisDefaults = require('../../plots/cartesian/axis_defaults');\n\nvar handleAxisPositionDefaults = require('../../plots/cartesian/position_defaults');\n\nvar axisLayoutAttrs = require('../../plots/cartesian/layout_attributes');\n\nvar alignmentConstants = require('../../constants/alignment');\n\nvar LINE_SPACING = alignmentConstants.LINE_SPACING;\nvar FROM_TL = alignmentConstants.FROM_TL;\nvar FROM_BR = alignmentConstants.FROM_BR;\n\nvar cn = require('./constants').cn;\n\nfunction draw(gd) {\n  var fullLayout = gd._fullLayout;\n\n  var colorBars = fullLayout._infolayer.selectAll('g.' + cn.colorbar).data(makeColorBarData(gd), function (opts) {\n    return opts._id;\n  });\n\n  colorBars.enter().append('g').attr('class', function (opts) {\n    return opts._id;\n  }).classed(cn.colorbar, true);\n  colorBars.each(function (opts) {\n    var g = d3.select(this);\n    Lib.ensureSingle(g, 'rect', cn.cbbg);\n    Lib.ensureSingle(g, 'g', cn.cbfills);\n    Lib.ensureSingle(g, 'g', cn.cblines);\n    Lib.ensureSingle(g, 'g', cn.cbaxis, function (s) {\n      s.classed(cn.crisp, true);\n    });\n    Lib.ensureSingle(g, 'g', cn.cbtitleunshift, function (s) {\n      s.append('g').classed(cn.cbtitle, true);\n    });\n    Lib.ensureSingle(g, 'rect', cn.cboutline);\n    var done = drawColorBar(g, opts, gd);\n    if (done && done.then) (gd._promises || []).push(done);\n\n    if (gd._context.edits.colorbarPosition) {\n      makeEditable(g, opts, gd);\n    }\n  });\n  colorBars.exit().each(function (opts) {\n    Plots.autoMargin(gd, opts._id);\n  }).remove();\n  colorBars.order();\n}\n\nfunction makeColorBarData(gd) {\n  var fullLayout = gd._fullLayout;\n  var calcdata = gd.calcdata;\n  var out = []; // single out item\n\n  var opts; // colorbar attr parent container\n\n  var cont; // trace attr container\n\n  var trace; // colorbar options\n\n  var cbOpt;\n\n  function initOpts(opts) {\n    return extendFlat(opts, {\n      // fillcolor can be a d3 scale, domain is z values, range is colors\n      // or leave it out for no fill,\n      // or set to a string constant for single-color fill\n      _fillcolor: null,\n      // line.color has the same options as fillcolor\n      _line: {\n        color: null,\n        width: null,\n        dash: null\n      },\n      // levels of lines to draw.\n      // note that this DOES NOT determine the extent of the bar\n      // that's given by the domain of fillcolor\n      // (or line.color if no fillcolor domain)\n      _levels: {\n        start: null,\n        end: null,\n        size: null\n      },\n      // separate fill levels (for example, heatmap coloring of a\n      // contour map) if this is omitted, fillcolors will be\n      // evaluated halfway between levels\n      _filllevels: null,\n      // for continuous colorscales: fill with a gradient instead of explicit levels\n      // value should be the colorscale [[0, c0], [v1, c1], ..., [1, cEnd]]\n      _fillgradient: null,\n      // when using a gradient, we need the data range specified separately\n      _zrange: null\n    });\n  }\n\n  function calcOpts() {\n    if (typeof cbOpt.calc === 'function') {\n      cbOpt.calc(gd, trace, opts);\n    } else {\n      opts._fillgradient = cont.reversescale ? flipScale(cont.colorscale) : cont.colorscale;\n      opts._zrange = [cont[cbOpt.min], cont[cbOpt.max]];\n    }\n  }\n\n  for (var i = 0; i < calcdata.length; i++) {\n    var cd = calcdata[i];\n    trace = cd[0].trace;\n    var moduleOpts = trace._module.colorbar;\n\n    if (trace.visible === true && moduleOpts) {\n      var allowsMultiplotCbs = Array.isArray(moduleOpts);\n      var cbOpts = allowsMultiplotCbs ? moduleOpts : [moduleOpts];\n\n      for (var j = 0; j < cbOpts.length; j++) {\n        cbOpt = cbOpts[j];\n        var contName = cbOpt.container;\n        cont = contName ? trace[contName] : trace;\n\n        if (cont && cont.showscale) {\n          opts = initOpts(cont.colorbar);\n          opts._id = 'cb' + trace.uid + (allowsMultiplotCbs && contName ? '-' + contName : '');\n          opts._traceIndex = trace.index;\n          opts._propPrefix = (contName ? contName + '.' : '') + 'colorbar.';\n          opts._meta = trace._meta;\n          calcOpts();\n          out.push(opts);\n        }\n      }\n    }\n  }\n\n  for (var k in fullLayout._colorAxes) {\n    cont = fullLayout[k];\n\n    if (cont.showscale) {\n      var colorAxOpts = fullLayout._colorAxes[k];\n      opts = initOpts(cont.colorbar);\n      opts._id = 'cb' + k;\n      opts._propPrefix = k + '.colorbar.';\n      opts._meta = fullLayout._meta;\n      cbOpt = {\n        min: 'cmin',\n        max: 'cmax'\n      };\n\n      if (colorAxOpts[0] !== 'heatmap') {\n        trace = colorAxOpts[1];\n        cbOpt.calc = trace._module.colorbar.calc;\n      }\n\n      calcOpts();\n      out.push(opts);\n    }\n  }\n\n  return out;\n}\n\nfunction drawColorBar(g, opts, gd) {\n  var fullLayout = gd._fullLayout;\n  var gs = fullLayout._size;\n  var fillColor = opts._fillcolor;\n  var line = opts._line;\n  var title = opts.title;\n  var titleSide = title.side;\n  var zrange = opts._zrange || d3.extent((typeof fillColor === 'function' ? fillColor : line.color).domain());\n  var lineColormap = typeof line.color === 'function' ? line.color : function () {\n    return line.color;\n  };\n  var fillColormap = typeof fillColor === 'function' ? fillColor : function () {\n    return fillColor;\n  };\n  var levelsIn = opts._levels;\n  var levelsOut = calcLevels(gd, opts, zrange);\n  var fillLevels = levelsOut.fill;\n  var lineLevels = levelsOut.line; // we calculate pixel sizes based on the specified graph size,\n  // not the actual (in case something pushed the margins around)\n  // which is a little odd but avoids an odd iterative effect\n  // when the colorbar itself is pushing the margins.\n  // but then the fractional size is calculated based on the\n  // actual graph size, so that the axes will size correctly.\n\n  var thickPx = Math.round(opts.thickness * (opts.thicknessmode === 'fraction' ? gs.w : 1));\n  var thickFrac = thickPx / gs.w;\n  var lenPx = Math.round(opts.len * (opts.lenmode === 'fraction' ? gs.h : 1));\n  var lenFrac = lenPx / gs.h;\n  var xpadFrac = opts.xpad / gs.w;\n  var yExtraPx = (opts.borderwidth + opts.outlinewidth) / 2;\n  var ypadFrac = opts.ypad / gs.h; // x positioning: do it initially just for left anchor,\n  // then fix at the end (since we don't know the width yet)\n\n  var xLeft = Math.round(opts.x * gs.w + opts.xpad); // for dragging... this is getting a little muddled...\n\n  var xLeftFrac = opts.x - thickFrac * ({\n    middle: 0.5,\n    right: 1\n  }[opts.xanchor] || 0); // y positioning we can do correctly from the start\n\n  var yBottomFrac = opts.y + lenFrac * (({\n    top: -0.5,\n    bottom: 0.5\n  }[opts.yanchor] || 0) - 0.5);\n  var yBottomPx = Math.round(gs.h * (1 - yBottomFrac));\n  var yTopPx = yBottomPx - lenPx; // stash a few things for makeEditable\n\n  opts._lenFrac = lenFrac;\n  opts._thickFrac = thickFrac;\n  opts._xLeftFrac = xLeftFrac;\n  opts._yBottomFrac = yBottomFrac; // stash mocked axis for contour label formatting\n\n  var ax = opts._axis = mockColorBarAxis(gd, opts, zrange); // position can't go in through supplyDefaults\n  // because that restricts it to [0,1]\n\n  ax.position = opts.x + xpadFrac + thickFrac;\n\n  if (['top', 'bottom'].indexOf(titleSide) !== -1) {\n    ax.title.side = titleSide;\n    ax.titlex = opts.x + xpadFrac;\n    ax.titley = yBottomFrac + (title.side === 'top' ? lenFrac - ypadFrac : ypadFrac);\n  }\n\n  if (line.color && opts.tickmode === 'auto') {\n    ax.tickmode = 'linear';\n    ax.tick0 = levelsIn.start;\n    var dtick = levelsIn.size; // expand if too many contours, so we don't get too many ticks\n\n    var autoNtick = Lib.constrain((yBottomPx - yTopPx) / 50, 4, 15) + 1;\n    var dtFactor = (zrange[1] - zrange[0]) / ((opts.nticks || autoNtick) * dtick);\n\n    if (dtFactor > 1) {\n      var dtexp = Math.pow(10, Math.floor(Math.log(dtFactor) / Math.LN10));\n      dtick *= dtexp * Lib.roundUp(dtFactor / dtexp, [2, 5, 10]); // if the contours are at round multiples, reset tick0\n      // so they're still at round multiples. Otherwise,\n      // keep the first label on the first contour level\n\n      if ((Math.abs(levelsIn.start) / levelsIn.size + 1e-6) % 1 < 2e-6) {\n        ax.tick0 = 0;\n      }\n    }\n\n    ax.dtick = dtick;\n  } // set domain after init, because we may want to\n  // allow it outside [0,1]\n\n\n  ax.domain = [yBottomFrac + ypadFrac, yBottomFrac + lenFrac - ypadFrac];\n  ax.setScale();\n  g.attr('transform', 'translate(' + Math.round(gs.l) + ',' + Math.round(gs.t) + ')');\n  var titleCont = g.select('.' + cn.cbtitleunshift).attr('transform', 'translate(-' + Math.round(gs.l) + ',-' + Math.round(gs.t) + ')');\n  var axLayer = g.select('.' + cn.cbaxis);\n  var titleEl;\n  var titleHeight = 0;\n\n  function drawTitle(titleClass, titleOpts) {\n    var dfltTitleOpts = {\n      propContainer: ax,\n      propName: opts._propPrefix + 'title',\n      traceIndex: opts._traceIndex,\n      _meta: opts._meta,\n      placeholder: fullLayout._dfltTitle.colorbar,\n      containerGroup: g.select('.' + cn.cbtitle)\n    }; // this class-to-rotate thing with convertToTspans is\n    // getting hackier and hackier... delete groups with the\n    // wrong class (in case earlier the colorbar was drawn on\n    // a different side, I think?)\n\n    var otherClass = titleClass.charAt(0) === 'h' ? titleClass.substr(1) : 'h' + titleClass;\n    g.selectAll('.' + otherClass + ',.' + otherClass + '-math-group').remove();\n    Titles.draw(gd, titleClass, extendFlat(dfltTitleOpts, titleOpts || {}));\n  }\n\n  function drawDummyTitle() {\n    if (['top', 'bottom'].indexOf(titleSide) !== -1) {\n      // draw the title so we know how much room it needs\n      // when we squish the axis. This one only applies to\n      // top or bottom titles, not right side.\n      var x = gs.l + (opts.x + xpadFrac) * gs.w;\n      var fontSize = ax.title.font.size;\n      var y;\n\n      if (titleSide === 'top') {\n        y = (1 - (yBottomFrac + lenFrac - ypadFrac)) * gs.h + gs.t + 3 + fontSize * 0.75;\n      } else {\n        y = (1 - (yBottomFrac + ypadFrac)) * gs.h + gs.t - 3 - fontSize * 0.25;\n      }\n\n      drawTitle(ax._id + 'title', {\n        attributes: {\n          x: x,\n          y: y,\n          'text-anchor': 'start'\n        }\n      });\n    }\n  }\n\n  function drawCbTitle() {\n    if (['top', 'bottom'].indexOf(titleSide) === -1) {\n      var fontSize = ax.title.font.size;\n      var y = ax._offset + ax._length / 2;\n      var x = gs.l + (ax.position || 0) * gs.w + (ax.side === 'right' ? 10 + fontSize * (ax.showticklabels ? 1 : 0.5) : -10 - fontSize * (ax.showticklabels ? 0.5 : 0)); // the 'h' + is a hack to get around the fact that\n      // convertToTspans rotates any 'y...' class by 90 degrees.\n      // TODO: find a better way to control this.\n\n      drawTitle('h' + ax._id + 'title', {\n        avoid: {\n          selection: d3.select(gd).selectAll('g.' + ax._id + 'tick'),\n          side: titleSide,\n          offsetLeft: gs.l,\n          offsetTop: 0,\n          maxShift: fullLayout.width\n        },\n        attributes: {\n          x: x,\n          y: y,\n          'text-anchor': 'middle'\n        },\n        transform: {\n          rotate: '-90',\n          offset: 0\n        }\n      });\n    }\n  }\n\n  function drawAxis() {\n    if (['top', 'bottom'].indexOf(titleSide) !== -1) {\n      // squish the axis top to make room for the title\n      var titleGroup = g.select('.' + cn.cbtitle);\n      var titleText = titleGroup.select('text');\n      var titleTrans = [-opts.outlinewidth / 2, opts.outlinewidth / 2];\n      var mathJaxNode = titleGroup.select('.h' + ax._id + 'title-math-group').node();\n      var lineSize = 15.6;\n\n      if (titleText.node()) {\n        lineSize = parseInt(titleText.node().style.fontSize, 10) * LINE_SPACING;\n      }\n\n      if (mathJaxNode) {\n        titleHeight = Drawing.bBox(mathJaxNode).height;\n\n        if (titleHeight > lineSize) {\n          // not entirely sure how mathjax is doing\n          // vertical alignment, but this seems to work.\n          titleTrans[1] -= (titleHeight - lineSize) / 2;\n        }\n      } else if (titleText.node() && !titleText.classed(cn.jsPlaceholder)) {\n        titleHeight = Drawing.bBox(titleText.node()).height;\n      }\n\n      if (titleHeight) {\n        // buffer btwn colorbar and title\n        // TODO: configurable\n        titleHeight += 5;\n\n        if (titleSide === 'top') {\n          ax.domain[1] -= titleHeight / gs.h;\n          titleTrans[1] *= -1;\n        } else {\n          ax.domain[0] += titleHeight / gs.h;\n          var nlines = svgTextUtils.lineCount(titleText);\n          titleTrans[1] += (1 - nlines) * lineSize;\n        }\n\n        titleGroup.attr('transform', 'translate(' + titleTrans + ')');\n        ax.setScale();\n      }\n    }\n\n    g.selectAll('.' + cn.cbfills + ',.' + cn.cblines).attr('transform', 'translate(0,' + Math.round(gs.h * (1 - ax.domain[1])) + ')');\n    axLayer.attr('transform', 'translate(0,' + Math.round(-gs.t) + ')');\n    var fills = g.select('.' + cn.cbfills).selectAll('rect.' + cn.cbfill).data(fillLevels);\n    fills.enter().append('rect').classed(cn.cbfill, true).style('stroke', 'none');\n    fills.exit().remove();\n    var zBounds = zrange.map(ax.c2p).map(Math.round).sort(function (a, b) {\n      return a - b;\n    });\n    fills.each(function (d, i) {\n      var z = [i === 0 ? zrange[0] : (fillLevels[i] + fillLevels[i - 1]) / 2, i === fillLevels.length - 1 ? zrange[1] : (fillLevels[i] + fillLevels[i + 1]) / 2].map(ax.c2p).map(Math.round); // offset the side adjoining the next rectangle so they\n      // overlap, to prevent antialiasing gaps\n\n      z[1] = Lib.constrain(z[1] + (z[1] > z[0]) ? 1 : -1, zBounds[0], zBounds[1]); // Colorbar cannot currently support opacities so we\n      // use an opaque fill even when alpha channels present\n\n      var fillEl = d3.select(this).attr({\n        x: xLeft,\n        width: Math.max(thickPx, 2),\n        y: d3.min(z),\n        height: Math.max(d3.max(z) - d3.min(z), 2)\n      });\n\n      if (opts._fillgradient) {\n        Drawing.gradient(fillEl, gd, opts._id, 'vertical', opts._fillgradient, 'fill');\n      } else {\n        // tinycolor can't handle exponents and\n        // at this scale, removing it makes no difference.\n        var colorString = fillColormap(d).replace('e-', '');\n        fillEl.attr('fill', tinycolor(colorString).toHexString());\n      }\n    });\n    var lines = g.select('.' + cn.cblines).selectAll('path.' + cn.cbline).data(line.color && line.width ? lineLevels : []);\n    lines.enter().append('path').classed(cn.cbline, true);\n    lines.exit().remove();\n    lines.each(function (d) {\n      d3.select(this).attr('d', 'M' + xLeft + ',' + (Math.round(ax.c2p(d)) + line.width / 2 % 1) + 'h' + thickPx).call(Drawing.lineGroupStyle, line.width, lineColormap(d), line.dash);\n    }); // force full redraw of labels and ticks\n\n    axLayer.selectAll('g.' + ax._id + 'tick,path').remove();\n    var shift = xLeft + thickPx + (opts.outlinewidth || 0) / 2 - (opts.ticks === 'outside' ? 1 : 0);\n    var vals = Axes.calcTicks(ax);\n    var transFn = Axes.makeTransFn(ax);\n    var tickSign = Axes.getTickSigns(ax)[2];\n    Axes.drawTicks(gd, ax, {\n      vals: ax.ticks === 'inside' ? Axes.clipEnds(ax, vals) : vals,\n      layer: axLayer,\n      path: Axes.makeTickPath(ax, shift, tickSign),\n      transFn: transFn\n    });\n    return Axes.drawLabels(gd, ax, {\n      vals: vals,\n      layer: axLayer,\n      transFn: transFn,\n      labelFns: Axes.makeLabelFns(ax, shift)\n    });\n  } // wait for the axis & title to finish rendering before\n  // continuing positioning\n  // TODO: why are we redrawing multiple times now with this?\n  // I guess autoMargin doesn't like being post-promise?\n\n\n  function positionCB() {\n    var innerWidth = thickPx + opts.outlinewidth / 2 + Drawing.bBox(axLayer.node()).width;\n    titleEl = titleCont.select('text');\n\n    if (titleEl.node() && !titleEl.classed(cn.jsPlaceholder)) {\n      var mathJaxNode = titleCont.select('.h' + ax._id + 'title-math-group').node();\n      var titleWidth;\n\n      if (mathJaxNode && ['top', 'bottom'].indexOf(titleSide) !== -1) {\n        titleWidth = Drawing.bBox(mathJaxNode).width;\n      } else {\n        // note: the formula below works for all title sides,\n        // (except for top/bottom mathjax, above)\n        // but the weird gs.l is because the titleunshift\n        // transform gets removed by Drawing.bBox\n        titleWidth = Drawing.bBox(titleCont.node()).right - xLeft - gs.l;\n      }\n\n      innerWidth = Math.max(innerWidth, titleWidth);\n    }\n\n    var outerwidth = 2 * opts.xpad + innerWidth + opts.borderwidth + opts.outlinewidth / 2;\n    var outerheight = yBottomPx - yTopPx;\n    g.select('.' + cn.cbbg).attr({\n      x: xLeft - opts.xpad - (opts.borderwidth + opts.outlinewidth) / 2,\n      y: yTopPx - yExtraPx,\n      width: Math.max(outerwidth, 2),\n      height: Math.max(outerheight + 2 * yExtraPx, 2)\n    }).call(Color.fill, opts.bgcolor).call(Color.stroke, opts.bordercolor).style('stroke-width', opts.borderwidth);\n    g.selectAll('.' + cn.cboutline).attr({\n      x: xLeft,\n      y: yTopPx + opts.ypad + (titleSide === 'top' ? titleHeight : 0),\n      width: Math.max(thickPx, 2),\n      height: Math.max(outerheight - 2 * opts.ypad - titleHeight, 2)\n    }).call(Color.stroke, opts.outlinecolor).style({\n      fill: 'none',\n      'stroke-width': opts.outlinewidth\n    }); // fix positioning for xanchor!='left'\n\n    var xoffset = ({\n      center: 0.5,\n      right: 1\n    }[opts.xanchor] || 0) * outerwidth;\n    g.attr('transform', 'translate(' + (gs.l - xoffset) + ',' + gs.t + ')'); // auto margin adjustment\n\n    var marginOpts = {};\n    var tFrac = FROM_TL[opts.yanchor];\n    var bFrac = FROM_BR[opts.yanchor];\n\n    if (opts.lenmode === 'pixels') {\n      marginOpts.y = opts.y;\n      marginOpts.t = outerheight * tFrac;\n      marginOpts.b = outerheight * bFrac;\n    } else {\n      marginOpts.t = marginOpts.b = 0;\n      marginOpts.yt = opts.y + opts.len * tFrac;\n      marginOpts.yb = opts.y - opts.len * bFrac;\n    }\n\n    var lFrac = FROM_TL[opts.xanchor];\n    var rFrac = FROM_BR[opts.xanchor];\n\n    if (opts.thicknessmode === 'pixels') {\n      marginOpts.x = opts.x;\n      marginOpts.l = outerwidth * lFrac;\n      marginOpts.r = outerwidth * rFrac;\n    } else {\n      var extraThickness = outerwidth - thickPx;\n      marginOpts.l = extraThickness * lFrac;\n      marginOpts.r = extraThickness * rFrac;\n      marginOpts.xl = opts.x - opts.thickness * lFrac;\n      marginOpts.xr = opts.x + opts.thickness * rFrac;\n    }\n\n    Plots.autoMargin(gd, opts._id, marginOpts);\n  }\n\n  return Lib.syncOrAsync([Plots.previousPromises, drawDummyTitle, drawAxis, drawCbTitle, Plots.previousPromises, positionCB], gd);\n}\n\nfunction makeEditable(g, opts, gd) {\n  var fullLayout = gd._fullLayout;\n  var gs = fullLayout._size;\n  var t0, xf, yf;\n  dragElement.init({\n    element: g.node(),\n    gd: gd,\n    prepFn: function prepFn() {\n      t0 = g.attr('transform');\n      setCursor(g);\n    },\n    moveFn: function moveFn(dx, dy) {\n      g.attr('transform', t0 + ' ' + 'translate(' + dx + ',' + dy + ')');\n      xf = dragElement.align(opts._xLeftFrac + dx / gs.w, opts._thickFrac, 0, 1, opts.xanchor);\n      yf = dragElement.align(opts._yBottomFrac - dy / gs.h, opts._lenFrac, 0, 1, opts.yanchor);\n      var csr = dragElement.getCursor(xf, yf, opts.xanchor, opts.yanchor);\n      setCursor(g, csr);\n    },\n    doneFn: function doneFn() {\n      setCursor(g);\n\n      if (xf !== undefined && yf !== undefined) {\n        var update = {};\n        update[opts._propPrefix + 'x'] = xf;\n        update[opts._propPrefix + 'y'] = yf;\n\n        if (opts._traceIndex !== undefined) {\n          Registry.call('_guiRestyle', gd, update, opts._traceIndex);\n        } else {\n          Registry.call('_guiRelayout', gd, update);\n        }\n      }\n    }\n  });\n}\n\nfunction calcLevels(gd, opts, zrange) {\n  var levelsIn = opts._levels;\n  var lineLevels = [];\n  var fillLevels = [];\n  var l;\n  var i;\n  var l0 = levelsIn.end + levelsIn.size / 100;\n  var ls = levelsIn.size;\n  var zr0 = 1.001 * zrange[0] - 0.001 * zrange[1];\n  var zr1 = 1.001 * zrange[1] - 0.001 * zrange[0];\n\n  for (i = 0; i < 1e5; i++) {\n    l = levelsIn.start + i * ls;\n    if (ls > 0 ? l >= l0 : l <= l0) break;\n    if (l > zr0 && l < zr1) lineLevels.push(l);\n  }\n\n  if (opts._fillgradient) {\n    fillLevels = [0];\n  } else if (typeof opts._fillcolor === 'function') {\n    var fillLevelsIn = opts._filllevels;\n\n    if (fillLevelsIn) {\n      l0 = fillLevelsIn.end + fillLevelsIn.size / 100;\n      ls = fillLevelsIn.size;\n\n      for (i = 0; i < 1e5; i++) {\n        l = fillLevelsIn.start + i * ls;\n        if (ls > 0 ? l >= l0 : l <= l0) break;\n        if (l > zrange[0] && l < zrange[1]) fillLevels.push(l);\n      }\n    } else {\n      fillLevels = lineLevels.map(function (v) {\n        return v - levelsIn.size / 2;\n      });\n      fillLevels.push(fillLevels[fillLevels.length - 1] + levelsIn.size);\n    }\n  } else if (opts._fillcolor && typeof opts._fillcolor === 'string') {\n    // doesn't matter what this value is, with a single value\n    // we'll make a single fill rect covering the whole bar\n    fillLevels = [0];\n  }\n\n  if (levelsIn.size < 0) {\n    lineLevels.reverse();\n    fillLevels.reverse();\n  }\n\n  return {\n    line: lineLevels,\n    fill: fillLevels\n  };\n}\n\nfunction mockColorBarAxis(gd, opts, zrange) {\n  var fullLayout = gd._fullLayout;\n  var cbAxisIn = {\n    type: 'linear',\n    range: zrange,\n    tickmode: opts.tickmode,\n    nticks: opts.nticks,\n    tick0: opts.tick0,\n    dtick: opts.dtick,\n    tickvals: opts.tickvals,\n    ticktext: opts.ticktext,\n    ticks: opts.ticks,\n    ticklen: opts.ticklen,\n    tickwidth: opts.tickwidth,\n    tickcolor: opts.tickcolor,\n    showticklabels: opts.showticklabels,\n    tickfont: opts.tickfont,\n    tickangle: opts.tickangle,\n    tickformat: opts.tickformat,\n    exponentformat: opts.exponentformat,\n    separatethousands: opts.separatethousands,\n    showexponent: opts.showexponent,\n    showtickprefix: opts.showtickprefix,\n    tickprefix: opts.tickprefix,\n    showticksuffix: opts.showticksuffix,\n    ticksuffix: opts.ticksuffix,\n    title: opts.title,\n    showline: true,\n    anchor: 'free',\n    side: 'right',\n    position: 1\n  };\n  var cbAxisOut = {\n    type: 'linear',\n    _id: 'y' + opts._id\n  };\n  var axisOptions = {\n    letter: 'y',\n    font: fullLayout.font,\n    noHover: true,\n    noTickson: true,\n    calendar: fullLayout.calendar // not really necessary (yet?)\n\n  };\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(cbAxisIn, cbAxisOut, axisLayoutAttrs, attr, dflt);\n  }\n\n  handleAxisDefaults(cbAxisIn, cbAxisOut, coerce, axisOptions, fullLayout);\n  handleAxisPositionDefaults(cbAxisIn, cbAxisOut, coerce, axisOptions);\n  return cbAxisOut;\n}\n\nmodule.exports = {\n  draw: draw\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar colorAttributes = require('../color/attributes');\n\nmodule.exports = {\n  bgcolor: {\n    valType: 'color',\n    dflt: colorAttributes.background,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the background color of the range slider.'\n  },\n  bordercolor: {\n    valType: 'color',\n    dflt: colorAttributes.defaultLine,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the border color of the range slider.'\n  },\n  borderwidth: {\n    valType: 'integer',\n    dflt: 0,\n    min: 0,\n    role: 'style',\n    editType: 'plot',\n    description: 'Sets the border width of the range slider.'\n  },\n  autorange: {\n    valType: 'boolean',\n    dflt: true,\n    role: 'style',\n    editType: 'calc',\n    impliedEdits: {\n      'range[0]': undefined,\n      'range[1]': undefined\n    },\n    description: ['Determines whether or not the range slider range is', 'computed in relation to the input data.', 'If `range` is provided, then `autorange` is set to *false*.'].join(' ')\n  },\n  range: {\n    valType: 'info_array',\n    role: 'info',\n    items: [{\n      valType: 'any',\n      editType: 'calc',\n      impliedEdits: {\n        '^autorange': false\n      }\n    }, {\n      valType: 'any',\n      editType: 'calc',\n      impliedEdits: {\n        '^autorange': false\n      }\n    }],\n    editType: 'calc',\n    impliedEdits: {\n      'autorange': false\n    },\n    description: ['Sets the range of the range slider.', 'If not set, defaults to the full xaxis range.', 'If the axis `type` is *log*, then you must take the', 'log of your desired range.', 'If the axis `type` is *date*, it should be date strings,', 'like date data, though Date objects and unix milliseconds', 'will be accepted and converted to strings.', 'If the axis `type` is *category*, it should be numbers,', 'using the scale where each category is assigned a serial', 'number from zero in the order it appears.'].join(' ')\n  },\n  thickness: {\n    valType: 'number',\n    dflt: 0.15,\n    min: 0,\n    max: 1,\n    role: 'style',\n    editType: 'plot',\n    description: ['The height of the range slider as a fraction of the', 'total plot area height.'].join(' ')\n  },\n  visible: {\n    valType: 'boolean',\n    dflt: true,\n    role: 'info',\n    editType: 'calc',\n    description: ['Determines whether or not the range slider will be visible.', 'If visible, perpendicular axes will be set to `fixedrange`'].join(' ')\n  },\n  editType: 'calc'\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar Plots = require('../plots');\n\nvar Drawing = require('../../components/drawing');\n\nvar getModuleCalcData = require('../get_data').getModuleCalcData;\n\nvar axisIds = require('./axis_ids');\n\nvar constants = require('./constants');\n\nvar xmlnsNamespaces = require('../../constants/xmlns_namespaces');\n\nvar ensureSingle = Lib.ensureSingle;\n\nfunction ensureSingleAndAddDatum(parent, nodeType, className) {\n  return Lib.ensureSingle(parent, nodeType, className, function (s) {\n    s.datum(className);\n  });\n}\n\nexports.name = 'cartesian';\nexports.attr = ['xaxis', 'yaxis'];\nexports.idRoot = ['x', 'y'];\nexports.idRegex = constants.idRegex;\nexports.attrRegex = constants.attrRegex;\nexports.attributes = require('./attributes');\nexports.layoutAttributes = require('./layout_attributes');\nexports.supplyLayoutDefaults = require('./layout_defaults');\nexports.transitionAxes = require('./transition_axes');\n\nexports.finalizeSubplots = function (layoutIn, layoutOut) {\n  var subplots = layoutOut._subplots;\n  var xList = subplots.xaxis;\n  var yList = subplots.yaxis;\n  var spSVG = subplots.cartesian;\n  var spAll = spSVG.concat(subplots.gl2d || []);\n  var allX = {};\n  var allY = {};\n  var i, xi, yi;\n\n  for (i = 0; i < spAll.length; i++) {\n    var parts = spAll[i].split('y');\n    allX[parts[0]] = 1;\n    allY['y' + parts[1]] = 1;\n  } // check for x axes with no subplot, and make one from the anchor of that x axis\n\n\n  for (i = 0; i < xList.length; i++) {\n    xi = xList[i];\n\n    if (!allX[xi]) {\n      yi = (layoutIn[axisIds.id2name(xi)] || {}).anchor;\n      if (!constants.idRegex.y.test(yi)) yi = 'y';\n      spSVG.push(xi + yi);\n      spAll.push(xi + yi);\n\n      if (!allY[yi]) {\n        allY[yi] = 1;\n        Lib.pushUnique(yList, yi);\n      }\n    }\n  } // same for y axes with no subplot\n\n\n  for (i = 0; i < yList.length; i++) {\n    yi = yList[i];\n\n    if (!allY[yi]) {\n      xi = (layoutIn[axisIds.id2name(yi)] || {}).anchor;\n      if (!constants.idRegex.x.test(xi)) xi = 'x';\n      spSVG.push(xi + yi);\n      spAll.push(xi + yi);\n\n      if (!allX[xi]) {\n        allX[xi] = 1;\n        Lib.pushUnique(xList, xi);\n      }\n    }\n  } // finally, if we've gotten here we're supposed to show cartesian...\n  // so if there are NO subplots at all, make one from the first\n  // x & y axes in the input layout\n\n\n  if (!spAll.length) {\n    xi = '';\n    yi = '';\n\n    for (var ki in layoutIn) {\n      if (constants.attrRegex.test(ki)) {\n        var axLetter = ki.charAt(0);\n\n        if (axLetter === 'x') {\n          if (!xi || +ki.substr(5) < +xi.substr(5)) {\n            xi = ki;\n          }\n        } else if (!yi || +ki.substr(5) < +yi.substr(5)) {\n          yi = ki;\n        }\n      }\n    }\n\n    xi = xi ? axisIds.name2id(xi) : 'x';\n    yi = yi ? axisIds.name2id(yi) : 'y';\n    xList.push(xi);\n    yList.push(yi);\n    spSVG.push(xi + yi);\n  }\n};\n/**\n * Cartesian.plot\n *\n * @param {DOM div | object} gd\n * @param {array (optional)} traces\n *  array of traces indices to plot\n *  if undefined, plots all cartesian traces,\n * @param {object} (optional) transitionOpts\n *  transition option object\n * @param {function} (optional) makeOnCompleteCallback\n *  transition make callback function from Plots.transition\n */\n\n\nexports.plot = function (gd, traces, transitionOpts, makeOnCompleteCallback) {\n  var fullLayout = gd._fullLayout;\n  var subplots = fullLayout._subplots.cartesian;\n  var calcdata = gd.calcdata;\n  var i;\n\n  if (!Array.isArray(traces)) {\n    // If traces is not provided, then it's a complete replot and missing\n    // traces are removed\n    traces = [];\n\n    for (i = 0; i < calcdata.length; i++) {\n      traces.push(i);\n    }\n  }\n\n  for (i = 0; i < subplots.length; i++) {\n    var subplot = subplots[i];\n    var subplotInfo = fullLayout._plots[subplot]; // Get all calcdata for this subplot:\n\n    var cdSubplot = [];\n    var pcd;\n\n    for (var j = 0; j < calcdata.length; j++) {\n      var cd = calcdata[j];\n      var trace = cd[0].trace; // Skip trace if whitelist provided and it's not whitelisted:\n      // if (Array.isArray(traces) && traces.indexOf(i) === -1) continue;\n\n      if (trace.xaxis + trace.yaxis === subplot) {\n        // XXX: Should trace carpet dependencies. Only replot all carpet plots if the carpet\n        // axis has actually changed:\n        //\n        // If this trace is specifically requested, add it to the list:\n        if (traces.indexOf(trace.index) !== -1 || trace.carpet) {\n          // Okay, so example: traces 0, 1, and 2 have fill = tonext. You animate\n          // traces 0 and 2. Trace 1 also needs to be updated, otherwise its fill\n          // is outdated. So this retroactively adds the previous trace if the\n          // traces are interdependent.\n          if (pcd && pcd[0].trace.xaxis + pcd[0].trace.yaxis === subplot && ['tonextx', 'tonexty', 'tonext'].indexOf(trace.fill) !== -1 && cdSubplot.indexOf(pcd) === -1) {\n            cdSubplot.push(pcd);\n          }\n\n          cdSubplot.push(cd);\n        } // Track the previous trace on this subplot for the retroactive-add step\n        // above:\n\n\n        pcd = cd;\n      }\n    }\n\n    plotOne(gd, subplotInfo, cdSubplot, transitionOpts, makeOnCompleteCallback);\n  }\n};\n\nfunction plotOne(gd, plotinfo, cdSubplot, transitionOpts, makeOnCompleteCallback) {\n  var traceLayerClasses = constants.traceLayerClasses;\n  var fullLayout = gd._fullLayout;\n  var modules = fullLayout._modules;\n\n  var _module, cdModuleAndOthers, cdModule;\n\n  var layerData = [];\n  var zoomScaleQueryParts = [];\n\n  for (var i = 0; i < modules.length; i++) {\n    _module = modules[i];\n    var name = _module.name;\n    var categories = Registry.modules[name].categories;\n\n    if (categories.svg) {\n      var className = _module.layerName || name + 'layer';\n      var plotMethod = _module.plot; // plot all visible traces of this type on this subplot at once\n\n      cdModuleAndOthers = getModuleCalcData(cdSubplot, plotMethod);\n      cdModule = cdModuleAndOthers[0]; // don't need to search the found traces again - in fact we need to NOT\n      // so that if two modules share the same plotter we don't double-plot\n\n      cdSubplot = cdModuleAndOthers[1];\n\n      if (cdModule.length) {\n        layerData.push({\n          i: traceLayerClasses.indexOf(className),\n          className: className,\n          plotMethod: plotMethod,\n          cdModule: cdModule\n        });\n      }\n\n      if (categories.zoomScale) {\n        zoomScaleQueryParts.push('.' + className);\n      }\n    }\n  }\n\n  layerData.sort(function (a, b) {\n    return a.i - b.i;\n  });\n  var layers = plotinfo.plot.selectAll('g.mlayer').data(layerData, function (d) {\n    return d.className;\n  });\n  layers.enter().append('g').attr('class', function (d) {\n    return d.className;\n  }).classed('mlayer', true).classed('rangeplot', plotinfo.isRangePlot);\n  layers.exit().remove();\n  layers.order();\n  layers.each(function (d) {\n    var sel = d3.select(this);\n    var className = d.className;\n    d.plotMethod(gd, plotinfo, d.cdModule, sel, transitionOpts, makeOnCompleteCallback); // layers that allow `cliponaxis: false`\n\n    if (constants.clipOnAxisFalseQuery.indexOf('.' + className) === -1) {\n      Drawing.setClipUrl(sel, plotinfo.layerClipId, gd);\n    }\n  }); // call Scattergl.plot separately\n\n  if (fullLayout._has('scattergl')) {\n    _module = Registry.getModule('scattergl');\n    cdModule = getModuleCalcData(cdSubplot, _module)[0];\n\n    _module.plot(gd, plotinfo, cdModule);\n  } // stash \"hot\" selections for faster interaction on drag and scroll\n\n\n  if (!gd._context.staticPlot) {\n    if (plotinfo._hasClipOnAxisFalse) {\n      plotinfo.clipOnAxisFalseTraces = plotinfo.plot.selectAll(constants.clipOnAxisFalseQuery.join(',')).selectAll('.trace');\n    }\n\n    if (zoomScaleQueryParts.length) {\n      var traces = plotinfo.plot.selectAll(zoomScaleQueryParts.join(',')).selectAll('.trace');\n      plotinfo.zoomScalePts = traces.selectAll('path.point');\n      plotinfo.zoomScaleTxt = traces.selectAll('.textpoint');\n    }\n  }\n}\n\nexports.clean = function (newFullData, newFullLayout, oldFullData, oldFullLayout) {\n  var oldPlots = oldFullLayout._plots || {};\n  var newPlots = newFullLayout._plots || {};\n  var oldSubplotList = oldFullLayout._subplots || {};\n  var plotinfo;\n  var i, k; // when going from a large splom graph to something else,\n  // we need to clear <g subplot> so that the new cartesian subplot\n  // can have the correct layer ordering\n\n  if (oldFullLayout._hasOnlyLargeSploms && !newFullLayout._hasOnlyLargeSploms) {\n    for (k in oldPlots) {\n      plotinfo = oldPlots[k];\n      if (plotinfo.plotgroup) plotinfo.plotgroup.remove();\n    }\n  }\n\n  var hadGl = oldFullLayout._has && oldFullLayout._has('gl');\n\n  var hasGl = newFullLayout._has && newFullLayout._has('gl');\n\n  if (hadGl && !hasGl) {\n    for (k in oldPlots) {\n      plotinfo = oldPlots[k];\n      if (plotinfo._scene) plotinfo._scene.destroy();\n    }\n  } // delete any titles we don't need anymore\n  // check if axis list has changed, and if so clear old titles\n\n\n  if (oldSubplotList.xaxis && oldSubplotList.yaxis) {\n    var oldAxIDs = axisIds.listIds({\n      _fullLayout: oldFullLayout\n    });\n\n    for (i = 0; i < oldAxIDs.length; i++) {\n      var oldAxId = oldAxIDs[i];\n\n      if (!newFullLayout[axisIds.id2name(oldAxId)]) {\n        oldFullLayout._infolayer.selectAll('.g-' + oldAxId + 'title').remove();\n      }\n    }\n  }\n\n  var hadCartesian = oldFullLayout._has && oldFullLayout._has('cartesian');\n\n  var hasCartesian = newFullLayout._has && newFullLayout._has('cartesian');\n\n  if (hadCartesian && !hasCartesian) {\n    // if we've gotten rid of all cartesian traces, remove all the subplot svg items\n    purgeSubplotLayers(oldFullLayout._cartesianlayer.selectAll('.subplot'), oldFullLayout);\n\n    oldFullLayout._defs.selectAll('.axesclip').remove();\n\n    delete oldFullLayout._axisConstraintGroups;\n  } else if (oldSubplotList.cartesian) {\n    // otherwise look for subplots we need to remove\n    for (i = 0; i < oldSubplotList.cartesian.length; i++) {\n      var oldSubplotId = oldSubplotList.cartesian[i];\n\n      if (!newPlots[oldSubplotId]) {\n        var selector = '.' + oldSubplotId + ',.' + oldSubplotId + '-x,.' + oldSubplotId + '-y';\n\n        oldFullLayout._cartesianlayer.selectAll(selector).remove();\n\n        removeSubplotExtras(oldSubplotId, oldFullLayout);\n      }\n    }\n  }\n};\n\nexports.drawFramework = function (gd) {\n  var fullLayout = gd._fullLayout;\n  var subplotData = makeSubplotData(gd);\n\n  var subplotLayers = fullLayout._cartesianlayer.selectAll('.subplot').data(subplotData, String);\n\n  subplotLayers.enter().append('g').attr('class', function (d) {\n    return 'subplot ' + d[0];\n  });\n  subplotLayers.order();\n  subplotLayers.exit().call(purgeSubplotLayers, fullLayout);\n  subplotLayers.each(function (d) {\n    var id = d[0];\n    var plotinfo = fullLayout._plots[id];\n    plotinfo.plotgroup = d3.select(this);\n    makeSubplotLayer(gd, plotinfo); // make separate drag layers for each subplot,\n    // but append them to paper rather than the plot groups,\n    // so they end up on top of the rest\n\n    plotinfo.draglayer = ensureSingle(fullLayout._draggers, 'g', id);\n  });\n};\n\nexports.rangePlot = function (gd, plotinfo, cdSubplot) {\n  makeSubplotLayer(gd, plotinfo);\n  plotOne(gd, plotinfo, cdSubplot);\n  Plots.style(gd);\n};\n\nfunction makeSubplotData(gd) {\n  var fullLayout = gd._fullLayout;\n  var ids = fullLayout._subplots.cartesian;\n  var len = ids.length;\n  var i, j, id, plotinfo, xa, ya; // split 'regular' and 'overlaying' subplots\n\n  var regulars = [];\n  var overlays = [];\n\n  for (i = 0; i < len; i++) {\n    id = ids[i];\n    plotinfo = fullLayout._plots[id];\n    xa = plotinfo.xaxis;\n    ya = plotinfo.yaxis;\n    var xa2 = xa._mainAxis;\n    var ya2 = ya._mainAxis;\n    var mainplot = xa2._id + ya2._id;\n    var mainplotinfo = fullLayout._plots[mainplot];\n    plotinfo.overlays = [];\n\n    if (mainplot !== id && mainplotinfo) {\n      plotinfo.mainplot = mainplot;\n      plotinfo.mainplotinfo = mainplotinfo;\n      overlays.push(id);\n    } else {\n      plotinfo.mainplot = undefined;\n      plotinfo.mainPlotinfo = undefined;\n      regulars.push(id);\n    }\n  } // fill in list of overlaying subplots in 'main plot'\n\n\n  for (i = 0; i < overlays.length; i++) {\n    id = overlays[i];\n    plotinfo = fullLayout._plots[id];\n    plotinfo.mainplotinfo.overlays.push(plotinfo);\n  } // put 'regular' subplot data before 'overlaying'\n\n\n  var subplotIds = regulars.concat(overlays);\n  var subplotData = new Array(len);\n\n  for (i = 0; i < len; i++) {\n    id = subplotIds[i];\n    plotinfo = fullLayout._plots[id];\n    xa = plotinfo.xaxis;\n    ya = plotinfo.yaxis; // use info about axis layer and overlaying pattern\n    // to clean what need to be cleaned up in exit selection\n\n    var d = [id, xa.layer, ya.layer, xa.overlaying || '', ya.overlaying || ''];\n\n    for (j = 0; j < plotinfo.overlays.length; j++) {\n      d.push(plotinfo.overlays[j].id);\n    }\n\n    subplotData[i] = d;\n  }\n\n  return subplotData;\n}\n\nfunction makeSubplotLayer(gd, plotinfo) {\n  var plotgroup = plotinfo.plotgroup;\n  var id = plotinfo.id;\n  var xLayer = constants.layerValue2layerClass[plotinfo.xaxis.layer];\n  var yLayer = constants.layerValue2layerClass[plotinfo.yaxis.layer];\n  var hasOnlyLargeSploms = gd._fullLayout._hasOnlyLargeSploms;\n\n  if (!plotinfo.mainplot) {\n    if (hasOnlyLargeSploms) {\n      // TODO could do even better\n      // - we don't need plot (but we would have to mock it in lsInner\n      //   and other places\n      // - we don't (x|y)lines and (x|y)axislayer for most subplots\n      //   usually just the bottom x and left y axes.\n      plotinfo.xlines = ensureSingle(plotgroup, 'path', 'xlines-above');\n      plotinfo.ylines = ensureSingle(plotgroup, 'path', 'ylines-above');\n      plotinfo.xaxislayer = ensureSingle(plotgroup, 'g', 'xaxislayer-above');\n      plotinfo.yaxislayer = ensureSingle(plotgroup, 'g', 'yaxislayer-above');\n    } else {\n      var backLayer = ensureSingle(plotgroup, 'g', 'layer-subplot');\n      plotinfo.shapelayer = ensureSingle(backLayer, 'g', 'shapelayer');\n      plotinfo.imagelayer = ensureSingle(backLayer, 'g', 'imagelayer');\n      plotinfo.gridlayer = ensureSingle(plotgroup, 'g', 'gridlayer');\n      plotinfo.zerolinelayer = ensureSingle(plotgroup, 'g', 'zerolinelayer');\n      ensureSingle(plotgroup, 'path', 'xlines-below');\n      ensureSingle(plotgroup, 'path', 'ylines-below');\n      plotinfo.overlinesBelow = ensureSingle(plotgroup, 'g', 'overlines-below');\n      ensureSingle(plotgroup, 'g', 'xaxislayer-below');\n      ensureSingle(plotgroup, 'g', 'yaxislayer-below');\n      plotinfo.overaxesBelow = ensureSingle(plotgroup, 'g', 'overaxes-below');\n      plotinfo.plot = ensureSingle(plotgroup, 'g', 'plot');\n      plotinfo.overplot = ensureSingle(plotgroup, 'g', 'overplot');\n      plotinfo.xlines = ensureSingle(plotgroup, 'path', 'xlines-above');\n      plotinfo.ylines = ensureSingle(plotgroup, 'path', 'ylines-above');\n      plotinfo.overlinesAbove = ensureSingle(plotgroup, 'g', 'overlines-above');\n      ensureSingle(plotgroup, 'g', 'xaxislayer-above');\n      ensureSingle(plotgroup, 'g', 'yaxislayer-above');\n      plotinfo.overaxesAbove = ensureSingle(plotgroup, 'g', 'overaxes-above'); // set refs to correct layers as determined by 'axis.layer'\n\n      plotinfo.xlines = plotgroup.select('.xlines-' + xLayer);\n      plotinfo.ylines = plotgroup.select('.ylines-' + yLayer);\n      plotinfo.xaxislayer = plotgroup.select('.xaxislayer-' + xLayer);\n      plotinfo.yaxislayer = plotgroup.select('.yaxislayer-' + yLayer);\n    }\n  } else {\n    var mainplotinfo = plotinfo.mainplotinfo;\n    var mainplotgroup = mainplotinfo.plotgroup;\n    var xId = id + '-x';\n    var yId = id + '-y'; // now make the components of overlaid subplots\n    // overlays don't have backgrounds, and append all\n    // their other components to the corresponding\n    // extra groups of their main plots.\n\n    plotinfo.gridlayer = mainplotinfo.gridlayer;\n    plotinfo.zerolinelayer = mainplotinfo.zerolinelayer;\n    ensureSingle(mainplotinfo.overlinesBelow, 'path', xId);\n    ensureSingle(mainplotinfo.overlinesBelow, 'path', yId);\n    ensureSingle(mainplotinfo.overaxesBelow, 'g', xId);\n    ensureSingle(mainplotinfo.overaxesBelow, 'g', yId);\n    plotinfo.plot = ensureSingle(mainplotinfo.overplot, 'g', id);\n    ensureSingle(mainplotinfo.overlinesAbove, 'path', xId);\n    ensureSingle(mainplotinfo.overlinesAbove, 'path', yId);\n    ensureSingle(mainplotinfo.overaxesAbove, 'g', xId);\n    ensureSingle(mainplotinfo.overaxesAbove, 'g', yId); // set refs to correct layers as determined by 'abovetraces'\n\n    plotinfo.xlines = mainplotgroup.select('.overlines-' + xLayer).select('.' + xId);\n    plotinfo.ylines = mainplotgroup.select('.overlines-' + yLayer).select('.' + yId);\n    plotinfo.xaxislayer = mainplotgroup.select('.overaxes-' + xLayer).select('.' + xId);\n    plotinfo.yaxislayer = mainplotgroup.select('.overaxes-' + yLayer).select('.' + yId);\n  } // common attributes for all subplots, overlays or not\n\n\n  if (!hasOnlyLargeSploms) {\n    ensureSingleAndAddDatum(plotinfo.gridlayer, 'g', plotinfo.xaxis._id);\n    ensureSingleAndAddDatum(plotinfo.gridlayer, 'g', plotinfo.yaxis._id);\n    plotinfo.gridlayer.selectAll('g').map(function (d) {\n      return d[0];\n    }).sort(axisIds.idSort);\n  }\n\n  plotinfo.xlines.style('fill', 'none').classed('crisp', true);\n  plotinfo.ylines.style('fill', 'none').classed('crisp', true);\n}\n\nfunction purgeSubplotLayers(layers, fullLayout) {\n  if (!layers) return;\n  var overlayIdsToRemove = {};\n  layers.each(function (d) {\n    var id = d[0];\n    var plotgroup = d3.select(this);\n    plotgroup.remove();\n    removeSubplotExtras(id, fullLayout);\n    overlayIdsToRemove[id] = true; // do not remove individual axis <clipPath>s here\n    // as other subplots may need them\n  }); // must remove overlaid subplot trace layers 'manually'\n\n  for (var k in fullLayout._plots) {\n    var subplotInfo = fullLayout._plots[k];\n    var overlays = subplotInfo.overlays || [];\n\n    for (var j = 0; j < overlays.length; j++) {\n      var overlayInfo = overlays[j];\n\n      if (overlayIdsToRemove[overlayInfo.id]) {\n        overlayInfo.plot.selectAll('.trace').remove();\n      }\n    }\n  }\n}\n\nfunction removeSubplotExtras(subplotId, fullLayout) {\n  fullLayout._draggers.selectAll('g.' + subplotId).remove();\n\n  fullLayout._defs.select('#clip' + fullLayout._uid + subplotId + 'plot').remove();\n}\n\nexports.toSVG = function (gd) {\n  var imageRoot = gd._fullLayout._glimages;\n  var root = d3.select(gd).selectAll('.svg-container');\n  var canvases = root.filter(function (d, i) {\n    return i === root.size() - 1;\n  }).selectAll('.gl-canvas-context, .gl-canvas-focus');\n\n  function canvasToImage() {\n    var canvas = this;\n    var imageData = canvas.toDataURL('image/png');\n    var image = imageRoot.append('svg:image');\n    image.attr({\n      xmlns: xmlnsNamespaces.svg,\n      'xlink:href': imageData,\n      preserveAspectRatio: 'none',\n      x: 0,\n      y: 0,\n      width: canvas.width,\n      height: canvas.height\n    });\n  }\n\n  canvases.each(canvasToImage);\n};\n\nexports.updateFx = require('./graph_interact').updateFx;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'legend',\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  draw: require('./draw'),\n  style: require('./style')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar tinycolor = require('tinycolor2');\n\nvar supportsPassive = require('has-passive-events');\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar svgTextUtils = require('../../lib/svg_text_utils');\n\nvar Color = require('../../components/color');\n\nvar Drawing = require('../../components/drawing');\n\nvar Fx = require('../../components/fx');\n\nvar Axes = require('./axes');\n\nvar setCursor = require('../../lib/setcursor');\n\nvar dragElement = require('../../components/dragelement');\n\nvar helpers = require('../../components/dragelement/helpers');\n\nvar selectingOrDrawing = helpers.selectingOrDrawing;\nvar freeMode = helpers.freeMode;\n\nvar FROM_TL = require('../../constants/alignment').FROM_TL;\n\nvar clearGlCanvases = require('../../lib/clear_gl_canvases');\n\nvar redrawReglTraces = require('../../plot_api/subroutines').redrawReglTraces;\n\nvar Plots = require('../plots');\n\nvar getFromId = require('./axis_ids').getFromId;\n\nvar prepSelect = require('./select').prepSelect;\n\nvar clearSelect = require('./select').clearSelect;\n\nvar selectOnClick = require('./select').selectOnClick;\n\nvar scaleZoom = require('./scale_zoom');\n\nvar constants = require('./constants');\n\nvar MINDRAG = constants.MINDRAG;\nvar MINZOOM = constants.MINZOOM; // flag for showing \"doubleclick to zoom out\" only at the beginning\n\nvar SHOWZOOMOUTTIP = true; // dragBox: create an element to drag one or more axis ends\n// inputs:\n//      plotinfo - which subplot are we making dragboxes on?\n//      x,y,w,h - left, top, width, height of the box\n//      ns - how does this drag the vertical axis?\n//          'n' - top only\n//          's' - bottom only\n//          'ns' - top and bottom together, difference unchanged\n//      ew - same for horizontal axis\n\nfunction makeDragBox(gd, plotinfo, x, y, w, h, ns, ew) {\n  // mouseDown stores ms of first mousedown event in the last\n  // `gd._context.doubleClickDelay` ms on the drag bars\n  // numClicks stores how many mousedowns have been seen\n  // within `gd._context.doubleClickDelay` so we can check for click or doubleclick events\n  // dragged stores whether a drag has occurred, so we don't have to\n  // redraw unnecessarily, ie if no move bigger than MINDRAG or MINZOOM px\n  var zoomlayer = gd._fullLayout._zoomlayer;\n  var isMainDrag = ns + ew === 'nsew';\n  var singleEnd = (ns + ew).length === 1; // main subplot x and y (i.e. found in plotinfo - the main ones)\n\n  var xa0, ya0; // {ax._id: ax} hash objects\n\n  var xaHash, yaHash; // xaHash/yaHash values (arrays)\n\n  var xaxes, yaxes; // main axis offsets\n\n  var xs, ys; // main axis lengths\n\n  var pw, ph; // contains keys 'xaHash', 'yaHash', 'xaxes', and 'yaxes'\n  // which are the x/y {ax._id: ax} hash objects and their values\n  // for linked axis relative to this subplot\n\n  var links; // similar to `links` but for matching axes\n\n  var matches; // set to ew/ns val when active, set to '' when inactive\n\n  var xActive, yActive; // are all axes in this subplot are fixed?\n\n  var allFixedRanges; // do we need to edit x/y ranges?\n\n  var editX, editY; // graph-wide optimization flags\n\n  var hasScatterGl, hasSplom, hasSVG; // collected changes to be made to the plot by relayout at the end\n\n  var updates;\n\n  function recomputeAxisLists() {\n    xa0 = plotinfo.xaxis;\n    ya0 = plotinfo.yaxis;\n    pw = xa0._length;\n    ph = ya0._length;\n    xs = xa0._offset;\n    ys = ya0._offset;\n    xaHash = {};\n    xaHash[xa0._id] = xa0;\n    yaHash = {};\n    yaHash[ya0._id] = ya0; // if we're dragging two axes at once, also drag overlays\n\n    if (ns && ew) {\n      var overlays = plotinfo.overlays;\n\n      for (var i = 0; i < overlays.length; i++) {\n        var xa = overlays[i].xaxis;\n        xaHash[xa._id] = xa;\n        var ya = overlays[i].yaxis;\n        yaHash[ya._id] = ya;\n      }\n    }\n\n    xaxes = hashValues(xaHash);\n    yaxes = hashValues(yaHash);\n    xActive = isDirectionActive(xaxes, ew);\n    yActive = isDirectionActive(yaxes, ns);\n    allFixedRanges = !yActive && !xActive;\n    links = calcLinks(gd, gd._fullLayout._axisConstraintGroups, xaHash, yaHash);\n    matches = calcLinks(gd, gd._fullLayout._axisMatchGroups, xaHash, yaHash);\n    editX = ew || links.isSubplotConstrained || matches.isSubplotConstrained;\n    editY = ns || links.isSubplotConstrained || matches.isSubplotConstrained;\n    var fullLayout = gd._fullLayout;\n    hasScatterGl = fullLayout._has('scattergl');\n    hasSplom = fullLayout._has('splom');\n    hasSVG = fullLayout._has('svg');\n  }\n\n  recomputeAxisLists();\n  var cursor = getDragCursor(yActive + xActive, gd._fullLayout.dragmode, isMainDrag);\n  var dragger = makeRectDragger(plotinfo, ns + ew + 'drag', cursor, x, y, w, h); // still need to make the element if the axes are disabled\n  // but nuke its events (except for maindrag which needs them for hover)\n  // and stop there\n\n  if (allFixedRanges && !isMainDrag) {\n    dragger.onmousedown = null;\n    dragger.style.pointerEvents = 'none';\n    return dragger;\n  }\n\n  var dragOptions = {\n    element: dragger,\n    gd: gd,\n    plotinfo: plotinfo\n  };\n\n  dragOptions.prepFn = function (e, startX, startY) {\n    var dragModePrev = dragOptions.dragmode;\n    var dragModeNow = gd._fullLayout.dragmode;\n\n    if (dragModeNow !== dragModePrev) {\n      dragOptions.dragmode = dragModeNow;\n    }\n\n    recomputeAxisLists();\n\n    if (!allFixedRanges) {\n      if (isMainDrag) {\n        // main dragger handles all drag modes, and changes\n        // to pan (or to zoom if it already is pan) on shift\n        if (e.shiftKey) {\n          if (dragModeNow === 'pan') dragModeNow = 'zoom';else if (!selectingOrDrawing(dragModeNow)) dragModeNow = 'pan';\n        } else if (e.ctrlKey) {\n          dragModeNow = 'pan';\n        }\n      } else {\n        // all other draggers just pan\n        dragModeNow = 'pan';\n      }\n    }\n\n    if (freeMode(dragModeNow)) dragOptions.minDrag = 1;else dragOptions.minDrag = undefined;\n\n    if (selectingOrDrawing(dragModeNow)) {\n      dragOptions.xaxes = xaxes;\n      dragOptions.yaxes = yaxes; // this attaches moveFn, clickFn, doneFn on dragOptions\n\n      prepSelect(e, startX, startY, dragOptions, dragModeNow);\n    } else {\n      dragOptions.clickFn = clickFn;\n\n      if (selectingOrDrawing(dragModePrev)) {\n        // TODO Fix potential bug\n        // Note: clearing / resetting selection state only happens, when user\n        // triggers at least one interaction in pan/zoom mode. Otherwise, the\n        // select/lasso outlines are deleted (in plots.js.cleanPlot) but the selection\n        // cache isn't cleared. So when the user switches back to select/lasso and\n        // 'adds to a selection' with Shift, the \"old\", seemingly removed outlines\n        // are redrawn again because the selection cache still holds their coordinates.\n        // However, this isn't easily solved, since plots.js would need\n        // to have a reference to the dragOptions object (which holds the\n        // selection cache).\n        clearAndResetSelect();\n      }\n\n      if (!allFixedRanges) {\n        if (dragModeNow === 'zoom') {\n          dragOptions.moveFn = zoomMove;\n          dragOptions.doneFn = zoomDone; // zoomMove takes care of the threshold, but we need to\n          // minimize this so that constrained zoom boxes will flip\n          // orientation at the right place\n\n          dragOptions.minDrag = 1;\n          zoomPrep(e, startX, startY);\n        } else if (dragModeNow === 'pan') {\n          dragOptions.moveFn = plotDrag;\n          dragOptions.doneFn = dragTail;\n        }\n      }\n    }\n\n    gd._fullLayout._redrag = function () {\n      var dragDataNow = gd._dragdata;\n\n      if (dragDataNow && dragDataNow.element === dragger) {\n        var dragModeNow = gd._fullLayout.dragmode;\n\n        if (!selectingOrDrawing(dragModeNow)) {\n          recomputeAxisLists();\n          updateSubplots([0, 0, pw, ph]);\n          dragOptions.moveFn(dragDataNow.dx, dragDataNow.dy);\n        } // TODO should we try to \"re-select\" under select/lasso modes?\n        // probably best to wait for https://github.com/plotly/plotly.js/issues/1851\n\n      }\n    };\n  };\n\n  function clearAndResetSelect() {\n    // clear selection polygon cache (if any)\n    dragOptions.plotinfo.selection = false; // clear selection outlines\n\n    clearSelect(gd);\n  }\n\n  function clickFn(numClicks, evt) {\n    var gd = dragOptions.gd;\n\n    if (gd._fullLayout._activeShapeIndex >= 0) {\n      gd._fullLayout._deactivateShape(gd);\n\n      return;\n    }\n\n    var clickmode = gd._fullLayout.clickmode;\n    removeZoombox(gd);\n    if (numClicks === 2 && !singleEnd) doubleClick();\n\n    if (isMainDrag) {\n      if (clickmode.indexOf('select') > -1) {\n        selectOnClick(evt, gd, xaxes, yaxes, plotinfo.id, dragOptions);\n      }\n\n      if (clickmode.indexOf('event') > -1) {\n        Fx.click(gd, evt, plotinfo.id);\n      }\n    } else if (numClicks === 1 && singleEnd) {\n      var ax = ns ? ya0 : xa0;\n      var end = ns === 's' || ew === 'w' ? 0 : 1;\n      var attrStr = ax._name + '.range[' + end + ']';\n      var initialText = getEndText(ax, end);\n      var hAlign = 'left';\n      var vAlign = 'middle';\n      if (ax.fixedrange) return;\n\n      if (ns) {\n        vAlign = ns === 'n' ? 'top' : 'bottom';\n        if (ax.side === 'right') hAlign = 'right';\n      } else if (ew === 'e') hAlign = 'right';\n\n      if (gd._context.showAxisRangeEntryBoxes) {\n        d3.select(dragger).call(svgTextUtils.makeEditable, {\n          gd: gd,\n          immediate: true,\n          background: gd._fullLayout.paper_bgcolor,\n          text: String(initialText),\n          fill: ax.tickfont ? ax.tickfont.color : '#444',\n          horizontalAlign: hAlign,\n          verticalAlign: vAlign\n        }).on('edit', function (text) {\n          var v = ax.d2r(text);\n\n          if (v !== undefined) {\n            Registry.call('_guiRelayout', gd, attrStr, v);\n          }\n        });\n      }\n    }\n  }\n\n  dragElement.init(dragOptions); // x/y px position at start of drag\n\n  var x0, y0; // bbox object of the zoombox\n\n  var box; // luminance of bg behind zoombox\n\n  var lum; // zoombox path outline\n\n  var path0; // is zoombox dimmed (during drag)\n\n  var dimmed; // 'x'-only, 'y' or 'xy' zooming\n\n  var zoomMode; // zoombox d3 selection\n\n  var zb; // zoombox corner d3 selection\n\n  var corners; // zoom takes over minDrag, so it also has to take over gd._dragged\n\n  var zoomDragged;\n\n  function zoomPrep(e, startX, startY) {\n    var dragBBox = dragger.getBoundingClientRect();\n    x0 = startX - dragBBox.left;\n    y0 = startY - dragBBox.top;\n    box = {\n      l: x0,\n      r: x0,\n      w: 0,\n      t: y0,\n      b: y0,\n      h: 0\n    };\n    lum = gd._hmpixcount ? gd._hmlumcount / gd._hmpixcount : tinycolor(gd._fullLayout.plot_bgcolor).getLuminance();\n    path0 = 'M0,0H' + pw + 'V' + ph + 'H0V0';\n    dimmed = false;\n    zoomMode = 'xy';\n    zoomDragged = false;\n    zb = makeZoombox(zoomlayer, lum, xs, ys, path0);\n    corners = makeCorners(zoomlayer, xs, ys);\n  }\n\n  function zoomMove(dx0, dy0) {\n    if (gd._transitioningWithDuration) {\n      return false;\n    }\n\n    var x1 = Math.max(0, Math.min(pw, dx0 + x0));\n    var y1 = Math.max(0, Math.min(ph, dy0 + y0));\n    var dx = Math.abs(x1 - x0);\n    var dy = Math.abs(y1 - y0);\n    box.l = Math.min(x0, x1);\n    box.r = Math.max(x0, x1);\n    box.t = Math.min(y0, y1);\n    box.b = Math.max(y0, y1);\n\n    function noZoom() {\n      zoomMode = '';\n      box.r = box.l;\n      box.t = box.b;\n      corners.attr('d', 'M0,0Z');\n    }\n\n    if (links.isSubplotConstrained) {\n      if (dx > MINZOOM || dy > MINZOOM) {\n        zoomMode = 'xy';\n\n        if (dx / pw > dy / ph) {\n          dy = dx * ph / pw;\n          if (y0 > y1) box.t = y0 - dy;else box.b = y0 + dy;\n        } else {\n          dx = dy * pw / ph;\n          if (x0 > x1) box.l = x0 - dx;else box.r = x0 + dx;\n        }\n\n        corners.attr('d', xyCorners(box));\n      } else {\n        noZoom();\n      }\n    } else if (matches.isSubplotConstrained) {\n      if (dx > MINZOOM || dy > MINZOOM) {\n        zoomMode = 'xy';\n        var r0 = Math.min(box.l / pw, (ph - box.b) / ph);\n        var r1 = Math.max(box.r / pw, (ph - box.t) / ph);\n        box.l = r0 * pw;\n        box.r = r1 * pw;\n        box.b = (1 - r0) * ph;\n        box.t = (1 - r1) * ph;\n        corners.attr('d', xyCorners(box));\n      } else {\n        noZoom();\n      }\n    } else if (!yActive || dy < Math.min(Math.max(dx * 0.6, MINDRAG), MINZOOM)) {\n      // look for small drags in one direction or the other,\n      // and only drag the other axis\n      if (dx < MINDRAG || !xActive) {\n        noZoom();\n      } else {\n        box.t = 0;\n        box.b = ph;\n        zoomMode = 'x';\n        corners.attr('d', xCorners(box, y0));\n      }\n    } else if (!xActive || dx < Math.min(dy * 0.6, MINZOOM)) {\n      box.l = 0;\n      box.r = pw;\n      zoomMode = 'y';\n      corners.attr('d', yCorners(box, x0));\n    } else {\n      zoomMode = 'xy';\n      corners.attr('d', xyCorners(box));\n    }\n\n    box.w = box.r - box.l;\n    box.h = box.b - box.t;\n    if (zoomMode) zoomDragged = true;\n    gd._dragged = zoomDragged;\n    updateZoombox(zb, corners, box, path0, dimmed, lum);\n    computeZoomUpdates();\n    gd.emit('plotly_relayouting', updates);\n    dimmed = true;\n  }\n\n  function computeZoomUpdates() {\n    updates = {}; // TODO: edit linked axes in zoomAxRanges and in dragTail\n\n    if (zoomMode === 'xy' || zoomMode === 'x') {\n      zoomAxRanges(xaxes, box.l / pw, box.r / pw, updates, links.xaxes);\n      updateMatchedAxRange('x', updates);\n    }\n\n    if (zoomMode === 'xy' || zoomMode === 'y') {\n      zoomAxRanges(yaxes, (ph - box.b) / ph, (ph - box.t) / ph, updates, links.yaxes);\n      updateMatchedAxRange('y', updates);\n    }\n  }\n\n  function zoomDone() {\n    computeZoomUpdates();\n    removeZoombox(gd);\n    dragTail();\n    showDoubleClickNotifier(gd);\n  } // scroll zoom, on all draggers except corners\n\n\n  var scrollViewBox = [0, 0, pw, ph]; // wait a little after scrolling before redrawing\n\n  var redrawTimer = null;\n  var REDRAWDELAY = constants.REDRAWDELAY;\n  var mainplot = plotinfo.mainplot ? gd._fullLayout._plots[plotinfo.mainplot] : plotinfo;\n\n  function zoomWheel(e) {\n    // deactivate mousewheel scrolling on embedded graphs\n    // devs can override this with layout._enablescrollzoom,\n    // but _ ensures this setting won't leave their page\n    if (!gd._context._scrollZoom.cartesian && !gd._fullLayout._enablescrollzoom) {\n      return;\n    }\n\n    clearAndResetSelect(); // If a transition is in progress, then disable any behavior:\n\n    if (gd._transitioningWithDuration) {\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    recomputeAxisLists();\n    clearTimeout(redrawTimer);\n    var wheelDelta = -e.deltaY;\n    if (!isFinite(wheelDelta)) wheelDelta = e.wheelDelta / 10;\n\n    if (!isFinite(wheelDelta)) {\n      Lib.log('Did not find wheel motion attributes: ', e);\n      return;\n    }\n\n    var zoom = Math.exp(-Math.min(Math.max(wheelDelta, -20), 20) / 200);\n    var gbb = mainplot.draglayer.select('.nsewdrag').node().getBoundingClientRect();\n    var xfrac = (e.clientX - gbb.left) / gbb.width;\n    var yfrac = (gbb.bottom - e.clientY) / gbb.height;\n    var i;\n\n    function zoomWheelOneAxis(ax, centerFraction, zoom) {\n      if (ax.fixedrange) return;\n      var axRange = Lib.simpleMap(ax.range, ax.r2l);\n      var v0 = axRange[0] + (axRange[1] - axRange[0]) * centerFraction;\n\n      function doZoom(v) {\n        return ax.l2r(v0 + (v - v0) * zoom);\n      }\n\n      ax.range = axRange.map(doZoom);\n    }\n\n    if (editX) {\n      // if we're only zooming this axis because of constraints,\n      // zoom it about the center\n      if (!ew) xfrac = 0.5;\n\n      for (i = 0; i < xaxes.length; i++) {\n        zoomWheelOneAxis(xaxes[i], xfrac, zoom);\n      }\n\n      updateMatchedAxRange('x');\n      scrollViewBox[2] *= zoom;\n      scrollViewBox[0] += scrollViewBox[2] * xfrac * (1 / zoom - 1);\n    }\n\n    if (editY) {\n      if (!ns) yfrac = 0.5;\n\n      for (i = 0; i < yaxes.length; i++) {\n        zoomWheelOneAxis(yaxes[i], yfrac, zoom);\n      }\n\n      updateMatchedAxRange('y');\n      scrollViewBox[3] *= zoom;\n      scrollViewBox[1] += scrollViewBox[3] * (1 - yfrac) * (1 / zoom - 1);\n    } // viewbox redraw at first\n\n\n    updateSubplots(scrollViewBox);\n    ticksAndAnnotations();\n    gd.emit('plotly_relayouting', updates); // then replot after a delay to make sure\n    // no more scrolling is coming\n\n    redrawTimer = setTimeout(function () {\n      scrollViewBox = [0, 0, pw, ph];\n      dragTail();\n    }, REDRAWDELAY);\n    e.preventDefault();\n    return;\n  } // everything but the corners gets wheel zoom\n\n\n  if (ns.length * ew.length !== 1) {\n    attachWheelEventHandler(dragger, zoomWheel);\n  } // plotDrag: move the plot in response to a drag\n\n\n  function plotDrag(dx, dy) {\n    // If a transition is in progress, then disable any behavior:\n    if (gd._transitioningWithDuration) {\n      return;\n    } // prevent axis drawing from monkeying with margins until we're done\n\n\n    gd._fullLayout._replotting = true;\n\n    if (xActive === 'ew' || yActive === 'ns') {\n      if (xActive) {\n        dragAxList(xaxes, dx);\n        updateMatchedAxRange('x');\n      }\n\n      if (yActive) {\n        dragAxList(yaxes, dy);\n        updateMatchedAxRange('y');\n      }\n\n      updateSubplots([xActive ? -dx : 0, yActive ? -dy : 0, pw, ph]);\n      ticksAndAnnotations();\n      gd.emit('plotly_relayouting', updates);\n      return;\n    } // dz: set a new value for one end (0 or 1) of an axis array axArray,\n    // and return a pixel shift for that end for the viewbox\n    // based on pixel drag distance d\n    // TODO: this makes (generally non-fatal) errors when you get\n    // near floating point limits\n\n\n    function dz(axArray, end, d) {\n      var otherEnd = 1 - end;\n      var movedAx;\n      var newLinearizedEnd;\n\n      for (var i = 0; i < axArray.length; i++) {\n        var axi = axArray[i];\n        if (axi.fixedrange) continue;\n        movedAx = axi;\n        newLinearizedEnd = axi._rl[otherEnd] + (axi._rl[end] - axi._rl[otherEnd]) / dZoom(d / axi._length);\n        var newEnd = axi.l2r(newLinearizedEnd); // if l2r comes back false or undefined, it means we've dragged off\n        // the end of valid ranges - so stop.\n\n        if (newEnd !== false && newEnd !== undefined) axi.range[end] = newEnd;\n      }\n\n      return movedAx._length * (movedAx._rl[end] - newLinearizedEnd) / (movedAx._rl[end] - movedAx._rl[otherEnd]);\n    }\n\n    if (links.isSubplotConstrained && xActive && yActive) {\n      // dragging a corner of a constrained subplot:\n      // respect the fixed corner, but harmonize dx and dy\n      var dxySign = xActive === 'w' === (yActive === 'n') ? 1 : -1;\n      var dxyFraction = (dx / pw + dxySign * dy / ph) / 2;\n      dx = dxyFraction * pw;\n      dy = dxySign * dxyFraction * ph;\n    }\n\n    if (xActive === 'w') dx = dz(xaxes, 0, dx);else if (xActive === 'e') dx = dz(xaxes, 1, -dx);else if (!xActive) dx = 0;\n    if (yActive === 'n') dy = dz(yaxes, 1, dy);else if (yActive === 's') dy = dz(yaxes, 0, -dy);else if (!yActive) dy = 0;\n    var xStart = xActive === 'w' ? dx : 0;\n    var yStart = yActive === 'n' ? dy : 0;\n\n    if (links.isSubplotConstrained) {\n      var i;\n\n      if (!xActive && yActive.length === 1) {\n        // dragging one end of the y axis of a constrained subplot\n        // scale the other axis the same about its middle\n        for (i = 0; i < xaxes.length; i++) {\n          xaxes[i].range = xaxes[i]._r.slice();\n          scaleZoom(xaxes[i], 1 - dy / ph);\n        }\n\n        dx = dy * pw / ph;\n        xStart = dx / 2;\n      }\n\n      if (!yActive && xActive.length === 1) {\n        for (i = 0; i < yaxes.length; i++) {\n          yaxes[i].range = yaxes[i]._r.slice();\n          scaleZoom(yaxes[i], 1 - dx / pw);\n        }\n\n        dy = dx * ph / pw;\n        yStart = dy / 2;\n      }\n    }\n\n    updateMatchedAxRange('x');\n    updateMatchedAxRange('y');\n    updateSubplots([xStart, yStart, pw - dx, ph - dy]);\n    ticksAndAnnotations();\n    gd.emit('plotly_relayouting', updates);\n  }\n\n  function updateMatchedAxRange(axLetter, out) {\n    var matchedAxes = matches.isSubplotConstrained ? {\n      x: yaxes,\n      y: xaxes\n    }[axLetter] : matches[axLetter + 'axes'];\n    var constrainedAxes = matches.isSubplotConstrained ? {\n      x: xaxes,\n      y: yaxes\n    }[axLetter] : [];\n\n    for (var i = 0; i < matchedAxes.length; i++) {\n      var ax = matchedAxes[i];\n      var axId = ax._id;\n      var axId2 = matches.xLinks[axId] || matches.yLinks[axId];\n      var ax2 = constrainedAxes[0] || xaHash[axId2] || yaHash[axId2];\n\n      if (ax2) {\n        if (out) {\n          // zoombox case - don't mutate 'range', just add keys in 'updates'\n          out[ax._name + '.range[0]'] = out[ax2._name + '.range[0]'];\n          out[ax._name + '.range[1]'] = out[ax2._name + '.range[1]'];\n        } else {\n          ax.range = ax2.range.slice();\n        }\n      }\n    }\n  } // Draw ticks and annotations (and other components) when ranges change.\n  // Also records the ranges that have changed for use by update at the end.\n\n\n  function ticksAndAnnotations() {\n    var activeAxIds = [];\n    var i;\n\n    function pushActiveAxIds(axList) {\n      for (i = 0; i < axList.length; i++) {\n        if (!axList[i].fixedrange) activeAxIds.push(axList[i]._id);\n      }\n    }\n\n    if (editX) {\n      pushActiveAxIds(xaxes);\n      pushActiveAxIds(links.xaxes);\n      pushActiveAxIds(matches.xaxes);\n    }\n\n    if (editY) {\n      pushActiveAxIds(yaxes);\n      pushActiveAxIds(links.yaxes);\n      pushActiveAxIds(matches.yaxes);\n    }\n\n    updates = {};\n\n    for (i = 0; i < activeAxIds.length; i++) {\n      var axId = activeAxIds[i];\n      var ax = getFromId(gd, axId);\n      Axes.drawOne(gd, ax, {\n        skipTitle: true\n      });\n      updates[ax._name + '.range[0]'] = ax.range[0];\n      updates[ax._name + '.range[1]'] = ax.range[1];\n    }\n\n    Axes.redrawComponents(gd, activeAxIds);\n  }\n\n  function doubleClick() {\n    if (gd._transitioningWithDuration) return;\n    var doubleClickConfig = gd._context.doubleClick;\n    var axList = [];\n    if (xActive) axList = axList.concat(xaxes);\n    if (yActive) axList = axList.concat(yaxes);\n    if (matches.xaxes) axList = axList.concat(matches.xaxes);\n    if (matches.yaxes) axList = axList.concat(matches.yaxes);\n    var attrs = {};\n    var ax, i, rangeInitial; // For reset+autosize mode:\n    // If *any* of the main axes is not at its initial range\n    // (or autoranged, if we have no initial range, to match the logic in\n    // doubleClickConfig === 'reset' below), we reset.\n    // If they are *all* at their initial ranges, then we autosize.\n\n    if (doubleClickConfig === 'reset+autosize') {\n      doubleClickConfig = 'autosize';\n\n      for (i = 0; i < axList.length; i++) {\n        ax = axList[i];\n\n        if (ax._rangeInitial && (ax.range[0] !== ax._rangeInitial[0] || ax.range[1] !== ax._rangeInitial[1]) || !ax._rangeInitial && !ax.autorange) {\n          doubleClickConfig = 'reset';\n          break;\n        }\n      }\n    }\n\n    if (doubleClickConfig === 'autosize') {\n      // don't set the linked axes here, so relayout marks them as shrinkable\n      // and we autosize just to the requested axis/axes\n      for (i = 0; i < axList.length; i++) {\n        ax = axList[i];\n        if (!ax.fixedrange) attrs[ax._name + '.autorange'] = true;\n      }\n    } else if (doubleClickConfig === 'reset') {\n      // when we're resetting, reset all linked axes too, so we get back\n      // to the fully-auto-with-constraints situation\n      if (xActive || links.isSubplotConstrained) axList = axList.concat(links.xaxes);\n      if (yActive && !links.isSubplotConstrained) axList = axList.concat(links.yaxes);\n\n      if (links.isSubplotConstrained) {\n        if (!xActive) axList = axList.concat(xaxes);else if (!yActive) axList = axList.concat(yaxes);\n      }\n\n      for (i = 0; i < axList.length; i++) {\n        ax = axList[i];\n\n        if (!ax.fixedrange) {\n          if (!ax._rangeInitial) {\n            attrs[ax._name + '.autorange'] = true;\n          } else {\n            rangeInitial = ax._rangeInitial;\n            attrs[ax._name + '.range[0]'] = rangeInitial[0];\n            attrs[ax._name + '.range[1]'] = rangeInitial[1];\n          }\n        }\n      }\n    }\n\n    gd.emit('plotly_doubleclick', null);\n    Registry.call('_guiRelayout', gd, attrs);\n  } // dragTail - finish a drag event with a redraw\n\n\n  function dragTail() {\n    // put the subplot viewboxes back to default (Because we're going to)\n    // be repositioning the data in the relayout. But DON'T call\n    // ticksAndAnnotations again - it's unnecessary and would overwrite `updates`\n    updateSubplots([0, 0, pw, ph]); // since we may have been redrawing some things during the drag, we may have\n    // accumulated MathJax promises - wait for them before we relayout.\n\n    Lib.syncOrAsync([Plots.previousPromises, function () {\n      gd._fullLayout._replotting = false;\n      Registry.call('_guiRelayout', gd, updates);\n    }], gd);\n  } // updateSubplots - find all plot viewboxes that should be\n  // affected by this drag, and update them. look for all plots\n  // sharing an affected axis (including the one being dragged),\n  // includes also scattergl and splom logic.\n\n\n  function updateSubplots(viewBox) {\n    var fullLayout = gd._fullLayout;\n    var plotinfos = fullLayout._plots;\n    var subplots = fullLayout._subplots.cartesian;\n    var i, sp, xa, ya;\n\n    if (hasSplom) {\n      Registry.subplotsRegistry.splom.drag(gd);\n    }\n\n    if (hasScatterGl) {\n      for (i = 0; i < subplots.length; i++) {\n        sp = plotinfos[subplots[i]];\n        xa = sp.xaxis;\n        ya = sp.yaxis;\n\n        if (sp._scene) {\n          var xrng = Lib.simpleMap(xa.range, xa.r2l);\n          var yrng = Lib.simpleMap(ya.range, ya.r2l);\n\n          sp._scene.update({\n            range: [xrng[0], yrng[0], xrng[1], yrng[1]]\n          });\n        }\n      }\n    }\n\n    if (hasSplom || hasScatterGl) {\n      clearGlCanvases(gd);\n      redrawReglTraces(gd);\n    }\n\n    if (hasSVG) {\n      var xScaleFactor = viewBox[2] / xa0._length;\n      var yScaleFactor = viewBox[3] / ya0._length;\n\n      for (i = 0; i < subplots.length; i++) {\n        sp = plotinfos[subplots[i]];\n        xa = sp.xaxis;\n        ya = sp.yaxis;\n        var editX2 = editX && !xa.fixedrange && xaHash[xa._id];\n        var editY2 = editY && !ya.fixedrange && yaHash[ya._id];\n        var xScaleFactor2, yScaleFactor2;\n        var clipDx, clipDy;\n\n        if (editX2) {\n          xScaleFactor2 = xScaleFactor;\n          clipDx = ew ? viewBox[0] : getShift(xa, xScaleFactor2);\n        } else if (matches.xaHash[xa._id]) {\n          xScaleFactor2 = xScaleFactor;\n          clipDx = viewBox[0] * xa._length / xa0._length;\n        } else if (matches.yaHash[xa._id]) {\n          xScaleFactor2 = yScaleFactor;\n          clipDx = yActive === 'ns' ? -viewBox[1] * xa._length / ya0._length : getShift(xa, xScaleFactor2, {\n            n: 'top',\n            s: 'bottom'\n          }[yActive]);\n        } else {\n          xScaleFactor2 = getLinkedScaleFactor(xa, xScaleFactor, yScaleFactor);\n          clipDx = scaleAndGetShift(xa, xScaleFactor2);\n        }\n\n        if (editY2) {\n          yScaleFactor2 = yScaleFactor;\n          clipDy = ns ? viewBox[1] : getShift(ya, yScaleFactor2);\n        } else if (matches.yaHash[ya._id]) {\n          yScaleFactor2 = yScaleFactor;\n          clipDy = viewBox[1] * ya._length / ya0._length;\n        } else if (matches.xaHash[ya._id]) {\n          yScaleFactor2 = xScaleFactor;\n          clipDy = xActive === 'ew' ? -viewBox[0] * ya._length / xa0._length : getShift(ya, yScaleFactor2, {\n            e: 'right',\n            w: 'left'\n          }[xActive]);\n        } else {\n          yScaleFactor2 = getLinkedScaleFactor(ya, xScaleFactor, yScaleFactor);\n          clipDy = scaleAndGetShift(ya, yScaleFactor2);\n        } // don't scale at all if neither axis is scalable here\n\n\n        if (!xScaleFactor2 && !yScaleFactor2) {\n          continue;\n        } // but if only one is, reset the other axis scaling\n\n\n        if (!xScaleFactor2) xScaleFactor2 = 1;\n        if (!yScaleFactor2) yScaleFactor2 = 1;\n        var plotDx = xa._offset - clipDx / xScaleFactor2;\n        var plotDy = ya._offset - clipDy / yScaleFactor2; // TODO could be more efficient here:\n        // setTranslate and setScale do a lot of extra work\n        // when working independently, should perhaps combine\n        // them into a single routine.\n\n        sp.clipRect.call(Drawing.setTranslate, clipDx, clipDy).call(Drawing.setScale, xScaleFactor2, yScaleFactor2);\n        sp.plot.call(Drawing.setTranslate, plotDx, plotDy).call(Drawing.setScale, 1 / xScaleFactor2, 1 / yScaleFactor2); // apply an inverse scale to individual points to counteract\n        // the scale of the trace group.\n        // apply only when scale changes, as adjusting the scale of\n        // all the points can be expansive.\n\n        if (xScaleFactor2 !== sp.xScaleFactor || yScaleFactor2 !== sp.yScaleFactor) {\n          Drawing.setPointGroupScale(sp.zoomScalePts, xScaleFactor2, yScaleFactor2);\n          Drawing.setTextPointsScale(sp.zoomScaleTxt, xScaleFactor2, yScaleFactor2);\n        }\n\n        Drawing.hideOutsideRangePoints(sp.clipOnAxisFalseTraces, sp); // update x/y scaleFactor stash\n\n        sp.xScaleFactor = xScaleFactor2;\n        sp.yScaleFactor = yScaleFactor2;\n      }\n    }\n  } // Find the appropriate scaling for this axis, if it's linked to the\n  // dragged axes by constraints. 0 is special, it means this axis shouldn't\n  // ever be scaled (will be converted to 1 if the other axis is scaled)\n\n\n  function getLinkedScaleFactor(ax, xScaleFactor, yScaleFactor) {\n    if (ax.fixedrange) return 0;\n\n    if (editX && links.xaHash[ax._id]) {\n      return xScaleFactor;\n    }\n\n    if (editY && (links.isSubplotConstrained ? links.xaHash : links.yaHash)[ax._id]) {\n      return yScaleFactor;\n    }\n\n    return 0;\n  }\n\n  function scaleAndGetShift(ax, scaleFactor) {\n    if (scaleFactor) {\n      ax.range = ax._r.slice();\n      scaleZoom(ax, scaleFactor);\n      return getShift(ax, scaleFactor);\n    }\n\n    return 0;\n  }\n\n  function getShift(ax, scaleFactor, from) {\n    return ax._length * (1 - scaleFactor) * FROM_TL[from || ax.constraintoward || 'middle'];\n  }\n\n  return dragger;\n}\n\nfunction makeDragger(plotinfo, nodeName, dragClass, cursor) {\n  var dragger3 = Lib.ensureSingle(plotinfo.draglayer, nodeName, dragClass, function (s) {\n    s.classed('drag', true).style({\n      fill: 'transparent',\n      'stroke-width': 0\n    }).attr('data-subplot', plotinfo.id);\n  });\n  dragger3.call(setCursor, cursor);\n  return dragger3.node();\n}\n\nfunction makeRectDragger(plotinfo, dragClass, cursor, x, y, w, h) {\n  var dragger = makeDragger(plotinfo, 'rect', dragClass, cursor);\n  d3.select(dragger).call(Drawing.setRect, x, y, w, h);\n  return dragger;\n}\n\nfunction isDirectionActive(axList, activeVal) {\n  for (var i = 0; i < axList.length; i++) {\n    if (!axList[i].fixedrange) return activeVal;\n  }\n\n  return '';\n}\n\nfunction getEndText(ax, end) {\n  var initialVal = ax.range[end];\n  var diff = Math.abs(initialVal - ax.range[1 - end]);\n  var dig; // TODO: this should basically be ax.r2d but we're doing extra\n  // rounding here... can we clean up at all?\n\n  if (ax.type === 'date') {\n    return initialVal;\n  } else if (ax.type === 'log') {\n    dig = Math.ceil(Math.max(0, -Math.log(diff) / Math.LN10)) + 3;\n    return d3.format('.' + dig + 'g')(Math.pow(10, initialVal));\n  } else {\n    // linear numeric (or category... but just show numbers here)\n    dig = Math.floor(Math.log(Math.abs(initialVal)) / Math.LN10) - Math.floor(Math.log(diff) / Math.LN10) + 4;\n    return d3.format('.' + String(dig) + 'g')(initialVal);\n  }\n}\n\nfunction zoomAxRanges(axList, r0Fraction, r1Fraction, updates, linkedAxes) {\n  for (var i = 0; i < axList.length; i++) {\n    var axi = axList[i];\n    if (axi.fixedrange) continue;\n\n    if (axi.rangebreaks) {\n      var isY = axi._id.charAt(0) === 'y';\n      var r0F = isY ? 1 - r0Fraction : r0Fraction;\n      var r1F = isY ? 1 - r1Fraction : r1Fraction;\n      updates[axi._name + '.range[0]'] = axi.l2r(axi.p2l(r0F * axi._length));\n      updates[axi._name + '.range[1]'] = axi.l2r(axi.p2l(r1F * axi._length));\n    } else {\n      var axRangeLinear0 = axi._rl[0];\n      var axRangeLinearSpan = axi._rl[1] - axRangeLinear0;\n      updates[axi._name + '.range[0]'] = axi.l2r(axRangeLinear0 + axRangeLinearSpan * r0Fraction);\n      updates[axi._name + '.range[1]'] = axi.l2r(axRangeLinear0 + axRangeLinearSpan * r1Fraction);\n    }\n  } // zoom linked axes about their centers\n\n\n  if (linkedAxes && linkedAxes.length) {\n    var linkedR0Fraction = (r0Fraction + (1 - r1Fraction)) / 2;\n    zoomAxRanges(linkedAxes, linkedR0Fraction, 1 - linkedR0Fraction, updates, []);\n  }\n}\n\nfunction dragAxList(axList, pix) {\n  for (var i = 0; i < axList.length; i++) {\n    var axi = axList[i];\n\n    if (!axi.fixedrange) {\n      if (axi.rangebreaks) {\n        var p0 = 0;\n        var p1 = axi._length;\n        var d0 = axi.p2l(p0 + pix) - axi.p2l(p0);\n        var d1 = axi.p2l(p1 + pix) - axi.p2l(p1);\n        var delta = (d0 + d1) / 2;\n        axi.range = [axi.l2r(axi._rl[0] - delta), axi.l2r(axi._rl[1] - delta)];\n      } else {\n        axi.range = [axi.l2r(axi._rl[0] - pix / axi._m), axi.l2r(axi._rl[1] - pix / axi._m)];\n      }\n    }\n  }\n} // common transform for dragging one end of an axis\n// d>0 is compressing scale (cursor is over the plot,\n//  the axis end should move with the cursor)\n// d<0 is expanding (cursor is off the plot, axis end moves\n//  nonlinearly so you can expand far)\n\n\nfunction dZoom(d) {\n  return 1 - (d >= 0 ? Math.min(d, 0.9) : 1 / (1 / Math.max(d, -0.3) + 3.222));\n}\n\nfunction getDragCursor(nsew, dragmode, isMainDrag) {\n  if (!nsew) return 'pointer';\n\n  if (nsew === 'nsew') {\n    // in this case here, clear cursor and\n    // use the cursor style set on <g .draglayer>\n    if (isMainDrag) return '';\n    if (dragmode === 'pan') return 'move';\n    return 'crosshair';\n  }\n\n  return nsew.toLowerCase() + '-resize';\n}\n\nfunction makeZoombox(zoomlayer, lum, xs, ys, path0) {\n  return zoomlayer.append('path').attr('class', 'zoombox').style({\n    'fill': lum > 0.2 ? 'rgba(0,0,0,0)' : 'rgba(255,255,255,0)',\n    'stroke-width': 0\n  }).attr('transform', 'translate(' + xs + ', ' + ys + ')').attr('d', path0 + 'Z');\n}\n\nfunction makeCorners(zoomlayer, xs, ys) {\n  return zoomlayer.append('path').attr('class', 'zoombox-corners').style({\n    fill: Color.background,\n    stroke: Color.defaultLine,\n    'stroke-width': 1,\n    opacity: 0\n  }).attr('transform', 'translate(' + xs + ', ' + ys + ')').attr('d', 'M0,0Z');\n}\n\nfunction updateZoombox(zb, corners, box, path0, dimmed, lum) {\n  zb.attr('d', path0 + 'M' + box.l + ',' + box.t + 'v' + box.h + 'h' + box.w + 'v-' + box.h + 'h-' + box.w + 'Z');\n  transitionZoombox(zb, corners, dimmed, lum);\n}\n\nfunction transitionZoombox(zb, corners, dimmed, lum) {\n  if (!dimmed) {\n    zb.transition().style('fill', lum > 0.2 ? 'rgba(0,0,0,0.4)' : 'rgba(255,255,255,0.3)').duration(200);\n    corners.transition().style('opacity', 1).duration(200);\n  }\n}\n\nfunction removeZoombox(gd) {\n  d3.select(gd).selectAll('.zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners').remove();\n}\n\nfunction showDoubleClickNotifier(gd) {\n  if (SHOWZOOMOUTTIP && gd.data && gd._context.showTips) {\n    Lib.notifier(Lib._(gd, 'Double-click to zoom back out'), 'long');\n    SHOWZOOMOUTTIP = false;\n  }\n}\n\nfunction xCorners(box, y0) {\n  return 'M' + (box.l - 0.5) + ',' + (y0 - MINZOOM - 0.5) + 'h-3v' + (2 * MINZOOM + 1) + 'h3ZM' + (box.r + 0.5) + ',' + (y0 - MINZOOM - 0.5) + 'h3v' + (2 * MINZOOM + 1) + 'h-3Z';\n}\n\nfunction yCorners(box, x0) {\n  return 'M' + (x0 - MINZOOM - 0.5) + ',' + (box.t - 0.5) + 'v-3h' + (2 * MINZOOM + 1) + 'v3ZM' + (x0 - MINZOOM - 0.5) + ',' + (box.b + 0.5) + 'v3h' + (2 * MINZOOM + 1) + 'v-3Z';\n}\n\nfunction xyCorners(box) {\n  var clen = Math.floor(Math.min(box.b - box.t, box.r - box.l, MINZOOM) / 2);\n  return 'M' + (box.l - 3.5) + ',' + (box.t - 0.5 + clen) + 'h3v' + -clen + 'h' + clen + 'v-3h-' + (clen + 3) + 'ZM' + (box.r + 3.5) + ',' + (box.t - 0.5 + clen) + 'h-3v' + -clen + 'h' + -clen + 'v-3h' + (clen + 3) + 'ZM' + (box.r + 3.5) + ',' + (box.b + 0.5 - clen) + 'h-3v' + clen + 'h' + -clen + 'v3h' + (clen + 3) + 'ZM' + (box.l - 3.5) + ',' + (box.b + 0.5 - clen) + 'h3v' + clen + 'h' + clen + 'v3h-' + (clen + 3) + 'Z';\n}\n\nfunction calcLinks(gd, groups, xaHash, yaHash) {\n  var isSubplotConstrained = false;\n  var xLinks = {};\n  var yLinks = {};\n  var xID, yID, xLinkID, yLinkID;\n\n  for (var i = 0; i < groups.length; i++) {\n    var group = groups[i]; // check if any of the x axes we're dragging is in this constraint group\n\n    for (xID in xaHash) {\n      if (group[xID]) {\n        // put the rest of these axes into xLinks, if we're not already\n        // dragging them, so we know to scale these axes automatically too\n        // to match the changes in the dragged x axes\n        for (xLinkID in group) {\n          if (!(xLinkID.charAt(0) === 'x' ? xaHash : yaHash)[xLinkID]) {\n            xLinks[xLinkID] = xID;\n          }\n        } // check if the x and y axes of THIS drag are linked\n\n\n        for (yID in yaHash) {\n          if (group[yID]) isSubplotConstrained = true;\n        }\n      }\n    } // now check if any of the y axes we're dragging is in this constraint group\n    // only look for outside links, as we've already checked for links within the dragger\n\n\n    for (yID in yaHash) {\n      if (group[yID]) {\n        for (yLinkID in group) {\n          if (!(yLinkID.charAt(0) === 'x' ? xaHash : yaHash)[yLinkID]) {\n            yLinks[yLinkID] = yID;\n          }\n        }\n      }\n    }\n  }\n\n  if (isSubplotConstrained) {\n    // merge xLinks and yLinks if the subplot is constrained,\n    // since we'll always apply both anyway and the two will contain\n    // duplicates\n    Lib.extendFlat(xLinks, yLinks);\n    yLinks = {};\n  }\n\n  var xaHashLinked = {};\n  var xaxesLinked = [];\n\n  for (xLinkID in xLinks) {\n    var xa = getFromId(gd, xLinkID);\n    xaxesLinked.push(xa);\n    xaHashLinked[xa._id] = xa;\n  }\n\n  var yaHashLinked = {};\n  var yaxesLinked = [];\n\n  for (yLinkID in yLinks) {\n    var ya = getFromId(gd, yLinkID);\n    yaxesLinked.push(ya);\n    yaHashLinked[ya._id] = ya;\n  }\n\n  return {\n    xaHash: xaHashLinked,\n    yaHash: yaHashLinked,\n    xaxes: xaxesLinked,\n    yaxes: yaxesLinked,\n    xLinks: xLinks,\n    yLinks: yLinks,\n    isSubplotConstrained: isSubplotConstrained\n  };\n} // still seems to be some confusion about onwheel vs onmousewheel...\n\n\nfunction attachWheelEventHandler(element, handler) {\n  if (!supportsPassive) {\n    if (element.onwheel !== undefined) element.onwheel = handler;else if (element.onmousewheel !== undefined) element.onmousewheel = handler;else if (!element.isAddedWheelEvent) {\n      element.isAddedWheelEvent = true;\n      element.addEventListener('wheel', handler, {\n        passive: false\n      });\n    }\n  } else {\n    var wheelEventName = element.onwheel !== undefined ? 'wheel' : 'mousewheel';\n\n    if (element._onwheel) {\n      element.removeEventListener(wheelEventName, element._onwheel);\n    }\n\n    element._onwheel = handler;\n    element.addEventListener(wheelEventName, handler, {\n      passive: false\n    });\n  }\n}\n\nfunction hashValues(hash) {\n  var out = [];\n\n  for (var k in hash) {\n    out.push(hash[k]);\n  }\n\n  return out;\n}\n\nmodule.exports = {\n  makeDragBox: makeDragBox,\n  makeDragger: makeDragger,\n  makeRectDragger: makeRectDragger,\n  makeZoombox: makeZoombox,\n  makeCorners: makeCorners,\n  updateZoombox: updateZoombox,\n  xyCorners: xyCorners,\n  transitionZoombox: transitionZoombox,\n  removeZoombox: removeZoombox,\n  showDoubleClickNotifier: showDoubleClickNotifier,\n  attachWheelEventHandler: attachWheelEventHandler\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar fontAttrs = require('../../plots/font_attributes');\n\nvar padAttrs = require('../../plots/pad_attributes');\n\nvar extendDeepAll = require('../../lib/extend').extendDeepAll;\n\nvar overrideAll = require('../../plot_api/edit_types').overrideAll;\n\nvar animationAttrs = require('../../plots/animation_attributes');\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nvar constants = require('./constants');\n\nvar stepsAttrs = templatedArray('step', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    description: ['Determines whether or not this step is included in the slider.'].join(' ')\n  },\n  method: {\n    valType: 'enumerated',\n    values: ['restyle', 'relayout', 'animate', 'update', 'skip'],\n    dflt: 'restyle',\n    role: 'info',\n    description: ['Sets the Plotly method to be called when the slider value is changed.', 'If the `skip` method is used, the API slider will function as normal', 'but will perform no API calls and will not bind automatically to state', 'updates. This may be used to create a component interface and attach to', 'slider events manually via JavaScript.'].join(' ')\n  },\n  args: {\n    valType: 'info_array',\n    role: 'info',\n    freeLength: true,\n    items: [{\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }, {\n      valType: 'any'\n    }],\n    description: ['Sets the arguments values to be passed to the Plotly', 'method set in `method` on slide.'].join(' ')\n  },\n  label: {\n    valType: 'string',\n    role: 'info',\n    description: 'Sets the text label to appear on the slider'\n  },\n  value: {\n    valType: 'string',\n    role: 'info',\n    description: ['Sets the value of the slider step, used to refer to the step programatically.', 'Defaults to the slider label if not provided.'].join(' ')\n  },\n  execute: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    description: ['When true, the API method is executed. When false, all other behaviors are the same', 'and command execution is skipped. This may be useful when hooking into, for example,', 'the `plotly_sliderchange` method and executing the API command manually without losing', 'the benefit of the slider automatically binding to the state of the plot through the', 'specification of `method` and `args`.'].join(' ')\n  }\n});\nmodule.exports = overrideAll(templatedArray('slider', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    description: ['Determines whether or not the slider is visible.'].join(' ')\n  },\n  active: {\n    valType: 'number',\n    role: 'info',\n    min: 0,\n    dflt: 0,\n    description: ['Determines which button (by index starting from 0) is', 'considered active.'].join(' ')\n  },\n  steps: stepsAttrs,\n  lenmode: {\n    valType: 'enumerated',\n    values: ['fraction', 'pixels'],\n    role: 'info',\n    dflt: 'fraction',\n    description: ['Determines whether this slider length', 'is set in units of plot *fraction* or in *pixels.', 'Use `len` to set the value.'].join(' ')\n  },\n  len: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    role: 'style',\n    description: ['Sets the length of the slider', 'This measure excludes the padding of both ends.', 'That is, the slider\\'s length is this length minus the', 'padding on both ends.'].join(' ')\n  },\n  x: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    dflt: 0,\n    role: 'style',\n    description: 'Sets the x position (in normalized coordinates) of the slider.'\n  },\n  pad: extendDeepAll(padAttrs({\n    editType: 'arraydraw'\n  }), {\n    description: 'Set the padding of the slider component along each side.'\n  }, {\n    t: {\n      dflt: 20\n    }\n  }),\n  xanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'left', 'center', 'right'],\n    dflt: 'left',\n    role: 'info',\n    description: ['Sets the slider\\'s horizontal position anchor.', 'This anchor binds the `x` position to the *left*, *center*', 'or *right* of the range selector.'].join(' ')\n  },\n  y: {\n    valType: 'number',\n    min: -2,\n    max: 3,\n    dflt: 0,\n    role: 'style',\n    description: 'Sets the y position (in normalized coordinates) of the slider.'\n  },\n  yanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'top', 'middle', 'bottom'],\n    dflt: 'top',\n    role: 'info',\n    description: ['Sets the slider\\'s vertical position anchor', 'This anchor binds the `y` position to the *top*, *middle*', 'or *bottom* of the range selector.'].join(' ')\n  },\n  transition: {\n    duration: {\n      valType: 'number',\n      role: 'info',\n      min: 0,\n      dflt: 150,\n      description: 'Sets the duration of the slider transition'\n    },\n    easing: {\n      valType: 'enumerated',\n      values: animationAttrs.transition.easing.values,\n      role: 'info',\n      dflt: 'cubic-in-out',\n      description: 'Sets the easing function of the slider transition'\n    }\n  },\n  currentvalue: {\n    visible: {\n      valType: 'boolean',\n      role: 'info',\n      dflt: true,\n      description: ['Shows the currently-selected value above the slider.'].join(' ')\n    },\n    xanchor: {\n      valType: 'enumerated',\n      values: ['left', 'center', 'right'],\n      dflt: 'left',\n      role: 'info',\n      description: ['The alignment of the value readout relative to the length of the slider.'].join(' ')\n    },\n    offset: {\n      valType: 'number',\n      dflt: 10,\n      role: 'info',\n      description: ['The amount of space, in pixels, between the current value label', 'and the slider.'].join(' ')\n    },\n    prefix: {\n      valType: 'string',\n      role: 'info',\n      description: 'When currentvalue.visible is true, this sets the prefix of the label.'\n    },\n    suffix: {\n      valType: 'string',\n      role: 'info',\n      description: 'When currentvalue.visible is true, this sets the suffix of the label.'\n    },\n    font: fontAttrs({\n      description: 'Sets the font of the current value label text.'\n    })\n  },\n  font: fontAttrs({\n    description: 'Sets the font of the slider step labels.'\n  }),\n  activebgcolor: {\n    valType: 'color',\n    role: 'style',\n    dflt: constants.gripBgActiveColor,\n    description: ['Sets the background color of the slider grip', 'while dragging.'].join(' ')\n  },\n  bgcolor: {\n    valType: 'color',\n    role: 'style',\n    dflt: constants.railBgColor,\n    description: 'Sets the background color of the slider.'\n  },\n  bordercolor: {\n    valType: 'color',\n    dflt: constants.railBorderColor,\n    role: 'style',\n    description: 'Sets the color of the border enclosing the slider.'\n  },\n  borderwidth: {\n    valType: 'number',\n    min: 0,\n    dflt: constants.railBorderWidth,\n    role: 'style',\n    description: 'Sets the width (in px) of the border enclosing the slider.'\n  },\n  ticklen: {\n    valType: 'number',\n    min: 0,\n    dflt: constants.tickLength,\n    role: 'style',\n    description: 'Sets the length in pixels of step tick marks'\n  },\n  tickcolor: {\n    valType: 'color',\n    dflt: constants.tickColor,\n    role: 'style',\n    description: 'Sets the color of the border enclosing the slider.'\n  },\n  tickwidth: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    role: 'style',\n    description: 'Sets the tick width (in px).'\n  },\n  minorticklen: {\n    valType: 'number',\n    min: 0,\n    dflt: constants.minorTickLength,\n    role: 'style',\n    description: 'Sets the length in pixels of minor step tick marks'\n  }\n}), 'arraydraw', 'from-root');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar numConstants = require('../../constants/numerical');\n\nvar BADNUM = numConstants.BADNUM;\nvar LOG_CLIP = numConstants.LOG_CLIP;\nvar LOG_CLIP_PLUS = LOG_CLIP + 0.5;\nvar LOG_CLIP_MINUS = LOG_CLIP - 0.5;\n\nvar Lib = require('../../lib');\n\nvar segmentsIntersect = Lib.segmentsIntersect;\nvar constrain = Lib.constrain;\n\nvar constants = require('./constants');\n\nmodule.exports = function linePoints(d, opts) {\n  var xa = opts.xaxis;\n  var ya = opts.yaxis;\n  var xLog = xa.type === 'log';\n  var yLog = ya.type === 'log';\n  var xLen = xa._length;\n  var yLen = ya._length;\n  var connectGaps = opts.connectGaps;\n  var baseTolerance = opts.baseTolerance;\n  var shape = opts.shape;\n  var linear = shape === 'linear';\n  var fill = opts.fill && opts.fill !== 'none';\n  var segments = [];\n  var minTolerance = constants.minTolerance;\n  var len = d.length;\n  var pts = new Array(len);\n  var pti = 0;\n  var i; // pt variables are pixel coordinates [x,y] of one point\n  // these four are the outputs of clustering on a line\n\n  var clusterStartPt, clusterEndPt, clusterHighPt, clusterLowPt; // \"this\" is the next point we're considering adding to the cluster\n\n  var thisPt; // did we encounter the high point first, then a low point, or vice versa?\n\n  var clusterHighFirst; // the first two points in the cluster determine its unit vector\n  // so the second is always in the \"High\" direction\n\n  var clusterUnitVector; // the pixel delta from clusterStartPt\n\n  var thisVector; // val variables are (signed) pixel distances along the cluster vector\n\n  var clusterRefDist, clusterHighVal, clusterLowVal, thisVal; // deviation variables are (signed) pixel distances normal to the cluster vector\n\n  var clusterMinDeviation, clusterMaxDeviation, thisDeviation; // turn one calcdata point into pixel coordinates\n\n  function getPt(index) {\n    var di = d[index];\n    if (!di) return false;\n    var x = opts.linearized ? xa.l2p(di.x) : xa.c2p(di.x);\n    var y = opts.linearized ? ya.l2p(di.y) : ya.c2p(di.y); // if non-positive log values, set them VERY far off-screen\n    // so the line looks essentially straight from the previous point.\n\n    if (x === BADNUM) {\n      if (xLog) x = xa.c2p(di.x, true);\n      if (x === BADNUM) return false; // If BOTH were bad log values, make the line follow a constant\n      // exponent rather than a constant slope\n\n      if (yLog && y === BADNUM) {\n        x *= Math.abs(xa._m * yLen * (xa._m > 0 ? LOG_CLIP_PLUS : LOG_CLIP_MINUS) / (ya._m * xLen * (ya._m > 0 ? LOG_CLIP_PLUS : LOG_CLIP_MINUS)));\n      }\n\n      x *= 1000;\n    }\n\n    if (y === BADNUM) {\n      if (yLog) y = ya.c2p(di.y, true);\n      if (y === BADNUM) return false;\n      y *= 1000;\n    }\n\n    return [x, y];\n  }\n\n  function crossesViewport(xFrac0, yFrac0, xFrac1, yFrac1) {\n    var dx = xFrac1 - xFrac0;\n    var dy = yFrac1 - yFrac0;\n    var dx0 = 0.5 - xFrac0;\n    var dy0 = 0.5 - yFrac0;\n    var norm2 = dx * dx + dy * dy;\n    var dot = dx * dx0 + dy * dy0;\n\n    if (dot > 0 && dot < norm2) {\n      var cross = dx0 * dy - dy0 * dx;\n      if (cross * cross < norm2) return true;\n    }\n  }\n\n  var latestXFrac, latestYFrac; // if we're off-screen, increase tolerance over baseTolerance\n\n  function getTolerance(pt, nextPt) {\n    var xFrac = pt[0] / xLen;\n    var yFrac = pt[1] / yLen;\n    var offScreenFraction = Math.max(0, -xFrac, xFrac - 1, -yFrac, yFrac - 1);\n\n    if (offScreenFraction && latestXFrac !== undefined && crossesViewport(xFrac, yFrac, latestXFrac, latestYFrac)) {\n      offScreenFraction = 0;\n    }\n\n    if (offScreenFraction && nextPt && crossesViewport(xFrac, yFrac, nextPt[0] / xLen, nextPt[1] / yLen)) {\n      offScreenFraction = 0;\n    }\n\n    return (1 + constants.toleranceGrowth * offScreenFraction) * baseTolerance;\n  }\n\n  function ptDist(pt1, pt2) {\n    var dx = pt1[0] - pt2[0];\n    var dy = pt1[1] - pt2[1];\n    return Math.sqrt(dx * dx + dy * dy);\n  } // last bit of filtering: clip paths that are VERY far off-screen\n  // so we don't get near the browser's hard limit (+/- 2^29 px in Chrome and FF)\n\n\n  var maxScreensAway = constants.maxScreensAway; // find the intersections between the segment from pt1 to pt2\n  // and the large rectangle maxScreensAway around the viewport\n  // if one of pt1 and pt2 is inside and the other outside, there\n  // will be only one intersection.\n  // if both are outside there will be 0 or 2 intersections\n  // (or 1 if it's right at a corner - we'll treat that like 0)\n  // returns an array of intersection pts\n\n  var xEdge0 = -xLen * maxScreensAway;\n  var xEdge1 = xLen * (1 + maxScreensAway);\n  var yEdge0 = -yLen * maxScreensAway;\n  var yEdge1 = yLen * (1 + maxScreensAway);\n  var edges = [[xEdge0, yEdge0, xEdge1, yEdge0], [xEdge1, yEdge0, xEdge1, yEdge1], [xEdge1, yEdge1, xEdge0, yEdge1], [xEdge0, yEdge1, xEdge0, yEdge0]];\n  var xEdge, yEdge, lastXEdge, lastYEdge, lastFarPt, edgePt; // for linear line shape, edge intersections should be linearly interpolated\n  // spline uses this too, which isn't precisely correct but is actually pretty\n  // good, because Catmull-Rom weights far-away points less in creating the curvature\n\n  function getLinearEdgeIntersections(pt1, pt2) {\n    var out = [];\n    var ptCount = 0;\n\n    for (var i = 0; i < 4; i++) {\n      var edge = edges[i];\n      var ptInt = segmentsIntersect(pt1[0], pt1[1], pt2[0], pt2[1], edge[0], edge[1], edge[2], edge[3]);\n\n      if (ptInt && (!ptCount || Math.abs(ptInt.x - out[0][0]) > 1 || Math.abs(ptInt.y - out[0][1]) > 1)) {\n        ptInt = [ptInt.x, ptInt.y]; // if we have 2 intersections, make sure the closest one to pt1 comes first\n\n        if (ptCount && ptDist(ptInt, pt1) < ptDist(out[0], pt1)) out.unshift(ptInt);else out.push(ptInt);\n        ptCount++;\n      }\n    }\n\n    return out;\n  }\n\n  function onlyConstrainedPoint(pt) {\n    if (pt[0] < xEdge0 || pt[0] > xEdge1 || pt[1] < yEdge0 || pt[1] > yEdge1) {\n      return [constrain(pt[0], xEdge0, xEdge1), constrain(pt[1], yEdge0, yEdge1)];\n    }\n  }\n\n  function sameEdge(pt1, pt2) {\n    if (pt1[0] === pt2[0] && (pt1[0] === xEdge0 || pt1[0] === xEdge1)) return true;\n    if (pt1[1] === pt2[1] && (pt1[1] === yEdge0 || pt1[1] === yEdge1)) return true;\n  } // for line shapes hv and vh, movement in the two dimensions is decoupled,\n  // so all we need to do is constrain each dimension independently\n\n\n  function getHVEdgeIntersections(pt1, pt2) {\n    var out = [];\n    var ptInt1 = onlyConstrainedPoint(pt1);\n    var ptInt2 = onlyConstrainedPoint(pt2);\n    if (ptInt1 && ptInt2 && sameEdge(ptInt1, ptInt2)) return out;\n    if (ptInt1) out.push(ptInt1);\n    if (ptInt2) out.push(ptInt2);\n    return out;\n  } // hvh and vhv we sometimes have to move one of the intersection points\n  // out BEYOND the clipping rect, by a maximum of a factor of 2, so that\n  // the midpoint line is drawn in the right place\n\n\n  function getABAEdgeIntersections(dim, limit0, limit1) {\n    return function (pt1, pt2) {\n      var ptInt1 = onlyConstrainedPoint(pt1);\n      var ptInt2 = onlyConstrainedPoint(pt2);\n      var out = [];\n      if (ptInt1 && ptInt2 && sameEdge(ptInt1, ptInt2)) return out;\n      if (ptInt1) out.push(ptInt1);\n      if (ptInt2) out.push(ptInt2);\n      var midShift = 2 * Lib.constrain((pt1[dim] + pt2[dim]) / 2, limit0, limit1) - ((ptInt1 || pt1)[dim] + (ptInt2 || pt2)[dim]);\n\n      if (midShift) {\n        var ptToAlter;\n\n        if (ptInt1 && ptInt2) {\n          ptToAlter = midShift > 0 === ptInt1[dim] > ptInt2[dim] ? ptInt1 : ptInt2;\n        } else ptToAlter = ptInt1 || ptInt2;\n\n        ptToAlter[dim] += midShift;\n      }\n\n      return out;\n    };\n  }\n\n  var getEdgeIntersections;\n\n  if (shape === 'linear' || shape === 'spline') {\n    getEdgeIntersections = getLinearEdgeIntersections;\n  } else if (shape === 'hv' || shape === 'vh') {\n    getEdgeIntersections = getHVEdgeIntersections;\n  } else if (shape === 'hvh') getEdgeIntersections = getABAEdgeIntersections(0, xEdge0, xEdge1);else if (shape === 'vhv') getEdgeIntersections = getABAEdgeIntersections(1, yEdge0, yEdge1); // a segment pt1->pt2 entirely outside the nearby region:\n  // find the corner it gets closest to touching\n\n\n  function getClosestCorner(pt1, pt2) {\n    var dx = pt2[0] - pt1[0];\n    var m = (pt2[1] - pt1[1]) / dx;\n    var b = (pt1[1] * pt2[0] - pt2[1] * pt1[0]) / dx;\n    if (b > 0) return [m > 0 ? xEdge0 : xEdge1, yEdge1];else return [m > 0 ? xEdge1 : xEdge0, yEdge0];\n  }\n\n  function updateEdge(pt) {\n    var x = pt[0];\n    var y = pt[1];\n    var xSame = x === pts[pti - 1][0];\n    var ySame = y === pts[pti - 1][1]; // duplicate point?\n\n    if (xSame && ySame) return;\n\n    if (pti > 1) {\n      // backtracking along an edge?\n      var xSame2 = x === pts[pti - 2][0];\n      var ySame2 = y === pts[pti - 2][1];\n\n      if (xSame && (x === xEdge0 || x === xEdge1) && xSame2) {\n        if (ySame2) pti--; // backtracking exactly - drop prev pt and don't add\n        else pts[pti - 1] = pt; // not exact: replace the prev pt\n      } else if (ySame && (y === yEdge0 || y === yEdge1) && ySame2) {\n        if (xSame2) pti--;else pts[pti - 1] = pt;\n      } else pts[pti++] = pt;\n    } else pts[pti++] = pt;\n  }\n\n  function updateEdgesForReentry(pt) {\n    // if we're outside the nearby region and going back in,\n    // we may need to loop around a corner point\n    if (pts[pti - 1][0] !== pt[0] && pts[pti - 1][1] !== pt[1]) {\n      updateEdge([lastXEdge, lastYEdge]);\n    }\n\n    updateEdge(pt);\n    lastFarPt = null;\n    lastXEdge = lastYEdge = 0;\n  }\n\n  function addPt(pt) {\n    latestXFrac = pt[0] / xLen;\n    latestYFrac = pt[1] / yLen; // Are we more than maxScreensAway off-screen any direction?\n    // if so, clip to this box, but in such a way that on-screen\n    // drawing is unchanged\n\n    xEdge = pt[0] < xEdge0 ? xEdge0 : pt[0] > xEdge1 ? xEdge1 : 0;\n    yEdge = pt[1] < yEdge0 ? yEdge0 : pt[1] > yEdge1 ? yEdge1 : 0;\n\n    if (xEdge || yEdge) {\n      if (!pti) {\n        // to get fills right - if first point is far, push it toward the\n        // screen in whichever direction(s) are far\n        pts[pti++] = [xEdge || pt[0], yEdge || pt[1]];\n      } else if (lastFarPt) {\n        // both this point and the last are outside the nearby region\n        // check if we're crossing the nearby region\n        var intersections = getEdgeIntersections(lastFarPt, pt);\n\n        if (intersections.length > 1) {\n          updateEdgesForReentry(intersections[0]);\n          pts[pti++] = intersections[1];\n        }\n      } else {\n        // we're leaving the nearby region - add the point where we left it\n        edgePt = getEdgeIntersections(pts[pti - 1], pt)[0];\n        pts[pti++] = edgePt;\n      }\n\n      var lastPt = pts[pti - 1];\n\n      if (xEdge && yEdge && (lastPt[0] !== xEdge || lastPt[1] !== yEdge)) {\n        // we've gone out beyond a new corner: add the corner too\n        // so that the next point will take the right winding\n        if (lastFarPt) {\n          if (lastXEdge !== xEdge && lastYEdge !== yEdge) {\n            if (lastXEdge && lastYEdge) {\n              // we've gone around to an opposite corner - we\n              // need to add the correct extra corner\n              // in order to get the right winding\n              updateEdge(getClosestCorner(lastFarPt, pt));\n            } else {\n              // we're coming from a far edge - the extra corner\n              // we need is determined uniquely by the sectors\n              updateEdge([lastXEdge || xEdge, lastYEdge || yEdge]);\n            }\n          } else if (lastXEdge && lastYEdge) {\n            updateEdge([lastXEdge, lastYEdge]);\n          }\n        }\n\n        updateEdge([xEdge, yEdge]);\n      } else if (lastXEdge - xEdge && lastYEdge - yEdge) {\n        // we're coming from an edge or far corner to an edge - again the\n        // extra corner we need is uniquely determined by the sectors\n        updateEdge([xEdge || lastXEdge, yEdge || lastYEdge]);\n      }\n\n      lastFarPt = pt;\n      lastXEdge = xEdge;\n      lastYEdge = yEdge;\n    } else {\n      if (lastFarPt) {\n        // this point is in range but the previous wasn't: add its entry pt first\n        updateEdgesForReentry(getEdgeIntersections(lastFarPt, pt)[0]);\n      }\n\n      pts[pti++] = pt;\n    }\n  } // loop over ALL points in this trace\n\n\n  for (i = 0; i < len; i++) {\n    clusterStartPt = getPt(i);\n    if (!clusterStartPt) continue;\n    pti = 0;\n    lastFarPt = null;\n    addPt(clusterStartPt); // loop over one segment of the trace\n\n    for (i++; i < len; i++) {\n      clusterHighPt = getPt(i);\n\n      if (!clusterHighPt) {\n        if (connectGaps) continue;else break;\n      } // can't decimate if nonlinear line shape\n      // TODO: we *could* decimate [hv]{2,3} shapes if we restricted clusters to horz or vert again\n      // but spline would be verrry awkward to decimate\n\n\n      if (!linear || !opts.simplify) {\n        addPt(clusterHighPt);\n        continue;\n      }\n\n      var nextPt = getPt(i + 1);\n      clusterRefDist = ptDist(clusterHighPt, clusterStartPt); // #3147 - always include the very first and last points for fills\n\n      if (!(fill && (pti === 0 || pti === len - 1)) && clusterRefDist < getTolerance(clusterHighPt, nextPt) * minTolerance) continue;\n      clusterUnitVector = [(clusterHighPt[0] - clusterStartPt[0]) / clusterRefDist, (clusterHighPt[1] - clusterStartPt[1]) / clusterRefDist];\n      clusterLowPt = clusterStartPt;\n      clusterHighVal = clusterRefDist;\n      clusterLowVal = clusterMinDeviation = clusterMaxDeviation = 0;\n      clusterHighFirst = false;\n      clusterEndPt = clusterHighPt; // loop over one cluster of points that collapse onto one line\n\n      for (i++; i < d.length; i++) {\n        thisPt = nextPt;\n        nextPt = getPt(i + 1);\n\n        if (!thisPt) {\n          if (connectGaps) continue;else break;\n        }\n\n        thisVector = [thisPt[0] - clusterStartPt[0], thisPt[1] - clusterStartPt[1]]; // cross product (or dot with normal to the cluster vector)\n\n        thisDeviation = thisVector[0] * clusterUnitVector[1] - thisVector[1] * clusterUnitVector[0];\n        clusterMinDeviation = Math.min(clusterMinDeviation, thisDeviation);\n        clusterMaxDeviation = Math.max(clusterMaxDeviation, thisDeviation);\n        if (clusterMaxDeviation - clusterMinDeviation > getTolerance(thisPt, nextPt)) break;\n        clusterEndPt = thisPt;\n        thisVal = thisVector[0] * clusterUnitVector[0] + thisVector[1] * clusterUnitVector[1];\n\n        if (thisVal > clusterHighVal) {\n          clusterHighVal = thisVal;\n          clusterHighPt = thisPt;\n          clusterHighFirst = false;\n        } else if (thisVal < clusterLowVal) {\n          clusterLowVal = thisVal;\n          clusterLowPt = thisPt;\n          clusterHighFirst = true;\n        }\n      } // insert this cluster into pts\n      // we've already inserted the start pt, now check if we have high and low pts\n\n\n      if (clusterHighFirst) {\n        addPt(clusterHighPt);\n        if (clusterEndPt !== clusterLowPt) addPt(clusterLowPt);\n      } else {\n        if (clusterLowPt !== clusterStartPt) addPt(clusterLowPt);\n        if (clusterEndPt !== clusterHighPt) addPt(clusterHighPt);\n      } // and finally insert the end pt\n\n\n      addPt(clusterEndPt); // have we reached the end of this segment?\n\n      if (i >= d.length || !thisPt) break; // otherwise we have an out-of-cluster point to insert as next clusterStartPt\n\n      addPt(thisPt);\n      clusterStartPt = thisPt;\n    } // to get fills right - repeat what we did at the start\n\n\n    if (lastFarPt) updateEdge([lastXEdge || lastFarPt[0], lastYEdge || lastFarPt[1]]);\n    segments.push(pts.slice(0, pti));\n  }\n\n  return segments;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nmodule.exports = function getUpdateObject(axisLayout, buttonLayout) {\n  var axName = axisLayout._name;\n  var update = {};\n\n  if (buttonLayout.step === 'all') {\n    update[axName + '.autorange'] = true;\n  } else {\n    var xrange = getXRange(axisLayout, buttonLayout);\n    update[axName + '.range[0]'] = xrange[0];\n    update[axName + '.range[1]'] = xrange[1];\n  }\n\n  return update;\n};\n\nfunction getXRange(axisLayout, buttonLayout) {\n  var currentRange = axisLayout.range;\n  var base = new Date(axisLayout.r2l(currentRange[1]));\n  var step = buttonLayout.step;\n  var count = buttonLayout.count;\n  var range0;\n\n  switch (buttonLayout.stepmode) {\n    case 'backward':\n      range0 = axisLayout.l2r(+d3.time[step].utc.offset(base, -count));\n      break;\n\n    case 'todate':\n      var base2 = d3.time[step].utc.offset(base, -count);\n      range0 = axisLayout.l2r(+d3.time[step].utc.ceil(base2));\n      break;\n  }\n\n  var range1 = currentRange[1];\n  return [range0, range1];\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar plotApi = require('./plot_api');\n\nvar plots = require('../plots/plots');\n\nvar Lib = require('../lib');\n\nvar helpers = require('../snapshot/helpers');\n\nvar toSVG = require('../snapshot/tosvg');\n\nvar svgToImg = require('../snapshot/svgtoimg');\n\nvar version = require('../version').version;\n\nvar attrs = {\n  format: {\n    valType: 'enumerated',\n    values: ['png', 'jpeg', 'webp', 'svg', 'full-json'],\n    dflt: 'png',\n    description: 'Sets the format of exported image.'\n  },\n  width: {\n    valType: 'number',\n    min: 1,\n    description: ['Sets the exported image width.', 'Defaults to the value found in `layout.width`', 'If set to *null*, the exported image width will match the current graph width.'].join(' ')\n  },\n  height: {\n    valType: 'number',\n    min: 1,\n    description: ['Sets the exported image height.', 'Defaults to the value found in `layout.height`', 'If set to *null*, the exported image height will match the current graph height.'].join(' ')\n  },\n  scale: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    description: ['Sets a scaling for the generated image.', 'If set, all features of a graphs (e.g. text, line width)', 'are scaled, unlike simply setting', 'a bigger *width* and *height*.'].join(' ')\n  },\n  setBackground: {\n    valType: 'any',\n    dflt: false,\n    description: ['Sets the image background mode.', 'By default, the image background is determined by `layout.paper_bgcolor`,', 'the *transparent* mode.', 'One might consider setting `setBackground` to *opaque*', 'when exporting a *jpeg* image as JPEGs do not support opacity.'].join(' ')\n  },\n  imageDataOnly: {\n    valType: 'boolean',\n    dflt: false,\n    description: ['Determines whether or not the return value is prefixed by', 'the image format\\'s corresponding \\'data:image;\\' spec.'].join(' ')\n  }\n};\n/** Plotly.toImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see above)\n * @return {promise}\n */\n\nfunction toImage(gd, opts) {\n  opts = opts || {};\n  var data;\n  var layout;\n  var config;\n  var fullLayout;\n\n  if (Lib.isPlainObject(gd)) {\n    data = gd.data || [];\n    layout = gd.layout || {};\n    config = gd.config || {};\n    fullLayout = {};\n  } else {\n    gd = Lib.getGraphDiv(gd);\n    data = Lib.extendDeep([], gd.data);\n    layout = Lib.extendDeep({}, gd.layout);\n    config = gd._context;\n    fullLayout = gd._fullLayout || {};\n  }\n\n  function isImpliedOrValid(attr) {\n    return !(attr in opts) || Lib.validate(opts[attr], attrs[attr]);\n  }\n\n  if (!isImpliedOrValid('width') && opts.width !== null || !isImpliedOrValid('height') && opts.height !== null) {\n    throw new Error('Height and width should be pixel values.');\n  }\n\n  if (!isImpliedOrValid('format')) {\n    throw new Error('Image format is not jpeg, png, svg or webp.');\n  }\n\n  var fullOpts = {};\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(opts, fullOpts, attrs, attr, dflt);\n  }\n\n  var format = coerce('format');\n  var width = coerce('width');\n  var height = coerce('height');\n  var scale = coerce('scale');\n  var setBackground = coerce('setBackground');\n  var imageDataOnly = coerce('imageDataOnly'); // put the cloned div somewhere off screen before attaching to DOM\n\n  var clonedGd = document.createElement('div');\n  clonedGd.style.position = 'absolute';\n  clonedGd.style.left = '-5000px';\n  document.body.appendChild(clonedGd); // extend layout with image options\n\n  var layoutImage = Lib.extendFlat({}, layout);\n\n  if (width) {\n    layoutImage.width = width;\n  } else if (opts.width === null && isNumeric(fullLayout.width)) {\n    layoutImage.width = fullLayout.width;\n  }\n\n  if (height) {\n    layoutImage.height = height;\n  } else if (opts.height === null && isNumeric(fullLayout.height)) {\n    layoutImage.height = fullLayout.height;\n  } // extend config for static plot\n\n\n  var configImage = Lib.extendFlat({}, config, {\n    _exportedPlot: true,\n    staticPlot: true,\n    setBackground: setBackground\n  });\n  var redrawFunc = helpers.getRedrawFunc(clonedGd);\n\n  function wait() {\n    return new Promise(function (resolve) {\n      setTimeout(resolve, helpers.getDelay(clonedGd._fullLayout));\n    });\n  }\n\n  function convert() {\n    return new Promise(function (resolve, reject) {\n      var svg = toSVG(clonedGd, format, scale);\n      var width = clonedGd._fullLayout.width;\n      var height = clonedGd._fullLayout.height;\n\n      function cleanup() {\n        plotApi.purge(clonedGd);\n        document.body.removeChild(clonedGd);\n      }\n\n      if (format === 'full-json') {\n        var json = plots.graphJson(clonedGd, false, 'keepdata', 'object', true, true);\n        json.version = version;\n        json = JSON.stringify(json);\n        cleanup();\n\n        if (imageDataOnly) {\n          return resolve(json);\n        } else {\n          return resolve(helpers.encodeJSON(json));\n        }\n      }\n\n      cleanup();\n\n      if (format === 'svg') {\n        if (imageDataOnly) {\n          return resolve(svg);\n        } else {\n          return resolve(helpers.encodeSVG(svg));\n        }\n      }\n\n      var canvas = document.createElement('canvas');\n      canvas.id = Lib.randstr();\n      svgToImg({\n        format: format,\n        width: width,\n        height: height,\n        scale: scale,\n        canvas: canvas,\n        svg: svg,\n        // ask svgToImg to return a Promise\n        //  rather than EventEmitter\n        //  leave EventEmitter for backward\n        //  compatibility\n        promise: true\n      }).then(resolve).catch(reject);\n    });\n  }\n\n  function urlToImageData(url) {\n    if (imageDataOnly) {\n      return url.replace(helpers.IMAGE_URL_PREFIX, '');\n    } else {\n      return url;\n    }\n  }\n\n  return new Promise(function (resolve, reject) {\n    plotApi.plot(clonedGd, data, layoutImage, configImage).then(redrawFunc).then(wait).then(convert).then(function (url) {\n      resolve(urlToImageData(url));\n    }).catch(function (err) {\n      reject(err);\n    });\n  });\n}\n\nmodule.exports = toImage;","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.github.io/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = typeof onFinally == 'function';\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// patch native Promise.prototype for native async functions\nif (!IS_PURE && typeof NativePromise == 'function' && !NativePromise.prototype['finally']) {\n  redefine(NativePromise.prototype, 'finally', getBuiltIn('Promise').prototype['finally']);\n}\n","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Registry = require('../registry');\n/*\n * containerArrayMatch: does this attribute string point into a\n * layout container array?\n *\n * @param {String} astr: an attribute string, like *annotations[2].text*\n *\n * @returns {Object | false} Returns false if `astr` doesn't match a container\n *  array. If it does, returns:\n *     {array: {String}, index: {Number}, property: {String}}\n *  ie the attribute string for the array, the index within the array (or ''\n *  if the whole array) and the property within that (or '' if the whole array\n *  or the whole object)\n */\n\n\nmodule.exports = function containerArrayMatch(astr) {\n  var rootContainers = Registry.layoutArrayContainers;\n  var regexpContainers = Registry.layoutArrayRegexes;\n  var rootPart = astr.split('[')[0];\n  var arrayStr;\n  var match; // look for regexp matches first, because they may be nested inside root matches\n  // eg updatemenus[i].buttons is nested inside updatemenus\n\n  for (var i = 0; i < regexpContainers.length; i++) {\n    match = astr.match(regexpContainers[i]);\n\n    if (match && match.index === 0) {\n      arrayStr = match[0];\n      break;\n    }\n  } // now look for root matches\n\n\n  if (!arrayStr) arrayStr = rootContainers[rootContainers.indexOf(rootPart)];\n  if (!arrayStr) return false;\n  var tail = astr.substr(arrayStr.length);\n  if (!tail) return {\n    array: arrayStr,\n    index: '',\n    property: ''\n  };\n  match = tail.match(/^\\[(0|[1-9][0-9]*)\\](\\.(.+))?$/);\n  if (!match) return false;\n  return {\n    array: arrayStr,\n    index: Number(match[1]),\n    property: match[3] || ''\n  };\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar annAttrs = require('../annotations/attributes');\n\nvar scatterLineAttrs = require('../../traces/scatter/attributes').line;\n\nvar dash = require('../drawing/attributes').dash;\n\nvar extendFlat = require('../../lib/extend').extendFlat;\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nmodule.exports = templatedArray('shape', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    editType: 'calc+arraydraw',\n    description: ['Determines whether or not this shape is visible.'].join(' ')\n  },\n  type: {\n    valType: 'enumerated',\n    values: ['circle', 'rect', 'path', 'line'],\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Specifies the shape type to be drawn.', 'If *line*, a line is drawn from (`x0`,`y0`) to (`x1`,`y1`)', 'with respect to the axes\\' sizing mode.', 'If *circle*, a circle is drawn from', '((`x0`+`x1`)/2, (`y0`+`y1`)/2))', 'with radius', '(|(`x0`+`x1`)/2 - `x0`|, |(`y0`+`y1`)/2 -`y0`)|)', 'with respect to the axes\\' sizing mode.', 'If *rect*, a rectangle is drawn linking', '(`x0`,`y0`), (`x1`,`y0`), (`x1`,`y1`), (`x0`,`y1`), (`x0`,`y0`)', 'with respect to the axes\\' sizing mode.', 'If *path*, draw a custom SVG path using `path`.', 'with respect to the axes\\' sizing mode.'].join(' ')\n  },\n  layer: {\n    valType: 'enumerated',\n    values: ['below', 'above'],\n    dflt: 'above',\n    role: 'info',\n    editType: 'arraydraw',\n    description: 'Specifies whether shapes are drawn below or above traces.'\n  },\n  xref: extendFlat({}, annAttrs.xref, {\n    description: ['Sets the shape\\'s x coordinate axis.', 'If set to an x axis id (e.g. *x* or *x2*), the `x` position', 'refers to an x coordinate.', 'If set to *paper*, the `x` position refers to the distance from', 'the left side of the plotting area in normalized coordinates', 'where *0* (*1*) corresponds to the left (right) side.', 'If the axis `type` is *log*, then you must take the', 'log of your desired range.', 'If the axis `type` is *date*, then you must convert', 'the date to unix time in milliseconds.'].join(' ')\n  }),\n  xsizemode: {\n    valType: 'enumerated',\n    values: ['scaled', 'pixel'],\n    dflt: 'scaled',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shapes\\'s sizing mode along the x axis.', 'If set to *scaled*, `x0`, `x1` and x coordinates within `path` refer to', 'data values on the x axis or a fraction of the plot area\\'s width', '(`xref` set to *paper*).', 'If set to *pixel*, `xanchor` specifies the x position in terms', 'of data or plot fraction but `x0`, `x1` and x coordinates within `path`', 'are pixels relative to `xanchor`. This way, the shape can have', 'a fixed width while maintaining a position relative to data or', 'plot fraction.'].join(' ')\n  },\n  xanchor: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Only relevant in conjunction with `xsizemode` set to *pixel*.', 'Specifies the anchor point on the x axis to which `x0`, `x1`', 'and x coordinates within `path` are relative to.', 'E.g. useful to attach a pixel sized shape to a certain data value.', 'No effect when `xsizemode` not set to *pixel*.'].join(' ')\n  },\n  x0: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shape\\'s starting x position.', 'See `type` and `xsizemode` for more info.'].join(' ')\n  },\n  x1: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shape\\'s end x position.', 'See `type` and `xsizemode` for more info.'].join(' ')\n  },\n  yref: extendFlat({}, annAttrs.yref, {\n    description: ['Sets the annotation\\'s y coordinate axis.', 'If set to an y axis id (e.g. *y* or *y2*), the `y` position', 'refers to an y coordinate', 'If set to *paper*, the `y` position refers to the distance from', 'the bottom of the plotting area in normalized coordinates', 'where *0* (*1*) corresponds to the bottom (top).'].join(' ')\n  }),\n  ysizemode: {\n    valType: 'enumerated',\n    values: ['scaled', 'pixel'],\n    dflt: 'scaled',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shapes\\'s sizing mode along the y axis.', 'If set to *scaled*, `y0`, `y1` and y coordinates within `path` refer to', 'data values on the y axis or a fraction of the plot area\\'s height', '(`yref` set to *paper*).', 'If set to *pixel*, `yanchor` specifies the y position in terms', 'of data or plot fraction but `y0`, `y1` and y coordinates within `path`', 'are pixels relative to `yanchor`. This way, the shape can have', 'a fixed height while maintaining a position relative to data or', 'plot fraction.'].join(' ')\n  },\n  yanchor: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Only relevant in conjunction with `ysizemode` set to *pixel*.', 'Specifies the anchor point on the y axis to which `y0`, `y1`', 'and y coordinates within `path` are relative to.', 'E.g. useful to attach a pixel sized shape to a certain data value.', 'No effect when `ysizemode` not set to *pixel*.'].join(' ')\n  },\n  y0: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shape\\'s starting y position.', 'See `type` and `ysizemode` for more info.'].join(' ')\n  },\n  y1: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the shape\\'s end y position.', 'See `type` and `ysizemode` for more info.'].join(' ')\n  },\n  path: {\n    valType: 'string',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['For `type` *path* - a valid SVG path with the pixel values', 'replaced by data values in `xsizemode`/`ysizemode` being *scaled*', 'and taken unmodified as pixels relative to `xanchor` and `yanchor`', 'in case of *pixel* size mode.', 'There are a few restrictions / quirks', 'only absolute instructions, not relative. So the allowed segments', 'are: M, L, H, V, Q, C, T, S, and Z', 'arcs (A) are not allowed because radius rx and ry are relative.', 'In the future we could consider supporting relative commands,', 'but we would have to decide on how to handle date and log axes.', 'Note that even as is, Q and C Bezier paths that are smooth on', 'linear axes may not be smooth on log, and vice versa.', 'no chained \"polybezier\" commands - specify the segment type for', 'each one.', 'On category axes, values are numbers scaled to the serial numbers', 'of categories because using the categories themselves there would', 'be no way to describe fractional positions', 'On data axes: because space and T are both normal components of path', 'strings, we can\\'t use either to separate date from time parts.', 'Therefore we\\'ll use underscore for this purpose:', '2015-02-21_13:45:56.789'].join(' ')\n  },\n  opacity: {\n    valType: 'number',\n    min: 0,\n    max: 1,\n    dflt: 1,\n    role: 'info',\n    editType: 'arraydraw',\n    description: 'Sets the opacity of the shape.'\n  },\n  line: {\n    color: extendFlat({}, scatterLineAttrs.color, {\n      editType: 'arraydraw'\n    }),\n    width: extendFlat({}, scatterLineAttrs.width, {\n      editType: 'calc+arraydraw'\n    }),\n    dash: extendFlat({}, dash, {\n      editType: 'arraydraw'\n    }),\n    role: 'info',\n    editType: 'calc+arraydraw'\n  },\n  fillcolor: {\n    valType: 'color',\n    dflt: 'rgba(0,0,0,0)',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Sets the color filling the shape\\'s interior. Only applies to closed shapes.'].join(' ')\n  },\n  fillrule: {\n    valType: 'enumerated',\n    values: ['evenodd', 'nonzero'],\n    dflt: 'evenodd',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Determines which regions of complex paths constitute the interior.', 'For more info please visit https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill-rule'].join(' ')\n  },\n  editable: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: false,\n    editType: 'calc+arraydraw',\n    description: ['Determines whether the shape could be activated for edit or not.', 'Has no effect when the older editable shapes mode is enabled via', '`config.editable` or `config.edits.shapePosition`.'].join(' ')\n  },\n  editType: 'arraydraw'\n});","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n/**\n * All paths are tuned for maximum scalability of the arrowhead,\n * ie throughout arrowwidth=0.3..3 the head is joined smoothly\n * to the line, with the line coming from the left and ending at (0, 0).\n *\n * `backoff` is the distance to move the arrowhead and the end of the line,\n * in order that the arrowhead points to the desired place, either at\n * the tip of the arrow or (in the case of circle or square)\n * the center of the symbol.\n *\n * `noRotate`, if truthy, says that this arrowhead should not rotate with the\n * arrow. That's the case for squares, which should always be straight, and\n * circles, for which it's irrelevant.\n */\n\nmodule.exports = [// no arrow\n{\n  path: '',\n  backoff: 0\n}, // wide with flat back\n{\n  path: 'M-2.4,-3V3L0.6,0Z',\n  backoff: 0.6\n}, // narrower with flat back\n{\n  path: 'M-3.7,-2.5V2.5L1.3,0Z',\n  backoff: 1.3\n}, // barbed\n{\n  path: 'M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z',\n  backoff: 1.55\n}, // wide line-drawn\n{\n  path: 'M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z',\n  backoff: 1.6\n}, // narrower line-drawn\n{\n  path: 'M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z',\n  backoff: 2\n}, // circle\n{\n  path: 'M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z',\n  backoff: 0,\n  noRotate: true\n}, // square\n{\n  path: 'M2,2V-2H-2V2Z',\n  backoff: 0,\n  noRotate: true\n}];","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  cn: {\n    colorbar: 'colorbar',\n    cbbg: 'cbbg',\n    cbfill: 'cbfill',\n    cbfills: 'cbfills',\n    cbline: 'cbline',\n    cblines: 'cblines',\n    cbaxis: 'cbaxis',\n    cbtitleunshift: 'cbtitleunshift',\n    cbtitle: 'cbtitle',\n    cboutline: 'cboutline',\n    crisp: 'crisp',\n    jsPlaceholder: 'js-placeholder'\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Color = require('../color');\n\nmodule.exports = function style(traces) {\n  traces.each(function (d) {\n    var trace = d[0].trace;\n    var yObj = trace.error_y || {};\n    var xObj = trace.error_x || {};\n    var s = d3.select(this);\n    s.selectAll('path.yerror').style('stroke-width', yObj.thickness + 'px').call(Color.stroke, yObj.color);\n    if (xObj.copy_ystyle) xObj = yObj;\n    s.selectAll('path.xerror').style('stroke-width', xObj.thickness + 'px').call(Color.stroke, xObj.color);\n  });\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar toImage = require('../plot_api/to_image');\n\nvar fileSaver = require('./filesaver');\n\nvar helpers = require('./helpers');\n/**\n * Plotly.downloadImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see Plotly.toImage in ../plot_api/to_image)\n * @return {promise}\n */\n\n\nfunction downloadImage(gd, opts) {\n  var _gd;\n\n  if (!Lib.isPlainObject(gd)) _gd = Lib.getGraphDiv(gd);\n  opts = opts || {};\n  opts.format = opts.format || 'png';\n  opts.imageDataOnly = true;\n  return new Promise(function (resolve, reject) {\n    if (_gd && _gd._snapshotInProgress) {\n      reject(new Error('Snapshotting already in progress.'));\n    } // see comments within svgtoimg for additional\n    //   discussion of problems with IE\n    //   can now draw to canvas, but CORS tainted canvas\n    //   does not allow toDataURL\n    //   svg format will work though\n\n\n    if (Lib.isIE() && opts.format !== 'svg') {\n      reject(new Error(helpers.MSG_IE_BAD_FORMAT));\n    }\n\n    if (_gd) _gd._snapshotInProgress = true;\n    var promise = toImage(gd, opts);\n    var filename = opts.filename || gd.fn || 'newplot';\n    filename += '.' + opts.format.replace('-', '.');\n    promise.then(function (result) {\n      if (_gd) _gd._snapshotInProgress = false;\n      return fileSaver(result, filename, opts.format);\n    }).then(function (name) {\n      resolve(name);\n    }).catch(function (err) {\n      if (_gd) _gd._snapshotInProgress = false;\n      reject(err);\n    });\n  });\n}\n\nmodule.exports = downloadImage;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = {\n  // 'y' position pad above counter axis domain\n  yPad: 0.02,\n  // minimum button width (regardless of text size)\n  minButtonWidth: 30,\n  // buttons rect radii\n  rx: 3,\n  ry: 3,\n  // light fraction used to compute the 'activecolor' default\n  lightAmount: 25,\n  darkAmount: 10\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isPlainObject = require('../lib/is_plain_object');\n\nvar noop = require('../lib/noop');\n\nvar Loggers = require('../lib/loggers');\n\nvar sorterAsc = require('../lib/search').sorterAsc;\n\nvar Registry = require('../registry');\n\nexports.containerArrayMatch = require('./container_array_match');\n\nvar isAddVal = exports.isAddVal = function isAddVal(val) {\n  return val === 'add' || isPlainObject(val);\n};\n\nvar isRemoveVal = exports.isRemoveVal = function isRemoveVal(val) {\n  return val === null || val === 'remove';\n};\n/*\n * applyContainerArrayChanges: for managing arrays of layout components in relayout\n * handles them all with a consistent interface.\n *\n * Here are the supported actions -> relayout calls -> edits we get here\n * (as prepared in _relayout):\n *\n * add an empty obj -> {'annotations[2]': 'add'} -> {2: {'': 'add'}}\n * add a specific obj -> {'annotations[2]': {attrs}} -> {2: {'': {attrs}}}\n * delete an obj -> {'annotations[2]': 'remove'} -> {2: {'': 'remove'}}\n *               -> {'annotations[2]': null} -> {2: {'': null}}\n * delete the whole array -> {'annotations': 'remove'} -> {'': {'': 'remove'}}\n *                        -> {'annotations': null} -> {'': {'': null}}\n * edit an object -> {'annotations[2].text': 'boo'} -> {2: {'text': 'boo'}}\n *\n * You can combine many edits to different objects. Objects are added and edited\n * in ascending order, then removed in descending order.\n * For example, starting with [a, b, c], if you want to:\n * - replace b with d:\n *   {'annotations[1]': d, 'annotations[2]': null} (b is item 2 after adding d)\n * - add a new item d between a and b, and edit b:\n *    {'annotations[1]': d, 'annotations[2].x': newX} (b is item 2 after adding d)\n * - delete b and edit c:\n *    {'annotations[1]': null, 'annotations[2].x': newX} (c is edited before b is removed)\n *\n * You CANNOT combine adding/deleting an item at index `i` with edits to the same index `i`\n * You CANNOT combine replacing/deleting the whole array with anything else (for the same array).\n *\n * @param {HTMLDivElement} gd\n *  the DOM element of the graph container div\n * @param {Lib.nestedProperty} componentType: the array we are editing\n * @param {Object} edits\n *  the changes to make; keys are indices to edit, values are themselves objects:\n *  {attr: newValue} of changes to make to that index (with add/remove behavior\n *  in special values of the empty attr)\n * @param {Object} flags\n *  the flags for which actions we're going to perform to display these (and\n *  any other) changes. If we're already `recalc`ing, we don't need to redraw\n *  individual items\n * @param {function} _nestedProperty\n *  a (possibly modified for gui edits) nestedProperty constructor\n *  The modified version takes a 3rd argument, for a prefix to the attribute\n *  string necessary for storing GUI edits\n *\n * @returns {bool} `true` if it managed to complete drawing of the changes\n *  `false` would mean the parent should replot.\n */\n\n\nexports.applyContainerArrayChanges = function applyContainerArrayChanges(gd, np, edits, flags, _nestedProperty) {\n  var componentType = np.astr;\n  var supplyComponentDefaults = Registry.getComponentMethod(componentType, 'supplyLayoutDefaults');\n  var draw = Registry.getComponentMethod(componentType, 'draw');\n  var drawOne = Registry.getComponentMethod(componentType, 'drawOne');\n  var replotLater = flags.replot || flags.recalc || supplyComponentDefaults === noop || draw === noop;\n  var layout = gd.layout;\n  var fullLayout = gd._fullLayout;\n\n  if (edits['']) {\n    if (Object.keys(edits).length > 1) {\n      Loggers.warn('Full array edits are incompatible with other edits', componentType);\n    }\n\n    var fullVal = edits[''][''];\n    if (isRemoveVal(fullVal)) np.set(null);else if (Array.isArray(fullVal)) np.set(fullVal);else {\n      Loggers.warn('Unrecognized full array edit value', componentType, fullVal);\n      return true;\n    }\n    if (replotLater) return false;\n    supplyComponentDefaults(layout, fullLayout);\n    draw(gd);\n    return true;\n  }\n\n  var componentNums = Object.keys(edits).map(Number).sort(sorterAsc);\n  var componentArrayIn = np.get();\n  var componentArray = componentArrayIn || []; // componentArrayFull is used just to keep splices in line between\n  // full and input arrays, so private keys can be copied over after\n  // redoing supplyDefaults\n  // TODO: this assumes componentArray is in gd.layout - which will not be\n  // true after we extend this to restyle\n\n  var componentArrayFull = _nestedProperty(fullLayout, componentType).get();\n\n  var deletes = [];\n  var firstIndexChange = -1;\n  var maxIndex = componentArray.length;\n  var i;\n  var j;\n  var componentNum;\n  var objEdits;\n  var objKeys;\n  var objVal;\n  var adding, prefix; // first make the add and edit changes\n\n  for (i = 0; i < componentNums.length; i++) {\n    componentNum = componentNums[i];\n    objEdits = edits[componentNum];\n    objKeys = Object.keys(objEdits);\n    objVal = objEdits[''], adding = isAddVal(objVal);\n\n    if (componentNum < 0 || componentNum > componentArray.length - (adding ? 0 : 1)) {\n      Loggers.warn('index out of range', componentType, componentNum);\n      continue;\n    }\n\n    if (objVal !== undefined) {\n      if (objKeys.length > 1) {\n        Loggers.warn('Insertion & removal are incompatible with edits to the same index.', componentType, componentNum);\n      }\n\n      if (isRemoveVal(objVal)) {\n        deletes.push(componentNum);\n      } else if (adding) {\n        if (objVal === 'add') objVal = {};\n        componentArray.splice(componentNum, 0, objVal);\n        if (componentArrayFull) componentArrayFull.splice(componentNum, 0, {});\n      } else {\n        Loggers.warn('Unrecognized full object edit value', componentType, componentNum, objVal);\n      }\n\n      if (firstIndexChange === -1) firstIndexChange = componentNum;\n    } else {\n      for (j = 0; j < objKeys.length; j++) {\n        prefix = componentType + '[' + componentNum + '].';\n\n        _nestedProperty(componentArray[componentNum], objKeys[j], prefix).set(objEdits[objKeys[j]]);\n      }\n    }\n  } // now do deletes\n\n\n  for (i = deletes.length - 1; i >= 0; i--) {\n    componentArray.splice(deletes[i], 1); // TODO: this drops private keys that had been stored in componentArrayFull\n    // does this have any ill effects?\n\n    if (componentArrayFull) componentArrayFull.splice(deletes[i], 1);\n  }\n\n  if (!componentArray.length) np.set(null);else if (!componentArrayIn) np.set(componentArray);\n  if (replotLater) return false;\n  supplyComponentDefaults(layout, fullLayout); // finally draw all the components we need to\n  // if we added or removed any, redraw all after it\n\n  if (drawOne !== noop) {\n    var indicesToDraw;\n\n    if (firstIndexChange === -1) {\n      // there's no re-indexing to do, so only redraw components that changed\n      indicesToDraw = componentNums;\n    } else {\n      // in case the component array was shortened, we still need do call\n      // drawOne on the latter items so they get properly removed\n      maxIndex = Math.max(componentArray.length, maxIndex);\n      indicesToDraw = [];\n\n      for (i = 0; i < componentNums.length; i++) {\n        componentNum = componentNums[i];\n        if (componentNum >= firstIndexChange) break;\n        indicesToDraw.push(componentNum);\n      }\n\n      for (i = firstIndexChange; i < maxIndex; i++) {\n        indicesToDraw.push(i);\n      }\n    }\n\n    for (i = 0; i < indicesToDraw.length; i++) {\n      drawOne(gd, indicesToDraw[i]);\n    }\n  } else draw(gd);\n\n  return true;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar traceIs = require('../../registry').traceIs;\n\nvar autoType = require('./axis_autotype');\n/*\n *  data: the plot data to use in choosing auto type\n *  name: axis object name (ie 'xaxis') if one should be stored\n */\n\n\nmodule.exports = function handleTypeDefaults(containerIn, containerOut, coerce, options) {\n  var axType = coerce('type', (options.splomStash || {}).type);\n\n  if (axType === '-') {\n    setAutoType(containerOut, options.data);\n\n    if (containerOut.type === '-') {\n      containerOut.type = 'linear';\n    } else {\n      // copy autoType back to input axis\n      // note that if this object didn't exist\n      // in the input layout, we have to put it in\n      // this happens in the main supplyDefaults function\n      containerIn.type = containerOut.type;\n    }\n  }\n};\n\nfunction setAutoType(ax, data) {\n  // new logic: let people specify any type they want,\n  // only autotype if type is '-'\n  if (ax.type !== '-') return;\n  var id = ax._id;\n  var axLetter = id.charAt(0);\n  var i; // support 3d\n\n  if (id.indexOf('scene') !== -1) id = axLetter;\n  var d0 = getFirstNonEmptyTrace(data, id, axLetter);\n  if (!d0) return; // first check for histograms, as the count direction\n  // should always default to a linear axis\n\n  if (d0.type === 'histogram' && axLetter === {\n    v: 'y',\n    h: 'x'\n  }[d0.orientation || 'v']) {\n    ax.type = 'linear';\n    return;\n  }\n\n  var calAttr = axLetter + 'calendar';\n  var calendar = d0[calAttr];\n  var opts = {\n    noMultiCategory: !traceIs(d0, 'cartesian') || traceIs(d0, 'noMultiCategory')\n  }; // To not confuse 2D x/y used for per-box sample points for multicategory coordinates\n\n  if (d0.type === 'box' && d0._hasPreCompStats && axLetter === {\n    h: 'x',\n    v: 'y'\n  }[d0.orientation || 'v']) {\n    opts.noMultiCategory = true;\n  } // check all boxes on this x axis to see\n  // if they're dates, numbers, or categories\n\n\n  if (isBoxWithoutPositionCoords(d0, axLetter)) {\n    var posLetter = getBoxPosLetter(d0);\n    var boxPositions = [];\n\n    for (i = 0; i < data.length; i++) {\n      var trace = data[i];\n      if (!traceIs(trace, 'box-violin') || (trace[axLetter + 'axis'] || axLetter) !== id) continue;\n      if (trace[posLetter] !== undefined) boxPositions.push(trace[posLetter][0]);else if (trace.name !== undefined) boxPositions.push(trace.name);else boxPositions.push('text');\n      if (trace[calAttr] !== calendar) calendar = undefined;\n    }\n\n    ax.type = autoType(boxPositions, calendar, opts);\n  } else if (d0.type === 'splom') {\n    var dimensions = d0.dimensions;\n    var dim = dimensions[d0._axesDim[id]];\n    if (dim.visible) ax.type = autoType(dim.values, calendar, opts);\n  } else {\n    ax.type = autoType(d0[axLetter] || [d0[axLetter + '0']], calendar, opts);\n  }\n}\n\nfunction getFirstNonEmptyTrace(data, id, axLetter) {\n  for (var i = 0; i < data.length; i++) {\n    var trace = data[i];\n\n    if (trace.type === 'splom' && trace._length > 0 && (trace['_' + axLetter + 'axes'] || {})[id]) {\n      return trace;\n    }\n\n    if ((trace[axLetter + 'axis'] || axLetter) === id) {\n      if (isBoxWithoutPositionCoords(trace, axLetter)) {\n        return trace;\n      } else if ((trace[axLetter] || []).length || trace[axLetter + '0']) {\n        return trace;\n      }\n    }\n  }\n}\n\nfunction getBoxPosLetter(trace) {\n  return {\n    v: 'x',\n    h: 'y'\n  }[trace.orientation || 'v'];\n}\n\nfunction isBoxWithoutPositionCoords(trace, axLetter) {\n  var posLetter = getBoxPosLetter(trace);\n  var isBox = traceIs(trace, 'box-violin');\n  var isCandlestick = traceIs(trace._fullInput || {}, 'candlestick');\n  return isBox && !isCandlestick && axLetter === posLetter && trace[posLetter] === undefined && trace[posLetter + '0'] === undefined;\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar isNumeric = require('fast-isnumeric');\n\nvar hasHover = require('has-hover');\n\nvar Lib = require('../lib');\n\nvar nestedProperty = Lib.nestedProperty;\n\nvar Events = require('../lib/events');\n\nvar Queue = require('../lib/queue');\n\nvar Registry = require('../registry');\n\nvar PlotSchema = require('./plot_schema');\n\nvar Plots = require('../plots/plots');\n\nvar Polar = require('../plots/polar/legacy');\n\nvar Axes = require('../plots/cartesian/axes');\n\nvar Drawing = require('../components/drawing');\n\nvar Color = require('../components/color');\n\nvar initInteractions = require('../plots/cartesian/graph_interact').initInteractions;\n\nvar xmlnsNamespaces = require('../constants/xmlns_namespaces');\n\nvar svgTextUtils = require('../lib/svg_text_utils');\n\nvar clearSelect = require('../plots/cartesian/select').clearSelect;\n\nvar dfltConfig = require('./plot_config').dfltConfig;\n\nvar manageArrays = require('./manage_arrays');\n\nvar helpers = require('./helpers');\n\nvar subroutines = require('./subroutines');\n\nvar editTypes = require('./edit_types');\n\nvar AX_NAME_PATTERN = require('../plots/cartesian/constants').AX_NAME_PATTERN;\n\nvar numericNameWarningCount = 0;\nvar numericNameWarningCountLimit = 5;\n/**\n * Main plot-creation function\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n * @param {array of objects} data\n *      array of traces, containing the data and display information for each trace\n * @param {object} layout\n *      object describing the overall display of the plot,\n *      all the stuff that doesn't pertain to any individual trace\n * @param {object} config\n *      configuration options (see ./plot_config.js for more info)\n *\n * OR\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n * @param {object} figure\n *      object containing `data`, `layout`, `config`, and `frames` members\n *\n */\n\nfunction plot(gd, data, layout, config) {\n  var frames;\n  gd = Lib.getGraphDiv(gd); // Events.init is idempotent and bails early if gd has already been init'd\n\n  Events.init(gd);\n\n  if (Lib.isPlainObject(data)) {\n    var obj = data;\n    data = obj.data;\n    layout = obj.layout;\n    config = obj.config;\n    frames = obj.frames;\n  }\n\n  var okToPlot = Events.triggerHandler(gd, 'plotly_beforeplot', [data, layout, config]);\n  if (okToPlot === false) return Promise.reject(); // if there's no data or layout, and this isn't yet a plotly plot\n  // container, log a warning to help plotly.js users debug\n\n  if (!data && !layout && !Lib.isPlotDiv(gd)) {\n    Lib.warn('Calling Plotly.plot as if redrawing ' + 'but this container doesn\\'t yet have a plot.', gd);\n  }\n\n  function addFrames() {\n    if (frames) {\n      return exports.addFrames(gd, frames);\n    }\n  } // transfer configuration options to gd until we move over to\n  // a more OO like model\n\n\n  setPlotContext(gd, config);\n  if (!layout) layout = {}; // hook class for plots main container (in case of plotly.js\n  // this won't be #embedded-graph or .js-tab-contents)\n\n  d3.select(gd).classed('js-plotly-plot', true); // off-screen getBoundingClientRect testing space,\n  // in #js-plotly-tester (and stored as Drawing.tester)\n  // so we can share cached text across tabs\n\n  Drawing.makeTester(); // collect promises for any async actions during plotting\n  // any part of the plotting code can push to gd._promises, then\n  // before we move to the next step, we check that they're all\n  // complete, and empty out the promise list again.\n\n  if (!Array.isArray(gd._promises)) gd._promises = [];\n  var graphWasEmpty = (gd.data || []).length === 0 && Array.isArray(data); // if there is already data on the graph, append the new data\n  // if you only want to redraw, pass a non-array for data\n\n  if (Array.isArray(data)) {\n    helpers.cleanData(data);\n    if (graphWasEmpty) gd.data = data;else gd.data.push.apply(gd.data, data); // for routines outside graph_obj that want a clean tab\n    // (rather than appending to an existing one) gd.empty\n    // is used to determine whether to make a new tab\n\n    gd.empty = false;\n  }\n\n  if (!gd.layout || graphWasEmpty) {\n    gd.layout = helpers.cleanLayout(layout);\n  }\n\n  Plots.supplyDefaults(gd);\n  var fullLayout = gd._fullLayout;\n\n  var hasCartesian = fullLayout._has('cartesian'); // Legacy polar plots\n\n\n  if (!fullLayout._has('polar') && data && data[0] && data[0].r) {\n    Lib.log('Legacy polar charts are deprecated!');\n    return plotLegacyPolar(gd, data, layout);\n  } // so we don't try to re-call Plotly.plot from inside\n  // legend and colorbar, if margins changed\n\n\n  fullLayout._replotting = true; // make or remake the framework if we need to\n\n  if (graphWasEmpty || fullLayout._shouldCreateBgLayer) {\n    makePlotFramework(gd);\n\n    if (fullLayout._shouldCreateBgLayer) {\n      delete fullLayout._shouldCreateBgLayer;\n    }\n  } // polar need a different framework\n\n\n  if (gd.framework !== makePlotFramework) {\n    gd.framework = makePlotFramework;\n    makePlotFramework(gd);\n  } // clear gradient defs on each .plot call, because we know we'll loop through all traces\n\n\n  Drawing.initGradients(gd); // save initial show spikes once per graph\n\n  if (graphWasEmpty) Axes.saveShowSpikeInitial(gd); // prepare the data and find the autorange\n  // generate calcdata, if we need to\n  // to force redoing calcdata, just delete it before calling Plotly.plot\n\n  var recalc = !gd.calcdata || gd.calcdata.length !== (gd._fullData || []).length;\n  if (recalc) Plots.doCalcdata(gd); // in case it has changed, attach fullData traces to calcdata\n\n  for (var i = 0; i < gd.calcdata.length; i++) {\n    gd.calcdata[i][0].trace = gd._fullData[i];\n  } // make the figure responsive\n\n\n  if (gd._context.responsive) {\n    if (!gd._responsiveChartHandler) {\n      // Keep a reference to the resize handler to purge it down the road\n      gd._responsiveChartHandler = function () {\n        if (!Lib.isHidden(gd)) Plots.resize(gd);\n      }; // Listen to window resize\n\n\n      window.addEventListener('resize', gd._responsiveChartHandler);\n    }\n  } else {\n    Lib.clearResponsive(gd);\n  }\n  /*\n   * start async-friendly code - now we're actually drawing things\n   */\n\n\n  var oldMargins = Lib.extendFlat({}, fullLayout._size); // draw framework first so that margin-pushing\n  // components can position themselves correctly\n\n  var drawFrameworkCalls = 0;\n\n  function drawFramework() {\n    var basePlotModules = fullLayout._basePlotModules;\n\n    for (var i = 0; i < basePlotModules.length; i++) {\n      if (basePlotModules[i].drawFramework) {\n        basePlotModules[i].drawFramework(gd);\n      }\n    }\n\n    if (!fullLayout._glcanvas && fullLayout._has('gl')) {\n      fullLayout._glcanvas = fullLayout._glcontainer.selectAll('.gl-canvas').data([{\n        key: 'contextLayer',\n        context: true,\n        pick: false\n      }, {\n        key: 'focusLayer',\n        context: false,\n        pick: false\n      }, {\n        key: 'pickLayer',\n        context: false,\n        pick: true\n      }], function (d) {\n        return d.key;\n      });\n\n      fullLayout._glcanvas.enter().append('canvas').attr('class', function (d) {\n        return 'gl-canvas gl-canvas-' + d.key.replace('Layer', '');\n      }).style({\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        overflow: 'visible',\n        'pointer-events': 'none'\n      });\n    }\n\n    if (fullLayout._glcanvas) {\n      fullLayout._glcanvas.attr('width', fullLayout.width).attr('height', fullLayout.height);\n\n      var regl = fullLayout._glcanvas.data()[0].regl;\n\n      if (regl) {\n        // Unfortunately, this can happen when relayouting to large\n        // width/height on some browsers.\n        if (Math.floor(fullLayout.width) !== regl._gl.drawingBufferWidth || Math.floor(fullLayout.height) !== regl._gl.drawingBufferHeight) {\n          var msg = 'WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.';\n\n          if (drawFrameworkCalls) {\n            Lib.error(msg);\n          } else {\n            Lib.log(msg + ' Clearing graph and plotting again.');\n            Plots.cleanPlot([], {}, gd._fullData, fullLayout);\n            Plots.supplyDefaults(gd);\n            fullLayout = gd._fullLayout;\n            Plots.doCalcdata(gd);\n            drawFrameworkCalls++;\n            return drawFramework();\n          }\n        }\n      }\n    }\n\n    if (fullLayout.modebar.orientation === 'h') {\n      fullLayout._modebardiv.style('height', null).style('width', '100%');\n    } else {\n      fullLayout._modebardiv.style('width', null).style('height', fullLayout.height + 'px');\n    }\n\n    return Plots.previousPromises(gd);\n  } // draw anything that can affect margins.\n\n\n  function marginPushers() {\n    // First reset the list of things that are allowed to change the margins\n    // So any deleted traces or components will be wiped out of the\n    // automargin calculation.\n    // This means *every* margin pusher must be listed here, even if it\n    // doesn't actually try to push the margins until later.\n    Plots.clearAutoMarginIds(gd);\n    subroutines.drawMarginPushers(gd);\n    Axes.allowAutoMargin(gd); // TODO can this be moved elsewhere?\n\n    if (fullLayout._has('pie')) {\n      var fullData = gd._fullData;\n\n      for (var i = 0; i < fullData.length; i++) {\n        var trace = fullData[i];\n\n        if (trace.type === 'pie' && trace.automargin) {\n          Plots.allowAutoMargin(gd, 'pie.' + trace.uid + '.automargin');\n        }\n      }\n    }\n\n    Plots.doAutoMargin(gd);\n    return Plots.previousPromises(gd);\n  } // in case the margins changed, draw margin pushers again\n\n\n  function marginPushersAgain() {\n    if (!Plots.didMarginChange(oldMargins, fullLayout._size)) return;\n    return Lib.syncOrAsync([marginPushers, subroutines.layoutStyles], gd);\n  }\n\n  function positionAndAutorange() {\n    if (!recalc) {\n      doAutoRangeAndConstraints();\n      return;\n    } // TODO: autosize extra for text markers and images\n    // see https://github.com/plotly/plotly.js/issues/1111\n\n\n    return Lib.syncOrAsync([Registry.getComponentMethod('shapes', 'calcAutorange'), Registry.getComponentMethod('annotations', 'calcAutorange'), doAutoRangeAndConstraints], gd);\n  }\n\n  function doAutoRangeAndConstraints() {\n    if (gd._transitioning) return;\n    subroutines.doAutoRangeAndConstraints(gd); // store initial ranges *after* enforcing constraints, otherwise\n    // we will never look like we're at the initial ranges\n\n    if (graphWasEmpty) Axes.saveRangeInitial(gd); // this one is different from shapes/annotations calcAutorange\n    // the others incorporate those components into ax._extremes,\n    // this one actually sets the ranges in rangesliders.\n\n    Registry.getComponentMethod('rangeslider', 'calcAutorange')(gd);\n  } // draw ticks, titles, and calculate axis scaling (._b, ._m)\n\n\n  function drawAxes() {\n    return Axes.draw(gd, graphWasEmpty ? '' : 'redraw');\n  }\n\n  var seq = [Plots.previousPromises, addFrames, drawFramework, marginPushers, marginPushersAgain];\n  if (hasCartesian) seq.push(positionAndAutorange);\n  seq.push(subroutines.layoutStyles);\n  if (hasCartesian) seq.push(drawAxes);\n  seq.push(subroutines.drawData, subroutines.finalDraw, initInteractions, Plots.addLinks, Plots.rehover, Plots.redrag, // TODO: doAutoMargin is only needed here for axis automargin, which\n  // happens outside of marginPushers where all the other automargins are\n  // calculated. Would be much better to separate margin calculations from\n  // component drawing - see https://github.com/plotly/plotly.js/issues/2704\n  Plots.doAutoMargin, Plots.previousPromises); // even if everything we did was synchronous, return a promise\n  // so that the caller doesn't care which route we took\n\n  var plotDone = Lib.syncOrAsync(seq, gd);\n  if (!plotDone || !plotDone.then) plotDone = Promise.resolve();\n  return plotDone.then(function () {\n    emitAfterPlot(gd);\n    return gd;\n  });\n}\n\nfunction emitAfterPlot(gd) {\n  var fullLayout = gd._fullLayout;\n\n  if (fullLayout._redrawFromAutoMarginCount) {\n    fullLayout._redrawFromAutoMarginCount--;\n  } else {\n    gd.emit('plotly_afterplot');\n  }\n}\n\nfunction setPlotConfig(obj) {\n  return Lib.extendFlat(dfltConfig, obj);\n}\n\nfunction setBackground(gd, bgColor) {\n  try {\n    gd._fullLayout._paper.style('background', bgColor);\n  } catch (e) {\n    Lib.error(e);\n  }\n}\n\nfunction opaqueSetBackground(gd, bgColor) {\n  var blend = Color.combine(bgColor, 'white');\n  setBackground(gd, blend);\n}\n\nfunction setPlotContext(gd, config) {\n  if (!gd._context) {\n    gd._context = Lib.extendDeep({}, dfltConfig); // stash <base> href, used to make robust clipPath URLs\n\n    var base = d3.select('base');\n    gd._context._baseUrl = base.size() && base.attr('href') ? window.location.href.split('#')[0] : '';\n  }\n\n  var context = gd._context;\n  var i, keys, key;\n\n  if (config) {\n    keys = Object.keys(config);\n\n    for (i = 0; i < keys.length; i++) {\n      key = keys[i];\n      if (key === 'editable' || key === 'edits') continue;\n\n      if (key in context) {\n        if (key === 'setBackground' && config[key] === 'opaque') {\n          context[key] = opaqueSetBackground;\n        } else {\n          context[key] = config[key];\n        }\n      }\n    } // map plot3dPixelRatio to plotGlPixelRatio for backward compatibility\n\n\n    if (config.plot3dPixelRatio && !context.plotGlPixelRatio) {\n      context.plotGlPixelRatio = context.plot3dPixelRatio;\n    } // now deal with editable and edits - first editable overrides\n    // everything, then edits refines\n\n\n    var editable = config.editable;\n\n    if (editable !== undefined) {\n      // we're not going to *use* context.editable, we're only going to\n      // use context.edits... but keep it for the record\n      context.editable = editable;\n      keys = Object.keys(context.edits);\n\n      for (i = 0; i < keys.length; i++) {\n        context.edits[keys[i]] = editable;\n      }\n    }\n\n    if (config.edits) {\n      keys = Object.keys(config.edits);\n\n      for (i = 0; i < keys.length; i++) {\n        key = keys[i];\n\n        if (key in context.edits) {\n          context.edits[key] = config.edits[key];\n        }\n      }\n    } // not part of the user-facing config options\n\n\n    context._exportedPlot = config._exportedPlot;\n  } // staticPlot forces a bunch of others:\n\n\n  if (context.staticPlot) {\n    context.editable = false;\n    context.edits = {};\n    context.autosizable = false;\n    context.scrollZoom = false;\n    context.doubleClick = false;\n    context.showTips = false;\n    context.showLink = false;\n    context.displayModeBar = false;\n  } // make sure hover-only devices have mode bar visible\n\n\n  if (context.displayModeBar === 'hover' && !hasHover) {\n    context.displayModeBar = true;\n  } // default and fallback for setBackground\n\n\n  if (context.setBackground === 'transparent' || typeof context.setBackground !== 'function') {\n    context.setBackground = setBackground;\n  } // Check if gd has a specified widht/height to begin with\n\n\n  context._hasZeroHeight = context._hasZeroHeight || gd.clientHeight === 0;\n  context._hasZeroWidth = context._hasZeroWidth || gd.clientWidth === 0; // fill context._scrollZoom helper to help manage scrollZoom flaglist\n\n  var szIn = context.scrollZoom;\n  var szOut = context._scrollZoom = {};\n\n  if (szIn === true) {\n    szOut.cartesian = 1;\n    szOut.gl3d = 1;\n    szOut.geo = 1;\n    szOut.mapbox = 1;\n  } else if (typeof szIn === 'string') {\n    var parts = szIn.split('+');\n\n    for (i = 0; i < parts.length; i++) {\n      szOut[parts[i]] = 1;\n    }\n  } else if (szIn !== false) {\n    szOut.gl3d = 1;\n    szOut.geo = 1;\n    szOut.mapbox = 1;\n  }\n}\n\nfunction plotLegacyPolar(gd, data, layout) {\n  // build or reuse the container skeleton\n  var plotContainer = d3.select(gd).selectAll('.plot-container').data([0]);\n  plotContainer.enter().insert('div', ':first-child').classed('plot-container plotly', true);\n  var paperDiv = plotContainer.selectAll('.svg-container').data([0]);\n  paperDiv.enter().append('div').classed('svg-container', true).style('position', 'relative'); // empty it everytime for now\n\n  paperDiv.html(''); // fulfill gd requirements\n\n  if (data) gd.data = data;\n  if (layout) gd.layout = layout;\n  Polar.manager.fillLayout(gd); // resize canvas\n\n  paperDiv.style({\n    width: gd._fullLayout.width + 'px',\n    height: gd._fullLayout.height + 'px'\n  }); // instantiate framework\n\n  gd.framework = Polar.manager.framework(gd); // plot\n\n  gd.framework({\n    data: gd.data,\n    layout: gd.layout\n  }, paperDiv.node()); // set undo point\n\n  gd.framework.setUndoPoint(); // get the resulting svg for extending it\n\n  var polarPlotSVG = gd.framework.svg(); // editable title\n\n  var opacity = 1;\n  var txt = gd._fullLayout.title ? gd._fullLayout.title.text : '';\n  if (txt === '' || !txt) opacity = 0;\n\n  var titleLayout = function titleLayout() {\n    this.call(svgTextUtils.convertToTspans, gd); // TODO: html/mathjax\n    // TODO: center title\n  };\n\n  var title = polarPlotSVG.select('.title-group text').call(titleLayout);\n\n  if (gd._context.edits.titleText) {\n    var placeholderText = Lib._(gd, 'Click to enter Plot title');\n\n    if (!txt || txt === placeholderText) {\n      opacity = 0.2; // placeholder is not going through convertToTspans\n      // so needs explicit data-unformatted\n\n      title.attr({\n        'data-unformatted': placeholderText\n      }).text(placeholderText).style({\n        opacity: opacity\n      }).on('mouseover.opacity', function () {\n        d3.select(this).transition().duration(100).style('opacity', 1);\n      }).on('mouseout.opacity', function () {\n        d3.select(this).transition().duration(1000).style('opacity', 0);\n      });\n    }\n\n    var setContenteditable = function setContenteditable() {\n      this.call(svgTextUtils.makeEditable, {\n        gd: gd\n      }).on('edit', function (text) {\n        gd.framework({\n          layout: {\n            title: {\n              text: text\n            }\n          }\n        });\n        this.text(text).call(titleLayout);\n        this.call(setContenteditable);\n      }).on('cancel', function () {\n        var txt = this.attr('data-unformatted');\n        this.text(txt).call(titleLayout);\n      });\n    };\n\n    title.call(setContenteditable);\n  }\n\n  gd._context.setBackground(gd, gd._fullLayout.paper_bgcolor);\n\n  Plots.addLinks(gd);\n  return Promise.resolve();\n} // convenience function to force a full redraw, mostly for use by plotly.js\n\n\nfunction redraw(gd) {\n  gd = Lib.getGraphDiv(gd);\n\n  if (!Lib.isPlotDiv(gd)) {\n    throw new Error('This element is not a Plotly plot: ' + gd);\n  }\n\n  helpers.cleanData(gd.data);\n  helpers.cleanLayout(gd.layout);\n  gd.calcdata = undefined;\n  return exports.plot(gd).then(function () {\n    gd.emit('plotly_redraw');\n    return gd;\n  });\n}\n/**\n * Convenience function to make idempotent plot option obvious to users.\n *\n * @param gd\n * @param {Object[]} data\n * @param {Object} layout\n * @param {Object} config\n */\n\n\nfunction newPlot(gd, data, layout, config) {\n  gd = Lib.getGraphDiv(gd); // remove gl contexts\n\n  Plots.cleanPlot([], {}, gd._fullData || [], gd._fullLayout || {});\n  Plots.purge(gd);\n  return exports.plot(gd, data, layout, config);\n}\n/**\n * Wrap negative indicies to their positive counterparts.\n *\n * @param {Number[]} indices An array of indices\n * @param {Number} maxIndex The maximum index allowable (arr.length - 1)\n */\n\n\nfunction positivifyIndices(indices, maxIndex) {\n  var parentLength = maxIndex + 1;\n  var positiveIndices = [];\n  var i;\n  var index;\n\n  for (i = 0; i < indices.length; i++) {\n    index = indices[i];\n\n    if (index < 0) {\n      positiveIndices.push(parentLength + index);\n    } else {\n      positiveIndices.push(index);\n    }\n  }\n\n  return positiveIndices;\n}\n/**\n * Ensures that an index array for manipulating gd.data is valid.\n *\n * Intended for use with addTraces, deleteTraces, and moveTraces.\n *\n * @param gd\n * @param indices\n * @param arrayName\n */\n\n\nfunction assertIndexArray(gd, indices, arrayName) {\n  var i, index;\n\n  for (i = 0; i < indices.length; i++) {\n    index = indices[i]; // validate that indices are indeed integers\n\n    if (index !== parseInt(index, 10)) {\n      throw new Error('all values in ' + arrayName + ' must be integers');\n    } // check that all indices are in bounds for given gd.data array length\n\n\n    if (index >= gd.data.length || index < -gd.data.length) {\n      throw new Error(arrayName + ' must be valid indices for gd.data.');\n    } // check that indices aren't repeated\n\n\n    if (indices.indexOf(index, i + 1) > -1 || index >= 0 && indices.indexOf(-gd.data.length + index) > -1 || index < 0 && indices.indexOf(gd.data.length + index) > -1) {\n      throw new Error('each index in ' + arrayName + ' must be unique.');\n    }\n  }\n}\n/**\n * Private function used by Plotly.moveTraces to check input args\n *\n * @param gd\n * @param currentIndices\n * @param newIndices\n */\n\n\nfunction checkMoveTracesArgs(gd, currentIndices, newIndices) {\n  // check that gd has attribute 'data' and 'data' is array\n  if (!Array.isArray(gd.data)) {\n    throw new Error('gd.data must be an array.');\n  } // validate currentIndices array\n\n\n  if (typeof currentIndices === 'undefined') {\n    throw new Error('currentIndices is a required argument.');\n  } else if (!Array.isArray(currentIndices)) {\n    currentIndices = [currentIndices];\n  }\n\n  assertIndexArray(gd, currentIndices, 'currentIndices'); // validate newIndices array if it exists\n\n  if (typeof newIndices !== 'undefined' && !Array.isArray(newIndices)) {\n    newIndices = [newIndices];\n  }\n\n  if (typeof newIndices !== 'undefined') {\n    assertIndexArray(gd, newIndices, 'newIndices');\n  } // check currentIndices and newIndices are the same length if newIdices exists\n\n\n  if (typeof newIndices !== 'undefined' && currentIndices.length !== newIndices.length) {\n    throw new Error('current and new indices must be of equal length.');\n  }\n}\n/**\n * A private function to reduce the type checking clutter in addTraces.\n *\n * @param gd\n * @param traces\n * @param newIndices\n */\n\n\nfunction checkAddTracesArgs(gd, traces, newIndices) {\n  var i, value; // check that gd has attribute 'data' and 'data' is array\n\n  if (!Array.isArray(gd.data)) {\n    throw new Error('gd.data must be an array.');\n  } // make sure traces exists\n\n\n  if (typeof traces === 'undefined') {\n    throw new Error('traces must be defined.');\n  } // make sure traces is an array\n\n\n  if (!Array.isArray(traces)) {\n    traces = [traces];\n  } // make sure each value in traces is an object\n\n\n  for (i = 0; i < traces.length; i++) {\n    value = traces[i];\n\n    if (typeof value !== 'object' || Array.isArray(value) || value === null) {\n      throw new Error('all values in traces array must be non-array objects');\n    }\n  } // make sure we have an index for each trace\n\n\n  if (typeof newIndices !== 'undefined' && !Array.isArray(newIndices)) {\n    newIndices = [newIndices];\n  }\n\n  if (typeof newIndices !== 'undefined' && newIndices.length !== traces.length) {\n    throw new Error('if indices is specified, traces.length must equal indices.length');\n  }\n}\n/**\n * A private function to reduce the type checking clutter in spliceTraces.\n * Get all update Properties from gd.data. Validate inputs and outputs.\n * Used by prependTrace and extendTraces\n *\n * @param gd\n * @param update\n * @param indices\n * @param maxPoints\n */\n\n\nfunction assertExtendTracesArgs(gd, update, indices, maxPoints) {\n  var maxPointsIsObject = Lib.isPlainObject(maxPoints);\n\n  if (!Array.isArray(gd.data)) {\n    throw new Error('gd.data must be an array');\n  }\n\n  if (!Lib.isPlainObject(update)) {\n    throw new Error('update must be a key:value object');\n  }\n\n  if (typeof indices === 'undefined') {\n    throw new Error('indices must be an integer or array of integers');\n  }\n\n  assertIndexArray(gd, indices, 'indices');\n\n  for (var key in update) {\n    /*\n     * Verify that the attribute to be updated contains as many trace updates\n     * as indices. Failure must result in throw and no-op\n     */\n    if (!Array.isArray(update[key]) || update[key].length !== indices.length) {\n      throw new Error('attribute ' + key + ' must be an array of length equal to indices array length');\n    }\n    /*\n     * if maxPoints is an object it must match keys and array lengths of 'update' 1:1\n     */\n\n\n    if (maxPointsIsObject && (!(key in maxPoints) || !Array.isArray(maxPoints[key]) || maxPoints[key].length !== update[key].length)) {\n      throw new Error('when maxPoints is set as a key:value object it must contain a 1:1 ' + 'corrispondence with the keys and number of traces in the update object');\n    }\n  }\n}\n/**\n * A private function to reduce the type checking clutter in spliceTraces.\n *\n * @param {Object|HTMLDivElement} gd\n * @param {Object} update\n * @param {Number[]} indices\n * @param {Number||Object} maxPoints\n * @return {Object[]}\n */\n\n\nfunction getExtendProperties(gd, update, indices, maxPoints) {\n  var maxPointsIsObject = Lib.isPlainObject(maxPoints);\n  var updateProps = [];\n  var trace, target, prop, insert, maxp; // allow scalar index to represent a single trace position\n\n  if (!Array.isArray(indices)) indices = [indices]; // negative indices are wrapped around to their positive value. Equivalent to python indexing.\n\n  indices = positivifyIndices(indices, gd.data.length - 1); // loop through all update keys and traces and harvest validated data.\n\n  for (var key in update) {\n    for (var j = 0; j < indices.length; j++) {\n      /*\n       * Choose the trace indexed by the indices map argument and get the prop setter-getter\n       * instance that references the key and value for this particular trace.\n       */\n      trace = gd.data[indices[j]];\n      prop = nestedProperty(trace, key);\n      /*\n       * Target is the existing gd.data.trace.dataArray value like \"x\" or \"marker.size\"\n       * Target must exist as an Array to allow the extend operation to be performed.\n       */\n\n      target = prop.get();\n      insert = update[key][j];\n\n      if (!Lib.isArrayOrTypedArray(insert)) {\n        throw new Error('attribute: ' + key + ' index: ' + j + ' must be an array');\n      }\n\n      if (!Lib.isArrayOrTypedArray(target)) {\n        throw new Error('cannot extend missing or non-array attribute: ' + key);\n      }\n\n      if (target.constructor !== insert.constructor) {\n        throw new Error('cannot extend array with an array of a different type: ' + key);\n      }\n      /*\n       * maxPoints may be an object map or a scalar. If object select the key:value, else\n       * Use the scalar maxPoints for all key and trace combinations.\n       */\n\n\n      maxp = maxPointsIsObject ? maxPoints[key][j] : maxPoints; // could have chosen null here, -1 just tells us to not take a window\n\n      if (!isNumeric(maxp)) maxp = -1;\n      /*\n       * Wrap the nestedProperty in an object containing required data\n       * for lengthening and windowing this particular trace - key combination.\n       * Flooring maxp mirrors the behaviour of floats in the Array.slice JSnative function.\n       */\n\n      updateProps.push({\n        prop: prop,\n        target: target,\n        insert: insert,\n        maxp: Math.floor(maxp)\n      });\n    }\n  } // all target and insertion data now validated\n\n\n  return updateProps;\n}\n/**\n * A private function to key Extend and Prepend traces DRY\n *\n * @param {Object|HTMLDivElement} gd\n * @param {Object} update\n * @param {Number[]} indices\n * @param {Number||Object} maxPoints\n * @param {Function} updateArray\n * @return {Object}\n */\n\n\nfunction spliceTraces(gd, update, indices, maxPoints, updateArray) {\n  assertExtendTracesArgs(gd, update, indices, maxPoints);\n  var updateProps = getExtendProperties(gd, update, indices, maxPoints);\n  var undoUpdate = {};\n  var undoPoints = {};\n\n  for (var i = 0; i < updateProps.length; i++) {\n    var prop = updateProps[i].prop;\n    var maxp = updateProps[i].maxp; // return new array and remainder\n\n    var out = updateArray(updateProps[i].target, updateProps[i].insert, maxp);\n    prop.set(out[0]); // build the inverse update object for the undo operation\n\n    if (!Array.isArray(undoUpdate[prop.astr])) undoUpdate[prop.astr] = [];\n    undoUpdate[prop.astr].push(out[1]); // build the matching maxPoints undo object containing original trace lengths\n\n    if (!Array.isArray(undoPoints[prop.astr])) undoPoints[prop.astr] = [];\n    undoPoints[prop.astr].push(updateProps[i].target.length);\n  }\n\n  return {\n    update: undoUpdate,\n    maxPoints: undoPoints\n  };\n}\n\nfunction concatTypedArray(arr0, arr1) {\n  var arr2 = new arr0.constructor(arr0.length + arr1.length);\n  arr2.set(arr0);\n  arr2.set(arr1, arr0.length);\n  return arr2;\n}\n/**\n * extend && prepend traces at indices with update arrays, window trace lengths to maxPoints\n *\n * Extend and Prepend have identical APIs. Prepend inserts an array at the head while Extend\n * inserts an array off the tail. Prepend truncates the tail of the array - counting maxPoints\n * from the head, whereas Extend truncates the head of the array, counting backward maxPoints\n * from the tail.\n *\n * If maxPoints is undefined, nonNumeric, negative or greater than extended trace length no\n * truncation / windowing will be performed. If its zero, well the whole trace is truncated.\n *\n * @param {Object|HTMLDivElement} gd The graph div\n * @param {Object} update The key:array map of target attributes to extend\n * @param {Number|Number[]} indices The locations of traces to be extended\n * @param {Number|Object} [maxPoints] Number of points for trace window after lengthening.\n *\n */\n\n\nfunction extendTraces(gd, update, indices, maxPoints) {\n  gd = Lib.getGraphDiv(gd);\n\n  function updateArray(target, insert, maxp) {\n    var newArray, remainder;\n\n    if (Lib.isTypedArray(target)) {\n      if (maxp < 0) {\n        var none = new target.constructor(0);\n        var both = concatTypedArray(target, insert);\n\n        if (maxp < 0) {\n          newArray = both;\n          remainder = none;\n        } else {\n          newArray = none;\n          remainder = both;\n        }\n      } else {\n        newArray = new target.constructor(maxp);\n        remainder = new target.constructor(target.length + insert.length - maxp);\n\n        if (maxp === insert.length) {\n          newArray.set(insert);\n          remainder.set(target);\n        } else if (maxp < insert.length) {\n          var numberOfItemsFromInsert = insert.length - maxp;\n          newArray.set(insert.subarray(numberOfItemsFromInsert));\n          remainder.set(target);\n          remainder.set(insert.subarray(0, numberOfItemsFromInsert), target.length);\n        } else {\n          var numberOfItemsFromTarget = maxp - insert.length;\n          var targetBegin = target.length - numberOfItemsFromTarget;\n          newArray.set(target.subarray(targetBegin));\n          newArray.set(insert, numberOfItemsFromTarget);\n          remainder.set(target.subarray(0, targetBegin));\n        }\n      }\n    } else {\n      newArray = target.concat(insert);\n      remainder = maxp >= 0 && maxp < newArray.length ? newArray.splice(0, newArray.length - maxp) : [];\n    }\n\n    return [newArray, remainder];\n  }\n\n  var undo = spliceTraces(gd, update, indices, maxPoints, updateArray);\n  var promise = exports.redraw(gd);\n  var undoArgs = [gd, undo.update, indices, undo.maxPoints];\n  Queue.add(gd, exports.prependTraces, undoArgs, extendTraces, arguments);\n  return promise;\n}\n\nfunction prependTraces(gd, update, indices, maxPoints) {\n  gd = Lib.getGraphDiv(gd);\n\n  function updateArray(target, insert, maxp) {\n    var newArray, remainder;\n\n    if (Lib.isTypedArray(target)) {\n      if (maxp <= 0) {\n        var none = new target.constructor(0);\n        var both = concatTypedArray(insert, target);\n\n        if (maxp < 0) {\n          newArray = both;\n          remainder = none;\n        } else {\n          newArray = none;\n          remainder = both;\n        }\n      } else {\n        newArray = new target.constructor(maxp);\n        remainder = new target.constructor(target.length + insert.length - maxp);\n\n        if (maxp === insert.length) {\n          newArray.set(insert);\n          remainder.set(target);\n        } else if (maxp < insert.length) {\n          var numberOfItemsFromInsert = insert.length - maxp;\n          newArray.set(insert.subarray(0, numberOfItemsFromInsert));\n          remainder.set(insert.subarray(numberOfItemsFromInsert));\n          remainder.set(target, numberOfItemsFromInsert);\n        } else {\n          var numberOfItemsFromTarget = maxp - insert.length;\n          newArray.set(insert);\n          newArray.set(target.subarray(0, numberOfItemsFromTarget), insert.length);\n          remainder.set(target.subarray(numberOfItemsFromTarget));\n        }\n      }\n    } else {\n      newArray = insert.concat(target);\n      remainder = maxp >= 0 && maxp < newArray.length ? newArray.splice(maxp, newArray.length) : [];\n    }\n\n    return [newArray, remainder];\n  }\n\n  var undo = spliceTraces(gd, update, indices, maxPoints, updateArray);\n  var promise = exports.redraw(gd);\n  var undoArgs = [gd, undo.update, indices, undo.maxPoints];\n  Queue.add(gd, exports.extendTraces, undoArgs, prependTraces, arguments);\n  return promise;\n}\n/**\n * Add data traces to an existing graph div.\n *\n * @param {Object|HTMLDivElement} gd The graph div\n * @param {Object[]} gd.data The array of traces we're adding to\n * @param {Object[]|Object} traces The object or array of objects to add\n * @param {Number[]|Number} [newIndices=[gd.data.length]] Locations to add traces\n *\n */\n\n\nfunction addTraces(gd, traces, newIndices) {\n  gd = Lib.getGraphDiv(gd);\n  var currentIndices = [];\n  var undoFunc = exports.deleteTraces;\n  var redoFunc = addTraces;\n  var undoArgs = [gd, currentIndices];\n  var redoArgs = [gd, traces]; // no newIndices here\n\n  var i;\n  var promise; // all validation is done elsewhere to remove clutter here\n\n  checkAddTracesArgs(gd, traces, newIndices); // make sure traces is an array\n\n  if (!Array.isArray(traces)) {\n    traces = [traces];\n  } // make sure traces do not repeat existing ones\n\n\n  traces = traces.map(function (trace) {\n    return Lib.extendFlat({}, trace);\n  });\n  helpers.cleanData(traces); // add the traces to gd.data (no redrawing yet!)\n\n  for (i = 0; i < traces.length; i++) {\n    gd.data.push(traces[i]);\n  } // to continue, we need to call moveTraces which requires currentIndices\n\n\n  for (i = 0; i < traces.length; i++) {\n    currentIndices.push(-traces.length + i);\n  } // if the user didn't define newIndices, they just want the traces appended\n  // i.e., we can simply redraw and be done\n\n\n  if (typeof newIndices === 'undefined') {\n    promise = exports.redraw(gd);\n    Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n    return promise;\n  } // make sure indices is property defined\n\n\n  if (!Array.isArray(newIndices)) {\n    newIndices = [newIndices];\n  }\n\n  try {\n    // this is redundant, but necessary to not catch later possible errors!\n    checkMoveTracesArgs(gd, currentIndices, newIndices);\n  } catch (error) {\n    // something went wrong, reset gd to be safe and rethrow error\n    gd.data.splice(gd.data.length - traces.length, traces.length);\n    throw error;\n  } // if we're here, the user has defined specific places to place the new traces\n  // this requires some extra work that moveTraces will do\n\n\n  Queue.startSequence(gd);\n  Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n  promise = exports.moveTraces(gd, currentIndices, newIndices);\n  Queue.stopSequence(gd);\n  return promise;\n}\n/**\n * Delete traces at `indices` from gd.data array.\n *\n * @param {Object|HTMLDivElement} gd The graph div\n * @param {Object[]} gd.data The array of traces we're removing from\n * @param {Number|Number[]} indices The indices\n */\n\n\nfunction deleteTraces(gd, indices) {\n  gd = Lib.getGraphDiv(gd);\n  var traces = [];\n  var undoFunc = exports.addTraces;\n  var redoFunc = deleteTraces;\n  var undoArgs = [gd, traces, indices];\n  var redoArgs = [gd, indices];\n  var i;\n  var deletedTrace; // make sure indices are defined\n\n  if (typeof indices === 'undefined') {\n    throw new Error('indices must be an integer or array of integers.');\n  } else if (!Array.isArray(indices)) {\n    indices = [indices];\n  }\n\n  assertIndexArray(gd, indices, 'indices'); // convert negative indices to positive indices\n\n  indices = positivifyIndices(indices, gd.data.length - 1); // we want descending here so that splicing later doesn't affect indexing\n\n  indices.sort(Lib.sorterDes);\n\n  for (i = 0; i < indices.length; i += 1) {\n    deletedTrace = gd.data.splice(indices[i], 1)[0];\n    traces.push(deletedTrace);\n  }\n\n  var promise = exports.redraw(gd);\n  Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n  return promise;\n}\n/**\n * Move traces at currentIndices array to locations in newIndices array.\n *\n * If newIndices is omitted, currentIndices will be moved to the end. E.g.,\n * these are equivalent:\n *\n * Plotly.moveTraces(gd, [1, 2, 3], [-3, -2, -1])\n * Plotly.moveTraces(gd, [1, 2, 3])\n *\n * @param {Object|HTMLDivElement} gd The graph div\n * @param {Object[]} gd.data The array of traces we're removing from\n * @param {Number|Number[]} currentIndices The locations of traces to be moved\n * @param {Number|Number[]} [newIndices] The locations to move traces to\n *\n * Example calls:\n *\n *      // move trace i to location x\n *      Plotly.moveTraces(gd, i, x)\n *\n *      // move trace i to end of array\n *      Plotly.moveTraces(gd, i)\n *\n *      // move traces i, j, k to end of array (i != j != k)\n *      Plotly.moveTraces(gd, [i, j, k])\n *\n *      // move traces [i, j, k] to [x, y, z] (i != j != k) (x != y != z)\n *      Plotly.moveTraces(gd, [i, j, k], [x, y, z])\n *\n *      // reorder all traces (assume there are 5--a, b, c, d, e)\n *      Plotly.moveTraces(gd, [b, d, e, a, c])  // same as 'move to end'\n */\n\n\nfunction moveTraces(gd, currentIndices, newIndices) {\n  gd = Lib.getGraphDiv(gd);\n  var newData = [];\n  var movingTraceMap = [];\n  var undoFunc = moveTraces;\n  var redoFunc = moveTraces;\n  var undoArgs = [gd, newIndices, currentIndices];\n  var redoArgs = [gd, currentIndices, newIndices];\n  var i; // to reduce complexity here, check args elsewhere\n  // this throws errors where appropriate\n\n  checkMoveTracesArgs(gd, currentIndices, newIndices); // make sure currentIndices is an array\n\n  currentIndices = Array.isArray(currentIndices) ? currentIndices : [currentIndices]; // if undefined, define newIndices to point to the end of gd.data array\n\n  if (typeof newIndices === 'undefined') {\n    newIndices = [];\n\n    for (i = 0; i < currentIndices.length; i++) {\n      newIndices.push(-currentIndices.length + i);\n    }\n  } // make sure newIndices is an array if it's user-defined\n\n\n  newIndices = Array.isArray(newIndices) ? newIndices : [newIndices]; // convert negative indices to positive indices (they're the same length)\n\n  currentIndices = positivifyIndices(currentIndices, gd.data.length - 1);\n  newIndices = positivifyIndices(newIndices, gd.data.length - 1); // at this point, we've coerced the index arrays into predictable forms\n  // get the traces that aren't being moved around\n\n  for (i = 0; i < gd.data.length; i++) {\n    // if index isn't in currentIndices, include it in ignored!\n    if (currentIndices.indexOf(i) === -1) {\n      newData.push(gd.data[i]);\n    }\n  } // get a mapping of indices to moving traces\n\n\n  for (i = 0; i < currentIndices.length; i++) {\n    movingTraceMap.push({\n      newIndex: newIndices[i],\n      trace: gd.data[currentIndices[i]]\n    });\n  } // reorder this mapping by newIndex, ascending\n\n\n  movingTraceMap.sort(function (a, b) {\n    return a.newIndex - b.newIndex;\n  }); // now, add the moving traces back in, in order!\n\n  for (i = 0; i < movingTraceMap.length; i += 1) {\n    newData.splice(movingTraceMap[i].newIndex, 0, movingTraceMap[i].trace);\n  }\n\n  gd.data = newData;\n  var promise = exports.redraw(gd);\n  Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n  return promise;\n}\n/**\n * restyle: update trace attributes of an existing plot\n *\n * Can be called two ways.\n *\n * Signature 1:\n * @param {String | HTMLDivElement} gd\n *  the id or DOM element of the graph container div\n * @param {String} astr\n *  attribute string (like `'marker.symbol'`) to update\n * @param {*} val\n *  value to give this attribute\n * @param {Number[] | Number} [traces]\n *  integer or array of integers for the traces to alter (all if omitted)\n *\n * Signature 2:\n * @param {String | HTMLDivElement} gd\n *  (as in signature 1)\n * @param {Object} aobj\n *  attribute object `{astr1: val1, astr2: val2 ...}`\n *  allows setting multiple attributes simultaneously\n * @param {Number[] | Number} [traces]\n *  (as in signature 1)\n *\n * `val` (or `val1`, `val2` ... in the object form) can be an array,\n * to apply different values to each trace.\n *\n * If the array is too short, it will wrap around (useful for\n * style files that want to specify cyclical default values).\n */\n\n\nfunction restyle(gd, astr, val, _traces) {\n  gd = Lib.getGraphDiv(gd);\n  helpers.clearPromiseQueue(gd);\n  var aobj = {};\n  if (typeof astr === 'string') aobj[astr] = val;else if (Lib.isPlainObject(astr)) {\n    // the 3-arg form\n    aobj = Lib.extendFlat({}, astr);\n    if (_traces === undefined) _traces = val;\n  } else {\n    Lib.warn('Restyle fail.', astr, val, _traces);\n    return Promise.reject();\n  }\n  if (Object.keys(aobj).length) gd.changed = true;\n  var traces = helpers.coerceTraceIndices(gd, _traces);\n\n  var specs = _restyle(gd, aobj, traces);\n\n  var flags = specs.flags; // clear calcdata and/or axis types if required so they get regenerated\n\n  if (flags.calc) gd.calcdata = undefined;\n  if (flags.clearAxisTypes) helpers.clearAxisTypes(gd, traces, {}); // fill in redraw sequence\n\n  var seq = [];\n\n  if (flags.fullReplot) {\n    seq.push(exports.plot);\n  } else {\n    seq.push(Plots.previousPromises); // maybe only call Plots.supplyDataDefaults in the splom case,\n    // to skip over long and slow axes defaults\n\n    Plots.supplyDefaults(gd);\n\n    if (flags.markerSize) {\n      Plots.doCalcdata(gd);\n      addAxRangeSequence(seq); // TODO\n      // if all axes have autorange:false, then\n      // proceed to subroutines.doTraceStyle(),\n      // otherwise we must go through addAxRangeSequence,\n      // which in general must redraws 'all' axes\n    }\n\n    if (flags.style) seq.push(subroutines.doTraceStyle);\n    if (flags.colorbars) seq.push(subroutines.doColorBars);\n    seq.push(emitAfterPlot);\n  }\n\n  seq.push(Plots.rehover, Plots.redrag);\n  Queue.add(gd, restyle, [gd, specs.undoit, specs.traces], restyle, [gd, specs.redoit, specs.traces]);\n  var plotDone = Lib.syncOrAsync(seq, gd);\n  if (!plotDone || !plotDone.then) plotDone = Promise.resolve();\n  return plotDone.then(function () {\n    gd.emit('plotly_restyle', specs.eventData);\n    return gd;\n  });\n} // for undo: undefined initial vals must be turned into nulls\n// so that we unset rather than ignore them\n\n\nfunction undefinedToNull(val) {\n  if (val === undefined) return null;\n  return val;\n}\n/**\n * Factory function to wrap nestedProperty with GUI edits if necessary\n * with GUI edits we add an optional prefix to the nestedProperty constructor\n * to prepend to the attribute string in the preGUI store.\n */\n\n\nfunction makeNP(preGUI, guiEditFlag) {\n  if (!guiEditFlag) return nestedProperty;\n  return function (container, attr, prefix) {\n    var np = nestedProperty(container, attr);\n    var npSet = np.set;\n\n    np.set = function (val) {\n      var fullAttr = (prefix || '') + attr;\n      storeCurrent(fullAttr, np.get(), val, preGUI);\n      npSet(val);\n    };\n\n    return np;\n  };\n}\n\nfunction storeCurrent(attr, val, newVal, preGUI) {\n  if (Array.isArray(val) || Array.isArray(newVal)) {\n    var arrayVal = Array.isArray(val) ? val : [];\n    var arrayNew = Array.isArray(newVal) ? newVal : [];\n    var maxLen = Math.max(arrayVal.length, arrayNew.length);\n\n    for (var i = 0; i < maxLen; i++) {\n      storeCurrent(attr + '[' + i + ']', arrayVal[i], arrayNew[i], preGUI);\n    }\n  } else if (Lib.isPlainObject(val) || Lib.isPlainObject(newVal)) {\n    var objVal = Lib.isPlainObject(val) ? val : {};\n    var objNew = Lib.isPlainObject(newVal) ? newVal : {};\n    var objBoth = Lib.extendFlat({}, objVal, objNew);\n\n    for (var key in objBoth) {\n      storeCurrent(attr + '.' + key, objVal[key], objNew[key], preGUI);\n    }\n  } else if (preGUI[attr] === undefined) {\n    preGUI[attr] = undefinedToNull(val);\n  }\n}\n/**\n * storeDirectGUIEdit: for routines that skip restyle/relayout and mock it\n * by emitting a plotly_restyle or plotly_relayout event, this routine\n * keeps track of the initial state in _preGUI for use by uirevision\n * Does *not* apply these changes to data/layout - that's the responsibility\n * of the calling routine.\n *\n * @param {object} container: the input attributes container (eg `layout` or a `trace`)\n * @param {object} preGUI: where original values should be stored, either\n *     `layout._preGUI` or `layout._tracePreGUI[uid]`\n * @param {object} edits: the {attr: val} object as normally passed to `relayout` etc\n */\n\n\nfunction _storeDirectGUIEdit(container, preGUI, edits) {\n  for (var attr in edits) {\n    var np = nestedProperty(container, attr);\n    storeCurrent(attr, np.get(), edits[attr], preGUI);\n  }\n}\n\nfunction _restyle(gd, aobj, traces) {\n  var fullLayout = gd._fullLayout;\n  var fullData = gd._fullData;\n  var data = gd.data;\n  var guiEditFlag = fullLayout._guiEditing;\n  var layoutNP = makeNP(fullLayout._preGUI, guiEditFlag);\n  var eventData = Lib.extendDeepAll({}, aobj);\n  var i;\n  cleanDeprecatedAttributeKeys(aobj); // initialize flags\n\n  var flags = editTypes.traceFlags(); // copies of the change (and previous values of anything affected)\n  // for the undo / redo queue\n\n  var redoit = {};\n  var undoit = {};\n  var axlist; // make a new empty vals array for undoit\n\n  function a0() {\n    return traces.map(function () {\n      return undefined;\n    });\n  } // for autoranging multiple axes\n\n\n  function addToAxlist(axid) {\n    var axName = Axes.id2name(axid);\n    if (axlist.indexOf(axName) === -1) axlist.push(axName);\n  }\n\n  function autorangeAttr(axName) {\n    return 'LAYOUT' + axName + '.autorange';\n  }\n\n  function rangeAttr(axName) {\n    return 'LAYOUT' + axName + '.range';\n  }\n\n  function getFullTrace(traceIndex) {\n    // usually fullData maps 1:1 onto data, but with groupby transforms\n    // the fullData index can be greater. Take the *first* matching trace.\n    for (var j = traceIndex; j < fullData.length; j++) {\n      if (fullData[j]._input === data[traceIndex]) return fullData[j];\n    } // should never get here - and if we *do* it should cause an error\n    // later on undefined fullTrace is passed to nestedProperty.\n\n  } // for attrs that interact (like scales & autoscales), save the\n  // old vals before making the change\n  // val=undefined will not set a value, just record what the value was.\n  // val=null will delete the attribute\n  // attr can be an array to set several at once (all to the same val)\n\n\n  function doextra(attr, val, i) {\n    if (Array.isArray(attr)) {\n      attr.forEach(function (a) {\n        doextra(a, val, i);\n      });\n      return;\n    } // quit if explicitly setting this elsewhere\n\n\n    if (attr in aobj || helpers.hasParent(aobj, attr)) return;\n    var extraparam;\n\n    if (attr.substr(0, 6) === 'LAYOUT') {\n      extraparam = layoutNP(gd.layout, attr.replace('LAYOUT', ''));\n    } else {\n      var tracei = traces[i];\n\n      var preGUI = fullLayout._tracePreGUI[getFullTrace(tracei)._fullInput.uid];\n\n      extraparam = makeNP(preGUI, guiEditFlag)(data[tracei], attr);\n    }\n\n    if (!(attr in undoit)) {\n      undoit[attr] = a0();\n    }\n\n    if (undoit[attr][i] === undefined) {\n      undoit[attr][i] = undefinedToNull(extraparam.get());\n    }\n\n    if (val !== undefined) {\n      extraparam.set(val);\n    }\n  }\n\n  function allBins(binAttr) {\n    return function (j) {\n      return fullData[j][binAttr];\n    };\n  }\n\n  function arrayBins(binAttr) {\n    return function (vij, j) {\n      return vij === false ? fullData[traces[j]][binAttr] : null;\n    };\n  } // now make the changes to gd.data (and occasionally gd.layout)\n  // and figure out what kind of graphics update we need to do\n\n\n  for (var ai in aobj) {\n    if (helpers.hasParent(aobj, ai)) {\n      throw new Error('cannot set ' + ai + ' and a parent attribute simultaneously');\n    }\n\n    var vi = aobj[ai];\n    var cont;\n    var contFull;\n    var param;\n    var oldVal;\n    var newVal;\n    var valObject; // Backward compatibility shim for turning histogram autobin on,\n    // or freezing previous autobinned values.\n    // Replace obsolete `autobin(x|y): true` with `(x|y)bins: null`\n    // and `autobin(x|y): false` with the `(x|y)bins` in `fullData`\n\n    if (ai === 'autobinx' || ai === 'autobiny') {\n      ai = ai.charAt(ai.length - 1) + 'bins';\n      if (Array.isArray(vi)) vi = vi.map(arrayBins(ai));else if (vi === false) vi = traces.map(allBins(ai));else vi = null;\n    }\n\n    redoit[ai] = vi;\n\n    if (ai.substr(0, 6) === 'LAYOUT') {\n      param = layoutNP(gd.layout, ai.replace('LAYOUT', ''));\n      undoit[ai] = [undefinedToNull(param.get())]; // since we're allowing val to be an array, allow it here too,\n      // even though that's meaningless\n\n      param.set(Array.isArray(vi) ? vi[0] : vi); // ironically, the layout attrs in restyle only require replot,\n      // not relayout\n\n      flags.calc = true;\n      continue;\n    } // set attribute in gd.data\n\n\n    undoit[ai] = a0();\n\n    for (i = 0; i < traces.length; i++) {\n      cont = data[traces[i]];\n      contFull = getFullTrace(traces[i]);\n      var preGUI = fullLayout._tracePreGUI[contFull._fullInput.uid];\n      param = makeNP(preGUI, guiEditFlag)(cont, ai);\n      oldVal = param.get();\n      newVal = Array.isArray(vi) ? vi[i % vi.length] : vi;\n      if (newVal === undefined) continue;\n      var finalPart = param.parts[param.parts.length - 1];\n      var prefix = ai.substr(0, ai.length - finalPart.length - 1);\n      var prefixDot = prefix ? prefix + '.' : '';\n      var innerContFull = prefix ? nestedProperty(contFull, prefix).get() : contFull;\n      valObject = PlotSchema.getTraceValObject(contFull, param.parts);\n\n      if (valObject && valObject.impliedEdits && newVal !== null) {\n        for (var impliedKey in valObject.impliedEdits) {\n          doextra(Lib.relativeAttr(ai, impliedKey), valObject.impliedEdits[impliedKey], i);\n        }\n      } else if ((finalPart === 'thicknessmode' || finalPart === 'lenmode') && oldVal !== newVal && (newVal === 'fraction' || newVal === 'pixels') && innerContFull) {\n        // changing colorbar size modes,\n        // make the resulting size not change\n        // note that colorbar fractional sizing is based on the\n        // original plot size, before anything (like a colorbar)\n        // increases the margins\n        var gs = fullLayout._size;\n        var orient = innerContFull.orient;\n        var topOrBottom = orient === 'top' || orient === 'bottom';\n\n        if (finalPart === 'thicknessmode') {\n          var thicknorm = topOrBottom ? gs.h : gs.w;\n          doextra(prefixDot + 'thickness', innerContFull.thickness * (newVal === 'fraction' ? 1 / thicknorm : thicknorm), i);\n        } else {\n          var lennorm = topOrBottom ? gs.w : gs.h;\n          doextra(prefixDot + 'len', innerContFull.len * (newVal === 'fraction' ? 1 / lennorm : lennorm), i);\n        }\n      } else if (ai === 'type' && (newVal === 'pie' !== (oldVal === 'pie') || newVal === 'funnelarea' !== (oldVal === 'funnelarea'))) {\n        var labelsTo = 'x';\n        var valuesTo = 'y';\n\n        if ((newVal === 'bar' || oldVal === 'bar') && cont.orientation === 'h') {\n          labelsTo = 'y';\n          valuesTo = 'x';\n        }\n\n        Lib.swapAttrs(cont, ['?', '?src'], 'labels', labelsTo);\n        Lib.swapAttrs(cont, ['d?', '?0'], 'label', labelsTo);\n        Lib.swapAttrs(cont, ['?', '?src'], 'values', valuesTo);\n\n        if (oldVal === 'pie' || oldVal === 'funnelarea') {\n          nestedProperty(cont, 'marker.color').set(nestedProperty(cont, 'marker.colors').get()); // super kludgy - but if all pies are gone we won't remove them otherwise\n\n          fullLayout._pielayer.selectAll('g.trace').remove();\n        } else if (Registry.traceIs(cont, 'cartesian')) {\n          nestedProperty(cont, 'marker.colors').set(nestedProperty(cont, 'marker.color').get());\n        }\n      }\n\n      undoit[ai][i] = undefinedToNull(oldVal); // set the new value - if val is an array, it's one el per trace\n      // first check for attributes that get more complex alterations\n\n      var swapAttrs = ['swapxy', 'swapxyaxes', 'orientation', 'orientationaxes'];\n\n      if (swapAttrs.indexOf(ai) !== -1) {\n        // setting an orientation: make sure it's changing\n        // before we swap everything else\n        if (ai === 'orientation') {\n          param.set(newVal); // obnoxious that we need this level of coupling... but in order to\n          // properly handle setting orientation to `null` we need to mimic\n          // the logic inside Bars.supplyDefaults for default orientation\n\n          var defaultOrientation = cont.x && !cont.y ? 'h' : 'v';\n\n          if ((param.get() || defaultOrientation) === contFull.orientation) {\n            continue;\n          }\n        } else if (ai === 'orientationaxes') {\n          // orientationaxes has no value,\n          // it flips everything and the axes\n          cont.orientation = {\n            v: 'h',\n            h: 'v'\n          }[contFull.orientation];\n        }\n\n        helpers.swapXYData(cont);\n        flags.calc = flags.clearAxisTypes = true;\n      } else if (Plots.dataArrayContainers.indexOf(param.parts[0]) !== -1) {\n        // TODO: use manageArrays.applyContainerArrayChanges here too\n        helpers.manageArrayContainers(param, newVal, undoit);\n        flags.calc = true;\n      } else {\n        if (valObject) {\n          // must redo calcdata when restyling array values of arrayOk attributes\n          // ... but no need to this for regl-based traces\n          if (valObject.arrayOk && !Registry.traceIs(contFull, 'regl') && (Lib.isArrayOrTypedArray(newVal) || Lib.isArrayOrTypedArray(oldVal))) {\n            flags.calc = true;\n          } else editTypes.update(flags, valObject);\n        } else {\n          /*\n           * if we couldn't find valObject,  assume a full recalc.\n           * This can happen if you're changing type and making\n           * some other edits too, so the modules we're\n           * looking at don't have these attributes in them.\n           */\n          flags.calc = true;\n        } // all the other ones, just modify that one attribute\n\n\n        param.set(newVal);\n      }\n    } // swap the data attributes of the relevant x and y axes?\n\n\n    if (['swapxyaxes', 'orientationaxes'].indexOf(ai) !== -1) {\n      Axes.swap(gd, traces);\n    } // swap hovermode if set to \"compare x/y data\"\n\n\n    if (ai === 'orientationaxes') {\n      var hovermode = nestedProperty(gd.layout, 'hovermode');\n\n      if (hovermode.get() === 'x') {\n        hovermode.set('y');\n      } else if (hovermode.get() === 'y') {\n        hovermode.set('x');\n      } else if (hovermode.get() === 'x unified') {\n        hovermode.set('y unified');\n      } else if (hovermode.get() === 'y unified') {\n        hovermode.set('x unified');\n      }\n    } // Major enough changes deserve autoscale and\n    // non-reversed axes so people don't get confused\n    //\n    // Note: autobin (or its new analog bin clearing) is not included here\n    // since we're not pushing bins back to gd.data, so if we have bin\n    // info it was explicitly provided by the user.\n\n\n    if (['orientation', 'type'].indexOf(ai) !== -1) {\n      axlist = [];\n\n      for (i = 0; i < traces.length; i++) {\n        var trace = data[traces[i]];\n\n        if (Registry.traceIs(trace, 'cartesian')) {\n          addToAxlist(trace.xaxis || 'x');\n          addToAxlist(trace.yaxis || 'y');\n        }\n      }\n\n      doextra(axlist.map(autorangeAttr), true, 0);\n      doextra(axlist.map(rangeAttr), [0, 1], 0);\n    }\n  }\n\n  if (flags.calc || flags.plot) {\n    flags.fullReplot = true;\n  }\n\n  return {\n    flags: flags,\n    undoit: undoit,\n    redoit: redoit,\n    traces: traces,\n    eventData: Lib.extendDeepNoArrays([], [eventData, traces])\n  };\n}\n/**\n * Converts deprecated attribute keys to\n * the current API to ensure backwards compatibility.\n *\n * This is needed for the update mechanism to determine which\n * subroutines to run based on the actual attribute\n * definitions (that don't include the deprecated ones).\n *\n * E.g. Maps {'xaxis.title': 'A chart'} to {'xaxis.title.text': 'A chart'}\n * and {titlefont: {...}} to {'title.font': {...}}.\n *\n * @param aobj\n */\n\n\nfunction cleanDeprecatedAttributeKeys(aobj) {\n  var oldAxisTitleRegex = Lib.counterRegex('axis', '\\.title', false, false);\n  var colorbarRegex = /colorbar\\.title$/;\n  var keys = Object.keys(aobj);\n  var i, key, value;\n\n  for (i = 0; i < keys.length; i++) {\n    key = keys[i];\n    value = aobj[key];\n\n    if ((key === 'title' || oldAxisTitleRegex.test(key) || colorbarRegex.test(key)) && (typeof value === 'string' || typeof value === 'number')) {\n      replace(key, key.replace('title', 'title.text'));\n    } else if (key.indexOf('titlefont') > -1) {\n      replace(key, key.replace('titlefont', 'title.font'));\n    } else if (key.indexOf('titleposition') > -1) {\n      replace(key, key.replace('titleposition', 'title.position'));\n    } else if (key.indexOf('titleside') > -1) {\n      replace(key, key.replace('titleside', 'title.side'));\n    } else if (key.indexOf('titleoffset') > -1) {\n      replace(key, key.replace('titleoffset', 'title.offset'));\n    }\n  }\n\n  function replace(oldAttrStr, newAttrStr) {\n    aobj[newAttrStr] = aobj[oldAttrStr];\n    delete aobj[oldAttrStr];\n  }\n}\n/**\n * relayout: update layout attributes of an existing plot\n *\n * Can be called two ways:\n *\n * Signature 1:\n * @param {String | HTMLDivElement} gd\n *  the id or dom element of the graph container div\n * @param {String} astr\n *  attribute string (like `'xaxis.range[0]'`) to update\n * @param {*} val\n *  value to give this attribute\n *\n * Signature 2:\n * @param {String | HTMLDivElement} gd\n *  (as in signature 1)\n * @param {Object} aobj\n *  attribute object `{astr1: val1, astr2: val2 ...}`\n *  allows setting multiple attributes simultaneously\n */\n\n\nfunction relayout(gd, astr, val) {\n  gd = Lib.getGraphDiv(gd);\n  helpers.clearPromiseQueue(gd);\n\n  if (gd.framework && gd.framework.isPolar) {\n    return Promise.resolve(gd);\n  }\n\n  var aobj = {};\n\n  if (typeof astr === 'string') {\n    aobj[astr] = val;\n  } else if (Lib.isPlainObject(astr)) {\n    aobj = Lib.extendFlat({}, astr);\n  } else {\n    Lib.warn('Relayout fail.', astr, val);\n    return Promise.reject();\n  }\n\n  if (Object.keys(aobj).length) gd.changed = true;\n\n  var specs = _relayout(gd, aobj);\n\n  var flags = specs.flags; // clear calcdata if required\n\n  if (flags.calc) gd.calcdata = undefined; // fill in redraw sequence\n  // even if we don't have anything left in aobj,\n  // something may have happened within relayout that we\n  // need to wait for\n\n  var seq = [Plots.previousPromises];\n\n  if (flags.layoutReplot) {\n    seq.push(subroutines.layoutReplot);\n  } else if (Object.keys(aobj).length) {\n    axRangeSupplyDefaultsByPass(gd, flags, specs) || Plots.supplyDefaults(gd);\n    if (flags.legend) seq.push(subroutines.doLegend);\n    if (flags.layoutstyle) seq.push(subroutines.layoutStyles);\n    if (flags.axrange) addAxRangeSequence(seq, specs.rangesAltered);\n    if (flags.ticks) seq.push(subroutines.doTicksRelayout);\n    if (flags.modebar) seq.push(subroutines.doModeBar);\n    if (flags.camera) seq.push(subroutines.doCamera);\n    if (flags.colorbars) seq.push(subroutines.doColorBars);\n    seq.push(emitAfterPlot);\n  }\n\n  seq.push(Plots.rehover, Plots.redrag);\n  Queue.add(gd, relayout, [gd, specs.undoit], relayout, [gd, specs.redoit]);\n  var plotDone = Lib.syncOrAsync(seq, gd);\n  if (!plotDone || !plotDone.then) plotDone = Promise.resolve(gd);\n  return plotDone.then(function () {\n    gd.emit('plotly_relayout', specs.eventData);\n    return gd;\n  });\n} // Optimization mostly for large splom traces where\n// Plots.supplyDefaults can take > 100ms\n\n\nfunction axRangeSupplyDefaultsByPass(gd, flags, specs) {\n  var fullLayout = gd._fullLayout;\n  if (!flags.axrange) return false;\n\n  for (var k in flags) {\n    if (k !== 'axrange' && flags[k]) return false;\n  }\n\n  for (var axId in specs.rangesAltered) {\n    var axName = Axes.id2name(axId);\n    var axIn = gd.layout[axName];\n    var axOut = fullLayout[axName];\n    axOut.autorange = axIn.autorange;\n    axOut.range = axIn.range.slice();\n    axOut.cleanRange();\n\n    if (axOut._matchGroup) {\n      for (var axId2 in axOut._matchGroup) {\n        if (axId2 !== axId) {\n          var ax2 = fullLayout[Axes.id2name(axId2)];\n          ax2.autorange = axOut.autorange;\n          ax2.range = axOut.range.slice();\n          ax2._input.range = axOut.range.slice();\n        }\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction addAxRangeSequence(seq, rangesAltered) {\n  // N.B. leave as sequence of subroutines (for now) instead of\n  // subroutine of its own so that finalDraw always gets\n  // executed after drawData\n  var drawAxes = rangesAltered ? function (gd) {\n    var axIds = [];\n    var skipTitle = true;\n\n    for (var id in rangesAltered) {\n      var ax = Axes.getFromId(gd, id);\n      axIds.push(id);\n\n      if (ax._matchGroup) {\n        for (var id2 in ax._matchGroup) {\n          if (!rangesAltered[id2]) {\n            axIds.push(id2);\n          }\n        }\n      }\n\n      if (ax.automargin) skipTitle = false;\n    }\n\n    return Axes.draw(gd, axIds, {\n      skipTitle: skipTitle\n    });\n  } : function (gd) {\n    return Axes.draw(gd, 'redraw');\n  };\n  seq.push(clearSelect, subroutines.doAutoRangeAndConstraints, drawAxes, subroutines.drawData, subroutines.finalDraw);\n}\n\nvar AX_RANGE_RE = /^[xyz]axis[0-9]*\\.range(\\[[0|1]\\])?$/;\nvar AX_AUTORANGE_RE = /^[xyz]axis[0-9]*\\.autorange$/;\nvar AX_DOMAIN_RE = /^[xyz]axis[0-9]*\\.domain(\\[[0|1]\\])?$/;\n\nfunction _relayout(gd, aobj) {\n  var layout = gd.layout;\n  var fullLayout = gd._fullLayout;\n  var guiEditFlag = fullLayout._guiEditing;\n  var layoutNP = makeNP(fullLayout._preGUI, guiEditFlag);\n  var keys = Object.keys(aobj);\n  var axes = Axes.list(gd);\n  var eventData = Lib.extendDeepAll({}, aobj);\n  var arrayEdits = {};\n  var arrayStr, i, j;\n  cleanDeprecatedAttributeKeys(aobj);\n  keys = Object.keys(aobj); // look for 'allaxes', split out into all axes\n  // in case of 3D the axis are nested within a scene which is held in _id\n\n  for (i = 0; i < keys.length; i++) {\n    if (keys[i].indexOf('allaxes') === 0) {\n      for (j = 0; j < axes.length; j++) {\n        var scene = axes[j]._id.substr(1);\n\n        var axisAttr = scene.indexOf('scene') !== -1 ? scene + '.' : '';\n        var newkey = keys[i].replace('allaxes', axisAttr + axes[j]._name);\n        if (!aobj[newkey]) aobj[newkey] = aobj[keys[i]];\n      }\n\n      delete aobj[keys[i]];\n    }\n  } // initialize flags\n\n\n  var flags = editTypes.layoutFlags(); // copies of the change (and previous values of anything affected)\n  // for the undo / redo queue\n\n  var redoit = {};\n  var undoit = {}; // for attrs that interact (like scales & autoscales), save the\n  // old vals before making the change\n  // val=undefined will not set a value, just record what the value was.\n  // attr can be an array to set several at once (all to the same val)\n\n  function doextra(attr, val) {\n    if (Array.isArray(attr)) {\n      attr.forEach(function (a) {\n        doextra(a, val);\n      });\n      return;\n    } // if we have another value for this attribute (explicitly or\n    // via a parent) do not override with this auto-generated extra\n\n\n    if (attr in aobj || helpers.hasParent(aobj, attr)) return;\n    var p = layoutNP(layout, attr);\n\n    if (!(attr in undoit)) {\n      undoit[attr] = undefinedToNull(p.get());\n    }\n\n    if (val !== undefined) p.set(val);\n  } // for constraint enforcement: keep track of all axes (as {id: name})\n  // we're editing the (auto)range of, so we can tell the others constrained\n  // to scale with them that it's OK for them to shrink\n\n\n  var rangesAltered = {};\n  var axId;\n\n  function recordAlteredAxis(pleafPlus) {\n    var axId = Axes.name2id(pleafPlus.split('.')[0]);\n    rangesAltered[axId] = 1;\n    return axId;\n  } // alter gd.layout\n\n\n  for (var ai in aobj) {\n    if (helpers.hasParent(aobj, ai)) {\n      throw new Error('cannot set ' + ai + ' and a parent attribute simultaneously');\n    }\n\n    var p = layoutNP(layout, ai);\n    var vi = aobj[ai];\n    var plen = p.parts.length; // p.parts may end with an index integer if the property is an array\n\n    var pend = plen - 1;\n\n    while (pend > 0 && typeof p.parts[pend] !== 'string') {\n      pend--;\n    } // last property in chain (leaf node)\n\n\n    var pleaf = p.parts[pend]; // leaf plus immediate parent\n\n    var pleafPlus = p.parts[pend - 1] + '.' + pleaf; // trunk nodes (everything except the leaf)\n\n    var ptrunk = p.parts.slice(0, pend).join('.');\n    var parentIn = nestedProperty(gd.layout, ptrunk).get();\n    var parentFull = nestedProperty(fullLayout, ptrunk).get();\n    var vOld = p.get();\n    if (vi === undefined) continue;\n    redoit[ai] = vi; // axis reverse is special - it is its own inverse\n    // op and has no flag.\n\n    undoit[ai] = pleaf === 'reverse' ? vi : undefinedToNull(vOld);\n    var valObject = PlotSchema.getLayoutValObject(fullLayout, p.parts);\n\n    if (valObject && valObject.impliedEdits && vi !== null) {\n      for (var impliedKey in valObject.impliedEdits) {\n        doextra(Lib.relativeAttr(ai, impliedKey), valObject.impliedEdits[impliedKey]);\n      }\n    } // Setting width or height to null must reset the graph's width / height\n    // back to its initial value as computed during the first pass in Plots.plotAutoSize.\n    //\n    // To do so, we must manually set them back here using the _initialAutoSize cache.\n    // can't use impliedEdits for this because behavior depends on vi\n\n\n    if (['width', 'height'].indexOf(ai) !== -1) {\n      if (vi) {\n        doextra('autosize', null); // currently we don't support autosize one dim only - so\n        // explicitly set the other one. Note that doextra will\n        // ignore this if the same relayout call also provides oppositeAttr\n\n        var oppositeAttr = ai === 'height' ? 'width' : 'height';\n        doextra(oppositeAttr, fullLayout[oppositeAttr]);\n      } else {\n        fullLayout[ai] = gd._initialAutoSize[ai];\n      }\n    } else if (ai === 'autosize') {\n      // depends on vi here too, so again can't use impliedEdits\n      doextra('width', vi ? null : fullLayout.width);\n      doextra('height', vi ? null : fullLayout.height);\n    } else if (pleafPlus.match(AX_RANGE_RE)) {\n      // check autorange vs range\n      recordAlteredAxis(pleafPlus);\n      nestedProperty(fullLayout, ptrunk + '._inputRange').set(null);\n    } else if (pleafPlus.match(AX_AUTORANGE_RE)) {\n      recordAlteredAxis(pleafPlus);\n      nestedProperty(fullLayout, ptrunk + '._inputRange').set(null);\n      var axFull = nestedProperty(fullLayout, ptrunk).get();\n\n      if (axFull._inputDomain) {\n        // if we're autoranging and this axis has a constrained domain,\n        // reset it so we don't get locked into a shrunken size\n        axFull._input.domain = axFull._inputDomain.slice();\n      }\n    } else if (pleafPlus.match(AX_DOMAIN_RE)) {\n      nestedProperty(fullLayout, ptrunk + '._inputDomain').set(null);\n    } // toggling axis type between log and linear: we need to convert\n    // positions for components that are still using linearized values,\n    // not data values like newer components.\n    // previously we did this for log <-> not-log, but now only do it\n    // for log <-> linear\n\n\n    if (pleaf === 'type') {\n      var ax = parentIn;\n      var toLog = parentFull.type === 'linear' && vi === 'log';\n      var fromLog = parentFull.type === 'log' && vi === 'linear';\n\n      if (toLog || fromLog) {\n        if (!ax || !ax.range) {\n          // 2D never gets here, but 3D does\n          // I don't think this is needed, but left here in case there\n          // are edge cases I'm not thinking of.\n          doextra(ptrunk + '.autorange', true);\n        } else if (!parentFull.autorange) {\n          // toggling log without autorange: need to also recalculate ranges\n          // because log axes use linearized values for range endpoints\n          var r0 = ax.range[0];\n          var r1 = ax.range[1];\n\n          if (toLog) {\n            // if both limits are negative, autorange\n            if (r0 <= 0 && r1 <= 0) {\n              doextra(ptrunk + '.autorange', true);\n            } // if one is negative, set it 6 orders below the other.\n\n\n            if (r0 <= 0) r0 = r1 / 1e6;else if (r1 <= 0) r1 = r0 / 1e6; // now set the range values as appropriate\n\n            doextra(ptrunk + '.range[0]', Math.log(r0) / Math.LN10);\n            doextra(ptrunk + '.range[1]', Math.log(r1) / Math.LN10);\n          } else {\n            doextra(ptrunk + '.range[0]', Math.pow(10, r0));\n            doextra(ptrunk + '.range[1]', Math.pow(10, r1));\n          }\n        } else if (toLog) {\n          // just make sure the range is positive and in the right\n          // order, it'll get recalculated later\n          ax.range = ax.range[1] > ax.range[0] ? [1, 2] : [2, 1];\n        } // clear polar view initial stash for radial range so that\n        // value get recomputed in correct units\n\n\n        if (Array.isArray(fullLayout._subplots.polar) && fullLayout._subplots.polar.length && fullLayout[p.parts[0]] && p.parts[1] === 'radialaxis') {\n          delete fullLayout[p.parts[0]]._subplot.viewInitial['radialaxis.range'];\n        } // Annotations and images also need to convert to/from linearized coords\n        // Shapes do not need this :)\n\n\n        Registry.getComponentMethod('annotations', 'convertCoords')(gd, parentFull, vi, doextra);\n        Registry.getComponentMethod('images', 'convertCoords')(gd, parentFull, vi, doextra);\n      } else {\n        // any other type changes: the range from the previous type\n        // will not make sense, so autorange it.\n        doextra(ptrunk + '.autorange', true);\n        doextra(ptrunk + '.range', null);\n      }\n\n      nestedProperty(fullLayout, ptrunk + '._inputRange').set(null);\n    } else if (pleaf.match(AX_NAME_PATTERN)) {\n      var fullProp = nestedProperty(fullLayout, ai).get();\n      var newType = (vi || {}).type; // This can potentially cause strange behavior if the autotype is not\n      // numeric (linear, because we don't auto-log) but the previous type\n      // was log. That's a very strange edge case though\n\n      if (!newType || newType === '-') newType = 'linear';\n      Registry.getComponentMethod('annotations', 'convertCoords')(gd, fullProp, newType, doextra);\n      Registry.getComponentMethod('images', 'convertCoords')(gd, fullProp, newType, doextra);\n    } // alter gd.layout\n    // collect array component edits for execution all together\n    // so we can ensure consistent behavior adding/removing items\n    // and order-independence for add/remove/edit all together in\n    // one relayout call\n\n\n    var containerArrayMatch = manageArrays.containerArrayMatch(ai);\n\n    if (containerArrayMatch) {\n      arrayStr = containerArrayMatch.array;\n      i = containerArrayMatch.index;\n      var propStr = containerArrayMatch.property;\n      var updateValObject = valObject || {\n        editType: 'calc'\n      };\n\n      if (i !== '' && propStr === '') {\n        // special handling of undoit if we're adding or removing an element\n        // ie 'annotations[2]' which can be {...} (add) or null,\n        // does not work when replacing the entire array\n        if (manageArrays.isAddVal(vi)) {\n          undoit[ai] = null;\n        } else if (manageArrays.isRemoveVal(vi)) {\n          undoit[ai] = (nestedProperty(layout, arrayStr).get() || [])[i];\n        } else {\n          Lib.warn('unrecognized full object value', aobj);\n        }\n      }\n\n      editTypes.update(flags, updateValObject); // prepare the edits object we'll send to applyContainerArrayChanges\n\n      if (!arrayEdits[arrayStr]) arrayEdits[arrayStr] = {};\n      var objEdits = arrayEdits[arrayStr][i];\n      if (!objEdits) objEdits = arrayEdits[arrayStr][i] = {};\n      objEdits[propStr] = vi;\n      delete aobj[ai];\n    } else if (pleaf === 'reverse') {\n      // handle axis reversal explicitly, as there's no 'reverse' attribute\n      if (parentIn.range) parentIn.range.reverse();else {\n        doextra(ptrunk + '.autorange', true);\n        parentIn.range = [1, 0];\n      }\n      if (parentFull.autorange) flags.calc = true;else flags.plot = true;\n    } else {\n      if (fullLayout._has('scatter-like') && fullLayout._has('regl') && ai === 'dragmode' && (vi === 'lasso' || vi === 'select') && !(vOld === 'lasso' || vOld === 'select')) {\n        flags.plot = true;\n      } else if (fullLayout._has('gl2d')) {\n        flags.plot = true;\n      } else if (valObject) editTypes.update(flags, valObject);else flags.calc = true;\n\n      p.set(vi);\n    }\n  } // now we've collected component edits - execute them all together\n\n\n  for (arrayStr in arrayEdits) {\n    var finished = manageArrays.applyContainerArrayChanges(gd, layoutNP(layout, arrayStr), arrayEdits[arrayStr], flags, layoutNP);\n    if (!finished) flags.plot = true;\n  } // figure out if we need to recalculate axis constraints\n\n\n  var constraints = fullLayout._axisConstraintGroups || [];\n\n  for (axId in rangesAltered) {\n    for (i = 0; i < constraints.length; i++) {\n      var group = constraints[i];\n\n      if (group[axId]) {\n        // Always recalc if we're changing constrained ranges.\n        // Otherwise it's possible to violate the constraints by\n        // specifying arbitrary ranges for all axes in the group.\n        // this way some ranges may expand beyond what's specified,\n        // as they do at first draw, to satisfy the constraints.\n        flags.calc = true;\n\n        for (var groupAxId in group) {\n          if (!rangesAltered[groupAxId]) {\n            Axes.getFromId(gd, groupAxId)._constraintShrinkable = true;\n          }\n        }\n      }\n    }\n  } // If the autosize changed or height or width was explicitly specified,\n  // this triggers a redraw\n  // TODO: do we really need special aobj.height/width handling here?\n  // couldn't editType do this?\n\n\n  if (updateAutosize(gd) || aobj.height || aobj.width) flags.plot = true;\n\n  if (flags.plot || flags.calc) {\n    flags.layoutReplot = true;\n  } // now all attribute mods are done, as are\n  // redo and undo so we can save them\n\n\n  return {\n    flags: flags,\n    rangesAltered: rangesAltered,\n    undoit: undoit,\n    redoit: redoit,\n    eventData: eventData\n  };\n}\n/*\n * updateAutosize: we made a change, does it change the autosize result?\n * puts the new size into fullLayout\n * returns true if either height or width changed\n */\n\n\nfunction updateAutosize(gd) {\n  var fullLayout = gd._fullLayout;\n  var oldWidth = fullLayout.width;\n  var oldHeight = fullLayout.height; // calculate autosizing\n\n  if (gd.layout.autosize) Plots.plotAutoSize(gd, gd.layout, fullLayout);\n  return fullLayout.width !== oldWidth || fullLayout.height !== oldHeight;\n}\n/**\n * update: update trace and layout attributes of an existing plot\n *\n * @param {String | HTMLDivElement} gd\n *  the id or DOM element of the graph container div\n * @param {Object} traceUpdate\n *  attribute object `{astr1: val1, astr2: val2 ...}`\n *  corresponding to updates in the plot's traces\n * @param {Object} layoutUpdate\n *  attribute object `{astr1: val1, astr2: val2 ...}`\n *  corresponding to updates in the plot's layout\n * @param {Number[] | Number} [traces]\n *  integer or array of integers for the traces to alter (all if omitted)\n *\n */\n\n\nfunction update(gd, traceUpdate, layoutUpdate, _traces) {\n  gd = Lib.getGraphDiv(gd);\n  helpers.clearPromiseQueue(gd);\n\n  if (gd.framework && gd.framework.isPolar) {\n    return Promise.resolve(gd);\n  }\n\n  if (!Lib.isPlainObject(traceUpdate)) traceUpdate = {};\n  if (!Lib.isPlainObject(layoutUpdate)) layoutUpdate = {};\n  if (Object.keys(traceUpdate).length) gd.changed = true;\n  if (Object.keys(layoutUpdate).length) gd.changed = true;\n  var traces = helpers.coerceTraceIndices(gd, _traces);\n\n  var restyleSpecs = _restyle(gd, Lib.extendFlat({}, traceUpdate), traces);\n\n  var restyleFlags = restyleSpecs.flags;\n\n  var relayoutSpecs = _relayout(gd, Lib.extendFlat({}, layoutUpdate));\n\n  var relayoutFlags = relayoutSpecs.flags; // clear calcdata and/or axis types if required\n\n  if (restyleFlags.calc || relayoutFlags.calc) gd.calcdata = undefined;\n  if (restyleFlags.clearAxisTypes) helpers.clearAxisTypes(gd, traces, layoutUpdate); // fill in redraw sequence\n\n  var seq = [];\n\n  if (relayoutFlags.layoutReplot) {\n    // N.B. works fine when both\n    // relayoutFlags.layoutReplot and restyleFlags.fullReplot are true\n    seq.push(subroutines.layoutReplot);\n  } else if (restyleFlags.fullReplot) {\n    seq.push(exports.plot);\n  } else {\n    seq.push(Plots.previousPromises);\n    axRangeSupplyDefaultsByPass(gd, relayoutFlags, relayoutSpecs) || Plots.supplyDefaults(gd);\n    if (restyleFlags.style) seq.push(subroutines.doTraceStyle);\n    if (restyleFlags.colorbars || relayoutFlags.colorbars) seq.push(subroutines.doColorBars);\n    if (relayoutFlags.legend) seq.push(subroutines.doLegend);\n    if (relayoutFlags.layoutstyle) seq.push(subroutines.layoutStyles);\n    if (relayoutFlags.axrange) addAxRangeSequence(seq, relayoutSpecs.rangesAltered);\n    if (relayoutFlags.ticks) seq.push(subroutines.doTicksRelayout);\n    if (relayoutFlags.modebar) seq.push(subroutines.doModeBar);\n    if (relayoutFlags.camera) seq.push(subroutines.doCamera);\n    seq.push(emitAfterPlot);\n  }\n\n  seq.push(Plots.rehover, Plots.redrag);\n  Queue.add(gd, update, [gd, restyleSpecs.undoit, relayoutSpecs.undoit, restyleSpecs.traces], update, [gd, restyleSpecs.redoit, relayoutSpecs.redoit, restyleSpecs.traces]);\n  var plotDone = Lib.syncOrAsync(seq, gd);\n  if (!plotDone || !plotDone.then) plotDone = Promise.resolve(gd);\n  return plotDone.then(function () {\n    gd.emit('plotly_update', {\n      data: restyleSpecs.eventData,\n      layout: relayoutSpecs.eventData\n    });\n    return gd;\n  });\n}\n/*\n * internal-use-only restyle/relayout/update variants that record the initial\n * values in (fullLayout|fullTrace)._preGUI so changes can be persisted across\n * Plotly.react data updates, dependent on uirevision attributes\n */\n\n\nfunction guiEdit(func) {\n  return function wrappedEdit(gd) {\n    gd._fullLayout._guiEditing = true;\n    var p = func.apply(null, arguments);\n    gd._fullLayout._guiEditing = false;\n    return p;\n  };\n} // For connecting edited layout attributes to uirevision attrs\n// If no `attr` we use `match[1] + '.uirevision'`\n// Ordered by most common edits first, to minimize our search time\n\n\nvar layoutUIControlPatterns = [{\n  pattern: /^hiddenlabels/,\n  attr: 'legend.uirevision'\n}, {\n  pattern: /^((x|y)axis\\d*)\\.((auto)?range|title\\.text)/\n}, // showspikes and modes include those nested inside scenes\n{\n  pattern: /axis\\d*\\.showspikes$/,\n  attr: 'modebar.uirevision'\n}, {\n  pattern: /(hover|drag)mode$/,\n  attr: 'modebar.uirevision'\n}, {\n  pattern: /^(scene\\d*)\\.camera/\n}, {\n  pattern: /^(geo\\d*)\\.(projection|center|fitbounds)/\n}, {\n  pattern: /^(ternary\\d*\\.[abc]axis)\\.(min|title\\.text)$/\n}, {\n  pattern: /^(polar\\d*\\.radialaxis)\\.((auto)?range|angle|title\\.text)/\n}, {\n  pattern: /^(polar\\d*\\.angularaxis)\\.rotation/\n}, {\n  pattern: /^(mapbox\\d*)\\.(center|zoom|bearing|pitch)/\n}, {\n  pattern: /^legend\\.(x|y)$/,\n  attr: 'editrevision'\n}, {\n  pattern: /^(shapes|annotations)/,\n  attr: 'editrevision'\n}, {\n  pattern: /^title\\.text$/,\n  attr: 'editrevision'\n}]; // same for trace attributes: if `attr` is given it's in layout,\n// or with no `attr` we use `trace.uirevision`\n\nvar traceUIControlPatterns = [{\n  pattern: /^selectedpoints$/,\n  attr: 'selectionrevision'\n}, // \"visible\" includes trace.transforms[i].styles[j].value.visible\n{\n  pattern: /(^|value\\.)visible$/,\n  attr: 'legend.uirevision'\n}, {\n  pattern: /^dimensions\\[\\d+\\]\\.constraintrange/\n}, {\n  pattern: /^node\\.(x|y|groups)/\n}, // for Sankey nodes\n{\n  pattern: /^level$/\n}, // for Sunburst & Treemap traces\n// below this you must be in editable: true mode\n// TODO: I still put name and title with `trace.uirevision`\n// reasonable or should these be `editrevision`?\n// Also applies to axis titles up in the layout section\n// \"name\" also includes transform.styles\n{\n  pattern: /(^|value\\.)name$/\n}, // including nested colorbar attributes (ie marker.colorbar)\n{\n  pattern: /colorbar\\.title\\.text$/\n}, {\n  pattern: /colorbar\\.(x|y)$/,\n  attr: 'editrevision'\n}];\n\nfunction findUIPattern(key, patternSpecs) {\n  for (var i = 0; i < patternSpecs.length; i++) {\n    var spec = patternSpecs[i];\n    var match = key.match(spec.pattern);\n\n    if (match) {\n      return {\n        head: match[1],\n        attr: spec.attr\n      };\n    }\n  }\n} // We're finding the new uirevision before supplyDefaults, so do the\n// inheritance manually. Note that only `undefined` inherits - other\n// falsy values are returned.\n\n\nfunction getNewRev(revAttr, container) {\n  var newRev = nestedProperty(container, revAttr).get();\n  if (newRev !== undefined) return newRev;\n  var parts = revAttr.split('.');\n  parts.pop();\n\n  while (parts.length > 1) {\n    parts.pop();\n    newRev = nestedProperty(container, parts.join('.') + '.uirevision').get();\n    if (newRev !== undefined) return newRev;\n  }\n\n  return container.uirevision;\n}\n\nfunction getFullTraceIndexFromUid(uid, fullData) {\n  for (var i = 0; i < fullData.length; i++) {\n    if (fullData[i]._fullInput.uid === uid) return i;\n  }\n\n  return -1;\n}\n\nfunction getTraceIndexFromUid(uid, data, tracei) {\n  for (var i = 0; i < data.length; i++) {\n    if (data[i].uid === uid) return i;\n  } // fall back on trace order, but only if user didn't provide a uid for that trace\n\n\n  return !data[tracei] || data[tracei].uid ? -1 : tracei;\n}\n\nfunction valsMatch(v1, v2) {\n  var v1IsObj = Lib.isPlainObject(v1);\n  var v1IsArray = Array.isArray(v1);\n\n  if (v1IsObj || v1IsArray) {\n    return (v1IsObj && Lib.isPlainObject(v2) || v1IsArray && Array.isArray(v2)) && JSON.stringify(v1) === JSON.stringify(v2);\n  }\n\n  return v1 === v2;\n}\n\nfunction applyUIRevisions(data, layout, oldFullData, oldFullLayout) {\n  var layoutPreGUI = oldFullLayout._preGUI;\n  var key, revAttr, oldRev, newRev, match, preGUIVal, newNP, newVal;\n  var bothInheritAutorange = [];\n  var newRangeAccepted = {};\n\n  for (key in layoutPreGUI) {\n    match = findUIPattern(key, layoutUIControlPatterns);\n\n    if (match) {\n      revAttr = match.attr || match.head + '.uirevision';\n      oldRev = nestedProperty(oldFullLayout, revAttr).get();\n      newRev = oldRev && getNewRev(revAttr, layout);\n\n      if (newRev && newRev === oldRev) {\n        preGUIVal = layoutPreGUI[key];\n        if (preGUIVal === null) preGUIVal = undefined;\n        newNP = nestedProperty(layout, key);\n        newVal = newNP.get();\n\n        if (valsMatch(newVal, preGUIVal)) {\n          if (newVal === undefined && key.substr(key.length - 9) === 'autorange') {\n            bothInheritAutorange.push(key.substr(0, key.length - 10));\n          }\n\n          newNP.set(undefinedToNull(nestedProperty(oldFullLayout, key).get()));\n          continue;\n        }\n      }\n    } else {\n      Lib.warn('unrecognized GUI edit: ' + key);\n    } // if we got this far, the new value was accepted as the new starting\n    // point (either because it changed or revision changed)\n    // so remove it from _preGUI for next time.\n\n\n    delete layoutPreGUI[key];\n\n    if (key.substr(key.length - 8, 6) === 'range[') {\n      newRangeAccepted[key.substr(0, key.length - 9)] = 1;\n    }\n  } // Special logic for `autorange`, since it interacts with `range`:\n  // If the new figure's matching `range` was kept, and `autorange`\n  // wasn't supplied explicitly in either the original or the new figure,\n  // we shouldn't alter that - but we may just have done that, so fix it.\n\n\n  for (var i = 0; i < bothInheritAutorange.length; i++) {\n    var axAttr = bothInheritAutorange[i];\n\n    if (newRangeAccepted[axAttr]) {\n      var newAx = nestedProperty(layout, axAttr).get();\n      if (newAx) delete newAx.autorange;\n    }\n  } // Now traces - try to match them up by uid (in case we added/deleted in\n  // the middle), then fall back on index.\n\n\n  var allTracePreGUI = oldFullLayout._tracePreGUI;\n\n  for (var uid in allTracePreGUI) {\n    var tracePreGUI = allTracePreGUI[uid];\n    var newTrace = null;\n    var fullInput;\n\n    for (key in tracePreGUI) {\n      // wait until we know we have preGUI values to look for traces\n      // but if we don't find both, stop looking at this uid\n      if (!newTrace) {\n        var fulli = getFullTraceIndexFromUid(uid, oldFullData);\n\n        if (fulli < 0) {\n          // Somehow we didn't even have this trace in oldFullData...\n          // I guess this could happen with `deleteTraces` or something\n          delete allTracePreGUI[uid];\n          break;\n        }\n\n        var fullTrace = oldFullData[fulli];\n        fullInput = fullTrace._fullInput;\n        var newTracei = getTraceIndexFromUid(uid, data, fullInput.index);\n\n        if (newTracei < 0) {\n          // No match in new data\n          delete allTracePreGUI[uid];\n          break;\n        }\n\n        newTrace = data[newTracei];\n      }\n\n      match = findUIPattern(key, traceUIControlPatterns);\n\n      if (match) {\n        if (match.attr) {\n          oldRev = nestedProperty(oldFullLayout, match.attr).get();\n          newRev = oldRev && getNewRev(match.attr, layout);\n        } else {\n          oldRev = fullInput.uirevision; // inheritance for trace.uirevision is simple, just layout.uirevision\n\n          newRev = newTrace.uirevision;\n          if (newRev === undefined) newRev = layout.uirevision;\n        }\n\n        if (newRev && newRev === oldRev) {\n          preGUIVal = tracePreGUI[key];\n          if (preGUIVal === null) preGUIVal = undefined;\n          newNP = nestedProperty(newTrace, key);\n          newVal = newNP.get();\n\n          if (valsMatch(newVal, preGUIVal)) {\n            newNP.set(undefinedToNull(nestedProperty(fullInput, key).get()));\n            continue;\n          }\n        }\n      } else {\n        Lib.warn('unrecognized GUI edit: ' + key + ' in trace uid ' + uid);\n      }\n\n      delete tracePreGUI[key];\n    }\n  }\n}\n/**\n * Plotly.react:\n * A plot/update method that takes the full plot state (same API as plot/newPlot)\n * and diffs to determine the minimal update pathway\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n * @param {array of objects} data\n *      array of traces, containing the data and display information for each trace\n * @param {object} layout\n *      object describing the overall display of the plot,\n *      all the stuff that doesn't pertain to any individual trace\n * @param {object} config\n *      configuration options (see ./plot_config.js for more info)\n *\n * OR\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n * @param {object} figure\n *      object containing `data`, `layout`, `config`, and `frames` members\n *\n */\n\n\nfunction react(gd, data, layout, config) {\n  var frames, plotDone;\n\n  function addFrames() {\n    return exports.addFrames(gd, frames);\n  }\n\n  gd = Lib.getGraphDiv(gd);\n  helpers.clearPromiseQueue(gd);\n  var oldFullData = gd._fullData;\n  var oldFullLayout = gd._fullLayout; // you can use this as the initial draw as well as to update\n\n  if (!Lib.isPlotDiv(gd) || !oldFullData || !oldFullLayout) {\n    plotDone = exports.newPlot(gd, data, layout, config);\n  } else {\n    if (Lib.isPlainObject(data)) {\n      var obj = data;\n      data = obj.data;\n      layout = obj.layout;\n      config = obj.config;\n      frames = obj.frames;\n    }\n\n    var configChanged = false; // assume that if there's a config at all, we're reacting to it too,\n    // and completely replace the previous config\n\n    if (config) {\n      var oldConfig = Lib.extendDeep({}, gd._context);\n      gd._context = undefined;\n      setPlotContext(gd, config);\n      configChanged = diffConfig(oldConfig, gd._context);\n    }\n\n    gd.data = data || [];\n    helpers.cleanData(gd.data);\n    gd.layout = layout || {};\n    helpers.cleanLayout(gd.layout);\n    applyUIRevisions(gd.data, gd.layout, oldFullData, oldFullLayout);\n    var allNames = Object.getOwnPropertyNames(oldFullLayout);\n\n    for (var q = 0; q < allNames.length; q++) {\n      var name = allNames[q];\n      var start = name.substring(0, 5);\n\n      if (start === 'xaxis' || start === 'yaxis') {\n        var emptyCategories = oldFullLayout[name]._emptyCategories;\n        if (emptyCategories) emptyCategories();\n      }\n    } // \"true\" skips updating calcdata and remapping arrays from calcTransforms,\n    // which supplyDefaults usually does at the end, but we may need to NOT do\n    // if the diff (which we haven't determined yet) says we'll recalc\n\n\n    Plots.supplyDefaults(gd, {\n      skipUpdateCalc: true\n    });\n    var newFullData = gd._fullData;\n    var newFullLayout = gd._fullLayout;\n    var immutable = newFullLayout.datarevision === undefined;\n    var transition = newFullLayout.transition;\n    var relayoutFlags = diffLayout(gd, oldFullLayout, newFullLayout, immutable, transition);\n    var newDataRevision = relayoutFlags.newDataRevision;\n    var restyleFlags = diffData(gd, oldFullData, newFullData, immutable, transition, newDataRevision); // TODO: how to translate this part of relayout to Plotly.react?\n    // // Setting width or height to null must reset the graph's width / height\n    // // back to its initial value as computed during the first pass in Plots.plotAutoSize.\n    // //\n    // // To do so, we must manually set them back here using the _initialAutoSize cache.\n    // if(['width', 'height'].indexOf(ai) !== -1 && vi === null) {\n    //     fullLayout[ai] = gd._initialAutoSize[ai];\n    // }\n\n    if (updateAutosize(gd)) relayoutFlags.layoutReplot = true; // clear calcdata if required\n\n    if (restyleFlags.calc || relayoutFlags.calc) gd.calcdata = undefined; // otherwise do the calcdata updates and calcTransform array remaps that we skipped earlier\n    else Plots.supplyDefaultsUpdateCalc(gd.calcdata, newFullData); // Note: what restyle/relayout use impliedEdits and clearAxisTypes for\n    // must be handled by the user when using Plotly.react.\n    // fill in redraw sequence\n\n    var seq = [];\n\n    if (frames) {\n      gd._transitionData = {};\n      Plots.createTransitionData(gd);\n      seq.push(addFrames);\n    } // Transition pathway,\n    // only used when 'transition' is set by user and\n    // when at least one animatable attribute has changed,\n    // N.B. config changed aren't animatable\n\n\n    if (newFullLayout.transition && !configChanged && (restyleFlags.anim || relayoutFlags.anim)) {\n      Plots.doCalcdata(gd);\n      subroutines.doAutoRangeAndConstraints(gd);\n      seq.push(function () {\n        return Plots.transitionFromReact(gd, restyleFlags, relayoutFlags, oldFullLayout);\n      });\n    } else if (restyleFlags.fullReplot || relayoutFlags.layoutReplot || configChanged) {\n      gd._fullLayout._skipDefaults = true;\n      seq.push(exports.plot);\n    } else {\n      for (var componentType in relayoutFlags.arrays) {\n        var indices = relayoutFlags.arrays[componentType];\n\n        if (indices.length) {\n          var drawOne = Registry.getComponentMethod(componentType, 'drawOne');\n\n          if (drawOne !== Lib.noop) {\n            for (var i = 0; i < indices.length; i++) {\n              drawOne(gd, indices[i]);\n            }\n          } else {\n            var draw = Registry.getComponentMethod(componentType, 'draw');\n\n            if (draw === Lib.noop) {\n              throw new Error('cannot draw components: ' + componentType);\n            }\n\n            draw(gd);\n          }\n        }\n      }\n\n      seq.push(Plots.previousPromises);\n      if (restyleFlags.style) seq.push(subroutines.doTraceStyle);\n      if (restyleFlags.colorbars || relayoutFlags.colorbars) seq.push(subroutines.doColorBars);\n      if (relayoutFlags.legend) seq.push(subroutines.doLegend);\n      if (relayoutFlags.layoutstyle) seq.push(subroutines.layoutStyles);\n      if (relayoutFlags.axrange) addAxRangeSequence(seq);\n      if (relayoutFlags.ticks) seq.push(subroutines.doTicksRelayout);\n      if (relayoutFlags.modebar) seq.push(subroutines.doModeBar);\n      if (relayoutFlags.camera) seq.push(subroutines.doCamera);\n      seq.push(emitAfterPlot);\n    }\n\n    seq.push(Plots.rehover, Plots.redrag);\n    plotDone = Lib.syncOrAsync(seq, gd);\n    if (!plotDone || !plotDone.then) plotDone = Promise.resolve(gd);\n  }\n\n  return plotDone.then(function () {\n    gd.emit('plotly_react', {\n      data: data,\n      layout: layout\n    });\n    return gd;\n  });\n}\n\nfunction diffData(gd, oldFullData, newFullData, immutable, transition, newDataRevision) {\n  var sameTraceLength = oldFullData.length === newFullData.length;\n\n  if (!transition && !sameTraceLength) {\n    return {\n      fullReplot: true,\n      calc: true\n    };\n  }\n\n  var flags = editTypes.traceFlags();\n  flags.arrays = {};\n  flags.nChanges = 0;\n  flags.nChangesAnim = 0;\n  var i, trace;\n\n  function getTraceValObject(parts) {\n    var out = PlotSchema.getTraceValObject(trace, parts);\n\n    if (!trace._module.animatable && out.anim) {\n      out.anim = false;\n    }\n\n    return out;\n  }\n\n  var diffOpts = {\n    getValObject: getTraceValObject,\n    flags: flags,\n    immutable: immutable,\n    transition: transition,\n    newDataRevision: newDataRevision,\n    gd: gd\n  };\n  var seenUIDs = {};\n\n  for (i = 0; i < oldFullData.length; i++) {\n    if (newFullData[i]) {\n      trace = newFullData[i]._fullInput;\n      if (Plots.hasMakesDataTransform(trace)) trace = newFullData[i];\n      if (seenUIDs[trace.uid]) continue;\n      seenUIDs[trace.uid] = 1;\n      getDiffFlags(oldFullData[i]._fullInput, trace, [], diffOpts);\n    }\n  }\n\n  if (flags.calc || flags.plot) {\n    flags.fullReplot = true;\n  }\n\n  if (transition && flags.nChanges && flags.nChangesAnim) {\n    flags.anim = flags.nChanges === flags.nChangesAnim && sameTraceLength ? 'all' : 'some';\n  }\n\n  return flags;\n}\n\nfunction diffLayout(gd, oldFullLayout, newFullLayout, immutable, transition) {\n  var flags = editTypes.layoutFlags();\n  flags.arrays = {};\n  flags.rangesAltered = {};\n  flags.nChanges = 0;\n  flags.nChangesAnim = 0;\n\n  function getLayoutValObject(parts) {\n    return PlotSchema.getLayoutValObject(newFullLayout, parts);\n  }\n\n  var diffOpts = {\n    getValObject: getLayoutValObject,\n    flags: flags,\n    immutable: immutable,\n    transition: transition,\n    gd: gd\n  };\n  getDiffFlags(oldFullLayout, newFullLayout, [], diffOpts);\n\n  if (flags.plot || flags.calc) {\n    flags.layoutReplot = true;\n  }\n\n  if (transition && flags.nChanges && flags.nChangesAnim) {\n    flags.anim = flags.nChanges === flags.nChangesAnim ? 'all' : 'some';\n  }\n\n  return flags;\n}\n\nfunction getDiffFlags(oldContainer, newContainer, outerparts, opts) {\n  var valObject, key, astr;\n  var getValObject = opts.getValObject;\n  var flags = opts.flags;\n  var immutable = opts.immutable;\n  var inArray = opts.inArray;\n  var arrayIndex = opts.arrayIndex;\n\n  function changed() {\n    var editType = valObject.editType;\n\n    if (inArray && editType.indexOf('arraydraw') !== -1) {\n      Lib.pushUnique(flags.arrays[inArray], arrayIndex);\n      return;\n    }\n\n    editTypes.update(flags, valObject);\n\n    if (editType !== 'none') {\n      flags.nChanges++;\n    } // track animatable changes\n\n\n    if (opts.transition && valObject.anim) {\n      flags.nChangesAnim++;\n    } // track cartesian axes with altered ranges\n\n\n    if (AX_RANGE_RE.test(astr) || AX_AUTORANGE_RE.test(astr)) {\n      flags.rangesAltered[outerparts[0]] = 1;\n    } // clear _inputDomain on cartesian axes with altered domains\n\n\n    if (AX_DOMAIN_RE.test(astr)) {\n      nestedProperty(newContainer, '_inputDomain').set(null);\n    } // track datarevision changes\n\n\n    if (key === 'datarevision') {\n      flags.newDataRevision = 1;\n    }\n  }\n\n  function valObjectCanBeDataArray(valObject) {\n    return valObject.valType === 'data_array' || valObject.arrayOk;\n  }\n\n  for (key in oldContainer) {\n    // short-circuit based on previous calls or previous keys that already maximized the pathway\n    if (flags.calc && !opts.transition) return;\n    var oldVal = oldContainer[key];\n    var newVal = newContainer[key];\n    var parts = outerparts.concat(key);\n    astr = parts.join('.');\n    if (key.charAt(0) === '_' || typeof oldVal === 'function' || oldVal === newVal) continue; // FIXME: ax.tick0 and dtick get filled in during plotting (except for geo subplots),\n    // and unlike other auto values they don't make it back into the input,\n    // so newContainer won't have them.\n\n    if ((key === 'tick0' || key === 'dtick') && outerparts[0] !== 'geo') {\n      var tickMode = newContainer.tickmode;\n      if (tickMode === 'auto' || tickMode === 'array' || !tickMode) continue;\n    } // FIXME: Similarly for axis ranges for 3D\n    // contourcarpet doesn't HAVE zmin/zmax, they're just auto-added. It needs them.\n\n\n    if (key === 'range' && newContainer.autorange) continue;\n    if ((key === 'zmin' || key === 'zmax') && newContainer.type === 'contourcarpet') continue;\n    valObject = getValObject(parts); // in case type changed, we may not even *have* a valObject.\n\n    if (!valObject) continue;\n    if (valObject._compareAsJSON && JSON.stringify(oldVal) === JSON.stringify(newVal)) continue;\n    var valType = valObject.valType;\n    var i;\n    var canBeDataArray = valObjectCanBeDataArray(valObject);\n    var wasArray = Array.isArray(oldVal);\n    var nowArray = Array.isArray(newVal); // hack for traces that modify the data in supplyDefaults, like\n    // converting 1D to 2D arrays, which will always create new objects\n\n    if (wasArray && nowArray) {\n      var inputKey = '_input_' + key;\n      var oldValIn = oldContainer[inputKey];\n      var newValIn = newContainer[inputKey];\n      if (Array.isArray(oldValIn) && oldValIn === newValIn) continue;\n    }\n\n    if (newVal === undefined) {\n      if (canBeDataArray && wasArray) flags.calc = true;else changed();\n    } else if (valObject._isLinkedToArray) {\n      var arrayEditIndices = [];\n      var extraIndices = false;\n      if (!inArray) flags.arrays[key] = arrayEditIndices;\n      var minLen = Math.min(oldVal.length, newVal.length);\n      var maxLen = Math.max(oldVal.length, newVal.length);\n\n      if (minLen !== maxLen) {\n        if (valObject.editType === 'arraydraw') {\n          extraIndices = true;\n        } else {\n          changed();\n          continue;\n        }\n      }\n\n      for (i = 0; i < minLen; i++) {\n        getDiffFlags(oldVal[i], newVal[i], parts.concat(i), // add array indices, but not if we're already in an array\n        Lib.extendFlat({\n          inArray: key,\n          arrayIndex: i\n        }, opts));\n      } // put this at the end so that we know our collected array indices are sorted\n      // but the check for length changes happens up front so we can short-circuit\n      // diffing if appropriate\n\n\n      if (extraIndices) {\n        for (i = minLen; i < maxLen; i++) {\n          arrayEditIndices.push(i);\n        }\n      }\n    } else if (!valType && Lib.isPlainObject(oldVal)) {\n      getDiffFlags(oldVal, newVal, parts, opts);\n    } else if (canBeDataArray) {\n      if (wasArray && nowArray) {\n        // don't try to diff two data arrays. If immutable we know the data changed,\n        // if not, assume it didn't and let `layout.datarevision` tell us if it did\n        if (immutable) {\n          flags.calc = true;\n        } // look for animatable attributes when the data changed\n\n\n        if (immutable || opts.newDataRevision) {\n          changed();\n        }\n      } else if (wasArray !== nowArray) {\n        flags.calc = true;\n      } else changed();\n    } else if (wasArray && nowArray) {\n      // info array, colorscale, 'any' - these are short, just stringify.\n      // I don't *think* that covers up any real differences post-validation, does it?\n      // otherwise we need to dive in 1 (info_array) or 2 (colorscale) levels and compare\n      // all elements.\n      if (oldVal.length !== newVal.length || String(oldVal) !== String(newVal)) {\n        changed();\n      }\n    } else {\n      changed();\n    }\n  }\n\n  for (key in newContainer) {\n    if (!(key in oldContainer || key.charAt(0) === '_' || typeof newContainer[key] === 'function')) {\n      valObject = getValObject(outerparts.concat(key));\n\n      if (valObjectCanBeDataArray(valObject) && Array.isArray(newContainer[key])) {\n        flags.calc = true;\n        return;\n      } else changed();\n    }\n  }\n}\n/*\n * simple diff for config - for now, just treat all changes as equivalent\n */\n\n\nfunction diffConfig(oldConfig, newConfig) {\n  var key;\n\n  for (key in oldConfig) {\n    if (key.charAt(0) === '_') continue;\n    var oldVal = oldConfig[key];\n    var newVal = newConfig[key];\n\n    if (oldVal !== newVal) {\n      if (Lib.isPlainObject(oldVal) && Lib.isPlainObject(newVal)) {\n        if (diffConfig(oldVal, newVal)) {\n          return true;\n        }\n      } else if (Array.isArray(oldVal) && Array.isArray(newVal)) {\n        if (oldVal.length !== newVal.length) {\n          return true;\n        }\n\n        for (var i = 0; i < oldVal.length; i++) {\n          if (oldVal[i] !== newVal[i]) {\n            if (Lib.isPlainObject(oldVal[i]) && Lib.isPlainObject(newVal[i])) {\n              if (diffConfig(oldVal[i], newVal[i])) {\n                return true;\n              }\n            } else {\n              return true;\n            }\n          }\n        }\n      } else {\n        return true;\n      }\n    }\n  }\n}\n/**\n * Animate to a frame, sequence of frame, frame group, or frame definition\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n *\n * @param {string or object or array of strings or array of objects} frameOrGroupNameOrFrameList\n *      a single frame, array of frames, or group to which to animate. The intent is\n *      inferred by the type of the input. Valid inputs are:\n *\n *      - string, e.g. 'groupname': animate all frames of a given `group` in the order\n *            in which they are defined via `Plotly.addFrames`.\n *\n *      - array of strings, e.g. ['frame1', frame2']: a list of frames by name to which\n *            to animate in sequence\n *\n *      - object: {data: ...}: a frame definition to which to animate. The frame is not\n *            and does not need to be added via `Plotly.addFrames`. It may contain any of\n *            the properties of a frame, including `data`, `layout`, and `traces`. The\n *            frame is used as provided and does not use the `baseframe` property.\n *\n *      - array of objects, e.g. [{data: ...}, {data: ...}]: a list of frame objects,\n *            each following the same rules as a single `object`.\n *\n * @param {object} animationOpts\n *      configuration for the animation\n */\n\n\nfunction animate(gd, frameOrGroupNameOrFrameList, animationOpts) {\n  gd = Lib.getGraphDiv(gd);\n\n  if (!Lib.isPlotDiv(gd)) {\n    throw new Error('This element is not a Plotly plot: ' + gd + '. It\\'s likely that you\\'ve failed ' + 'to create a plot before animating it. For more details, see ' + 'https://plotly.com/javascript/animations/');\n  }\n\n  var trans = gd._transitionData; // This is the queue of frames that will be animated as soon as possible. They\n  // are popped immediately upon the *start* of a transition:\n\n  if (!trans._frameQueue) {\n    trans._frameQueue = [];\n  }\n\n  animationOpts = Plots.supplyAnimationDefaults(animationOpts);\n  var transitionOpts = animationOpts.transition;\n  var frameOpts = animationOpts.frame; // Since frames are popped immediately, an empty queue only means all frames have\n  // *started* to transition, not that the animation is complete. To solve that,\n  // track a separate counter that increments at the same time as frames are added\n  // to the queue, but decrements only when the transition is complete.\n\n  if (trans._frameWaitingCnt === undefined) {\n    trans._frameWaitingCnt = 0;\n  }\n\n  function getTransitionOpts(i) {\n    if (Array.isArray(transitionOpts)) {\n      if (i >= transitionOpts.length) {\n        return transitionOpts[0];\n      } else {\n        return transitionOpts[i];\n      }\n    } else {\n      return transitionOpts;\n    }\n  }\n\n  function getFrameOpts(i) {\n    if (Array.isArray(frameOpts)) {\n      if (i >= frameOpts.length) {\n        return frameOpts[0];\n      } else {\n        return frameOpts[i];\n      }\n    } else {\n      return frameOpts;\n    }\n  } // Execute a callback after the wrapper function has been called n times.\n  // This is used to defer the resolution until a transition has resovled *and*\n  // the frame has completed. If it's not done this way, then we get a race\n  // condition in which the animation might resolve before a transition is complete\n  // or vice versa.\n\n\n  function callbackOnNthTime(cb, n) {\n    var cnt = 0;\n    return function () {\n      if (cb && ++cnt === n) {\n        return cb();\n      }\n    };\n  }\n\n  return new Promise(function (resolve, reject) {\n    function discardExistingFrames() {\n      if (trans._frameQueue.length === 0) {\n        return;\n      }\n\n      while (trans._frameQueue.length) {\n        var next = trans._frameQueue.pop();\n\n        if (next.onInterrupt) {\n          next.onInterrupt();\n        }\n      }\n\n      gd.emit('plotly_animationinterrupted', []);\n    }\n\n    function queueFrames(frameList) {\n      if (frameList.length === 0) return;\n\n      for (var i = 0; i < frameList.length; i++) {\n        var computedFrame;\n\n        if (frameList[i].type === 'byname') {\n          // If it's a named frame, compute it:\n          computedFrame = Plots.computeFrame(gd, frameList[i].name);\n        } else {\n          // Otherwise we must have been given a simple object, so treat\n          // the input itself as the computed frame.\n          computedFrame = frameList[i].data;\n        }\n\n        var frameOpts = getFrameOpts(i);\n        var transitionOpts = getTransitionOpts(i); // It doesn't make much sense for the transition duration to be greater than\n        // the frame duration, so limit it:\n\n        transitionOpts.duration = Math.min(transitionOpts.duration, frameOpts.duration);\n        var nextFrame = {\n          frame: computedFrame,\n          name: frameList[i].name,\n          frameOpts: frameOpts,\n          transitionOpts: transitionOpts\n        };\n\n        if (i === frameList.length - 1) {\n          // The last frame in this .animate call stores the promise resolve\n          // and reject callbacks. This is how we ensure that the animation\n          // loop (which may exist as a result of a *different* .animate call)\n          // still resolves or rejecdts this .animate call's promise. once it's\n          // complete.\n          nextFrame.onComplete = callbackOnNthTime(resolve, 2);\n          nextFrame.onInterrupt = reject;\n        }\n\n        trans._frameQueue.push(nextFrame);\n      } // Set it as never having transitioned to a frame. This will cause the animation\n      // loop to immediately transition to the next frame (which, for immediate mode,\n      // is the first frame in the list since all others would have been discarded\n      // below)\n\n\n      if (animationOpts.mode === 'immediate') {\n        trans._lastFrameAt = -Infinity;\n      } // Only it's not already running, start a RAF loop. This could be avoided in the\n      // case that there's only one frame, but it significantly complicated the logic\n      // and only sped things up by about 5% or so for a lorenz attractor simulation.\n      // It would be a fine thing to implement, but the benefit of that optimization\n      // doesn't seem worth the extra complexity.\n\n\n      if (!trans._animationRaf) {\n        beginAnimationLoop();\n      }\n    }\n\n    function stopAnimationLoop() {\n      gd.emit('plotly_animated'); // Be sure to unset also since it's how we know whether a loop is already running:\n\n      window.cancelAnimationFrame(trans._animationRaf);\n      trans._animationRaf = null;\n    }\n\n    function nextFrame() {\n      if (trans._currentFrame && trans._currentFrame.onComplete) {\n        // Execute the callback and unset it to ensure it doesn't\n        // accidentally get called twice\n        trans._currentFrame.onComplete();\n      }\n\n      var newFrame = trans._currentFrame = trans._frameQueue.shift();\n\n      if (newFrame) {\n        // Since it's sometimes necessary to do deep digging into frame data,\n        // we'll consider it not 100% impossible for nulls or numbers to sneak through,\n        // so check when casting the name, just to be absolutely certain:\n        var stringName = newFrame.name ? newFrame.name.toString() : null;\n        gd._fullLayout._currentFrame = stringName;\n        trans._lastFrameAt = Date.now();\n        trans._timeToNext = newFrame.frameOpts.duration; // This is simply called and it's left to .transition to decide how to manage\n        // interrupting current transitions. That means we don't need to worry about\n        // how it resolves or what happens after this:\n\n        Plots.transition(gd, newFrame.frame.data, newFrame.frame.layout, helpers.coerceTraceIndices(gd, newFrame.frame.traces), newFrame.frameOpts, newFrame.transitionOpts).then(function () {\n          if (newFrame.onComplete) {\n            newFrame.onComplete();\n          }\n        });\n        gd.emit('plotly_animatingframe', {\n          name: stringName,\n          frame: newFrame.frame,\n          animation: {\n            frame: newFrame.frameOpts,\n            transition: newFrame.transitionOpts\n          }\n        });\n      } else {\n        // If there are no more frames, then stop the RAF loop:\n        stopAnimationLoop();\n      }\n    }\n\n    function beginAnimationLoop() {\n      gd.emit('plotly_animating'); // If no timer is running, then set last frame = long ago so that the next\n      // frame is immediately transitioned:\n\n      trans._lastFrameAt = -Infinity;\n      trans._timeToNext = 0;\n      trans._runningTransitions = 0;\n      trans._currentFrame = null;\n\n      var doFrame = function doFrame() {\n        // This *must* be requested before nextFrame since nextFrame may decide\n        // to cancel it if there's nothing more to animated:\n        trans._animationRaf = window.requestAnimationFrame(doFrame); // Check if we're ready for a new frame:\n\n        if (Date.now() - trans._lastFrameAt > trans._timeToNext) {\n          nextFrame();\n        }\n      };\n\n      doFrame();\n    } // This is an animate-local counter that helps match up option input list\n    // items with the particular frame.\n\n\n    var configCounter = 0;\n\n    function setTransitionConfig(frame) {\n      if (Array.isArray(transitionOpts)) {\n        if (configCounter >= transitionOpts.length) {\n          frame.transitionOpts = transitionOpts[configCounter];\n        } else {\n          frame.transitionOpts = transitionOpts[0];\n        }\n      } else {\n        frame.transitionOpts = transitionOpts;\n      }\n\n      configCounter++;\n      return frame;\n    } // Disambiguate what's sort of frames have been received\n\n\n    var i, frame;\n    var frameList = [];\n    var allFrames = frameOrGroupNameOrFrameList === undefined || frameOrGroupNameOrFrameList === null;\n    var isFrameArray = Array.isArray(frameOrGroupNameOrFrameList);\n    var isSingleFrame = !allFrames && !isFrameArray && Lib.isPlainObject(frameOrGroupNameOrFrameList);\n\n    if (isSingleFrame) {\n      // In this case, a simple object has been passed to animate.\n      frameList.push({\n        type: 'object',\n        data: setTransitionConfig(Lib.extendFlat({}, frameOrGroupNameOrFrameList))\n      });\n    } else if (allFrames || ['string', 'number'].indexOf(typeof frameOrGroupNameOrFrameList) !== -1) {\n      // In this case, null or undefined has been passed so that we want to\n      // animate *all* currently defined frames\n      for (i = 0; i < trans._frames.length; i++) {\n        frame = trans._frames[i];\n        if (!frame) continue;\n\n        if (allFrames || String(frame.group) === String(frameOrGroupNameOrFrameList)) {\n          frameList.push({\n            type: 'byname',\n            name: String(frame.name),\n            data: setTransitionConfig({\n              name: frame.name\n            })\n          });\n        }\n      }\n    } else if (isFrameArray) {\n      for (i = 0; i < frameOrGroupNameOrFrameList.length; i++) {\n        var frameOrName = frameOrGroupNameOrFrameList[i];\n\n        if (['number', 'string'].indexOf(typeof frameOrName) !== -1) {\n          frameOrName = String(frameOrName); // In this case, there's an array and this frame is a string name:\n\n          frameList.push({\n            type: 'byname',\n            name: frameOrName,\n            data: setTransitionConfig({\n              name: frameOrName\n            })\n          });\n        } else if (Lib.isPlainObject(frameOrName)) {\n          frameList.push({\n            type: 'object',\n            data: setTransitionConfig(Lib.extendFlat({}, frameOrName))\n          });\n        }\n      }\n    } // Verify that all of these frames actually exist; return and reject if not:\n\n\n    for (i = 0; i < frameList.length; i++) {\n      frame = frameList[i];\n\n      if (frame.type === 'byname' && !trans._frameHash[frame.data.name]) {\n        Lib.warn('animate failure: frame not found: \"' + frame.data.name + '\"');\n        reject();\n        return;\n      }\n    } // If the mode is either next or immediate, then all currently queued frames must\n    // be dumped and the corresponding .animate promises rejected.\n\n\n    if (['next', 'immediate'].indexOf(animationOpts.mode) !== -1) {\n      discardExistingFrames();\n    }\n\n    if (animationOpts.direction === 'reverse') {\n      frameList.reverse();\n    }\n\n    var currentFrame = gd._fullLayout._currentFrame;\n\n    if (currentFrame && animationOpts.fromcurrent) {\n      var idx = -1;\n\n      for (i = 0; i < frameList.length; i++) {\n        frame = frameList[i];\n\n        if (frame.type === 'byname' && frame.name === currentFrame) {\n          idx = i;\n          break;\n        }\n      }\n\n      if (idx > 0 && idx < frameList.length - 1) {\n        var filteredFrameList = [];\n\n        for (i = 0; i < frameList.length; i++) {\n          frame = frameList[i];\n\n          if (frameList[i].type !== 'byname' || i > idx) {\n            filteredFrameList.push(frame);\n          }\n        }\n\n        frameList = filteredFrameList;\n      }\n    }\n\n    if (frameList.length > 0) {\n      queueFrames(frameList);\n    } else {\n      // This is the case where there were simply no frames. It's a little strange\n      // since there's not much to do:\n      gd.emit('plotly_animated');\n      resolve();\n    }\n  });\n}\n/**\n * Register new frames\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n *\n * @param {array of objects} frameList\n *      list of frame definitions, in which each object includes any of:\n *      - name: {string} name of frame to add\n *      - data: {array of objects} trace data\n *      - layout {object} layout definition\n *      - traces {array} trace indices\n *      - baseframe {string} name of frame from which this frame gets defaults\n *\n *  @param {array of integers} indices\n *      an array of integer indices matching the respective frames in `frameList`. If not\n *      provided, an index will be provided in serial order. If already used, the frame\n *      will be overwritten.\n */\n\n\nfunction addFrames(gd, frameList, indices) {\n  gd = Lib.getGraphDiv(gd);\n\n  if (frameList === null || frameList === undefined) {\n    return Promise.resolve();\n  }\n\n  if (!Lib.isPlotDiv(gd)) {\n    throw new Error('This element is not a Plotly plot: ' + gd + '. It\\'s likely that you\\'ve failed ' + 'to create a plot before adding frames. For more details, see ' + 'https://plotly.com/javascript/animations/');\n  }\n\n  var i, frame, j, idx;\n  var _frames = gd._transitionData._frames;\n  var _frameHash = gd._transitionData._frameHash;\n\n  if (!Array.isArray(frameList)) {\n    throw new Error('addFrames failure: frameList must be an Array of frame definitions' + frameList);\n  } // Create a sorted list of insertions since we run into lots of problems if these\n  // aren't in ascending order of index:\n  //\n  // Strictly for sorting. Make sure this is guaranteed to never collide with any\n  // already-exisisting indices:\n\n\n  var bigIndex = _frames.length + frameList.length * 2;\n  var insertions = [];\n  var _frameHashLocal = {};\n\n  for (i = frameList.length - 1; i >= 0; i--) {\n    if (!Lib.isPlainObject(frameList[i])) continue; // The entire logic for checking for this type of name collision can be removed once we migrate to ES6 and\n    // use a Map instead of an Object instance, as Map keys aren't converted to strings.\n\n    var lookupName = frameList[i].name;\n    var name = (_frameHash[lookupName] || _frameHashLocal[lookupName] || {}).name;\n    var newName = frameList[i].name;\n    var collisionPresent = _frameHash[name] || _frameHashLocal[name];\n\n    if (name && newName && typeof newName === 'number' && collisionPresent && numericNameWarningCount < numericNameWarningCountLimit) {\n      numericNameWarningCount++;\n      Lib.warn('addFrames: overwriting frame \"' + (_frameHash[name] || _frameHashLocal[name]).name + '\" with a frame whose name of type \"number\" also equates to \"' + name + '\". This is valid but may potentially lead to unexpected ' + 'behavior since all plotly.js frame names are stored internally ' + 'as strings.');\n\n      if (numericNameWarningCount === numericNameWarningCountLimit) {\n        Lib.warn('addFrames: This API call has yielded too many of these warnings. ' + 'For the rest of this call, further warnings about numeric frame ' + 'names will be suppressed.');\n      }\n    }\n\n    _frameHashLocal[lookupName] = {\n      name: lookupName\n    };\n    insertions.push({\n      frame: Plots.supplyFrameDefaults(frameList[i]),\n      index: indices && indices[i] !== undefined && indices[i] !== null ? indices[i] : bigIndex + i\n    });\n  } // Sort this, taking note that undefined insertions end up at the end:\n\n\n  insertions.sort(function (a, b) {\n    if (a.index > b.index) return -1;\n    if (a.index < b.index) return 1;\n    return 0;\n  });\n  var ops = [];\n  var revops = [];\n  var frameCount = _frames.length;\n\n  for (i = insertions.length - 1; i >= 0; i--) {\n    frame = insertions[i].frame;\n\n    if (typeof frame.name === 'number') {\n      Lib.warn('Warning: addFrames accepts frames with numeric names, but the numbers are' + 'implicitly cast to strings');\n    }\n\n    if (!frame.name) {\n      // Repeatedly assign a default name, incrementing the counter each time until\n      // we get a name that's not in the hashed lookup table:\n      while (_frameHash[frame.name = 'frame ' + gd._transitionData._counter++]) {\n        ;\n      }\n    }\n\n    if (_frameHash[frame.name]) {\n      // If frame is present, overwrite its definition:\n      for (j = 0; j < _frames.length; j++) {\n        if ((_frames[j] || {}).name === frame.name) break;\n      }\n\n      ops.push({\n        type: 'replace',\n        index: j,\n        value: frame\n      });\n      revops.unshift({\n        type: 'replace',\n        index: j,\n        value: _frames[j]\n      });\n    } else {\n      // Otherwise insert it at the end of the list:\n      idx = Math.max(0, Math.min(insertions[i].index, frameCount));\n      ops.push({\n        type: 'insert',\n        index: idx,\n        value: frame\n      });\n      revops.unshift({\n        type: 'delete',\n        index: idx\n      });\n      frameCount++;\n    }\n  }\n\n  var undoFunc = Plots.modifyFrames;\n  var redoFunc = Plots.modifyFrames;\n  var undoArgs = [gd, revops];\n  var redoArgs = [gd, ops];\n  if (Queue) Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n  return Plots.modifyFrames(gd, ops);\n}\n/**\n * Delete frame\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n *\n * @param {array of integers} frameList\n *      list of integer indices of frames to be deleted\n */\n\n\nfunction deleteFrames(gd, frameList) {\n  gd = Lib.getGraphDiv(gd);\n\n  if (!Lib.isPlotDiv(gd)) {\n    throw new Error('This element is not a Plotly plot: ' + gd);\n  }\n\n  var i, idx;\n  var _frames = gd._transitionData._frames;\n  var ops = [];\n  var revops = [];\n\n  if (!frameList) {\n    frameList = [];\n\n    for (i = 0; i < _frames.length; i++) {\n      frameList.push(i);\n    }\n  }\n\n  frameList = frameList.slice();\n  frameList.sort();\n\n  for (i = frameList.length - 1; i >= 0; i--) {\n    idx = frameList[i];\n    ops.push({\n      type: 'delete',\n      index: idx\n    });\n    revops.unshift({\n      type: 'insert',\n      index: idx,\n      value: _frames[idx]\n    });\n  }\n\n  var undoFunc = Plots.modifyFrames;\n  var redoFunc = Plots.modifyFrames;\n  var undoArgs = [gd, revops];\n  var redoArgs = [gd, ops];\n  if (Queue) Queue.add(gd, undoFunc, undoArgs, redoFunc, redoArgs);\n  return Plots.modifyFrames(gd, ops);\n}\n/**\n * Purge a graph container div back to its initial pre-Plotly.plot state\n *\n * @param {string id or DOM element} gd\n *      the id or DOM element of the graph container div\n */\n\n\nfunction purge(gd) {\n  gd = Lib.getGraphDiv(gd);\n  var fullLayout = gd._fullLayout || {};\n  var fullData = gd._fullData || []; // remove gl contexts\n\n  Plots.cleanPlot([], {}, fullData, fullLayout); // purge properties\n\n  Plots.purge(gd); // purge event emitter methods\n\n  Events.purge(gd); // remove plot container\n\n  if (fullLayout._container) fullLayout._container.remove(); // in contrast to Plotly.Plots.purge which does NOT clear _context!\n\n  delete gd._context;\n  return gd;\n} // -------------------------------------------------------\n// makePlotFramework: Create the plot container and axes\n// -------------------------------------------------------\n\n\nfunction makePlotFramework(gd) {\n  var gd3 = d3.select(gd);\n  var fullLayout = gd._fullLayout; // Plot container\n\n  fullLayout._container = gd3.selectAll('.plot-container').data([0]);\n\n  fullLayout._container.enter().insert('div', ':first-child').classed('plot-container', true).classed('plotly', true); // Make the svg container\n\n\n  fullLayout._paperdiv = fullLayout._container.selectAll('.svg-container').data([0]);\n\n  fullLayout._paperdiv.enter().append('div').classed('svg-container', true).style('position', 'relative'); // Make the graph containers\n  // start fresh each time we get here, so we know the order comes out\n  // right, rather than enter/exit which can muck up the order\n  // TODO: sort out all the ordering so we don't have to\n  // explicitly delete anything\n  // FIXME: parcoords reuses this object, not the best pattern\n\n\n  fullLayout._glcontainer = fullLayout._paperdiv.selectAll('.gl-container').data([{}]);\n\n  fullLayout._glcontainer.enter().append('div').classed('gl-container', true);\n\n  fullLayout._paperdiv.selectAll('.main-svg').remove();\n\n  fullLayout._paperdiv.select('.modebar-container').remove();\n\n  fullLayout._paper = fullLayout._paperdiv.insert('svg', ':first-child').classed('main-svg', true);\n  fullLayout._toppaper = fullLayout._paperdiv.append('svg').classed('main-svg', true);\n  fullLayout._modebardiv = fullLayout._paperdiv.append('div');\n  fullLayout._hoverpaper = fullLayout._paperdiv.append('svg').classed('main-svg', true);\n\n  if (!fullLayout._uid) {\n    var otherUids = {};\n    d3.selectAll('defs').each(function () {\n      if (this.id) otherUids[this.id.split('-')[1]] = 1;\n    });\n    fullLayout._uid = Lib.randstr(otherUids);\n  }\n\n  fullLayout._paperdiv.selectAll('.main-svg').attr(xmlnsNamespaces.svgAttrs);\n\n  fullLayout._defs = fullLayout._paper.append('defs').attr('id', 'defs-' + fullLayout._uid);\n  fullLayout._clips = fullLayout._defs.append('g').classed('clips', true);\n  fullLayout._topdefs = fullLayout._toppaper.append('defs').attr('id', 'topdefs-' + fullLayout._uid);\n  fullLayout._topclips = fullLayout._topdefs.append('g').classed('clips', true);\n  fullLayout._bgLayer = fullLayout._paper.append('g').classed('bglayer', true);\n  fullLayout._draggers = fullLayout._paper.append('g').classed('draglayer', true); // lower shape/image layer - note that this is behind\n  // all subplots data/grids but above the backgrounds\n  // except inset subplots, whose backgrounds are drawn\n  // inside their own group so that they appear above\n  // the data for the main subplot\n  // lower shapes and images which are fully referenced to\n  // a subplot still get drawn within the subplot's group\n  // so they will work correctly on insets\n\n  var layerBelow = fullLayout._paper.append('g').classed('layer-below', true);\n\n  fullLayout._imageLowerLayer = layerBelow.append('g').classed('imagelayer', true);\n  fullLayout._shapeLowerLayer = layerBelow.append('g').classed('shapelayer', true); // single cartesian layer for the whole plot\n\n  fullLayout._cartesianlayer = fullLayout._paper.append('g').classed('cartesianlayer', true); // single polar layer for the whole plot\n\n  fullLayout._polarlayer = fullLayout._paper.append('g').classed('polarlayer', true); // single ternary layer for the whole plot\n\n  fullLayout._ternarylayer = fullLayout._paper.append('g').classed('ternarylayer', true); // single geo layer for the whole plot\n\n  fullLayout._geolayer = fullLayout._paper.append('g').classed('geolayer', true); // single funnelarea layer for the whole plot\n\n  fullLayout._funnelarealayer = fullLayout._paper.append('g').classed('funnelarealayer', true); // single pie layer for the whole plot\n\n  fullLayout._pielayer = fullLayout._paper.append('g').classed('pielayer', true); // single treemap layer for the whole plot\n\n  fullLayout._treemaplayer = fullLayout._paper.append('g').classed('treemaplayer', true); // single sunburst layer for the whole plot\n\n  fullLayout._sunburstlayer = fullLayout._paper.append('g').classed('sunburstlayer', true); // single indicator layer for the whole plot\n\n  fullLayout._indicatorlayer = fullLayout._toppaper.append('g').classed('indicatorlayer', true); // fill in image server scrape-svg\n\n  fullLayout._glimages = fullLayout._paper.append('g').classed('glimages', true); // lastly upper shapes, info (legend, annotations) and hover layers go on top\n  // these are in a different svg element normally, but get collapsed into a single\n  // svg when exporting (after inserting 3D)\n  // upper shapes/images are only those drawn above the whole plot, including subplots\n\n  var layerAbove = fullLayout._toppaper.append('g').classed('layer-above', true);\n\n  fullLayout._imageUpperLayer = layerAbove.append('g').classed('imagelayer', true);\n  fullLayout._shapeUpperLayer = layerAbove.append('g').classed('shapelayer', true);\n  fullLayout._infolayer = fullLayout._toppaper.append('g').classed('infolayer', true);\n  fullLayout._menulayer = fullLayout._toppaper.append('g').classed('menulayer', true);\n  fullLayout._zoomlayer = fullLayout._toppaper.append('g').classed('zoomlayer', true);\n  fullLayout._hoverlayer = fullLayout._hoverpaper.append('g').classed('hoverlayer', true); // Make the modebar container\n\n  fullLayout._modebardiv.classed('modebar-container', true).style('position', 'absolute').style('top', '0px').style('right', '0px');\n\n  gd.emit('plotly_framework');\n}\n\nexports.animate = animate;\nexports.addFrames = addFrames;\nexports.deleteFrames = deleteFrames;\nexports.addTraces = addTraces;\nexports.deleteTraces = deleteTraces;\nexports.extendTraces = extendTraces;\nexports.moveTraces = moveTraces;\nexports.prependTraces = prependTraces;\nexports.newPlot = newPlot;\nexports.plot = plot;\nexports.purge = purge;\nexports.react = react;\nexports.redraw = redraw;\nexports.relayout = relayout;\nexports.restyle = restyle;\nexports.setPlotConfig = setPlotConfig;\nexports.update = update;\nexports._guiRelayout = guiEdit(relayout);\nexports._guiRestyle = guiEdit(restyle);\nexports._guiUpdate = guiEdit(update);\nexports._storeDirectGUIEdit = _storeDirectGUIEdit;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar ARROWPATHS = require('./arrow_paths');\n\nvar fontAttrs = require('../../plots/font_attributes');\n\nvar cartesianConstants = require('../../plots/cartesian/constants');\n\nvar templatedArray = require('../../plot_api/plot_template').templatedArray;\n\nmodule.exports = templatedArray('annotation', {\n  visible: {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    editType: 'calc+arraydraw',\n    description: ['Determines whether or not this annotation is visible.'].join(' ')\n  },\n  text: {\n    valType: 'string',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the text associated with this annotation.', 'Plotly uses a subset of HTML tags to do things like', 'newline (<br>), bold (<b></b>), italics (<i></i>),', 'hyperlinks (<a href=\\'...\\'></a>). Tags <em>, <sup>, <sub>', '<span> are also supported.'].join(' ')\n  },\n  textangle: {\n    valType: 'angle',\n    dflt: 0,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets the angle at which the `text` is drawn', 'with respect to the horizontal.'].join(' ')\n  },\n  font: fontAttrs({\n    editType: 'calc+arraydraw',\n    colorEditType: 'arraydraw',\n    description: 'Sets the annotation text font.'\n  }),\n  width: {\n    valType: 'number',\n    min: 1,\n    dflt: null,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets an explicit width for the text box. null (default) lets the', 'text set the box width. Wider text will be clipped.', 'There is no automatic wrapping; use <br> to start a new line.'].join(' ')\n  },\n  height: {\n    valType: 'number',\n    min: 1,\n    dflt: null,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets an explicit height for the text box. null (default) lets the', 'text set the box height. Taller text will be clipped.'].join(' ')\n  },\n  opacity: {\n    valType: 'number',\n    min: 0,\n    max: 1,\n    dflt: 1,\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the opacity of the annotation (text + arrow).'\n  },\n  align: {\n    valType: 'enumerated',\n    values: ['left', 'center', 'right'],\n    dflt: 'center',\n    role: 'style',\n    editType: 'arraydraw',\n    description: ['Sets the horizontal alignment of the `text` within the box.', 'Has an effect only if `text` spans two or more lines', '(i.e. `text` contains one or more <br> HTML tags) or if an', 'explicit width is set to override the text width.'].join(' ')\n  },\n  valign: {\n    valType: 'enumerated',\n    values: ['top', 'middle', 'bottom'],\n    dflt: 'middle',\n    role: 'style',\n    editType: 'arraydraw',\n    description: ['Sets the vertical alignment of the `text` within the box.', 'Has an effect only if an explicit height is set to override', 'the text height.'].join(' ')\n  },\n  bgcolor: {\n    valType: 'color',\n    dflt: 'rgba(0,0,0,0)',\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the background color of the annotation.'\n  },\n  bordercolor: {\n    valType: 'color',\n    dflt: 'rgba(0,0,0,0)',\n    role: 'style',\n    editType: 'arraydraw',\n    description: ['Sets the color of the border enclosing the annotation `text`.'].join(' ')\n  },\n  borderpad: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets the padding (in px) between the `text`', 'and the enclosing border.'].join(' ')\n  },\n  borderwidth: {\n    valType: 'number',\n    min: 0,\n    dflt: 1,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets the width (in px) of the border enclosing', 'the annotation `text`.'].join(' ')\n  },\n  // arrow\n  showarrow: {\n    valType: 'boolean',\n    dflt: true,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Determines whether or not the annotation is drawn with an arrow.', 'If *true*, `text` is placed near the arrow\\'s tail.', 'If *false*, `text` lines up with the `x` and `y` provided.'].join(' ')\n  },\n  arrowcolor: {\n    valType: 'color',\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the color of the annotation arrow.'\n  },\n  arrowhead: {\n    valType: 'integer',\n    min: 0,\n    max: ARROWPATHS.length,\n    dflt: 1,\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the end annotation arrow head style.'\n  },\n  startarrowhead: {\n    valType: 'integer',\n    min: 0,\n    max: ARROWPATHS.length,\n    dflt: 1,\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the start annotation arrow head style.'\n  },\n  arrowside: {\n    valType: 'flaglist',\n    flags: ['end', 'start'],\n    extras: ['none'],\n    dflt: 'end',\n    role: 'style',\n    editType: 'arraydraw',\n    description: 'Sets the annotation arrow head position.'\n  },\n  arrowsize: {\n    valType: 'number',\n    min: 0.3,\n    dflt: 1,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets the size of the end annotation arrow head, relative to `arrowwidth`.', 'A value of 1 (default) gives a head about 3x as wide as the line.'].join(' ')\n  },\n  startarrowsize: {\n    valType: 'number',\n    min: 0.3,\n    dflt: 1,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets the size of the start annotation arrow head, relative to `arrowwidth`.', 'A value of 1 (default) gives a head about 3x as wide as the line.'].join(' ')\n  },\n  arrowwidth: {\n    valType: 'number',\n    min: 0.1,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: 'Sets the width (in px) of annotation arrow line.'\n  },\n  standoff: {\n    valType: 'number',\n    min: 0,\n    dflt: 0,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets a distance, in pixels, to move the end arrowhead away from the', 'position it is pointing at, for example to point at the edge of', 'a marker independent of zoom. Note that this shortens the arrow', 'from the `ax` / `ay` vector, in contrast to `xshift` / `yshift`', 'which moves everything by this amount.'].join(' ')\n  },\n  startstandoff: {\n    valType: 'number',\n    min: 0,\n    dflt: 0,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Sets a distance, in pixels, to move the start arrowhead away from the', 'position it is pointing at, for example to point at the edge of', 'a marker independent of zoom. Note that this shortens the arrow', 'from the `ax` / `ay` vector, in contrast to `xshift` / `yshift`', 'which moves everything by this amount.'].join(' ')\n  },\n  ax: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the x component of the arrow tail about the arrow head.', 'If `axref` is `pixel`, a positive (negative) ', 'component corresponds to an arrow pointing', 'from right to left (left to right).', 'If `axref` is an axis, this is an absolute value on that axis,', 'like `x`, NOT a relative value.'].join(' ')\n  },\n  ay: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the y component of the arrow tail about the arrow head.', 'If `ayref` is `pixel`, a positive (negative) ', 'component corresponds to an arrow pointing', 'from bottom to top (top to bottom).', 'If `ayref` is an axis, this is an absolute value on that axis,', 'like `y`, NOT a relative value.'].join(' ')\n  },\n  axref: {\n    valType: 'enumerated',\n    dflt: 'pixel',\n    values: ['pixel', cartesianConstants.idRegex.x.toString()],\n    role: 'info',\n    editType: 'calc',\n    description: ['Indicates in what terms the tail of the annotation (ax,ay) ', 'is specified. If `pixel`, `ax` is a relative offset in pixels ', 'from `x`. If set to an x axis id (e.g. *x* or *x2*), `ax` is ', 'specified in the same terms as that axis. This is useful ', 'for trendline annotations which should continue to indicate ', 'the correct trend when zoomed.'].join(' ')\n  },\n  ayref: {\n    valType: 'enumerated',\n    dflt: 'pixel',\n    values: ['pixel', cartesianConstants.idRegex.y.toString()],\n    role: 'info',\n    editType: 'calc',\n    description: ['Indicates in what terms the tail of the annotation (ax,ay) ', 'is specified. If `pixel`, `ay` is a relative offset in pixels ', 'from `y`. If set to a y axis id (e.g. *y* or *y2*), `ay` is ', 'specified in the same terms as that axis. This is useful ', 'for trendline annotations which should continue to indicate ', 'the correct trend when zoomed.'].join(' ')\n  },\n  // positioning\n  xref: {\n    valType: 'enumerated',\n    values: ['paper', cartesianConstants.idRegex.x.toString()],\n    role: 'info',\n    editType: 'calc',\n    description: ['Sets the annotation\\'s x coordinate axis.', 'If set to an x axis id (e.g. *x* or *x2*), the `x` position', 'refers to an x coordinate', 'If set to *paper*, the `x` position refers to the distance from', 'the left side of the plotting area in normalized coordinates', 'where 0 (1) corresponds to the left (right) side.'].join(' ')\n  },\n  x: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the annotation\\'s x position.', 'If the axis `type` is *log*, then you must take the', 'log of your desired range.', 'If the axis `type` is *date*, it should be date strings,', 'like date data, though Date objects and unix milliseconds', 'will be accepted and converted to strings.', 'If the axis `type` is *category*, it should be numbers,', 'using the scale where each category is assigned a serial', 'number from zero in the order it appears.'].join(' ')\n  },\n  xanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'left', 'center', 'right'],\n    dflt: 'auto',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the text box\\'s horizontal position anchor', 'This anchor binds the `x` position to the *left*, *center*', 'or *right* of the annotation.', 'For example, if `x` is set to 1, `xref` to *paper* and', '`xanchor` to *right* then the right-most portion of the', 'annotation lines up with the right-most edge of the', 'plotting area.', 'If *auto*, the anchor is equivalent to *center* for', 'data-referenced annotations or if there is an arrow,', 'whereas for paper-referenced with no arrow, the anchor picked', 'corresponds to the closest side.'].join(' ')\n  },\n  xshift: {\n    valType: 'number',\n    dflt: 0,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Shifts the position of the whole annotation and arrow to the', 'right (positive) or left (negative) by this many pixels.'].join(' ')\n  },\n  yref: {\n    valType: 'enumerated',\n    values: ['paper', cartesianConstants.idRegex.y.toString()],\n    role: 'info',\n    editType: 'calc',\n    description: ['Sets the annotation\\'s y coordinate axis.', 'If set to an y axis id (e.g. *y* or *y2*), the `y` position', 'refers to an y coordinate', 'If set to *paper*, the `y` position refers to the distance from', 'the bottom of the plotting area in normalized coordinates', 'where 0 (1) corresponds to the bottom (top).'].join(' ')\n  },\n  y: {\n    valType: 'any',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the annotation\\'s y position.', 'If the axis `type` is *log*, then you must take the', 'log of your desired range.', 'If the axis `type` is *date*, it should be date strings,', 'like date data, though Date objects and unix milliseconds', 'will be accepted and converted to strings.', 'If the axis `type` is *category*, it should be numbers,', 'using the scale where each category is assigned a serial', 'number from zero in the order it appears.'].join(' ')\n  },\n  yanchor: {\n    valType: 'enumerated',\n    values: ['auto', 'top', 'middle', 'bottom'],\n    dflt: 'auto',\n    role: 'info',\n    editType: 'calc+arraydraw',\n    description: ['Sets the text box\\'s vertical position anchor', 'This anchor binds the `y` position to the *top*, *middle*', 'or *bottom* of the annotation.', 'For example, if `y` is set to 1, `yref` to *paper* and', '`yanchor` to *top* then the top-most portion of the', 'annotation lines up with the top-most edge of the', 'plotting area.', 'If *auto*, the anchor is equivalent to *middle* for', 'data-referenced annotations or if there is an arrow,', 'whereas for paper-referenced with no arrow, the anchor picked', 'corresponds to the closest side.'].join(' ')\n  },\n  yshift: {\n    valType: 'number',\n    dflt: 0,\n    role: 'style',\n    editType: 'calc+arraydraw',\n    description: ['Shifts the position of the whole annotation and arrow up', '(positive) or down (negative) by this many pixels.'].join(' ')\n  },\n  clicktoshow: {\n    valType: 'enumerated',\n    values: [false, 'onoff', 'onout'],\n    dflt: false,\n    role: 'style',\n    editType: 'arraydraw',\n    description: ['Makes this annotation respond to clicks on the plot.', 'If you click a data point that exactly matches the `x` and `y`', 'values of this annotation, and it is hidden (visible: false),', 'it will appear. In *onoff* mode, you must click the same point', 'again to make it disappear, so if you click multiple points,', 'you can show multiple annotations. In *onout* mode, a click', 'anywhere else in the plot (on another data point or not) will', 'hide this annotation.', 'If you need to show/hide this annotation in response to different', '`x` or `y` values, you can set `xclick` and/or `yclick`. This is', 'useful for example to label the side of a bar. To label markers', 'though, `standoff` is preferred over `xclick` and `yclick`.'].join(' ')\n  },\n  xclick: {\n    valType: 'any',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Toggle this annotation when clicking a data point whose `x` value', 'is `xclick` rather than the annotation\\'s `x` value.'].join(' ')\n  },\n  yclick: {\n    valType: 'any',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Toggle this annotation when clicking a data point whose `y` value', 'is `yclick` rather than the annotation\\'s `y` value.'].join(' ')\n  },\n  hovertext: {\n    valType: 'string',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Sets text to appear when hovering over this annotation.', 'If omitted or blank, no hover label will appear.'].join(' ')\n  },\n  hoverlabel: {\n    bgcolor: {\n      valType: 'color',\n      role: 'style',\n      editType: 'arraydraw',\n      description: ['Sets the background color of the hover label.', 'By default uses the annotation\\'s `bgcolor` made opaque,', 'or white if it was transparent.'].join(' ')\n    },\n    bordercolor: {\n      valType: 'color',\n      role: 'style',\n      editType: 'arraydraw',\n      description: ['Sets the border color of the hover label.', 'By default uses either dark grey or white, for maximum', 'contrast with `hoverlabel.bgcolor`.'].join(' ')\n    },\n    font: fontAttrs({\n      editType: 'arraydraw',\n      description: ['Sets the hover label text font.', 'By default uses the global hover font and size,', 'with color from `hoverlabel.bordercolor`.'].join(' ')\n    }),\n    editType: 'arraydraw'\n  },\n  captureevents: {\n    valType: 'boolean',\n    role: 'info',\n    editType: 'arraydraw',\n    description: ['Determines whether the annotation text box captures mouse move', 'and click events, or allows those events to pass through to data', 'points in the plot that may be behind the annotation. By default', '`captureevents` is *false* unless `hovertext` is provided.', 'If you use the event `plotly_clickannotation` without `hovertext`', 'you must explicitly enable `captureevents`.'].join(' ')\n  },\n  editType: 'calc',\n  _deprecated: {\n    ref: {\n      valType: 'string',\n      role: 'info',\n      editType: 'calc',\n      description: ['Obsolete. Set `xref` and `yref` separately instead.'].join(' ')\n    }\n  }\n});","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar handleAnnotationCommonDefaults = require('./common_defaults');\n\nvar attributes = require('./attributes');\n\nmodule.exports = function supplyLayoutDefaults(layoutIn, layoutOut) {\n  handleArrayContainerDefaults(layoutIn, layoutOut, {\n    name: 'annotations',\n    handleItemDefaults: handleAnnotationDefaults\n  });\n};\n\nfunction handleAnnotationDefaults(annIn, annOut, fullLayout) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(annIn, annOut, attributes, attr, dflt);\n  }\n\n  var visible = coerce('visible');\n  var clickToShow = coerce('clicktoshow');\n  if (!(visible || clickToShow)) return;\n  handleAnnotationCommonDefaults(annIn, annOut, fullLayout, coerce);\n  var showArrow = annOut.showarrow; // positioning\n\n  var axLetters = ['x', 'y'];\n  var arrowPosDflt = [-10, -30];\n  var gdMock = {\n    _fullLayout: fullLayout\n  };\n\n  for (var i = 0; i < 2; i++) {\n    var axLetter = axLetters[i]; // xref, yref\n\n    var axRef = Axes.coerceRef(annIn, annOut, gdMock, axLetter, '', 'paper');\n\n    if (axRef !== 'paper') {\n      var ax = Axes.getFromId(gdMock, axRef);\n\n      ax._annIndices.push(annOut._index);\n    } // x, y\n\n\n    Axes.coercePosition(annOut, gdMock, coerce, axRef, axLetter, 0.5);\n\n    if (showArrow) {\n      var arrowPosAttr = 'a' + axLetter; // axref, ayref\n\n      var aaxRef = Axes.coerceRef(annIn, annOut, gdMock, arrowPosAttr, 'pixel'); // for now the arrow can only be on the same axis or specified as pixels\n      // TODO: sometime it might be interesting to allow it to be on *any* axis\n      // but that would require updates to drawing & autorange code and maybe more\n\n      if (aaxRef !== 'pixel' && aaxRef !== axRef) {\n        aaxRef = annOut[arrowPosAttr] = 'pixel';\n      } // ax, ay\n\n\n      var aDflt = aaxRef === 'pixel' ? arrowPosDflt[i] : 0.4;\n      Axes.coercePosition(annOut, gdMock, coerce, aaxRef, arrowPosAttr, aDflt);\n    } // xanchor, yanchor\n\n\n    coerce(axLetter + 'anchor'); // xshift, yshift\n\n    coerce(axLetter + 'shift');\n  } // if you have one coordinate you should have both\n\n\n  Lib.noneOrAll(annIn, annOut, ['x', 'y']); // if you have one part of arrow length you should have both\n\n  if (showArrow) {\n    Lib.noneOrAll(annIn, annOut, ['ax', 'ay']);\n  }\n\n  if (clickToShow) {\n    var xClick = coerce('xclick');\n    var yClick = coerce('yclick'); // put the actual click data to bind to into private attributes\n    // so we don't have to do this little bit of logic on every hover event\n\n    annOut._xclick = xClick === undefined ? annOut.x : Axes.cleanPosition(xClick, gdMock, annOut.xref);\n    annOut._yclick = yClick === undefined ? annOut.y : Axes.cleanPosition(yClick, gdMock, annOut.yref);\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nmodule.exports = require('../src/core');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar m4FromQuat = require('gl-mat4/fromQuat');\n\nvar Registry = require('../registry');\n\nvar Lib = require('../lib');\n\nvar Plots = require('../plots/plots');\n\nvar AxisIds = require('../plots/cartesian/axis_ids');\n\nvar Color = require('../components/color');\n\nvar cleanId = AxisIds.cleanId;\nvar getFromTrace = AxisIds.getFromTrace;\nvar traceIs = Registry.traceIs; // clear the promise queue if one of them got rejected\n\nexports.clearPromiseQueue = function (gd) {\n  if (Array.isArray(gd._promises) && gd._promises.length > 0) {\n    Lib.log('Clearing previous rejected promises from queue.');\n  }\n\n  gd._promises = [];\n}; // make a few changes to the layout right away\n// before it gets used for anything\n// backward compatibility and cleanup of nonstandard options\n\n\nexports.cleanLayout = function (layout) {\n  var i, j;\n  if (!layout) layout = {}; // cannot have (x|y)axis1, numbering goes axis, axis2, axis3...\n\n  if (layout.xaxis1) {\n    if (!layout.xaxis) layout.xaxis = layout.xaxis1;\n    delete layout.xaxis1;\n  }\n\n  if (layout.yaxis1) {\n    if (!layout.yaxis) layout.yaxis = layout.yaxis1;\n    delete layout.yaxis1;\n  }\n\n  if (layout.scene1) {\n    if (!layout.scene) layout.scene = layout.scene1;\n    delete layout.scene1;\n  }\n\n  var axisAttrRegex = (Plots.subplotsRegistry.cartesian || {}).attrRegex;\n  var polarAttrRegex = (Plots.subplotsRegistry.polar || {}).attrRegex;\n  var ternaryAttrRegex = (Plots.subplotsRegistry.ternary || {}).attrRegex;\n  var sceneAttrRegex = (Plots.subplotsRegistry.gl3d || {}).attrRegex;\n  var keys = Object.keys(layout);\n\n  for (i = 0; i < keys.length; i++) {\n    var key = keys[i];\n\n    if (axisAttrRegex && axisAttrRegex.test(key)) {\n      // modifications to cartesian axes\n      var ax = layout[key];\n\n      if (ax.anchor && ax.anchor !== 'free') {\n        ax.anchor = cleanId(ax.anchor);\n      }\n\n      if (ax.overlaying) ax.overlaying = cleanId(ax.overlaying); // old method of axis type - isdate and islog (before category existed)\n\n      if (!ax.type) {\n        if (ax.isdate) ax.type = 'date';else if (ax.islog) ax.type = 'log';else if (ax.isdate === false && ax.islog === false) ax.type = 'linear';\n      }\n\n      if (ax.autorange === 'withzero' || ax.autorange === 'tozero') {\n        ax.autorange = true;\n        ax.rangemode = 'tozero';\n      }\n\n      delete ax.islog;\n      delete ax.isdate;\n      delete ax.categories; // replaced by _categories\n      // prune empty domain arrays made before the new nestedProperty\n\n      if (emptyContainer(ax, 'domain')) delete ax.domain; // autotick -> tickmode\n\n      if (ax.autotick !== undefined) {\n        if (ax.tickmode === undefined) {\n          ax.tickmode = ax.autotick ? 'auto' : 'linear';\n        }\n\n        delete ax.autotick;\n      }\n\n      cleanTitle(ax);\n    } else if (polarAttrRegex && polarAttrRegex.test(key)) {\n      // modifications for polar\n      var polar = layout[key];\n      cleanTitle(polar.radialaxis);\n    } else if (ternaryAttrRegex && ternaryAttrRegex.test(key)) {\n      // modifications for ternary\n      var ternary = layout[key];\n      cleanTitle(ternary.aaxis);\n      cleanTitle(ternary.baxis);\n      cleanTitle(ternary.caxis);\n    } else if (sceneAttrRegex && sceneAttrRegex.test(key)) {\n      // modifications for 3D scenes\n      var scene = layout[key]; // clean old Camera coords\n\n      var cameraposition = scene.cameraposition;\n\n      if (Array.isArray(cameraposition) && cameraposition[0].length === 4) {\n        var rotation = cameraposition[0];\n        var center = cameraposition[1];\n        var radius = cameraposition[2];\n        var mat = m4FromQuat([], rotation);\n        var eye = [];\n\n        for (j = 0; j < 3; ++j) {\n          eye[j] = center[j] + radius * mat[2 + 4 * j];\n        }\n\n        scene.camera = {\n          eye: {\n            x: eye[0],\n            y: eye[1],\n            z: eye[2]\n          },\n          center: {\n            x: center[0],\n            y: center[1],\n            z: center[2]\n          },\n          up: {\n            x: 0,\n            y: 0,\n            z: 1\n          } // we just ignore calculating camera z up in this case\n\n        };\n        delete scene.cameraposition;\n      } // clean axis titles\n\n\n      cleanTitle(scene.xaxis);\n      cleanTitle(scene.yaxis);\n      cleanTitle(scene.zaxis);\n    }\n  }\n\n  var annotationsLen = Array.isArray(layout.annotations) ? layout.annotations.length : 0;\n\n  for (i = 0; i < annotationsLen; i++) {\n    var ann = layout.annotations[i];\n    if (!Lib.isPlainObject(ann)) continue;\n\n    if (ann.ref) {\n      if (ann.ref === 'paper') {\n        ann.xref = 'paper';\n        ann.yref = 'paper';\n      } else if (ann.ref === 'data') {\n        ann.xref = 'x';\n        ann.yref = 'y';\n      }\n\n      delete ann.ref;\n    }\n\n    cleanAxRef(ann, 'xref');\n    cleanAxRef(ann, 'yref');\n  }\n\n  var shapesLen = Array.isArray(layout.shapes) ? layout.shapes.length : 0;\n\n  for (i = 0; i < shapesLen; i++) {\n    var shape = layout.shapes[i];\n    if (!Lib.isPlainObject(shape)) continue;\n    cleanAxRef(shape, 'xref');\n    cleanAxRef(shape, 'yref');\n  }\n\n  var legend = layout.legend;\n\n  if (legend) {\n    // check for old-style legend positioning (x or y is +/- 100)\n    if (legend.x > 3) {\n      legend.x = 1.02;\n      legend.xanchor = 'left';\n    } else if (legend.x < -2) {\n      legend.x = -0.02;\n      legend.xanchor = 'right';\n    }\n\n    if (legend.y > 3) {\n      legend.y = 1.02;\n      legend.yanchor = 'bottom';\n    } else if (legend.y < -2) {\n      legend.y = -0.02;\n      legend.yanchor = 'top';\n    }\n  } // clean plot title\n\n\n  cleanTitle(layout);\n  /*\n   * Moved from rotate -> orbit for dragmode\n   */\n\n  if (layout.dragmode === 'rotate') layout.dragmode = 'orbit'; // sanitize rgb(fractions) and rgba(fractions) that old tinycolor\n  // supported, but new tinycolor does not because they're not valid css\n\n  Color.clean(layout); // clean the layout container in layout.template\n\n  if (layout.template && layout.template.layout) {\n    exports.cleanLayout(layout.template.layout);\n  }\n\n  return layout;\n};\n\nfunction cleanAxRef(container, attr) {\n  var valIn = container[attr];\n  var axLetter = attr.charAt(0);\n\n  if (valIn && valIn !== 'paper') {\n    container[attr] = cleanId(valIn, axLetter);\n  }\n}\n/**\n * Cleans up old title attribute structure (flat) in favor of the new one (nested).\n *\n * @param {Object} titleContainer - an object potentially including deprecated title attributes\n */\n\n\nfunction cleanTitle(titleContainer) {\n  if (titleContainer) {\n    // title -> title.text\n    // (although title used to be a string attribute,\n    // numbers are accepted as well)\n    if (typeof titleContainer.title === 'string' || typeof titleContainer.title === 'number') {\n      titleContainer.title = {\n        text: titleContainer.title\n      };\n    }\n\n    rewireAttr('titlefont', 'font');\n    rewireAttr('titleposition', 'position');\n    rewireAttr('titleside', 'side');\n    rewireAttr('titleoffset', 'offset');\n  }\n\n  function rewireAttr(oldAttrName, newAttrName) {\n    var oldAttrSet = titleContainer[oldAttrName];\n    var newAttrSet = titleContainer.title && titleContainer.title[newAttrName];\n\n    if (oldAttrSet && !newAttrSet) {\n      // Ensure title object exists\n      if (!titleContainer.title) {\n        titleContainer.title = {};\n      }\n\n      titleContainer.title[newAttrName] = titleContainer[oldAttrName];\n      delete titleContainer[oldAttrName];\n    }\n  }\n}\n/*\n * cleanData: Make a few changes to the data for backward compatibility\n * before it gets used for anything. Modifies the data traces users provide.\n *\n * Important: if you're going to add something here that modifies a data array,\n * update it in place so the new array === the old one.\n */\n\n\nexports.cleanData = function (data) {\n  for (var tracei = 0; tracei < data.length; tracei++) {\n    var trace = data[tracei];\n    var i; // use xbins to bin data in x, and ybins to bin data in y\n\n    if (trace.type === 'histogramy' && 'xbins' in trace && !('ybins' in trace)) {\n      trace.ybins = trace.xbins;\n      delete trace.xbins;\n    } // error_y.opacity is obsolete - merge into color\n\n\n    if (trace.error_y && 'opacity' in trace.error_y) {\n      var dc = Color.defaults;\n      var yeColor = trace.error_y.color || (traceIs(trace, 'bar') ? Color.defaultLine : dc[tracei % dc.length]);\n      trace.error_y.color = Color.addOpacity(Color.rgb(yeColor), Color.opacity(yeColor) * trace.error_y.opacity);\n      delete trace.error_y.opacity;\n    } // convert bardir to orientation, and put the data into\n    // the axes it's eventually going to be used with\n\n\n    if ('bardir' in trace) {\n      if (trace.bardir === 'h' && (traceIs(trace, 'bar') || trace.type.substr(0, 9) === 'histogram')) {\n        trace.orientation = 'h';\n        exports.swapXYData(trace);\n      }\n\n      delete trace.bardir;\n    } // now we have only one 1D histogram type, and whether\n    // it uses x or y data depends on trace.orientation\n\n\n    if (trace.type === 'histogramy') exports.swapXYData(trace);\n\n    if (trace.type === 'histogramx' || trace.type === 'histogramy') {\n      trace.type = 'histogram';\n    } // scl->scale, reversescl->reversescale\n\n\n    if ('scl' in trace && !('colorscale' in trace)) {\n      trace.colorscale = trace.scl;\n      delete trace.scl;\n    }\n\n    if ('reversescl' in trace && !('reversescale' in trace)) {\n      trace.reversescale = trace.reversescl;\n      delete trace.reversescl;\n    } // axis ids x1 -> x, y1-> y\n\n\n    if (trace.xaxis) trace.xaxis = cleanId(trace.xaxis, 'x');\n    if (trace.yaxis) trace.yaxis = cleanId(trace.yaxis, 'y'); // scene ids scene1 -> scene\n\n    if (traceIs(trace, 'gl3d') && trace.scene) {\n      trace.scene = Plots.subplotsRegistry.gl3d.cleanId(trace.scene);\n    }\n\n    if (!traceIs(trace, 'pie-like') && !traceIs(trace, 'bar-like')) {\n      if (Array.isArray(trace.textposition)) {\n        for (i = 0; i < trace.textposition.length; i++) {\n          trace.textposition[i] = cleanTextPosition(trace.textposition[i]);\n        }\n      } else if (trace.textposition) {\n        trace.textposition = cleanTextPosition(trace.textposition);\n      }\n    } // fix typo in colorscale definition\n\n\n    var _module = Registry.getModule(trace);\n\n    if (_module && _module.colorbar) {\n      var containerName = _module.colorbar.container;\n      var container = containerName ? trace[containerName] : trace;\n\n      if (container && container.colorscale) {\n        if (container.colorscale === 'YIGnBu') container.colorscale = 'YlGnBu';\n        if (container.colorscale === 'YIOrRd') container.colorscale = 'YlOrRd';\n      }\n    } // fix typo in surface 'highlight*' definitions\n\n\n    if (trace.type === 'surface' && Lib.isPlainObject(trace.contours)) {\n      var dims = ['x', 'y', 'z'];\n\n      for (i = 0; i < dims.length; i++) {\n        var opts = trace.contours[dims[i]];\n        if (!Lib.isPlainObject(opts)) continue;\n\n        if (opts.highlightColor) {\n          opts.highlightcolor = opts.highlightColor;\n          delete opts.highlightColor;\n        }\n\n        if (opts.highlightWidth) {\n          opts.highlightwidth = opts.highlightWidth;\n          delete opts.highlightWidth;\n        }\n      }\n    } // fixes from converting finance from transforms to real trace types\n\n\n    if (trace.type === 'candlestick' || trace.type === 'ohlc') {\n      var increasingShowlegend = (trace.increasing || {}).showlegend !== false;\n      var decreasingShowlegend = (trace.decreasing || {}).showlegend !== false;\n      var increasingName = cleanFinanceDir(trace.increasing);\n      var decreasingName = cleanFinanceDir(trace.decreasing); // now figure out something smart to do with the separate direction\n      // names we removed\n\n      if (increasingName !== false && decreasingName !== false) {\n        // both sub-names existed: base name previously had no effect\n        // so ignore it and try to find a shared part of the sub-names\n        var newName = commonPrefix(increasingName, decreasingName, increasingShowlegend, decreasingShowlegend); // if no common part, leave whatever name was (or wasn't) there\n\n        if (newName) trace.name = newName;\n      } else if ((increasingName || decreasingName) && !trace.name) {\n        // one sub-name existed but not the base name - just use the sub-name\n        trace.name = increasingName || decreasingName;\n      }\n    } // transforms backward compatibility fixes\n\n\n    if (Array.isArray(trace.transforms)) {\n      var transforms = trace.transforms;\n\n      for (i = 0; i < transforms.length; i++) {\n        var transform = transforms[i];\n        if (!Lib.isPlainObject(transform)) continue;\n\n        switch (transform.type) {\n          case 'filter':\n            if (transform.filtersrc) {\n              transform.target = transform.filtersrc;\n              delete transform.filtersrc;\n            }\n\n            if (transform.calendar) {\n              if (!transform.valuecalendar) {\n                transform.valuecalendar = transform.calendar;\n              }\n\n              delete transform.calendar;\n            }\n\n            break;\n\n          case 'groupby':\n            // Name has changed from `style` to `styles`, so use `style` but prefer `styles`:\n            transform.styles = transform.styles || transform.style;\n\n            if (transform.styles && !Array.isArray(transform.styles)) {\n              var prevStyles = transform.styles;\n              var styleKeys = Object.keys(prevStyles);\n              transform.styles = [];\n\n              for (var j = 0; j < styleKeys.length; j++) {\n                transform.styles.push({\n                  target: styleKeys[j],\n                  value: prevStyles[styleKeys[j]]\n                });\n              }\n            }\n\n            break;\n        }\n      }\n    } // prune empty containers made before the new nestedProperty\n\n\n    if (emptyContainer(trace, 'line')) delete trace.line;\n\n    if ('marker' in trace) {\n      if (emptyContainer(trace.marker, 'line')) delete trace.marker.line;\n      if (emptyContainer(trace, 'marker')) delete trace.marker;\n    } // sanitize rgb(fractions) and rgba(fractions) that old tinycolor\n    // supported, but new tinycolor does not because they're not valid css\n\n\n    Color.clean(trace); // remove obsolete autobin(x|y) attributes, but only if true\n    // if false, this needs to happen in Histogram.calc because it\n    // can be a one-time autobin so we need to know the results before\n    // we can push them back into the trace.\n\n    if (trace.autobinx) {\n      delete trace.autobinx;\n      delete trace.xbins;\n    }\n\n    if (trace.autobiny) {\n      delete trace.autobiny;\n      delete trace.ybins;\n    }\n\n    cleanTitle(trace);\n    if (trace.colorbar) cleanTitle(trace.colorbar);\n    if (trace.marker && trace.marker.colorbar) cleanTitle(trace.marker.colorbar);\n    if (trace.line && trace.line.colorbar) cleanTitle(trace.line.colorbar);\n    if (trace.aaxis) cleanTitle(trace.aaxis);\n    if (trace.baxis) cleanTitle(trace.baxis);\n  }\n};\n\nfunction cleanFinanceDir(dirContainer) {\n  if (!Lib.isPlainObject(dirContainer)) return false;\n  var dirName = dirContainer.name;\n  delete dirContainer.name;\n  delete dirContainer.showlegend;\n  return (typeof dirName === 'string' || typeof dirName === 'number') && String(dirName);\n}\n\nfunction commonPrefix(name1, name2, show1, show2) {\n  // if only one is shown in the legend, use that\n  if (show1 && !show2) return name1;\n  if (show2 && !show1) return name2; // if both or neither are in the legend, check if one is blank (or whitespace)\n  // and use the other one\n  // note that hover labels can still use the name even if the legend doesn't\n\n  if (!name1.trim()) return name2;\n  if (!name2.trim()) return name1;\n  var minLen = Math.min(name1.length, name2.length);\n  var i;\n\n  for (i = 0; i < minLen; i++) {\n    if (name1.charAt(i) !== name2.charAt(i)) break;\n  }\n\n  var out = name1.substr(0, i);\n  return out.trim();\n} // textposition - support partial attributes (ie just 'top')\n// and incorrect use of middle / center etc.\n\n\nfunction cleanTextPosition(textposition) {\n  var posY = 'middle';\n  var posX = 'center';\n\n  if (typeof textposition === 'string') {\n    if (textposition.indexOf('top') !== -1) posY = 'top';else if (textposition.indexOf('bottom') !== -1) posY = 'bottom';\n    if (textposition.indexOf('left') !== -1) posX = 'left';else if (textposition.indexOf('right') !== -1) posX = 'right';\n  }\n\n  return posY + ' ' + posX;\n}\n\nfunction emptyContainer(outer, innerStr) {\n  return innerStr in outer && typeof outer[innerStr] === 'object' && Object.keys(outer[innerStr]).length === 0;\n} // swap all the data and data attributes associated with x and y\n\n\nexports.swapXYData = function (trace) {\n  var i;\n  Lib.swapAttrs(trace, ['?', '?0', 'd?', '?bins', 'nbins?', 'autobin?', '?src', 'error_?']);\n\n  if (Array.isArray(trace.z) && Array.isArray(trace.z[0])) {\n    if (trace.transpose) delete trace.transpose;else trace.transpose = true;\n  }\n\n  if (trace.error_x && trace.error_y) {\n    var errorY = trace.error_y;\n    var copyYstyle = 'copy_ystyle' in errorY ? errorY.copy_ystyle : !(errorY.color || errorY.thickness || errorY.width);\n    Lib.swapAttrs(trace, ['error_?.copy_ystyle']);\n\n    if (copyYstyle) {\n      Lib.swapAttrs(trace, ['error_?.color', 'error_?.thickness', 'error_?.width']);\n    }\n  }\n\n  if (typeof trace.hoverinfo === 'string') {\n    var hoverInfoParts = trace.hoverinfo.split('+');\n\n    for (i = 0; i < hoverInfoParts.length; i++) {\n      if (hoverInfoParts[i] === 'x') hoverInfoParts[i] = 'y';else if (hoverInfoParts[i] === 'y') hoverInfoParts[i] = 'x';\n    }\n\n    trace.hoverinfo = hoverInfoParts.join('+');\n  }\n}; // coerce traceIndices input to array of trace indices\n\n\nexports.coerceTraceIndices = function (gd, traceIndices) {\n  if (isNumeric(traceIndices)) {\n    return [traceIndices];\n  } else if (!Array.isArray(traceIndices) || !traceIndices.length) {\n    return gd.data.map(function (_, i) {\n      return i;\n    });\n  } else if (Array.isArray(traceIndices)) {\n    var traceIndicesOut = [];\n\n    for (var i = 0; i < traceIndices.length; i++) {\n      if (Lib.isIndex(traceIndices[i], gd.data.length)) {\n        traceIndicesOut.push(traceIndices[i]);\n      } else {\n        Lib.warn('trace index (', traceIndices[i], ') is not a number or is out of bounds');\n      }\n    }\n\n    return traceIndicesOut;\n  }\n\n  return traceIndices;\n};\n/**\n * Manages logic around array container item creation / deletion / update\n * that nested property alone can't handle.\n *\n * @param {Object} np\n *  nested property of update attribute string about trace or layout object\n * @param {*} newVal\n *  update value passed to restyle / relayout / update\n * @param {Object} undoit\n *  undo hash (N.B. undoit may be mutated here).\n *\n */\n\n\nexports.manageArrayContainers = function (np, newVal, undoit) {\n  var obj = np.obj;\n  var parts = np.parts;\n  var pLength = parts.length;\n  var pLast = parts[pLength - 1];\n  var pLastIsNumber = isNumeric(pLast);\n\n  if (pLastIsNumber && newVal === null) {\n    // delete item\n    // Clear item in array container when new value is null\n    var contPath = parts.slice(0, pLength - 1).join('.');\n    var cont = Lib.nestedProperty(obj, contPath).get();\n    cont.splice(pLast, 1); // Note that nested property clears null / undefined at end of\n    // array container, but not within them.\n  } else if (pLastIsNumber && np.get() === undefined) {\n    // create item\n    // When adding a new item, make sure undo command will remove it\n    if (np.get() === undefined) undoit[np.astr] = null;\n    np.set(newVal);\n  } else {\n    // update item\n    // If the last part of attribute string isn't a number,\n    // np.set is all we need.\n    np.set(newVal);\n  }\n};\n/*\n * Match the part to strip off to turn an attribute into its parent\n * really it should be either '.some_characters' or '[number]'\n * but we're a little more permissive here and match either\n * '.not_brackets_or_dot' or '[not_brackets_or_dot]'\n */\n\n\nvar ATTR_TAIL_RE = /(\\.[^\\[\\]\\.]+|\\[[^\\[\\]\\.]+\\])$/;\n\nfunction getParent(attr) {\n  var tail = attr.search(ATTR_TAIL_RE);\n  if (tail > 0) return attr.substr(0, tail);\n}\n/*\n * hasParent: does an attribute object contain a parent of the given attribute?\n * for example, given 'images[2].x' do we also have 'images' or 'images[2]'?\n *\n * @param {Object} aobj\n *  update object, whose keys are attribute strings and values are their new settings\n * @param {string} attr\n *  the attribute string to test against\n * @returns {Boolean}\n *  is a parent of attr present in aobj?\n */\n\n\nexports.hasParent = function (aobj, attr) {\n  var attrParent = getParent(attr);\n\n  while (attrParent) {\n    if (attrParent in aobj) return true;\n    attrParent = getParent(attrParent);\n  }\n\n  return false;\n};\n/**\n * Empty out types for all axes containing these traces so we auto-set them again\n *\n * @param {object} gd\n * @param {[integer]} traces: trace indices to search for axes to clear the types of\n * @param {object} layoutUpdate: any update being done concurrently to the layout,\n *   which may supercede clearing the axis types\n */\n\n\nvar axLetters = ['x', 'y', 'z'];\n\nexports.clearAxisTypes = function (gd, traces, layoutUpdate) {\n  for (var i = 0; i < traces.length; i++) {\n    var trace = gd._fullData[i];\n\n    for (var j = 0; j < 3; j++) {\n      var ax = getFromTrace(gd, trace, axLetters[j]); // do not clear log type - that's never an auto result so must have been intentional\n\n      if (ax && ax.type !== 'log') {\n        var axAttr = ax._name;\n\n        var sceneName = ax._id.substr(1);\n\n        if (sceneName.substr(0, 5) === 'scene') {\n          if (layoutUpdate[sceneName] !== undefined) continue;\n          axAttr = sceneName + '.' + axAttr;\n        }\n\n        var typeAttr = axAttr + '.type';\n\n        if (layoutUpdate[axAttr] === undefined && layoutUpdate[typeAttr] === undefined) {\n          Lib.nestedProperty(gd.layout, typeAttr).set(null);\n        }\n      }\n    }\n  }\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nexports.version = require('./version').version; // inject promise polyfill\n\nrequire('es6-promise').polyfill(); // inject plot css\n\n\nrequire('../build/plotcss'); // inject default MathJax config\n\n\nrequire('./fonts/mathjax_config')(); // include registry module and expose register method\n\n\nvar Registry = require('./registry');\n\nvar register = exports.register = Registry.register; // expose plot api methods\n\nvar plotApi = require('./plot_api');\n\nvar methodNames = Object.keys(plotApi);\n\nfor (var i = 0; i < methodNames.length; i++) {\n  var name = methodNames[i]; // _ -> private API methods, but still registered for internal use\n\n  if (name.charAt(0) !== '_') exports[name] = plotApi[name];\n  register({\n    moduleType: 'apiMethod',\n    name: name,\n    fn: plotApi[name]\n  });\n} // scatter is the only trace included by default\n\n\nregister(require('./traces/scatter')); // register all registrable components modules\n\nregister([require('./components/legend'), require('./components/fx'), // fx needs to come after legend\nrequire('./components/annotations'), require('./components/annotations3d'), require('./components/shapes'), require('./components/images'), require('./components/updatemenus'), require('./components/sliders'), require('./components/rangeslider'), require('./components/rangeselector'), require('./components/grid'), require('./components/errorbars'), require('./components/colorscale'), require('./components/colorbar')]); // locales en and en-US are required for default behavior\n\nregister([require('./locale-en'), require('./locale-en-us')]); // locales that are present in the window should be loaded\n\nif (window.PlotlyLocales && Array.isArray(window.PlotlyLocales)) {\n  register(window.PlotlyLocales);\n  delete window.PlotlyLocales;\n} // plot icons\n\n\nexports.Icons = require('./fonts/ploticon'); // unofficial 'beta' plot methods, use at your own risk\n\nexports.Plots = require('./plots/plots');\nexports.Fx = require('./components/fx');\nexports.Snapshot = require('./snapshot');\nexports.PlotSchema = require('./plot_api/plot_schema');\nexports.Queue = require('./lib/queue'); // export d3 used in the bundle\n\nexports.d3 = require('d3');","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar handleArrayContainerDefaults = require('../../plots/array_container_defaults');\n\nvar handleAnnotationCommonDefaults = require('../annotations/common_defaults');\n\nvar attributes = require('./attributes');\n\nmodule.exports = function handleDefaults(sceneLayoutIn, sceneLayoutOut, opts) {\n  handleArrayContainerDefaults(sceneLayoutIn, sceneLayoutOut, {\n    name: 'annotations',\n    handleItemDefaults: handleAnnotationDefaults,\n    fullLayout: opts.fullLayout\n  });\n};\n\nfunction handleAnnotationDefaults(annIn, annOut, sceneLayout, opts) {\n  function coerce(attr, dflt) {\n    return Lib.coerce(annIn, annOut, attributes, attr, dflt);\n  }\n\n  function coercePosition(axLetter) {\n    var axName = axLetter + 'axis'; // mock in such way that getFromId grabs correct 3D axis\n\n    var gdMock = {\n      _fullLayout: {}\n    };\n    gdMock._fullLayout[axName] = sceneLayout[axName];\n    return Axes.coercePosition(annOut, gdMock, coerce, axLetter, axLetter, 0.5);\n  }\n\n  var visible = coerce('visible');\n  if (!visible) return;\n  handleAnnotationCommonDefaults(annIn, annOut, opts.fullLayout, coerce);\n  coercePosition('x');\n  coercePosition('y');\n  coercePosition('z'); // if you have one coordinate you should all three\n\n  Lib.noneOrAll(annIn, annOut, ['x', 'y', 'z']); // hard-set here for completeness\n\n  annOut.xref = 'x';\n  annOut.yref = 'y';\n  annOut.zref = 'z';\n  coerce('xanchor');\n  coerce('yanchor');\n  coerce('xshift');\n  coerce('yshift');\n\n  if (annOut.showarrow) {\n    annOut.axref = 'pixel';\n    annOut.ayref = 'pixel'; // TODO maybe default values should be bigger than the 2D case?\n\n    coerce('ax', -10);\n    coerce('ay', -30); // if you have one part of arrow length you should have both\n\n    Lib.noneOrAll(annIn, annOut, ['ax', 'ay']);\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../lib');\n\nvar dfltConfig = require('../plot_api/plot_config').dfltConfig;\n/**\n * Copy arg array *without* removing `undefined` values from objects.\n *\n * @param gd\n * @param args\n * @returns {Array}\n */\n\n\nfunction copyArgArray(gd, args) {\n  var copy = [];\n  var arg;\n\n  for (var i = 0; i < args.length; i++) {\n    arg = args[i];\n    if (arg === gd) copy[i] = arg;else if (typeof arg === 'object') {\n      copy[i] = Array.isArray(arg) ? Lib.extendDeep([], arg) : Lib.extendDeepAll({}, arg);\n    } else copy[i] = arg;\n  }\n\n  return copy;\n} // -----------------------------------------------------\n// Undo/Redo queue for plots\n// -----------------------------------------------------\n\n\nvar queue = {}; // TODO: disable/enable undo and redo buttons appropriately\n\n/**\n * Add an item to the undoQueue for a graphDiv\n *\n * @param gd\n * @param undoFunc Function undo this operation\n * @param undoArgs Args to supply undoFunc with\n * @param redoFunc Function to redo this operation\n * @param redoArgs Args to supply redoFunc with\n */\n\nqueue.add = function (gd, undoFunc, undoArgs, redoFunc, redoArgs) {\n  var queueObj, queueIndex; // make sure we have the queue and our position in it\n\n  gd.undoQueue = gd.undoQueue || {\n    index: 0,\n    queue: [],\n    sequence: false\n  };\n  queueIndex = gd.undoQueue.index; // if we're already playing an undo or redo, or if this is an auto operation\n  // (like pane resize... any others?) then we don't save this to the undo queue\n\n  if (gd.autoplay) {\n    if (!gd.undoQueue.inSequence) gd.autoplay = false;\n    return;\n  } // if we're not in a sequence or are just starting, we need a new queue item\n\n\n  if (!gd.undoQueue.sequence || gd.undoQueue.beginSequence) {\n    queueObj = {\n      undo: {\n        calls: [],\n        args: []\n      },\n      redo: {\n        calls: [],\n        args: []\n      }\n    };\n    gd.undoQueue.queue.splice(queueIndex, gd.undoQueue.queue.length - queueIndex, queueObj);\n    gd.undoQueue.index += 1;\n  } else {\n    queueObj = gd.undoQueue.queue[queueIndex - 1];\n  }\n\n  gd.undoQueue.beginSequence = false; // we unshift to handle calls for undo in a forward for loop later\n\n  if (queueObj) {\n    queueObj.undo.calls.unshift(undoFunc);\n    queueObj.undo.args.unshift(undoArgs);\n    queueObj.redo.calls.push(redoFunc);\n    queueObj.redo.args.push(redoArgs);\n  }\n\n  if (gd.undoQueue.queue.length > dfltConfig.queueLength) {\n    gd.undoQueue.queue.shift();\n    gd.undoQueue.index--;\n  }\n};\n/**\n * Begin a sequence of undoQueue changes\n *\n * @param gd\n */\n\n\nqueue.startSequence = function (gd) {\n  gd.undoQueue = gd.undoQueue || {\n    index: 0,\n    queue: [],\n    sequence: false\n  };\n  gd.undoQueue.sequence = true;\n  gd.undoQueue.beginSequence = true;\n};\n/**\n * Stop a sequence of undoQueue changes\n *\n * Call this *after* you're sure your undo chain has ended\n *\n * @param gd\n */\n\n\nqueue.stopSequence = function (gd) {\n  gd.undoQueue = gd.undoQueue || {\n    index: 0,\n    queue: [],\n    sequence: false\n  };\n  gd.undoQueue.sequence = false;\n  gd.undoQueue.beginSequence = false;\n};\n/**\n * Move one step back in the undo queue, and undo the object there.\n *\n * @param gd\n */\n\n\nqueue.undo = function undo(gd) {\n  var queueObj, i;\n\n  if (gd.framework && gd.framework.isPolar) {\n    gd.framework.undo();\n    return;\n  }\n\n  if (gd.undoQueue === undefined || isNaN(gd.undoQueue.index) || gd.undoQueue.index <= 0) {\n    return;\n  } // index is pointing to next *forward* queueObj, point to the one we're undoing\n\n\n  gd.undoQueue.index--; // get the queueObj for instructions on how to undo\n\n  queueObj = gd.undoQueue.queue[gd.undoQueue.index]; // this sequence keeps things from adding to the queue during undo/redo\n\n  gd.undoQueue.inSequence = true;\n\n  for (i = 0; i < queueObj.undo.calls.length; i++) {\n    queue.plotDo(gd, queueObj.undo.calls[i], queueObj.undo.args[i]);\n  }\n\n  gd.undoQueue.inSequence = false;\n  gd.autoplay = false;\n};\n/**\n * Redo the current object in the undo, then move forward in the queue.\n *\n * @param gd\n */\n\n\nqueue.redo = function redo(gd) {\n  var queueObj, i;\n\n  if (gd.framework && gd.framework.isPolar) {\n    gd.framework.redo();\n    return;\n  }\n\n  if (gd.undoQueue === undefined || isNaN(gd.undoQueue.index) || gd.undoQueue.index >= gd.undoQueue.queue.length) {\n    return;\n  } // get the queueObj for instructions on how to undo\n\n\n  queueObj = gd.undoQueue.queue[gd.undoQueue.index]; // this sequence keeps things from adding to the queue during undo/redo\n\n  gd.undoQueue.inSequence = true;\n\n  for (i = 0; i < queueObj.redo.calls.length; i++) {\n    queue.plotDo(gd, queueObj.redo.calls[i], queueObj.redo.args[i]);\n  }\n\n  gd.undoQueue.inSequence = false;\n  gd.autoplay = false; // index is pointing to the thing we just redid, move it\n\n  gd.undoQueue.index++;\n};\n/**\n * Called by undo/redo to make the actual changes.\n *\n * Not meant to be called publically, but included for mocking out in tests.\n *\n * @param gd\n * @param func\n * @param args\n */\n\n\nqueue.plotDo = function (gd, func, args) {\n  gd.autoplay = true; // this *won't* copy gd and it preserves `undefined` properties!\n\n  args = copyArgArray(gd, args); // call the supplied function\n\n  func.apply(null, args);\n};\n\nmodule.exports = queue;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: 'annotations3d',\n  schema: {\n    subplots: {\n      scene: {\n        annotations: require('./attributes')\n      }\n    }\n  },\n  layoutAttributes: require('./attributes'),\n  handleDefaults: require('./defaults'),\n  includeBasePlot: includeGL3D,\n  convert: require('./convert'),\n  draw: require('./draw')\n};\n\nfunction includeGL3D(layoutIn, layoutOut) {\n  var GL3D = Registry.subplotsRegistry.gl3d;\n  if (!GL3D) return;\n  var attrRegex = GL3D.attrRegex;\n  var keys = Object.keys(layoutIn);\n\n  for (var i = 0; i < keys.length; i++) {\n    var k = keys[i];\n\n    if (attrRegex.test(k) && (layoutIn[k].annotations || []).length) {\n      Lib.pushUnique(layoutOut._basePlotModules, GL3D);\n      Lib.pushUnique(layoutOut._subplots.gl3d, k);\n    }\n  }\n}","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar helpers = require('./helpers');\n\nvar Snapshot = {\n  getDelay: helpers.getDelay,\n  getRedrawFunc: helpers.getRedrawFunc,\n  clone: require('./cloneplot'),\n  toSVG: require('./tosvg'),\n  svgToImg: require('./svgtoimg'),\n  toImage: require('./toimage'),\n  downloadImage: require('./download')\n};\nmodule.exports = Snapshot;","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar d3 = require('d3');\n\nvar Lib = require('../lib');\n\nvar Drawing = require('../components/drawing');\n\nvar Color = require('../components/color');\n\nvar xmlnsNamespaces = require('../constants/xmlns_namespaces');\n\nvar DOUBLEQUOTE_REGEX = /\"/g;\nvar DUMMY_SUB = 'TOBESTRIPPED';\nvar DUMMY_REGEX = new RegExp('(\"' + DUMMY_SUB + ')|(' + DUMMY_SUB + '\")', 'g');\n\nfunction htmlEntityDecode(s) {\n  var hiddenDiv = d3.select('body').append('div').style({\n    display: 'none'\n  }).html('');\n  var replaced = s.replace(/(&[^;]*;)/gi, function (d) {\n    if (d === '&lt;') {\n      return '&#60;';\n    } // special handling for brackets\n\n\n    if (d === '&rt;') {\n      return '&#62;';\n    }\n\n    if (d.indexOf('<') !== -1 || d.indexOf('>') !== -1) {\n      return '';\n    }\n\n    return hiddenDiv.html(d).text(); // everything else, let the browser decode it to unicode\n  });\n  hiddenDiv.remove();\n  return replaced;\n}\n\nfunction xmlEntityEncode(str) {\n  return str.replace(/&(?!\\w+;|\\#[0-9]+;| \\#x[0-9A-F]+;)/g, '&amp;');\n}\n\nmodule.exports = function toSVG(gd, format, scale) {\n  var fullLayout = gd._fullLayout;\n  var svg = fullLayout._paper;\n  var toppaper = fullLayout._toppaper;\n  var width = fullLayout.width;\n  var height = fullLayout.height;\n  var i; // make background color a rect in the svg, then revert after scraping\n  // all other alterations have been dealt with by properly preparing the svg\n  // in the first place... like setting cursors with css classes so we don't\n  // have to remove them, and providing the right namespaces in the svg to\n  // begin with\n\n  svg.insert('rect', ':first-child').call(Drawing.setRect, 0, 0, width, height).call(Color.fill, fullLayout.paper_bgcolor); // subplot-specific to-SVG methods\n  // which notably add the contents of the gl-container\n  // into the main svg node\n\n  var basePlotModules = fullLayout._basePlotModules || [];\n\n  for (i = 0; i < basePlotModules.length; i++) {\n    var _module = basePlotModules[i];\n    if (_module.toSVG) _module.toSVG(gd);\n  } // add top items above them assumes everything in toppaper is either\n  // a group or a defs, and if it's empty (like hoverlayer) we can ignore it.\n\n\n  if (toppaper) {\n    var nodes = toppaper.node().childNodes; // make copy of nodes as childNodes prop gets mutated in loop below\n\n    var topGroups = Array.prototype.slice.call(nodes);\n\n    for (i = 0; i < topGroups.length; i++) {\n      var topGroup = topGroups[i];\n      if (topGroup.childNodes.length) svg.node().appendChild(topGroup);\n    }\n  } // remove draglayer for Adobe Illustrator compatibility\n\n\n  if (fullLayout._draggers) {\n    fullLayout._draggers.remove();\n  } // in case the svg element had an explicit background color, remove this\n  // we want the rect to get the color so it's the right size; svg bg will\n  // fill whatever container it's displayed in regardless of plot size.\n\n\n  svg.node().style.background = '';\n  svg.selectAll('text').attr({\n    'data-unformatted': null,\n    'data-math': null\n  }).each(function () {\n    var txt = d3.select(this); // hidden text is pre-formatting mathjax, the browser ignores it\n    // but in a static plot it's useless and it can confuse batik\n    // we've tried to standardize on display:none but make sure we still\n    // catch visibility:hidden if it ever arises\n\n    if (this.style.visibility === 'hidden' || this.style.display === 'none') {\n      txt.remove();\n      return;\n    } else {\n      // clear other visibility/display values to default\n      // to not potentially confuse non-browser SVG implementations\n      txt.style({\n        visibility: null,\n        display: null\n      });\n    } // Font family styles break things because of quotation marks,\n    // so we must remove them *after* the SVG DOM has been serialized\n    // to a string (browsers convert singles back)\n\n\n    var ff = this.style.fontFamily;\n\n    if (ff && ff.indexOf('\"') !== -1) {\n      txt.style('font-family', ff.replace(DOUBLEQUOTE_REGEX, DUMMY_SUB));\n    }\n  });\n\n  if (fullLayout._gradientUrlQueryParts) {\n    var queryParts = [];\n\n    for (var k in fullLayout._gradientUrlQueryParts) {\n      queryParts.push(k);\n    }\n\n    if (queryParts.length) {\n      svg.selectAll(queryParts.join(',')).each(function () {\n        var pt = d3.select(this); // similar to font family styles above,\n        // we must remove \" after the SVG DOM has been serialized\n\n        var fill = this.style.fill;\n\n        if (fill && fill.indexOf('url(') !== -1) {\n          pt.style('fill', fill.replace(DOUBLEQUOTE_REGEX, DUMMY_SUB));\n        }\n\n        var stroke = this.style.stroke;\n\n        if (stroke && stroke.indexOf('url(') !== -1) {\n          pt.style('stroke', stroke.replace(DOUBLEQUOTE_REGEX, DUMMY_SUB));\n        }\n      });\n    }\n  }\n\n  if (format === 'pdf' || format === 'eps') {\n    // these formats make the extra line MathJax adds around symbols look super thick in some cases\n    // it looks better if this is removed entirely.\n    svg.selectAll('#MathJax_SVG_glyphs path').attr('stroke-width', 0);\n  } // fix for IE namespacing quirk?\n  // http://stackoverflow.com/questions/19610089/unwanted-namespaces-on-svg-markup-when-using-xmlserializer-in-javascript-with-ie\n\n\n  svg.node().setAttributeNS(xmlnsNamespaces.xmlns, 'xmlns', xmlnsNamespaces.svg);\n  svg.node().setAttributeNS(xmlnsNamespaces.xmlns, 'xmlns:xlink', xmlnsNamespaces.xlink);\n\n  if (format === 'svg' && scale) {\n    svg.attr('width', scale * width);\n    svg.attr('height', scale * height);\n    svg.attr('viewBox', '0 0 ' + width + ' ' + height);\n  }\n\n  var s = new window.XMLSerializer().serializeToString(svg.node());\n  s = htmlEntityDecode(s);\n  s = xmlEntityEncode(s); // Fix quotations around font strings and gradient URLs\n\n  s = s.replace(DUMMY_REGEX, '\\''); // IE is very strict, so we will need to clean\n  //  svg with the following regex\n  //  yes this is messy, but do not know a better way\n  // Even with this IE will not work due to tainted canvas\n  //  see https://github.com/kangax/fabric.js/issues/1957\n  //      http://stackoverflow.com/questions/18112047/canvas-todataurl-working-in-all-browsers-except-ie10\n  // Leave here just in case the CORS/tainted IE issue gets resolved\n\n  if (Lib.isIE()) {\n    // replace double quote with single quote\n    s = s.replace(/\"/gi, '\\''); // url in svg are single quoted\n    //   since we changed double to single\n    //   we'll need to change these to double-quoted\n\n    s = s.replace(/(\\('#)([^']*)('\\))/gi, '(\\\"#$2\\\")'); // font names with spaces will be escaped single-quoted\n    //   we'll need to change these to double-quoted\n\n    s = s.replace(/(\\\\')/gi, '\\\"');\n  }\n\n  return s;\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar constants = require('./constants');\n\nmodule.exports = {\n  moduleType: 'component',\n  name: constants.name,\n  layoutAttributes: require('./attributes'),\n  supplyLayoutDefaults: require('./defaults'),\n  draw: require('./draw')\n};","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar draw = require('./draw').draw;\n\nmodule.exports = function calcAutorange(gd) {\n  var fullLayout = gd._fullLayout;\n  var annotationList = Lib.filterVisible(fullLayout.annotations);\n\n  if (annotationList.length && gd._fullData.length) {\n    return Lib.syncOrAsync([draw, annAutorange], gd);\n  }\n};\n\nfunction annAutorange(gd) {\n  var fullLayout = gd._fullLayout; // find the bounding boxes for each of these annotations'\n  // relative to their anchor points\n  // use the arrow and the text bg rectangle,\n  // as the whole anno may include hidden text in its bbox\n\n  Lib.filterVisible(fullLayout.annotations).forEach(function (ann) {\n    var xa = Axes.getFromId(gd, ann.xref);\n    var ya = Axes.getFromId(gd, ann.yref);\n    ann._extremes = {};\n    if (xa) calcAxisExpansion(ann, xa);\n    if (ya) calcAxisExpansion(ann, ya);\n  });\n}\n\nfunction calcAxisExpansion(ann, ax) {\n  var axId = ax._id;\n  var letter = axId.charAt(0);\n  var pos = ann[letter];\n  var apos = ann['a' + letter];\n  var ref = ann[letter + 'ref'];\n  var aref = ann['a' + letter + 'ref'];\n  var padplus = ann['_' + letter + 'padplus'];\n  var padminus = ann['_' + letter + 'padminus'];\n  var shift = {\n    x: 1,\n    y: -1\n  }[letter] * ann[letter + 'shift'];\n  var headSize = 3 * ann.arrowsize * ann.arrowwidth || 0;\n  var headPlus = headSize + shift;\n  var headMinus = headSize - shift;\n  var startHeadSize = 3 * ann.startarrowsize * ann.arrowwidth || 0;\n  var startHeadPlus = startHeadSize + shift;\n  var startHeadMinus = startHeadSize - shift;\n  var extremes;\n\n  if (aref === ref) {\n    // expand for the arrowhead (padded by arrowhead)\n    var extremeArrowHead = Axes.findExtremes(ax, [ax.r2c(pos)], {\n      ppadplus: headPlus,\n      ppadminus: headMinus\n    }); // again for the textbox (padded by textbox)\n\n    var extremeText = Axes.findExtremes(ax, [ax.r2c(apos)], {\n      ppadplus: Math.max(padplus, startHeadPlus),\n      ppadminus: Math.max(padminus, startHeadMinus)\n    });\n    extremes = {\n      min: [extremeArrowHead.min[0], extremeText.min[0]],\n      max: [extremeArrowHead.max[0], extremeText.max[0]]\n    };\n  } else {\n    startHeadPlus = apos ? startHeadPlus + apos : startHeadPlus;\n    startHeadMinus = apos ? startHeadMinus - apos : startHeadMinus;\n    extremes = Axes.findExtremes(ax, [ax.r2c(pos)], {\n      ppadplus: Math.max(padplus, headPlus, startHeadPlus),\n      ppadminus: Math.max(padminus, headMinus, startHeadMinus)\n    });\n  }\n\n  ann._extremes[axId] = extremes;\n}","var anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar newPromiseCapability = require('../internals/new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar constants = require('./constants');\n\nvar helpers = require('./helpers');\n\nmodule.exports = function calcAutorange(gd) {\n  var fullLayout = gd._fullLayout;\n  var shapeList = Lib.filterVisible(fullLayout.shapes);\n  if (!shapeList.length || !gd._fullData.length) return;\n\n  for (var i = 0; i < shapeList.length; i++) {\n    var shape = shapeList[i];\n    shape._extremes = {};\n    var ax, bounds;\n\n    if (shape.xref !== 'paper') {\n      var vx0 = shape.xsizemode === 'pixel' ? shape.xanchor : shape.x0;\n      var vx1 = shape.xsizemode === 'pixel' ? shape.xanchor : shape.x1;\n      ax = Axes.getFromId(gd, shape.xref);\n      bounds = shapeBounds(ax, vx0, vx1, shape.path, constants.paramIsX);\n\n      if (bounds) {\n        shape._extremes[ax._id] = Axes.findExtremes(ax, bounds, calcXPaddingOptions(shape));\n      }\n    }\n\n    if (shape.yref !== 'paper') {\n      var vy0 = shape.ysizemode === 'pixel' ? shape.yanchor : shape.y0;\n      var vy1 = shape.ysizemode === 'pixel' ? shape.yanchor : shape.y1;\n      ax = Axes.getFromId(gd, shape.yref);\n      bounds = shapeBounds(ax, vy0, vy1, shape.path, constants.paramIsY);\n\n      if (bounds) {\n        shape._extremes[ax._id] = Axes.findExtremes(ax, bounds, calcYPaddingOptions(shape));\n      }\n    }\n  }\n};\n\nfunction calcXPaddingOptions(shape) {\n  return calcPaddingOptions(shape.line.width, shape.xsizemode, shape.x0, shape.x1, shape.path, false);\n}\n\nfunction calcYPaddingOptions(shape) {\n  return calcPaddingOptions(shape.line.width, shape.ysizemode, shape.y0, shape.y1, shape.path, true);\n}\n\nfunction calcPaddingOptions(lineWidth, sizeMode, v0, v1, path, isYAxis) {\n  var ppad = lineWidth / 2;\n  var axisDirectionReverted = isYAxis;\n\n  if (sizeMode === 'pixel') {\n    var coords = path ? helpers.extractPathCoords(path, isYAxis ? constants.paramIsY : constants.paramIsX) : [v0, v1];\n    var maxValue = Lib.aggNums(Math.max, null, coords);\n    var minValue = Lib.aggNums(Math.min, null, coords);\n    var beforePad = minValue < 0 ? Math.abs(minValue) + ppad : ppad;\n    var afterPad = maxValue > 0 ? maxValue + ppad : ppad;\n    return {\n      ppad: ppad,\n      ppadplus: axisDirectionReverted ? beforePad : afterPad,\n      ppadminus: axisDirectionReverted ? afterPad : beforePad\n    };\n  } else {\n    return {\n      ppad: ppad\n    };\n  }\n}\n\nfunction shapeBounds(ax, v0, v1, path, paramsToUse) {\n  var convertVal = ax.type === 'category' || ax.type === 'multicategory' ? ax.r2c : ax.d2c;\n  if (v0 !== undefined) return [convertVal(v0), convertVal(v1)];\n  if (!path) return;\n  var min = Infinity;\n  var max = -Infinity;\n  var segments = path.match(constants.segmentRE);\n  var i;\n  var segment;\n  var drawnParam;\n  var params;\n  var val;\n  if (ax.type === 'date') convertVal = helpers.decodeDate(convertVal);\n\n  for (i = 0; i < segments.length; i++) {\n    segment = segments[i];\n    drawnParam = paramsToUse[segment.charAt(0)].drawn;\n    if (drawnParam === undefined) continue;\n    params = segments[i].substr(1).match(constants.paramRE);\n    if (!params || params.length < drawnParam) continue;\n    val = convertVal(params[drawnParam]);\n    if (val < min) min = val;\n    if (val > max) max = val;\n  }\n\n  if (max >= min) return [min, max];\n}"],"sourceRoot":""}