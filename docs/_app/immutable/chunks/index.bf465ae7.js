import{S as Pc,i as Ic,s as Lc,k as N,l as F,m as C,h as S,b as ie,F as us,V as FY,W as DY,w as C$,X as UI,y as fr,z as dr,A as hr,Y as jI,g as pr,d as gr,B as mr,Z as gv,_ as ka,T as qe,U as Ge,n as I,$ as pd,E as b,a0 as M$,a1 as gd,a as V,q as M,H as jr,c as J,r as T,D as qr}from"./index.55619a77.js";import{I as ry}from"./Image.82ecf308.js";/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var OY=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),RY=Object.prototype.hasOwnProperty;function mA(e,t){return RY.call(e,t)}function yA(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)mA(e,i)&&r.push(i);return r}function wr(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function vA(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function qu(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function qI(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function bA(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(bA(e[t]))return!0}else if(typeof e=="object"){for(var r=yA(e),i=r.length,s=0;s<i;s++)if(bA(e[r[s]]))return!0}}return!1}function uF(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var GI=function(e){OY(t,e);function t(n,r,i,s,a){var o=this.constructor,l=e.call(this,uF(n,{name:r,index:i,operation:s,tree:a}))||this;return l.name=r,l.index=i,l.operation=s,l.tree=a,Object.setPrototypeOf(l,o.prototype),l.message=uF(n,{name:r,index:i,operation:s,tree:a}),l}return t}(Error),ut=GI,PY=wr,Xf={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=mv(n,this.path);r&&(r=wr(r));var i=rc(n,{op:"remove",path:this.from}).removed;return rc(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=mv(n,this.from);return rc(n,{op:"add",path:this.path,value:wr(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:u0(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},IY={add:function(e,t,n){return vA(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Xf.move,copy:Xf.copy,test:Xf.test,_get:Xf._get};function mv(e,t){if(t=="")return e;var n={op:"_get",path:t};return rc(e,n),n.value}function rc(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):yv(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=mv(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=u0(e,t.value),a.test===!1)throw new ut("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new ut("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return a}}else{r||(e=wr(e));var o=t.path||"",l=o.split("/"),u=e,c=1,f=l.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=yv;;){if(h=l[c],h&&h.indexOf("~")!=-1&&(h=qI(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(u[h]===void 0?d=l.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(u)){if(h==="-")h=u.length;else{if(n&&!vA(h))throw new ut("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);vA(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>u.length)throw new ut("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var a=IY[t.op].call(t,u,h,e);if(a.test===!1)throw new ut("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}}else if(c>=f){var a=Xf[t.op].call(t,u,h,e);if(a.test===!1)throw new ut("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return a}if(u=u[h],n&&c<f&&(!u||typeof u!="object"))throw new ut("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function Zb(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new ut("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=wr(e));for(var s=new Array(t.length),a=0,o=t.length;a<o;a++)s[a]=rc(e,t[a],n,!0,i,a),e=s[a].newDocument;return s.newDocument=e,s}function LY(e,t,n){var r=rc(e,t);if(r.test===!1)throw new ut("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function yv(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new ut("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Xf[e.op]){if(typeof e.path!="string")throw new ut("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new ut('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new ut("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new ut("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&bA(e.value))throw new ut("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new ut("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new ut("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},o=WI([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new ut("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new ut("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function WI(e,t,n){try{if(!Array.isArray(e))throw new ut("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Zb(wr(t),wr(e),n||!0);else{n=n||yv;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof ut)return i;throw i}}function u0(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,a;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!u0(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(s=o.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!u0(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}const zY=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:ut,_areEquals:u0,applyOperation:rc,applyPatch:Zb,applyReducer:LY,deepClone:PY,getValueByPointer:mv,validate:WI,validator:yv},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var T$=new WeakMap,BY=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),UY=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function jY(e){return T$.get(e)}function qY(e,t){return e.observers.get(t)}function GY(e,t){e.observers.delete(t.callback)}function WY(e,t){t.unobserve()}function HY(e,t){var n=[],r,i=jY(e);if(!i)i=new BY(e),T$.set(e,i);else{var s=qY(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=wr(e),t){r.callback=t,r.next=null;var a=function(){xA(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){xA(r),clearTimeout(r.next),GY(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},i.observers.set(t,new UY(t,r)),r}function xA(e,t){t===void 0&&(t=!1);var n=T$.get(e.object);N$(n.value,e.object,e.patches,"",t),e.patches.length&&Zb(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function N$(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=yA(t),a=yA(e),o=!1,l=a.length-1;l>=0;l--){var u=a[l],c=e[u];if(mA(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?N$(c,f,n,r+"/"+qu(u),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+qu(u),value:wr(c)}),n.push({op:"replace",path:r+"/"+qu(u),value:wr(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+qu(u),value:wr(c)}),n.push({op:"remove",path:r+"/"+qu(u)}),o=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&s.length==a.length))for(var l=0;l<s.length;l++){var u=s[l];!mA(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+qu(u),value:wr(t[u])})}}}function VY(e,t,n){n===void 0&&(n=!1);var r=[];return N$(e,t,r,"",n),r}const JY=Object.freeze(Object.defineProperty({__proto__:null,compare:VY,generate:xA,observe:HY,unobserve:WY},Symbol.toStringTag,{value:"Module"}));Object.assign({},zY,JY,{JsonPatchError:GI,deepClone:wr,escapePathComponent:qu,unescapePathComponent:qI});function Qb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var YY=/("(?:[^\\"]|\\.)*")|[:,]/g,XY=function(t,n){var r,i,s;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function a(o,l,u){var c,f,d,h,p,g,m,y,v,x,_,w;if(o&&typeof o.toJSON=="function"&&(o=o.toJSON()),_=JSON.stringify(o,s),_===void 0)return _;if(m=i-l.length-u,_.length<=m&&(v=_.replace(YY,function(k,E){return E||k+" "}),v.length<=m))return v;if(s!=null&&(o=JSON.parse(_),s=void 0),typeof o=="object"&&o!==null){if(y=l+r,d=[],f=0,Array.isArray(o))for(x="[",c="]",m=o.length;f<m;f++)d.push(a(o[f],y,f===m-1?0:1)||"null");else for(x="{",c="}",g=Object.keys(o),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=a(o[h],y,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[x,r+d.join(`,
`+y),c].join(`
`+l)}return _}(t,"",0)};const GS=Qb(XY);function ar(e,t,n){return e.fields=t||[],e.fname=n,e}function ft(e){return e==null?null:e.fname}function sn(e){return e==null?null:e.fields}function HI(e){return e.length===1?KY(e[0]):ZY(e)}const KY=e=>function(t){return t[e]},ZY=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function H(e){throw Error(e)}function Ss(e){const t=[],n=e.length;let r=null,i=0,s="",a,o,l;e=e+"";function u(){t.push(s+e.substring(a,o)),s="",a=o+1}for(a=o=0;o<n;++o)if(l=e[o],l==="\\")s+=e.substring(a,o++),a=o;else if(l===r)u(),r=null,i=-1;else{if(r)continue;a===i&&l==='"'||a===i&&l==="'"?(a=o+1,r=l):l==="."&&!i?o>a?u():a=o+1:l==="["?(o>a&&u(),i=a=o+1):l==="]"&&(i||H("Access path missing open bracket: "+e),i>0&&u(),i=0,a=o+1)}return i&&H("Access path missing closing bracket: "+e),r&&H("Access path missing closing quote: "+e),o>a&&(o++,u()),t}function Qn(e,t,n){const r=Ss(e);return e=r.length===1?r[0]:e,ar((n&&n.get||HI)(r),[e],t||e)}const q0=Qn("id"),un=ar(e=>e,[],"identity"),yo=ar(()=>0,[],"zero"),Yd=ar(()=>1,[],"one"),Zr=ar(()=>!0,[],"true"),lo=ar(()=>!1,[],"false");function QY(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const VI=0,F$=1,D$=2,JI=3,YI=4;function O$(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:QY,r=e||VI;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=F$&&n(t||"error","ERROR",arguments),this},warn(){return r>=D$&&n(t||"warn","WARN",arguments),this},info(){return r>=JI&&n(t||"log","INFO",arguments),this},debug(){return r>=YI&&n(t||"log","DEBUG",arguments),this}}}var Y=Array.isArray;function ce(e){return e===Object(e)}const cF=e=>e!=="__proto__";function Xd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((r,i)=>{for(const s in i)if(s==="signals")r.signals=eX(r.signals,i.signals);else{const a=s==="legend"?{layout:1}:s==="style"?!0:null;Kd(r,s,i[s],a)}return r},{})}function Kd(e,t,n,r){if(!cF(t))return;let i,s;if(ce(n)&&!Y(n)){s=ce(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Kd(s,i,n[i]):cF(i)&&(s[i]=n[i])}else e[t]=n}function eX(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function Oe(e){return e[e.length-1]}function tn(e){return e==null||e===""?null:+e}const XI=e=>t=>e*Math.exp(t),KI=e=>t=>Math.log(e*t),ZI=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),QI=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,vv=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function e2(e,t,n,r){const i=n(e[0]),s=n(Oe(e)),a=(s-i)*t;return[r(i-a),r(s-a)]}function eL(e,t){return e2(e,t,tn,un)}function tL(e,t){var n=Math.sign(e[0]);return e2(e,t,KI(n),XI(n))}function nL(e,t,n){return e2(e,t,vv(n),vv(1/n))}function rL(e,t,n){return e2(e,t,ZI(n),QI(n))}function t2(e,t,n,r,i){const s=r(e[0]),a=r(Oe(e)),o=t!=null?r(t):(s+a)/2;return[i(o+(s-o)*n),i(o+(a-o)*n)]}function R$(e,t,n){return t2(e,t,n,tn,un)}function P$(e,t,n){const r=Math.sign(e[0]);return t2(e,t,n,KI(r),XI(r))}function bv(e,t,n,r){return t2(e,t,n,vv(r),vv(1/r))}function I$(e,t,n,r){return t2(e,t,n,ZI(r),QI(r))}function iL(e){return 1+~~(new Date(e).getMonth()/3)}function sL(e){return 1+~~(new Date(e).getUTCMonth()/3)}function le(e){return e!=null?Y(e)?e:[e]:[]}function aL(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function $e(e){return typeof e=="function"}const tX="descending";function L$(e,t,n){n=n||{},t=le(t)||[];const r=[],i=[],s={},a=n.comparator||nX;return le(e).forEach((o,l)=>{o!=null&&(r.push(t[l]===tX?-1:1),i.push(o=$e(o)?o:Qn(o,null,n)),(sn(o)||[]).forEach(u=>s[u]=1))}),i.length===0?null:ar(a(i,r),Object.keys(s))}const n2=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),nX=(e,t)=>e.length===1?rX(e[0],t[0]):iX(e,t,e.length),rX=(e,t)=>function(n,r){return n2(e(n),e(r))*t},iX=(e,t,n)=>(t.push(0),function(r,i){let s,a=0,o=-1;for(;a===0&&++o<n;)s=e[o],a=n2(s(r),s(i));return a*t[o]});function cn(e){return $e(e)?e:()=>e}function z$(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Ae(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function ms(e,t){let n=0,r,i,s,a;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=a=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>a&&(a=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=a=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>a&&(a=i))}return[s,a]}function oL(e,t){const n=e.length;let r=-1,i,s,a,o,l;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=a=s;break}if(r===n)return[-1,-1];for(o=l=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,o=r),a<s&&(a=s,l=r))}return[o,l]}const sX=Object.prototype.hasOwnProperty;function ve(e,t){return sX.call(e,t)}const iy={};function Zd(e){let t={},n;function r(s){return ve(t,s)&&t[s]!==iy}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,a){return r(s)||(++i.size,t[s]===iy&&--i.empty),t[s]=a,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=iy),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let a=0;for(const o in t){const l=t[o];l!==iy&&(!n||!n(l))&&(s[o]=l,++a)}i.size=a,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function lL(e,t,n,r,i,s){if(!n&&n!==0)return s;const a=+n;let o=e[0],l=Oe(e),u;l<o&&(u=o,o=l,l=u),u=Math.abs(t-o);const c=Math.abs(l-t);return u<c&&u<=a?r:c<=a?i:s}function ne(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ae(r,n)}function Kf(e,t,n,r){let i=t[0],s=t[t.length-1],a;return i>s&&(a=i,i=s,s=a),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function Ko(e){return typeof e=="boolean"}function Co(e){return Object.prototype.toString.call(e)==="[object Date]"}function uL(e){return e&&$e(e[Symbol.iterator])}function Ye(e){return typeof e=="number"}function cL(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function oe(e){return typeof e=="string"}function B$(e,t,n){e&&(e=t?le(e).map(o=>o.replace(/\\(.)/g,"$1")):le(e));const r=e&&e.length,i=n&&n.get||HI,s=o=>i(t?[o]:Ss(o));let a;if(!r)a=function(){return""};else if(r===1){const o=s(e[0]);a=function(l){return""+o(l)}}else{const o=e.map(s);a=function(l){let u=""+o[0](l),c=0;for(;++c<r;)u+="|"+o[c](l);return u}}return ar(a,e,"key")}function fL(e,t){const n=e[0],r=Oe(e),i=+t;return i?i===1?r:n+i*(r-n):n}const aX=1e4;function dL(e){e=+e||aX;let t,n,r;const i=()=>{t={},n={},r=0},s=(a,o)=>(++r>e&&(n=t,t={},r=1),t[a]=o);return i(),{clear:i,has:a=>ve(t,a)||ve(n,a),get:a=>ve(t,a)?t[a]:ve(n,a)?s(a,n[a]):void 0,set:(a,o)=>ve(t,a)?t[a]=o:s(a,o)}}function hL(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const a=r||new t.constructor(i+s);let o=0,l=0,u=0;for(;o<i&&l<s;++u)a[u]=e(t[o],n[l])>0?n[l++]:t[o++];for(;o<i;++o,++u)a[u]=t[o];for(;l<s;++l,++u)a[u]=n[l];return a}function Sg(e,t){let n="";for(;--t>=0;)n+=e;return n}function pL(e,t,n,r){const i=n||" ",s=e+"",a=t-s.length;return a<=0?s:r==="left"?Sg(i,a)+s:r==="center"?Sg(i,~~(a/2))+s+Sg(i,Math.ceil(a/2)):s+Sg(i,a)}function G0(e){return e&&Oe(e)-e[0]||0}function te(e){return Y(e)?"["+e.map(te)+"]":ce(e)||oe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function U$(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const oX=e=>Ye(e)||Co(e)?e:Date.parse(e);function j$(e,t){return t=t||oX,e==null||e===""?null:t(e)}function q$(e){return e==null||e===""?null:e+""}function Di(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function gL(e,t,n,r){const i=r??"…",s=e+"",a=s.length,o=Math.max(0,t-i.length);return a<=t?s:n==="left"?i+s.slice(a-o):n==="center"?s.slice(0,Math.ceil(o/2))+i+s.slice(a-~~(o/2)):s.slice(0,o)+i}function fo(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}var fF={},WS={},HS=34,Zp=10,VS=13;function mL(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function lX(e,t){var n=mL(e);return function(r,i){return t(n(r),i,e)}}function dF(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function jn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function uX(e){return e<0?"-"+jn(-e,6):e>9999?"+"+jn(e,6):jn(e,4)}function cX(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":uX(e.getUTCFullYear())+"-"+jn(e.getUTCMonth()+1,2)+"-"+jn(e.getUTCDate(),2)+(i?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(r,2)+"."+jn(i,3)+"Z":r?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(r,2)+"Z":n||t?"T"+jn(t,2)+":"+jn(n,2)+"Z":"")}function fX(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,y){if(h)return h(m,y-1);p=m,h=d?lX(m,d):mL(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,y,v=p<=0,x=!1;f.charCodeAt(p-1)===Zp&&--p,f.charCodeAt(p-1)===VS&&--p;function _(){if(v)return WS;if(x)return x=!1,fF;var k,E=g,A;if(f.charCodeAt(E)===HS){for(;g++<p&&f.charCodeAt(g)!==HS||f.charCodeAt(++g)===HS;);return(k=g)>=p?v=!0:(A=f.charCodeAt(g++))===Zp?x=!0:A===VS&&(x=!0,f.charCodeAt(g)===Zp&&++g),f.slice(E+1,k-1).replace(/""/g,'"')}for(;g<p;){if((A=f.charCodeAt(k=g++))===Zp)x=!0;else if(A===VS)x=!0,f.charCodeAt(g)===Zp&&++g;else if(A!==n)continue;return f.slice(E,k)}return v=!0,f.slice(E,p)}for(;(y=_())!==WS;){for(var w=[];y!==fF&&y!==WS;)w.push(y),y=_();d&&(w=d(w,m++))==null||h.push(w)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function a(f,d){return d==null&&(d=dF(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function o(f,d){return d==null&&(d=dF(f)),s(f,d).join(`
`)}function l(f){return f.map(u).join(`
`)}function u(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?cX(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:a,formatBody:o,formatRows:l,formatRow:u,formatValue:c}}function dX(e){return e}function hX(e){if(e==null)return dX;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],a=e.translate[1];return function(o,l){l||(t=n=0);var u=2,c=o.length,f=new Array(c);for(f[0]=(t+=o[0])*r+s,f[1]=(n+=o[1])*i+a;u<c;)f[u]=o[u],++u;return f}}function pX(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function gX(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return hF(e,n)})}:hF(e,t)}function hF(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=yL(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function yL(e,t){var n=hX(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&pX(f,p)}function s(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function o(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(o)}function u(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=l(c.arcs);break;case"MultiPolygon":d=c.arcs.map(l);break;default:return null}return{type:f,coordinates:d}}return u(t)}function mX(e,t){var n={},r={},i={},s=[],a=-1;t.forEach(function(u,c){var f=e.arcs[u<0?~u:u],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=u,t[c]=d)}),t.forEach(function(u){var c=o(u),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(u),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(u),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[u],r[h.start=f]=i[h.end=d]=h});function o(u){var c=e.arcs[u<0?~u:u],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],u<0?[d,f]:[f,d]}function l(u,c){for(var f in u){var d=u[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return l(i,r),l(r,i),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function yX(e){return yL(e,vX.apply(this,arguments))}function vX(e,t,n){var r,i,s;if(arguments.length>1)r=bX(e,t,n);else for(i=0,r=new Array(s=e.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:mX(e,r)}}function bX(e,t,n){var r=[],i=[],s;function a(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:s})}function o(f){f.forEach(a)}function l(f){f.forEach(o)}function u(f){f.forEach(l)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":o(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":u(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}function ma(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function xX(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function W0(e){let t,n,r;e.length!==2?(t=ma,n=(o,l)=>ma(e(o),l),r=(o,l)=>e(o)-l):(t=e===ma||e===xX?e:wX,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function wX(){return 0}function vL(e){return e===null?NaN:+e}function*_X(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const bL=W0(ma),xv=bL.right,EX=bL.left;W0(vL).center;const H0=xv;function kX(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function SX(e,t){const n=kX(e,t);return n&&Math.sqrt(n)}class Nn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}class pF extends Map{constructor(t,n=_L){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(wA(this,t))}has(t){return super.has(wA(this,t))}set(t,n){return super.set(xL(this,t),n)}delete(t){return super.delete(wL(this,t))}}class wv extends Set{constructor(t,n=_L){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(wA(this,t))}add(t){return super.add(xL(this,t))}delete(t){return super.delete(wL(this,t))}}function wA({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function xL({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function wL({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function _L(e){return e!==null&&typeof e=="object"?e.valueOf():e}function AX(e,t){return Array.from(t,n=>e[n])}function $X(e=ma){if(e===ma)return EL;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function EL(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const CX=Math.sqrt(50),MX=Math.sqrt(10),TX=Math.sqrt(2);function _v(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=CX?10:s>=MX?5:s>=TX?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=n&&n<2?_v(e,t,n*2):[o,l,u]}function _A(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?_v(t,e,n):_v(e,t,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function EA(e,t,n){return t=+t,e=+e,n=+n,_v(e,t,n)[2]}function Ro(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?EA(t,e,n):EA(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function ic(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function kA(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function kL(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?EL:$X(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),h=Math.max(n,Math.floor(t-u*f/l+d)),p=Math.min(r,Math.floor(t+(l-u)*f/l+d));kL(e,t,h,p,i)}const s=e[t];let a=n,o=r;for(Qp(e,n,t),i(e[r],s)>0&&Qp(e,n,r);a<o;){for(Qp(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?Qp(e,n,o):(++o,Qp(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function Qp(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function SA(e,t,n){if(e=Float64Array.from(_X(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return kA(e);if(t>=1)return ic(e);var r,i=(r-1)*t,s=Math.floor(i),a=ic(kL(e,s).subarray(0,s+1)),o=kA(e.subarray(s+1));return a+(o-a)*(i-s)}}function SL(e,t,n=vL){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function NX(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function AL(e,t){return SA(e,.5,t)}function*FX(e){for(const t of e)yield*t}function $L(e){return Array.from(FX(e))}function _r(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function CL(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function DX(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ev(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function md(e){return e=Ev(Math.abs(e)),e?e[1]:NaN}function OX(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function RX(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var PX=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hc(e){if(!(t=PX.exec(e)))throw new Error("invalid format: "+e);var t;return new G$({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hc.prototype=G$.prototype;function G$(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}G$.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function IX(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var ML;function LX(e,t){var n=Ev(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(ML=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Ev(e,Math.max(0,t+s-1))[0]}function gF(e,t){var n=Ev(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const mF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:DX,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>gF(e*100,t),r:gF,s:LX,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function yF(e){return e}var vF=Array.prototype.map,bF=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function TL(e){var t=e.grouping===void 0||e.thousands===void 0?yF:OX(vF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?yF:RX(vF.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=hc(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,y=f.width,v=f.comma,x=f.precision,_=f.trim,w=f.type;w==="n"?(v=!0,w="g"):mF[w]||(x===void 0&&(x=12),_=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var k=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E=g==="$"?r:/[%p]/.test(w)?a:"",A=mF[w],z=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function D(R){var j=k,O=E,L,P,B;if(w==="c")O=A(R)+O,R="";else{R=+R;var U=R<0||1/R<0;if(R=isNaN(R)?l:A(Math.abs(R),x),_&&(R=IX(R)),U&&+R==0&&p!=="+"&&(U=!1),j=(U?p==="("?p:o:p==="-"||p==="("?"":p)+j,O=(w==="s"?bF[8+ML/3]:"")+O+(U&&p==="("?")":""),z){for(L=-1,P=R.length;++L<P;)if(B=R.charCodeAt(L),48>B||B>57){O=(B===46?i+R.slice(L+1):R.slice(L))+O,R=R.slice(0,L);break}}}v&&!m&&(R=t(R,1/0));var q=j.length+R.length+O.length,X=q<y?new Array(y-q+1).join(d):"";switch(v&&m&&(R=t(X+R,X.length?y-O.length:1/0),X=""),h){case"<":R=j+R+O+X;break;case"=":R=j+X+R+O;break;case"^":R=X.slice(0,q=X.length>>1)+j+R+O+X.slice(q);break;default:R=X+j+R+O;break}return s(R)}return D.toString=function(){return f+""},D}function c(f,d){var h=u((f=hc(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(md(d)/3)))*3,g=Math.pow(10,-p),m=bF[8+p/3];return function(y){return h(g*y)+m}}return{format:u,formatPrefix:c}}var sy,r2,W$;zX({thousands:",",grouping:[3],currency:["$",""]});function zX(e){return sy=TL(e),r2=sy.format,W$=sy.formatPrefix,sy}function NL(e){return Math.max(0,-md(Math.abs(e)))}function FL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(md(t)/3)))*3-md(Math.abs(e)))}function DL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,md(t)-md(e))+1}const JS=new Date,YS=new Date;function At(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),t(s,o),e(s);while(u<s&&s<a);return l},i.filter=s=>At(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(JS.setTime(+s),YS.setTime(+a),e(JS),e(YS),Math.floor(n(JS,YS))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const yd=At(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);yd.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?At(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):yd);yd.range;const ca=1e3,Hr=ca*60,fa=Hr*60,Sa=fa*24,H$=Sa*7,xF=Sa*30,XS=Sa*365,da=At(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ca)},(e,t)=>(t-e)/ca,e=>e.getUTCSeconds());da.range;const i2=At(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ca)},(e,t)=>{e.setTime(+e+t*Hr)},(e,t)=>(t-e)/Hr,e=>e.getMinutes());i2.range;const s2=At(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Hr)},(e,t)=>(t-e)/Hr,e=>e.getUTCMinutes());s2.range;const a2=At(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ca-e.getMinutes()*Hr)},(e,t)=>{e.setTime(+e+t*fa)},(e,t)=>(t-e)/fa,e=>e.getHours());a2.range;const o2=At(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*fa)},(e,t)=>(t-e)/fa,e=>e.getUTCHours());o2.range;const ya=At(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Hr)/Sa,e=>e.getDate()-1);ya.range;const Mo=At(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Sa,e=>e.getUTCDate()-1);Mo.range;const OL=At(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Sa,e=>Math.floor(e/Sa));OL.range;function zc(e){return At(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Hr)/H$)}const Qd=zc(0),kv=zc(1),BX=zc(2),UX=zc(3),vd=zc(4),jX=zc(5),qX=zc(6);Qd.range;kv.range;BX.range;UX.range;vd.range;jX.range;qX.range;function Bc(e){return At(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/H$)}const eh=Bc(0),Sv=Bc(1),GX=Bc(2),WX=Bc(3),bd=Bc(4),HX=Bc(5),VX=Bc(6);eh.range;Sv.range;GX.range;WX.range;bd.range;HX.range;VX.range;const c0=At(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());c0.range;const f0=At(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());f0.range;const ys=At(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ys.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:At(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});ys.range;const vs=At(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());vs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:At(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});vs.range;function RL(e,t,n,r,i,s){const a=[[da,1,ca],[da,5,5*ca],[da,15,15*ca],[da,30,30*ca],[s,1,Hr],[s,5,5*Hr],[s,15,15*Hr],[s,30,30*Hr],[i,1,fa],[i,3,3*fa],[i,6,6*fa],[i,12,12*fa],[r,1,Sa],[r,2,2*Sa],[n,1,H$],[t,1,xF],[t,3,3*xF],[e,1,XS]];function o(u,c,f){const d=c<u;d&&([u,c]=[c,u]);const h=f&&typeof f.range=="function"?f:l(u,c,f),p=h?h.range(u,+c+1):[];return d?p.reverse():p}function l(u,c,f){const d=Math.abs(c-u)/f,h=W0(([,,m])=>m).right(a,d);if(h===a.length)return e.every(Ro(u/XS,c/XS,f));if(h===0)return yd.every(Math.max(Ro(u,c,f),1));const[p,g]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return p.every(g)}return[o,l]}const[JX,YX]=RL(vs,f0,eh,OL,o2,s2),[XX,KX]=RL(ys,c0,Qd,ya,a2,i2),jt="year",er="quarter",an="month",Et="week",tr="date",en="day",bs="dayofyear",kr="hours",Sr="minutes",Qr="seconds",Oi="milliseconds",V$=[jt,er,an,Et,tr,en,bs,kr,Sr,Qr,Oi],KS=V$.reduce((e,t,n)=>(e[t]=1+n,e),{});function J$(e){const t=le(e).slice(),n={};return t.length||H("Missing time unit."),t.forEach(i=>{ve(KS,i)?n[i]=1:H(`Invalid time unit: ${i}.`)}),(n[Et]||n[en]?1:0)+(n[er]||n[an]||n[tr]?1:0)+(n[bs]?1:0)>1&&H(`Incompatible time units: ${e}`),t.sort((i,s)=>KS[i]-KS[s]),t}const ZX={[jt]:"%Y ",[er]:"Q%q ",[an]:"%b ",[tr]:"%d ",[Et]:"W%U ",[en]:"%a ",[bs]:"%j ",[kr]:"%H:00",[Sr]:"00:%M",[Qr]:":%S",[Oi]:".%L",[`${jt}-${an}`]:"%Y-%m ",[`${jt}-${an}-${tr}`]:"%Y-%m-%d ",[`${kr}-${Sr}`]:"%H:%M"};function PL(e,t){const n=Ae({},ZX,t),r=J$(e),i=r.length;let s="",a=0,o,l;for(a=0;a<i;)for(o=r.length;o>a;--o)if(l=r.slice(a,o).join("-"),n[l]!=null){s+=n[l],a=o;break}return s.trim()}const Hu=new Date;function Y$(e){return Hu.setFullYear(e),Hu.setMonth(0),Hu.setDate(1),Hu.setHours(0,0,0,0),Hu}function IL(e){return zL(new Date(e))}function LL(e){return AA(new Date(e))}function zL(e){return ya.count(Y$(e.getFullYear())-1,e)}function AA(e){return Qd.count(Y$(e.getFullYear())-1,e)}function $A(e){return Y$(e).getDay()}function QX(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(-1,t,n,r,i,s,a);return o.setFullYear(e),o}return new Date(e,t,n,r,i,s,a)}function BL(e){return jL(new Date(e))}function UL(e){return CA(new Date(e))}function jL(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Mo.count(t-1,e)}function CA(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return eh.count(t-1,e)}function MA(e){return Hu.setTime(Date.UTC(e,0,1)),Hu.getUTCDay()}function eK(e,t,n,r,i,s,a){if(0<=e&&e<100){const o=new Date(Date.UTC(-1,t,n,r,i,s,a));return o.setUTCFullYear(n.y),o}return new Date(Date.UTC(e,t,n,r,i,s,a))}function qL(e,t,n,r,i){const s=t||1,a=Oe(e),o=(y,v,x)=>(x=x||y,tK(n[x],r[x],y===a&&s,v)),l=new Date,u=Di(e),c=u[jt]?o(jt):cn(2012),f=u[an]?o(an):u[er]?o(er):yo,d=u[Et]&&u[en]?o(en,1,Et+en):u[Et]?o(Et,1):u[en]?o(en,1):u[tr]?o(tr,1):u[bs]?o(bs,1):Yd,h=u[kr]?o(kr):yo,p=u[Sr]?o(Sr):yo,g=u[Qr]?o(Qr):yo,m=u[Oi]?o(Oi):yo;return function(y){l.setTime(+y);const v=c(l);return i(v,f(l),d(l,v),h(l),p(l),g(l),m(l))}}function tK(e,t,n,r){const i=n<=1?e:r?(s,a)=>r+n*Math.floor((e(s,a)-r)/n):(s,a)=>n*Math.floor(e(s,a)/n);return t?(s,a)=>t(i(s,a),a):i}function xd(e,t,n){return t+e*7-(n+6)%7}const nK={[jt]:e=>e.getFullYear(),[er]:e=>Math.floor(e.getMonth()/3),[an]:e=>e.getMonth(),[tr]:e=>e.getDate(),[kr]:e=>e.getHours(),[Sr]:e=>e.getMinutes(),[Qr]:e=>e.getSeconds(),[Oi]:e=>e.getMilliseconds(),[bs]:e=>zL(e),[Et]:e=>AA(e),[Et+en]:(e,t)=>xd(AA(e),e.getDay(),$A(t)),[en]:(e,t)=>xd(1,e.getDay(),$A(t))},rK={[er]:e=>3*e,[Et]:(e,t)=>xd(e,0,$A(t))};function GL(e,t){return qL(e,t||1,nK,rK,QX)}const iK={[jt]:e=>e.getUTCFullYear(),[er]:e=>Math.floor(e.getUTCMonth()/3),[an]:e=>e.getUTCMonth(),[tr]:e=>e.getUTCDate(),[kr]:e=>e.getUTCHours(),[Sr]:e=>e.getUTCMinutes(),[Qr]:e=>e.getUTCSeconds(),[Oi]:e=>e.getUTCMilliseconds(),[bs]:e=>jL(e),[Et]:e=>CA(e),[en]:(e,t)=>xd(1,e.getUTCDay(),MA(t)),[Et+en]:(e,t)=>xd(CA(e),e.getUTCDay(),MA(t))},sK={[er]:e=>3*e,[Et]:(e,t)=>xd(e,0,MA(t))};function WL(e,t){return qL(e,t||1,iK,sK,eK)}const aK={[jt]:ys,[er]:c0.every(3),[an]:c0,[Et]:Qd,[tr]:ya,[en]:ya,[bs]:ya,[kr]:a2,[Sr]:i2,[Qr]:da,[Oi]:yd},oK={[jt]:vs,[er]:f0.every(3),[an]:f0,[Et]:eh,[tr]:Mo,[en]:Mo,[bs]:Mo,[kr]:o2,[Sr]:s2,[Qr]:da,[Oi]:yd};function th(e){return aK[e]}function nh(e){return oK[e]}function HL(e,t,n){return e?e.offset(t,n):void 0}function VL(e,t,n){return HL(th(e),t,n)}function JL(e,t,n){return HL(nh(e),t,n)}function YL(e,t,n,r){return e?e.range(t,n,r):void 0}function XL(e,t,n,r){return YL(th(e),t,n,r)}function KL(e,t,n,r){return YL(nh(e),t,n,r)}const Ag=1e3,$g=Ag*60,Cg=$g*60,l2=Cg*24,lK=l2*7,wF=l2*30,TA=l2*365,ZL=[jt,an,tr,kr,Sr,Qr,Oi],Mg=ZL.slice(0,-1),Tg=Mg.slice(0,-1),Ng=Tg.slice(0,-1),uK=Ng.slice(0,-1),cK=[jt,Et],_F=[jt,an],QL=[jt],eg=[[Mg,1,Ag],[Mg,5,5*Ag],[Mg,15,15*Ag],[Mg,30,30*Ag],[Tg,1,$g],[Tg,5,5*$g],[Tg,15,15*$g],[Tg,30,30*$g],[Ng,1,Cg],[Ng,3,3*Cg],[Ng,6,6*Cg],[Ng,12,12*Cg],[uK,1,l2],[cK,1,lK],[_F,1,wF],[_F,3,3*wF],[QL,1,TA]];function ez(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(G0(t))/n;let i=W0(o=>o[2]).right(eg,r),s,a;return i===eg.length?(s=QL,a=Ro(t[0]/TA,t[1]/TA,n)):i?(i=eg[r/eg[i-1][2]<eg[i][2]/r?i-1:i],s=i[0],a=i[1]):(s=ZL,a=Math.max(Ro(t[0],t[1],n),1)),{units:s,step:a}}function ZS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function QS(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function tg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function tz(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,l=e.shortMonths,u=ng(i),c=rg(i),f=ng(s),d=rg(s),h=ng(a),p=rg(a),g=ng(o),m=rg(o),y=ng(l),v=rg(l),x={a:U,A:q,b:X,B:ae,c:null,d:CF,e:CF,f:DK,g:qK,G:WK,H:TK,I:NK,j:FK,L:nz,m:OK,M:RK,p:fe,q:we,Q:NF,s:FF,S:PK,u:IK,U:LK,V:zK,w:BK,W:UK,x:null,X:null,y:jK,Y:GK,Z:HK,"%":TF},_={a:Te,A:Se,b:je,B:Ln,c:null,d:MF,e:MF,f:XK,g:aZ,G:lZ,H:VK,I:JK,j:YK,L:iz,m:KK,M:ZK,p:fn,q:dn,Q:NF,s:FF,S:QK,u:eZ,U:tZ,V:nZ,w:rZ,W:iZ,x:null,X:null,y:sZ,Y:oZ,Z:uZ,"%":TF},w={a:D,A:R,b:j,B:O,c:L,d:AF,e:AF,f:AK,g:SF,G:kF,H:$F,I:$F,j:_K,L:SK,m:wK,M:EK,p:z,q:xK,Q:CK,s:MK,S:kK,u:gK,U:mK,V:yK,w:pK,W:vK,x:P,X:B,y:SF,Y:kF,Z:bK,"%":$K};x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),_.x=k(n,_),_.X=k(r,_),_.c=k(t,_);function k(ue,he){return function(ke){var Z=[],dt=-1,Ne=0,gt=ue.length,bt,lr,tf;for(ke instanceof Date||(ke=new Date(+ke));++dt<gt;)ue.charCodeAt(dt)===37&&(Z.push(ue.slice(Ne,dt)),(lr=EF[bt=ue.charAt(++dt)])!=null?bt=ue.charAt(++dt):lr=bt==="e"?" ":"0",(tf=he[bt])&&(bt=tf(ke,lr)),Z.push(bt),Ne=dt+1);return Z.push(ue.slice(Ne,dt)),Z.join("")}}function E(ue,he){return function(ke){var Z=tg(1900,void 0,1),dt=A(Z,ue,ke+="",0),Ne,gt;if(dt!=ke.length)return null;if("Q"in Z)return new Date(Z.Q);if("s"in Z)return new Date(Z.s*1e3+("L"in Z?Z.L:0));if(he&&!("Z"in Z)&&(Z.Z=0),"p"in Z&&(Z.H=Z.H%12+Z.p*12),Z.m===void 0&&(Z.m="q"in Z?Z.q:0),"V"in Z){if(Z.V<1||Z.V>53)return null;"w"in Z||(Z.w=1),"Z"in Z?(Ne=QS(tg(Z.y,0,1)),gt=Ne.getUTCDay(),Ne=gt>4||gt===0?Sv.ceil(Ne):Sv(Ne),Ne=Mo.offset(Ne,(Z.V-1)*7),Z.y=Ne.getUTCFullYear(),Z.m=Ne.getUTCMonth(),Z.d=Ne.getUTCDate()+(Z.w+6)%7):(Ne=ZS(tg(Z.y,0,1)),gt=Ne.getDay(),Ne=gt>4||gt===0?kv.ceil(Ne):kv(Ne),Ne=ya.offset(Ne,(Z.V-1)*7),Z.y=Ne.getFullYear(),Z.m=Ne.getMonth(),Z.d=Ne.getDate()+(Z.w+6)%7)}else("W"in Z||"U"in Z)&&("w"in Z||(Z.w="u"in Z?Z.u%7:"W"in Z?1:0),gt="Z"in Z?QS(tg(Z.y,0,1)).getUTCDay():ZS(tg(Z.y,0,1)).getDay(),Z.m=0,Z.d="W"in Z?(Z.w+6)%7+Z.W*7-(gt+5)%7:Z.w+Z.U*7-(gt+6)%7);return"Z"in Z?(Z.H+=Z.Z/100|0,Z.M+=Z.Z%100,QS(Z)):ZS(Z)}}function A(ue,he,ke,Z){for(var dt=0,Ne=he.length,gt=ke.length,bt,lr;dt<Ne;){if(Z>=gt)return-1;if(bt=he.charCodeAt(dt++),bt===37){if(bt=he.charAt(dt++),lr=w[bt in EF?he.charAt(dt++):bt],!lr||(Z=lr(ue,ke,Z))<0)return-1}else if(bt!=ke.charCodeAt(Z++))return-1}return Z}function z(ue,he,ke){var Z=u.exec(he.slice(ke));return Z?(ue.p=c.get(Z[0].toLowerCase()),ke+Z[0].length):-1}function D(ue,he,ke){var Z=h.exec(he.slice(ke));return Z?(ue.w=p.get(Z[0].toLowerCase()),ke+Z[0].length):-1}function R(ue,he,ke){var Z=f.exec(he.slice(ke));return Z?(ue.w=d.get(Z[0].toLowerCase()),ke+Z[0].length):-1}function j(ue,he,ke){var Z=y.exec(he.slice(ke));return Z?(ue.m=v.get(Z[0].toLowerCase()),ke+Z[0].length):-1}function O(ue,he,ke){var Z=g.exec(he.slice(ke));return Z?(ue.m=m.get(Z[0].toLowerCase()),ke+Z[0].length):-1}function L(ue,he,ke){return A(ue,t,he,ke)}function P(ue,he,ke){return A(ue,n,he,ke)}function B(ue,he,ke){return A(ue,r,he,ke)}function U(ue){return a[ue.getDay()]}function q(ue){return s[ue.getDay()]}function X(ue){return l[ue.getMonth()]}function ae(ue){return o[ue.getMonth()]}function fe(ue){return i[+(ue.getHours()>=12)]}function we(ue){return 1+~~(ue.getMonth()/3)}function Te(ue){return a[ue.getUTCDay()]}function Se(ue){return s[ue.getUTCDay()]}function je(ue){return l[ue.getUTCMonth()]}function Ln(ue){return o[ue.getUTCMonth()]}function fn(ue){return i[+(ue.getUTCHours()>=12)]}function dn(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var he=k(ue+="",x);return he.toString=function(){return ue},he},parse:function(ue){var he=E(ue+="",!1);return he.toString=function(){return ue},he},utcFormat:function(ue){var he=k(ue+="",_);return he.toString=function(){return ue},he},utcParse:function(ue){var he=E(ue+="",!0);return he.toString=function(){return ue},he}}}var EF={"-":"",_:" ",0:"0"},Lt=/^\s*\d+/,fK=/^%/,dK=/[\\^$*+?|[\]().{}]/g;function Le(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function hK(e){return e.replace(dK,"\\$&")}function ng(e){return new RegExp("^(?:"+e.map(hK).join("|")+")","i")}function rg(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function pK(e,t,n){var r=Lt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function gK(e,t,n){var r=Lt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function mK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function yK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function vK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function kF(e,t,n){var r=Lt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function SF(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function bK(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function xK(e,t,n){var r=Lt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function wK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function AF(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function _K(e,t,n){var r=Lt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function $F(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function EK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function kK(e,t,n){var r=Lt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function SK(e,t,n){var r=Lt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function AK(e,t,n){var r=Lt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function $K(e,t,n){var r=fK.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function CK(e,t,n){var r=Lt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function MK(e,t,n){var r=Lt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function CF(e,t){return Le(e.getDate(),t,2)}function TK(e,t){return Le(e.getHours(),t,2)}function NK(e,t){return Le(e.getHours()%12||12,t,2)}function FK(e,t){return Le(1+ya.count(ys(e),e),t,3)}function nz(e,t){return Le(e.getMilliseconds(),t,3)}function DK(e,t){return nz(e,t)+"000"}function OK(e,t){return Le(e.getMonth()+1,t,2)}function RK(e,t){return Le(e.getMinutes(),t,2)}function PK(e,t){return Le(e.getSeconds(),t,2)}function IK(e){var t=e.getDay();return t===0?7:t}function LK(e,t){return Le(Qd.count(ys(e)-1,e),t,2)}function rz(e){var t=e.getDay();return t>=4||t===0?vd(e):vd.ceil(e)}function zK(e,t){return e=rz(e),Le(vd.count(ys(e),e)+(ys(e).getDay()===4),t,2)}function BK(e){return e.getDay()}function UK(e,t){return Le(kv.count(ys(e)-1,e),t,2)}function jK(e,t){return Le(e.getFullYear()%100,t,2)}function qK(e,t){return e=rz(e),Le(e.getFullYear()%100,t,2)}function GK(e,t){return Le(e.getFullYear()%1e4,t,4)}function WK(e,t){var n=e.getDay();return e=n>=4||n===0?vd(e):vd.ceil(e),Le(e.getFullYear()%1e4,t,4)}function HK(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Le(t/60|0,"0",2)+Le(t%60,"0",2)}function MF(e,t){return Le(e.getUTCDate(),t,2)}function VK(e,t){return Le(e.getUTCHours(),t,2)}function JK(e,t){return Le(e.getUTCHours()%12||12,t,2)}function YK(e,t){return Le(1+Mo.count(vs(e),e),t,3)}function iz(e,t){return Le(e.getUTCMilliseconds(),t,3)}function XK(e,t){return iz(e,t)+"000"}function KK(e,t){return Le(e.getUTCMonth()+1,t,2)}function ZK(e,t){return Le(e.getUTCMinutes(),t,2)}function QK(e,t){return Le(e.getUTCSeconds(),t,2)}function eZ(e){var t=e.getUTCDay();return t===0?7:t}function tZ(e,t){return Le(eh.count(vs(e)-1,e),t,2)}function sz(e){var t=e.getUTCDay();return t>=4||t===0?bd(e):bd.ceil(e)}function nZ(e,t){return e=sz(e),Le(bd.count(vs(e),e)+(vs(e).getUTCDay()===4),t,2)}function rZ(e){return e.getUTCDay()}function iZ(e,t){return Le(Sv.count(vs(e)-1,e),t,2)}function sZ(e,t){return Le(e.getUTCFullYear()%100,t,2)}function aZ(e,t){return e=sz(e),Le(e.getUTCFullYear()%100,t,2)}function oZ(e,t){return Le(e.getUTCFullYear()%1e4,t,4)}function lZ(e,t){var n=e.getUTCDay();return e=n>=4||n===0?bd(e):bd.ceil(e),Le(e.getUTCFullYear()%1e4,t,4)}function uZ(){return"+0000"}function TF(){return"%"}function NF(e){return+e}function FF(e){return Math.floor(+e/1e3)}var Of,X$,az,K$,oz;cZ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function cZ(e){return Of=tz(e),X$=Of.format,az=Of.parse,K$=Of.utcFormat,oz=Of.utcParse,Of}function Fg(e){const t={};return n=>t[n]||(t[n]=e(n))}function fZ(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=dZ(r,i);const a=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+a}}function dZ(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function lz(e){const t=Fg(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=hc(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return fZ(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,a){a=hc(a??",f");const o=Ro(r,i,s),l=Math.max(Math.abs(r),Math.abs(i));let u;if(a.precision==null)switch(a.type){case"s":return isNaN(u=FL(o,l))||(a.precision=u),n(a,l);case"":case"e":case"g":case"p":case"r":{isNaN(u=DL(o,l))||(a.precision=u-(a.type==="e"));break}case"f":case"%":{isNaN(u=NL(o))||(a.precision=u-(a.type==="%")*2);break}}return t(a)}}}let NA;uz();function uz(){return NA=lz({format:r2,formatPrefix:W$})}function cz(e){return lz(TL(e))}function Av(e){return arguments.length?NA=cz(e):NA}function DF(e,t,n){n=n||{},ce(n)||H(`Invalid time multi-format specifier: ${n}`);const r=t(Qr),i=t(Sr),s=t(kr),a=t(tr),o=t(Et),l=t(an),u=t(er),c=t(jt),f=e(n[Oi]||".%L"),d=e(n[Qr]||":%S"),h=e(n[Sr]||"%I:%M"),p=e(n[kr]||"%I %p"),g=e(n[tr]||n[en]||"%a %d"),m=e(n[Et]||"%b %d"),y=e(n[an]||"%B"),v=e(n[er]||"%B"),x=e(n[jt]||"%Y");return _=>(r(_)<_?f:i(_)<_?d:s(_)<_?h:a(_)<_?p:l(_)<_?o(_)<_?g:m:c(_)<_?u(_)<_?y:v:x)(_)}function fz(e){const t=Fg(e.format),n=Fg(e.utcFormat);return{timeFormat:r=>oe(r)?t(r):DF(t,th,r),utcFormat:r=>oe(r)?n(r):DF(n,nh,r),timeParse:Fg(e.parse),utcParse:Fg(e.utcParse)}}let FA;dz();function dz(){return FA=fz({format:X$,parse:az,utcFormat:K$,utcParse:oz})}function hz(e){return fz(tz(e))}function d0(e){return arguments.length?FA=hz(e):FA}const DA=(e,t)=>Ae({},e,t);function pz(e,t){const n=e?cz(e):Av(),r=t?hz(t):d0();return DA(n,r)}function Z$(e,t){const n=arguments.length;return n&&n!==2&&H("defaultLocale expects either zero or two arguments."),n?DA(Av(e),d0(t)):DA(Av(),d0())}function hZ(){return uz(),dz(),Z$()}const pZ=/^(data:|([A-Za-z]+:)?\/\/)/,gZ=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,mZ=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,OF="file://";function yZ(e,t){return n=>({options:n||{},sanitize:bZ,load:vZ,fileAccess:!!t,file:xZ(t),http:_Z(e)})}async function vZ(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function bZ(e,t){t=Ae({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,a;const o=gZ.test(e.replace(mZ,""));(e==null||typeof e!="string"||!o)&&H("Sanitize failure, invalid URI: "+te(e));const l=pZ.test(e);return(a=t.baseURL)&&!l&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),s=(i=e.startsWith(OF))||t.mode==="file"||t.mode!=="http"&&!l&&n,i?e=e.slice(OF.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function xZ(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):wZ}async function wZ(){H("No file system access.")}function _Z(e){return e?async function(t,n){const r=Ae({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?$e(s[i])?s[i]():s.text():H(s.status+""+s.statusText)}:EZ}async function EZ(){H("No HTTP fetch method available.")}const kZ=e=>e!=null&&e===e,SZ=e=>e==="true"||e==="false"||e===!0||e===!1,AZ=e=>!Number.isNaN(Date.parse(e)),gz=e=>!Number.isNaN(+e)&&!(e instanceof Date),$Z=e=>gz(e)&&Number.isInteger(+e),OA={boolean:U$,integer:tn,number:tn,date:j$,string:q$,unknown:un},ay=[SZ,$Z,gz,AZ],CZ=["boolean","integer","number","date"];function mz(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=ay.length,i=ay.map((s,a)=>a+1);for(let s=0,a=0,o,l;s<n;++s)for(l=t?e[s][t]:e[s],o=0;o<r;++o)if(i[o]&&kZ(l)&&!ay[o](l)&&(i[o]=0,++a,a===ay.length))return"string";return CZ[i.reduce((s,a)=>s===0?a:s,0)-1]}function yz(e,t){return t.reduce((n,r)=>(n[r]=mz(e,r),n),{})}function RF(e){const t=function(n,r){const i={delimiter:e};return Q$(n,r?Ae(r,i):i)};return t.responseType="text",t}function Q$(e,t){return t.header&&(e=t.header.map(te).join(t.delimiter)+`
`+e),fX(t.delimiter).parse(e+"")}Q$.responseType="text";function MZ(e){return typeof Buffer=="function"&&$e(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function eC(e,t){const n=t&&t.property?Qn(t.property):un;return ce(e)&&!MZ(e)?TZ(n(e),t):n(JSON.parse(e))}eC.responseType="json";function TZ(e,t){return!Y(e)&&uL(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const NZ={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function vz(e,t){let n,r,i,s;return e=eC(e,t),t&&t.feature?(n=gX,i=t.feature):t&&t.mesh?(n=yX,i=t.mesh,s=NZ[t.filter]):H("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):H("Invalid TopoJSON object: "+i),r&&r.features||[r]}vz.responseType="json";const Wy={dsv:Q$,csv:RF(","),tsv:RF("	"),json:eC,topojson:vz};function tC(e,t){return arguments.length>1?(Wy[e]=t,this):ve(Wy,e)?Wy[e]:null}function bz(e){const t=tC(e);return t&&t.responseType||"text"}function xz(e,t,n,r){t=t||{};const i=tC(t.type||"json");return i||H("Unknown data format type: "+t.type),e=i(e,t),t.parse&&FZ(e,t.parse,n,r),ve(e,"columns")&&delete e.columns,e}function FZ(e,t,n,r){if(!e.length)return;const i=d0();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),a,o,l,u,c,f;t==="auto"&&(t=yz(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!OA[p])throw Error("Illegal format pattern: "+h+":"+p);return OA[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(a=e[l],u=0;u<f;++u)o=s[u],a[o]=d[u](a[o])}const u2=yZ(typeof fetch<"u"&&fetch,null);function c2(e){const t=e||un,n=[],r={};return n.add=i=>{const s=t(i);return r[s]||(r[s]=1,n.push(i)),n},n.remove=i=>{const s=t(i);if(r[s]){r[s]=0;const a=n.indexOf(i);a>=0&&n.splice(a,1)}return n},n}async function Hy(e,t){try{await t(e)}catch(n){e.error(n)}}const wz=Symbol("vega_id");let DZ=1;function f2(e){return!!(e&&me(e))}function me(e){return e[wz]}function _z(e,t){return e[wz]=t,e}function Ue(e){const t=e===Object(e)?e:{data:e};return me(t)?t:_z(t,DZ++)}function nC(e){return d2(e,Ue({}))}function d2(e,t){for(const n in e)t[n]=e[n];return t}function Ez(e,t){return _z(t,me(e))}function Uc(e,t){return e?t?(n,r)=>e(n,r)||me(t(n))-me(t(r)):(n,r)=>e(n,r)||me(n)-me(r):null}function kz(e){return e&&e.constructor===jc}function jc(){const e=[],t=[],n=[],r=[],i=[];let s=null,a=!1;return{constructor:jc,insert(o){const l=le(o),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(o){const l=$e(o)?r:t,u=le(o),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(o,l,u){const c={field:l,value:cn(u)};return $e(o)?(c.filter=o,i.push(c)):(c.tuple=o,n.push(c)),this},encode(o,l){return $e(o)?i.push({filter:o,field:l}):n.push({tuple:o,field:l}),this},clean(o){return s=o,this},reflow(){return a=!0,this},pulse(o,l){const u={},c={};let f,d,h,p,g,m;for(f=0,d=l.length;f<d;++f)u[me(l[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],u[me(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],l.forEach(v=>{p(v)&&(u[me(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=me(g),u[m]?u[m]=1:o.add.push(Ue(e[f]));for(f=0,d=l.length;f<d;++f)g=l[f],u[me(g)]<0&&o.rem.push(g);function y(v,x,_){_?v[x]=_(v):o.encode=x,a||(c[me(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=u[me(g)],m>0&&(y(g,p,h.value),o.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,l.forEach(v=>{p(v)&&u[me(v)]>0&&y(v,h.field,h.value)}),o.modifies(h.field);if(a)o.mod=t.length||r.length?l.filter(v=>u[me(v)]>0):l.slice();else for(m in c)o.mod.push(c[m]);return(s||s==null&&(t.length||r.length))&&o.clean(!0),o}}}const Vy="_:mod:_";function h2(){Object.defineProperty(this,Vy,{writable:!0,value:{}})}h2.prototype={set(e,t,n,r){const i=this,s=i[e],a=i[Vy];return t!=null&&t>=0?(s[t]!==n||r)&&(s[t]=n,a[t+":"+e]=-1,a[e]=-1):(s!==n||r)&&(i[e]=n,a[e]=Y(n)?1+n.length:-1),i},modified(e,t){const n=this[Vy];if(arguments.length){if(Y(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Vy]={},this}};let OZ=0;const RZ="pulse",PZ=new h2,IZ=1,LZ=2;function Ze(e,t,n,r){this.id=++OZ,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function PF(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Ze.prototype={targets(){return this._targets||(this._targets=c2(q0))},set(e){return this.value!==e?(this.value=e,1):0},skip:PF(IZ),modified:PF(LZ),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new h2,i=this._argops=this._argops||[],s=[];let a,o,l,u;const c=(f,d,h)=>{h instanceof Ze?(h!==this&&(t&&h.targets().add(this),s.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(a in e)if(o=e[a],a===RZ)le(o).forEach(f=>{f instanceof Ze?f!==this&&(f.targets().add(this),s.push(f)):H("Pulse parameters must be operator instances.")}),this.source=o;else if(Y(o))for(r.set(a,-1,Array(l=o.length)),u=0;u<l;++u)c(a,u,o[u]);else c(a,-1,o);return this.marshall().clear(),n&&(i.initonly=!0),s},marshall(e){const t=this._argval||PZ,n=this._argops;let r,i,s,a;if(n){const o=n.length;for(i=0;i<o;++i)r=n[i],s=r.op,a=s.modified()&&s.stamp===e,t.set(r.name,r.index,s.value,a);if(n.initonly){for(i=0;i<o;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function zZ(e,t,n,r){let i=1,s;return e instanceof Ze?s=e:e&&e.prototype instanceof Ze?s=new e:$e(e)?s=new Ze(null,e):(i=0,s=new Ze(e,t)),this.rank(s),i&&(r=n,n=t),n&&this.connect(s,s.parameters(n,r)),this.touch(s),s}function BZ(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let UZ=0;function p2(e,t,n){this.id=++UZ,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function uo(e,t,n){return new p2(e,t,n)}p2.prototype={_filter:Zr,_apply:un,targets(){return this._targets||(this._targets=c2(q0))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=uo(e);return this.targets().add(t),t},apply(e){const t=uo(null,e);return this.targets().add(t),t},merge(){const e=uo();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=uo();return this.targets().add(uo(null,null,z$(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(uo(null,null,()=>n=!0)),t.targets().add(uo(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Zr,this._targets=null}};function jZ(e,t,n,r){const i=this,s=uo(n,r),a=function(u){u.dataflow=i;try{s.receive(u)}catch(c){i.error(c)}finally{i.run()}};let o;typeof e=="string"&&typeof document<"u"?o=document.querySelectorAll(e):o=le(e);const l=o.length;for(let u=0;u<l;++u)o[u].addEventListener(t,a);return s}function qZ(e,t){const n=this.locale();return xz(e,t,n.timeParse,n.utcParse)}function GZ(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function WZ(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:bz(t&&t.type)});try{i=n.parse(i,t)}catch(s){r=-2,n.warn("Data ingestion failed",e,s)}}catch(s){r=-1,n.warn("Loading failed",e,s)}return{data:i,status:r}}async function HZ(e,t,n){const r=this,i=r._pending||VZ(r);i.requests+=1;const s=await r.request(t,n);return r.pulse(e,r.changeset().remove(Zr).insert(s.data||[])),i.done(),s}function VZ(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const JZ={skip:!0};function YZ(e,t,n,r,i){return(e instanceof Ze?KZ:XZ)(this,e,t,n,r,i),this}function XZ(e,t,n,r,i,s){const a=Ae({},s,JZ);let o,l;$e(n)||(n=cn(n)),r===void 0?o=u=>e.touch(n(u)):$e(r)?(l=new Ze(null,r,i,!1),o=u=>{l.evaluate(u);const c=n(u),f=l.value;kz(f)?e.pulse(c,f,s):e.update(c,f,a)}):o=u=>e.update(n(u),r,a),t.apply(o)}function KZ(e,t,n,r,i,s){if(r===void 0)t.targets().add(n);else{const a=s||{},o=new Ze(null,ZZ(n,r),i,!1);o.modified(a.force),o.rank=t.rank,t.targets().add(o),n&&(o.skip(!0),o.value=n.value,o.targets().add(n),e.connect(n,[o]))}}function ZZ(e,t){return t=$e(t)?t:cn(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function QZ(e){e.rank=++this._rank}function eQ(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&H("Cycle detected in dataflow graph.")}const $v={},ts=1<<0,ho=1<<1,ia=1<<2,tQ=ts|ho,IF=ts|ia,Rf=ts|ho|ia,LF=1<<3,ig=1<<4,zF=1<<5,BF=1<<6;function To(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function e5(e,t){const n=[];return fo(e,t,r=>n.push(r)),n}function UF(e,t){const n={};return e.visit(t,r=>{n[me(r)]=1}),r=>n[me(r)]?null:r}function oy(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}To.prototype={StopPropagation:$v,ADD:ts,REM:ho,MOD:ia,ADD_REM:tQ,ADD_MOD:IF,ALL:Rf,REFLOW:LF,SOURCE:ig,NO_SOURCE:zF,NO_FIELDS:BF,fork(e){return new To(this.dataflow).init(this,e)},clone(){const e=this.fork(Rf);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Rf|ig)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new To(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&BF)&&(n.fields=e.fields),t&ts?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ho?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&ia?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&zF?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Rf;return t&ts&&this.add.length||t&ho&&this.rem.length||t&ia&&this.mod.length},reflow(e){if(e)return this.fork(Rf).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(ia,UF(this,ts))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Y(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Y(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&ts&&(n.addF=oy(n.addF,t)),e&ho&&(n.remF=oy(n.remF,t)),e&ia&&(n.modF=oy(n.modF,t)),e&ig&&(n.srcF=oy(n.srcF,t)),n},materialize(e){e=e||Rf;const t=this;return e&ts&&t.addF&&(t.add=e5(t.add,t.addF),t.addF=null),e&ho&&t.remF&&(t.rem=e5(t.rem,t.remF),t.remF=null),e&ia&&t.modF&&(t.mod=e5(t.mod,t.modF),t.modF=null),e&ig&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&ig)return fo(n.source,n.srcF,r),n;e&ts&&fo(n.add,n.addF,r),e&ho&&fo(n.rem,n.remF,r),e&ia&&fo(n.mod,n.modF,r);const i=n.source;if(e&LF&&i){const s=n.add.length+n.mod.length;s===i.length||(s?fo(i,UF(n,IF),r):fo(i,n.srcF,r))}return n}};function rC(e,t,n,r){const i=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const a of n)if(a.stamp===t){if(a.fields){const o=i.fields||(i.fields={});for(const l in a.fields)o[l]=1}a.changed(i.ADD)&&(s|=i.ADD),a.changed(i.REM)&&(s|=i.REM),a.changed(i.MOD)&&(s|=i.MOD)}this.changes=s}ne(rC,To,{fork(e){const t=new To(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Y(e)?e.some(r=>n[r]):n[e]:0},filter(){H("MultiPulse does not support filtering.")},materialize(){H("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let s=0;if(e&n.SOURCE)for(;s<i;++s)r[s].visit(e,t);else for(;s<i;++s)r[s].stamp===n.stamp&&r[s].visit(e,t);return n}});async function nQ(e,t,n){const r=this,i=[];if(r._pulse)return Sz(r);if(r._pending&&await r._pending,t&&await Hy(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const s=++r._clock;r._pulse=new To(r,s,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=c2(q0);let a=0,o,l,u;try{for(;r._heap.size()>0;){if(o=r._heap.pop(),o.rank!==o.qrank){r._enqueue(o,!0);continue}l=o.run(r._getPulse(o,e)),l.then?l=await l:l.async&&(i.push(l.async),l=$v),l!==$v&&o._targets&&o._targets.forEach(c=>r._enqueue(c)),++a}}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${s}: ${a} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await Hy(r,c[f].callback)}return n&&await Hy(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function rQ(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function iQ(e,t,n){return this._pulse?Sz(this):(this.evaluate(e,t,n),this)}function sQ(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function Sz(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function aQ(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function oQ(e,t){const n=e.source,r=this._clock;return n&&Y(n)?new rC(this,r,n.map(i=>i.pulse),t):this._input[e.id]||lQ(this._pulse,n&&n.pulse)}function lQ(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==$v&&(e.source=t.source),e)}const iC={skip:!1,force:!1};function uQ(e,t){const n=t||iC;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function cQ(e,t,n){const r=n||iC;return(e.set(t)||r.force)&&this.touch(e,r),this}function fQ(e,t,n){this.touch(e,n||iC);const r=new To(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function dQ(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),Az(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,hQ(t,0,e)):r=n,r}}}function Az(e,t,n,r){let i,s;const a=e[n];for(;n>t;){if(s=n-1>>1,i=e[s],r(a,i)<0){e[n]=i,n=s;continue}break}return e[n]=a}function hQ(e,t,n){const r=t,i=e.length,s=e[t];let a=(t<<1)+1,o;for(;a<i;)o=a+1,o<i&&n(e[a],e[o])>=0&&(a=o),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=s,Az(e,r,t,n)}function rd(){this.logger(O$()),this.logLevel(F$),this._clock=0,this._rank=0,this._locale=Z$();try{this._loader=u2()}catch{}this._touched=c2(q0),this._input={},this._pulse=null,this._heap=dQ((e,t)=>e.qrank-t.qrank),this._postrun=[]}function sg(e){return function(){return this._log[e].apply(this,arguments)}}rd.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:sg("error"),warn:sg("warn"),info:sg("info"),debug:sg("debug"),logLevel:sg("level"),cleanThreshold:1e4,add:zZ,connect:BZ,rank:QZ,rerank:eQ,pulse:fQ,touch:uQ,update:cQ,changeset:jc,ingest:GZ,parse:qZ,preload:HZ,request:WZ,events:jZ,on:YZ,evaluate:nQ,run:iQ,runAsync:rQ,runAfter:sQ,_enqueue:aQ,_getPulse:oQ};function G(e,t){Ze.call(this,e,null,t)}ne(G,Ze,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const wd={};function $z(e){const t=Cz(e);return t&&t.Definition||null}function Cz(e){return e=e&&e.toLowerCase(),ve(wd,e)?wd[e]:null}function*Mz(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function sC(e,t,n){const r=Float64Array.from(Mz(e,n));return r.sort(ma),t.map(i=>SL(r,i))}function aC(e,t){return sC(e,[.25,.5,.75],t)}function oC(e,t){const n=e.length,r=SX(e,t),i=aC(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function Tz(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],a=e.extent[1],o,l,u,c,f,d;const h=e.span||a-s||Math.abs(s)||1;if(e.step)o=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);o=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/r),u=e.minstep||0,o=Math.max(u,Math.pow(n,Math.round(Math.log(h)/r)-l));Math.ceil(h/o)>t;)o*=n;for(f=0,d=i.length;f<d;++f)c=o/i[f],c>=u&&h/c<=t&&(o=c)}c=Math.log(o);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/o+g)*o,s=s<c?c-o:c,a=Math.ceil(a/o)*o),{start:s,stop:a===s?s+o:a,step:o}}var ei=Math.random;function pQ(e){ei=e}function Nz(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Mz(e,r)),s=i.length,a=t;let o,l,u,c;for(u=0,c=Array(a);u<a;++u){for(o=0,l=0;l<s;++l)o+=i[~~(ei()*s)];c[u]=o/s}return c.sort(ma),[SA(c,n/2),SA(c,1-n/2)]}function Fz(e,t,n,r){r=r||(d=>d);const i=e.length,s=new Float64Array(i);let a=0,o=1,l=r(e[0]),u=l,c=l+t,f;for(;o<i;++o){if(f=r(e[o]),f>=c){for(u=(l+u)/2;a<o;++a)s[a]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;a<o;++a)s[a]=u;return n?gQ(s,t+t/4):s}function gQ(e,t){const n=e.length;let r=0,i=1,s,a;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(a=i+(r+s-i-i>>1);a<i;)e[a++]=e[i];for(;a>i;)e[a--]=e[r]}r=i,i=s}return e}function mQ(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function yQ(e,t){t==null&&(t=e,e=0);let n,r,i;const s={min(a){return arguments.length?(n=a||0,i=r-n,s):n},max(a){return arguments.length?(r=a||0,i=r-n,s):r},sample(){return n+Math.floor(i*ei())},pdf(a){return a===Math.floor(a)&&a>=n&&a<r?1/i:0},cdf(a){const o=Math.floor(a);return o<n?0:o>=r?1:(o-n+1)/i},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*i):NaN}};return s.min(e).max(t)}const Dz=Math.sqrt(2*Math.PI),vQ=Math.SQRT2;let ag=NaN;function g2(e,t){e=e||0,t=t??1;let n=0,r=0,i,s;if(ag===ag)n=ag,ag=NaN;else{do n=ei()*2-1,r=ei()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,ag=r*s}return e+n*t}function lC(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Dz)}function m2(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const a=Math.exp(-i*i/2);let o;i<7.07106781186547?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=a*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s=s/o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=a/o/2.506628274631)}return r>0?1-s:s}function y2(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*vQ*bQ(2*e-1)}function bQ(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function uC(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>g2(n,r),pdf:s=>lC(s,n,r),cdf:s=>m2(s,n,r),icdf:s=>y2(s,n,r)};return i.mean(e).stdev(t)}function cC(e,t){const n=uC();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=oC(e)),i):t},sample(){return e[~~(ei()*r)]+t*n.sample()},pdf(s){let a=0,o=0;for(;o<r;++o)a+=n.pdf((s-e[o])/t);return a/t/r},cdf(s){let a=0,o=0;for(;o<r;++o)a+=n.cdf((s-e[o])/t);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function fC(e,t){return e=e||0,t=t??1,Math.exp(e+g2()*t)}function dC(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Dz*e)}function hC(e,t,n){return m2(Math.log(e),t,n)}function pC(e,t,n){return Math.exp(y2(e,t,n))}function Oz(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>fC(n,r),pdf:s=>dC(s,n,r),cdf:s=>hC(s,n,r),icdf:s=>pC(s,n,r)};return i.mean(e).stdev(t)}function Rz(e,t){let n=0,r;function i(a){const o=[];let l=0,u;for(u=0;u<n;++u)l+=o[u]=a[u]==null?1:+a[u];for(u=0;u<n;++u)o[u]/=l;return o}const s={weights(a){return arguments.length?(r=i(t=a||[]),s):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),s.weights(t)):e},sample(){const a=ei();let o=e[n-1],l=r[0],u=0;for(;u<n-1;l+=r[++u])if(a<l){o=e[u];break}return o.sample()},pdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].pdf(a);return o},cdf(a){let o=0,l=0;for(;l<n;++l)o+=r[l]*e[l].cdf(a);return o},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function gC(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ei()}function mC(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function yC(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function vC(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Pz(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s??1,i):r},sample:()=>gC(n,r),pdf:s=>mC(s,n,r),cdf:s=>yC(s,n,r),icdf:s=>vC(s,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function bC(e,t,n){let r=0,i=0;for(const s of e){const a=n(s);t(s)==null||a==null||isNaN(a)||(r+=(a-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function V0(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function v2(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,s=new Float64Array(i),a=new Float64Array(i);let o=0,l=0,u=0,c,f,d;for(d of e)s[o]=c=+t(d),a[o]=f=+n(d),++o,l+=(c-l)/o,u+=(f-u)/o;for(o=0;o<i;++o)s[o]-=l,a[o]-=u;return[s,a,l,u]}function J0(e,t,n,r){let i=-1,s,a;for(const o of e)s=t(o),a=n(o),s!=null&&(s=+s)>=s&&a!=null&&(a=+a)>=a&&r(s,a,++i)}function rh(e,t,n,r,i){let s=0,a=0;return J0(e,t,n,(o,l)=>{const u=l-i(o),c=l-r;s+=u*u,a+=c*c}),1-s/a}function xC(e,t,n){let r=0,i=0,s=0,a=0,o=0;J0(e,t,n,(c,f)=>{++o,r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=V0(r,i,s,a),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:rh(e,t,n,i,u)}}function Iz(e,t,n){let r=0,i=0,s=0,a=0,o=0;J0(e,t,n,(c,f)=>{++o,c=Math.log(c),r+=(c-r)/o,i+=(f-i)/o,s+=(c*f-s)/o,a+=(c*c-a)/o});const l=V0(r,i,s,a),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:rh(e,t,n,i,u)}}function Lz(e,t,n){const[r,i,s,a]=v2(e,t,n);let o=0,l=0,u=0,c=0,f=0,d,h,p;J0(e,t,n,(v,x)=>{d=r[f++],h=Math.log(x),p=d*x,o+=(x*h-o)/f,l+=(p-l)/f,u+=(p*h-u)/f,c+=(d*p-c)/f});const[g,m]=V0(l/a,o/a,u/a,c/a),y=v=>Math.exp(g+m*(v-s));return{coef:[Math.exp(g-m*s),m],predict:y,rSquared:rh(e,t,n,a,y)}}function zz(e,t,n){let r=0,i=0,s=0,a=0,o=0,l=0;J0(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++l,r+=(h-r)/l,i+=(p-i)/l,s+=(h*p-s)/l,a+=(h*h-a)/l,o+=(d-o)/l});const u=V0(r,i,s,a),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:rh(e,t,n,o,c)}}function wC(e,t,n){const[r,i,s,a]=v2(e,t,n),o=r.length;let l=0,u=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<o;)p=r[h],g=i[h++],m=p*p,l+=(m-l)/h,u+=(m*p-u)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const y=c-l*l,v=l*y-u*u,x=(d*l-f*u)/v,_=(f*y-d*u)/v,w=-x*l,k=E=>(E=E-s,x*E*E+_*E+w+a);return{coef:[w-_*s+x*s*s+a,_-2*x*s,x],predict:k,rSquared:rh(e,t,n,a,k)}}function Bz(e,t,n,r){if(r===0)return bC(e,t,n);if(r===1)return xC(e,t,n);if(r===2)return wC(e,t,n);const[i,s,a,o]=v2(e,t,n),l=i.length,u=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],d)*s[p];for(u.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(u);const y=wQ(c),v=x=>{x-=a;let _=o+y[0]+y[1]*x+y[2]*x*x;for(d=3;d<f;++d)_+=y[d]*Math.pow(x,d);return _};return{coef:xQ(f,y,-a,o),predict:v,rSquared:rh(e,t,n,o,v)}}function xQ(e,t,n,r){const i=Array(e);let s,a,o,l;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(o=t[s],l=1,i[s]+=o,a=1;a<=s;++a)l*=(s+1-a)/a,i[s-a]+=o*Math.pow(n,a)*l;return i[0]+=r,i}function wQ(e){const t=e.length-1,n=[];let r,i,s,a,o;for(r=0;r<t;++r){for(a=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][a])&&(a=i);for(s=r;s<t+1;++s)o=e[s][r],e[s][r]=e[s][a],e[s][a]=o;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(o=0,s=i+1;s<t;++s)o+=e[s][i]*n[s];n[i]=(e[t][i]-o)/e[i][i]}return n}const jF=2,qF=1e-12;function Uz(e,t,n,r){const[i,s,a,o]=v2(e,t,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=jF;){const p=[0,u-1];for(let m=0;m<l;++m){const y=i[m],v=p[0],x=p[1],_=y-i[v]>i[x]-y?v:x;let w=0,k=0,E=0,A=0,z=0;const D=1/Math.abs(i[_]-y||1);for(let O=v;O<=x;++O){const L=i[O],P=s[O],B=_Q(Math.abs(y-L)*D)*d[O],U=L*B;w+=B,k+=U,E+=P*B,A+=P*U,z+=L*U}const[R,j]=V0(k/w,E/w,A/w,z/w);c[m]=R+j*y,f[m]=Math.abs(s[m]-c[m]),EQ(i,m+1,p)}if(h===jF)break;const g=AL(f);if(Math.abs(g)<qF)break;for(let m=0,y,v;m<l;++m)y=f[m]/(6*g),d[m]=y>=1?qF:(v=1-y*y)*v}return kQ(i,c,a,o)}function _Q(e){return(e=1-e*e*e)*e*e}function EQ(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function kQ(e,t,n,r){const i=e.length,s=[];let a=0,o=0,l=[],u;for(;a<i;++a)u=e[a]+n,l[0]===u?l[1]+=(t[a]-l[1])/++o:(o=0,l[1]+=r,l=[u,t[a]],s.push(l));return l[1]+=r,s}const SQ=.5*Math.PI/180;function b2(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=g=>[g,e(g)],s=t[0],a=t[1],o=a-s,l=o/r,u=[i(s)],c=[];if(n===r){for(let g=1;g<r;++g)u.push(i(s+g/n*o));return u.push(i(a)),u}else{c.push(i(a));for(let g=n;--g>0;)c.push(i(s+g/n*o))}let f=u[0],d=c[c.length-1];const h=1/o,p=AQ(f[1],c);for(;d;){const g=i((f[0]+d[0])/2);g[0]-f[0]>=l&&$Q(f,g,d,h,p)>SQ?c.push(g):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function AQ(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const a=t[s][1];a<n&&(n=a),a>r&&(r=a)}return 1/(r-n)}function $Q(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),a=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-a)}function CQ(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function RA(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:CQ(e)}function jz(e,t,n){return n||e+(t?"_"+t:"")}const t5=()=>{},MQ={init:t5,add:t5,rem:t5,idx:0},h0={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Y0=Object.keys(h0).filter(e=>e!=="__count__");function TQ(e,t){return n=>Ae({name:e,out:n||e},MQ,t)}[...Y0,"__count__"].forEach(e=>{h0[e]=TQ(e,h0[e])});function qz(e,t){return h0[e](t)}function Gz(e,t){return e.idx-t.idx}function NQ(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=h0[i]())})};return e.forEach(n),Object.values(t).sort(Gz)}function FQ(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function DQ(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function OQ(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function RQ(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function Wz(e,t){const n=t||un,r=NQ(e),i=e.slice().sort(Gz);function s(a){this._ops=r,this._out=i,this.cell=a,this.init()}return s.prototype.init=FQ,s.prototype.add=DQ,s.prototype.rem=OQ,s.prototype.set=RQ,s.prototype.get=n,s.fields=e.map(a=>a.out),s}function _C(e){this._key=e?Qn(e):me,this.reset()}const Ht=_C.prototype;Ht.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Ht.add=function(e){this._add.push(e)};Ht.rem=function(e){this._rem.push(e)};Ht.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,s=Array(r-i),a={};let o,l,u;for(o=0;o<i;++o)a[n(t[o])]=1;for(o=0,l=0;o<r;++o)a[n(u=e[o])]?a[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s};Ht.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,s;for(;--r>=0;)s=e(t[r])+"",ve(n,s)||(n[s]=1,++i);return i};Ht.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=oL(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Ht.argmin=function(e){return this.extent(e)[0]||{}};Ht.argmax=function(e){return this.extent(e)[1]||{}};Ht.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Ht.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Ht.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=aC(this.values(),e),this._get=e),this._q};Ht.q1=function(e){return this.quartile(e)[0]};Ht.q2=function(e){return this.quartile(e)[1]};Ht.q3=function(e){return this.quartile(e)[2]};Ht.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=Nz(this.values(),1e3,.05,e),this._get=e),this._ci};Ht.ci0=function(e){return this.ci(e)[0]};Ht.ci1=function(e){return this.ci(e)[1]};function Po(e){G.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Po.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Y0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};ne(Po,G,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function s(o){let l,u,c,f;for(l in o)for(c=o[l].tuple,u=0;u<i;++u)r[u][f=c[n[u]]]=f}s(e._prev),s(t);function a(o,l,u){const c=n[u],f=r[u++];for(const d in f){const h=o?o+"|"+d:d;l[c]=f[d],u<i?a(h,l,u):t[h]||e.cell(h,l)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const y=le(sn(m)),v=y.length;let x=0,_;for(;x<v;++x)r[_=y[x]]||(r[_]=1,t.push(_))}this._dims=le(e.groupby),this._dnames=this._dims.map(m=>{const y=ft(m);return i(m),n.push(y),y}),this.cellkey=e.key?e.key:RA(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],a=e.ops||["count"],o=e.as||[],l=s.length,u={};let c,f,d,h,p,g;for(l!==a.length&&H("Unmatched number of fields and aggregate ops."),g=0;g<l;++g){if(c=s[g],f=a[g],c==null&&f!=="count"&&H("Null aggregate field specified."),h=ft(c),p=jz(f,h,o[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=u[h],d||(i(c),d=u[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(qz(f,p))}return this._measures=this._measures.map(m=>Wz(m,m.field)),Object.create(null)},cellkey:RA(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let s=0;s<i;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new _C),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,s={};for(let a=0;a<i;++a)s[n[a]]=r[a](e);return t?Ez(t.tuple,s):Ue(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,s=r.length;i<s;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,s=e.add,a=e.rem,o=e.mod;let l,u,c,f;if(r)for(u in r)l=r[u],(!i||l.num)&&a.push(l.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(l.num===0&&i?a:o).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const PQ=1e-14;function EC(e){G.call(this,null,e)}EC.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};ne(EC,G,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,s=r.step,a=e.as||["bin0","bin1"],o=a[0],l=a[1];let u;return e.modified()?(t=t.reflow(!0),u=t.SOURCE):u=t.modified(sn(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const f=r(c);c[o]=f,c[l]=f==null?null:i+s*(1+(f-i)/s)}:c=>c[o]=r(c)),t.modifies(n?a:o)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Tz(e),r=n.step;let i=n.start,s=i+Math.ceil((n.stop-i)/r)*r,a,o;(a=e.anchor)!=null&&(o=a-(i+r*Math.floor((a-i)/r)),i+=o,s+=o);const l=function(u){let c=tn(t(u));return c==null?null:c<i?-1/0:c>s?1/0:(c=Math.max(i,Math.min(c,s-r)),i+r*Math.floor(PQ+(c-i)/r))};return l.start=i,l.stop=n.stop,l.step=r,this.value=ar(l,sn(t),e.name||"bin_"+ft(t))}});function Hz(e,t,n){const r=e;let i=t||[],s=n||[],a={},o=0;return{add:l=>s.push(l),remove:l=>a[r(l)]=++o,size:()=>i.length,data:(l,u)=>(o&&(i=i.filter(c=>!a[r(c)]),a={},o=0),u&&l&&i.sort(l),s.length&&(i=l?hL(l,i,s.sort(l)):i.concat(s),s=[]),i)}}function kC(e){G.call(this,[],e)}kC.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};ne(kC,G,{transform(e,t){const n=t.fork(t.ALL),r=Hz(me,this.value,n.materialize(n.ADD).add),i=e.sort,s=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(Uc(i),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function Vz(e){Ze.call(this,null,IQ,e)}ne(Vz,Ze);function IQ(e){return this.value&&!e.modified()?this.value:L$(e.fields,e.orders)}function SC(e){G.call(this,null,e)}SC.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function LQ(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}ne(SC,G,{transform(e,t){const n=f=>d=>{for(var h=LQ(o(d),e.case,s)||[],p,g=0,m=h.length;g<m;++g)a.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,s=this._match,a=this._stop,o=e.field,l=e.as||["text","count"],u=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],s=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let o,l,u;for(o in n)l=r[o],u=n[o]||0,!l&&u?(r[o]=l=Ue({}),l[i]=o,l[s]=u,a.add.push(l)):u===0?(l&&a.rem.push(l),n[o]=null,r[o]=null):l[s]!==u&&(l[s]=u,a.mod.push(l));return a.modifies(t)}});function AC(e){G.call(this,null,e)}AC.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};ne(AC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],s=r[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let o=this.value;return a?(o&&(n.rem=o),o=t.materialize(t.SOURCE).source,n.add=this.value=zQ(o,i,s,e.filter||Zr)):n.mod=o,n.source=this.value,n.modifies(r)}});function zQ(e,t,n,r){for(var i=[],s={},a=e.length,o=0,l,u;o<a;++o)for(s[t]=u=e[o],l=0;l<a;++l)s[n]=e[l],r(s)&&(i.push(Ue(s)),s={},s[t]=u);return i}const GF={kde:cC,mixture:Rz,normal:uC,lognormal:Oz,uniform:Pz},BQ="distributions",WF="function",UQ="field";function Jz(e,t){const n=e[WF];ve(GF,n)||H("Unknown distribution function: "+n);const r=GF[n]();for(const i in e)i===UQ?r.data((e.from||t()).map(e[i])):i===BQ?r[i](e[i].map(s=>Jz(s,t))):typeof r[i]===WF&&r[i](e[i]);return r}function $C(e){G.call(this,null,e)}const Yz=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],jQ={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Yz},{name:"weights",type:"number",array:!0}]};$C.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Yz.concat(jQ)},{name:"as",type:"string",array:!0,default:["value","density"]}]};ne($C,G,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=Jz(e.distribution,qQ(t)),i=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&H("Invalid density method: "+a),!e.extent&&!r.data&&H("Missing density extent parameter."),a=r[a];const o=e.as||["value","density"],l=e.extent||ms(r.data()),u=b2(a,l,i,s).map(c=>{const f={};return f[o[0]]=c[0],f[o[1]]=c[1],Ue(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function qQ(e){return()=>e.materialize(e.SOURCE).source}function Xz(e,t){return e?e.map((n,r)=>t[r]||ft(n)):null}function CC(e,t,n){const r=[],i=f=>f(l);let s,a,o,l,u,c;if(t==null)r.push(e.map(n));else for(s={},a=0,o=e.length;a<o;++a)l=e[a],u=t.map(i),c=s[u],c||(s[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}const Kz="bin";function MC(e){G.call(this,null,e)}MC.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Kz}]};const GQ=(e,t)=>G0(ms(e,t))/30;ne(MC,G,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=CC(t.source,e.groupby,un),i=e.smooth||!1,s=e.field,a=e.step||GQ(n,s),o=Uc((p,g)=>s(p)-s(g)),l=e.as||Kz,u=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<u;++d){const p=r[d].sort(o);h=-1;for(const g of Fz(p,a,i,s))g<c&&(c=g),g>f&&(f=g),p[++h][l]=g}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(l)}});function Zz(e){Ze.call(this,null,WQ,e),this.modified(!0)}ne(Zz,Ze);function WQ(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ar(n=>t(n,e),sn(t),ft(t))}function TC(e){G.call(this,[void 0,void 0],e)}TC.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};ne(TC,G,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let s=n[0],a=n[1];if((i||s==null)&&(s=1/0,a=-1/0),t.visit(i?t.SOURCE:t.ADD,o=>{const l=tn(r(o));l!=null&&(l<s&&(s=l),l>a&&(a=l))}),!Number.isFinite(s)||!Number.isFinite(a)){let o=ft(r);o&&(o=` for field "${o}"`),t.dataflow.warn(`Infinite extent${o}: [${s}, ${a}]`),s=a=void 0}this.value=[s,a]}});function NC(e,t){Ze.call(this,e),this.parent=t,this.count=0}ne(NC,Ze,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function x2(e){G.call(this,{},e),this._keys=Zd();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}ne(x2,G,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let s=ve(i,e)&&i[e],a,o;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[e])&&o.tuple,a=n.dataflow,s=new NC(n.fork(n.NO_SOURCE),this),a.add(s).connect(t(a,e,o)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,s=this._keys,a=e.modified("key"),o=l=>this.subflow(l,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=me(l),c=s.get(u);c!==void 0&&(s.delete(u),o(c).rem(l))}),t.visit(t.ADD,l=>{const u=r(l);s.set(me(l),u),o(u).add(l)}),a||t.modified(r.fields)?t.visit(t.MOD,l=>{const u=me(l),c=s.get(u),f=r(l);c===f?o(f).mod(l):(s.set(u,f),o(c).rem(l),o(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{o(s.get(me(l))).mod(l)}),a&&t.visit(t.REFLOW,l=>{const u=me(l),c=s.get(u),f=r(l);c!==f&&(s.set(u,f),o(c).rem(l),o(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function Qz(e){Ze.call(this,null,HQ,e)}ne(Qz,Ze);function HQ(e){return this.value&&!e.modified()?this.value:Y(e.name)?le(e.name).map(t=>Qn(t)):Qn(e.name,e.as)}function FC(e){G.call(this,Zd(),e)}FC.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};ne(FC,G,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),s=i.add,a=i.rem,o=i.mod,l=e.expr;let u=!0;t.visit(t.REM,f=>{const d=me(f);r.has(d)?r.delete(d):a.push(f)}),t.visit(t.ADD,f=>{l(f,e)?s.push(f):r.set(me(f),1)});function c(f){const d=me(f),h=l(f,e),p=r.get(d);h&&p?(r.delete(d),s.push(f)):!h&&!p?(r.set(d,1),a.push(f)):u&&h&&!p&&o.push(f)}return t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function DC(e){G.call(this,[],e)}DC.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};ne(DC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Xz(r,e.as||[]),s=e.index||null,a=i.length;return n.rem=this.value,t.visit(t.SOURCE,o=>{const l=r.map(p=>p(o)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<u;++c){for(d=nC(o),f=0;f<a;++f)d[i[f]]=(h=l[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(i)}});function OC(e){G.call(this,[],e)}OC.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};ne(OC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(ft),s=e.as||["key","value"],a=s[0],o=s[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let c=0,f;c<l;++c)f=nC(u),f[a]=i[c],f[o]=r[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function RC(e){G.call(this,null,e)}RC.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};ne(RC,G,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),s=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,a=>a[r]=n(a,e))}});function eB(e){G.call(this,[],e)}ne(eB,G,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,s=e.size-i.length,a,o,l;if(s>0){for(a=[];--s>=0;)a.push(l=Ue(r(e))),i.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else o=i.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,i=i.slice(-s);return n.source=this.value=i,n}});const ly={value:"value",median:AL,mean:NX,min:kA,max:ic},VQ=[];function PC(e){G.call(this,[],e)}PC.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function JQ(e){var t=e.method||ly.value,n;if(ly[t]==null)H("Unrecognized imputation method: "+t);else return t===ly.value?(n=e.value!==void 0?e.value:0,()=>n):ly[t]}function YQ(e){const t=e.field;return n=>n?t(n):NaN}ne(PC,G,{transform(e,t){var n=t.fork(t.ALL),r=JQ(e),i=YQ(e),s=ft(e.field),a=ft(e.key),o=(e.groupby||[]).map(ft),l=XQ(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length,d,h,p,g,m,y,v,x,_,w;for(m=0,x=l.length;m<x;++m)for(d=l[m],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=l.domain[v],w={_impute:!0},y=0,_=p.length;y<_;++y)w[o[y]]=p[y];w[a]=g,w[s]=Number.isNaN(h)?h=r(d,i):h,u.push(Ue(w))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}});function XQ(e,t,n,r){var i=y=>y(m),s=[],a=r?r.slice():[],o={},l={},u,c,f,d,h,p,g,m;for(a.forEach((y,v)=>o[y]=v+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=o[p]||(o[p]=a.push(p)),c=(u=t?t.map(i):VQ)+"",(f=l[c])||(f=l[c]=[],s.push(f),f.values=u),f[h-1]=m;return s.domain=a,s}function IC(e){Po.call(this,e)}IC.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Y0},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};ne(IC,Po,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(i=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Ae(s,i[n.cellkey(s)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function LC(e){G.call(this,null,e)}LC.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};ne(LC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=CC(r,e.groupby,e.field),s=(e.groupby||[]).map(ft),a=e.bandwidth,o=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;o!=="pdf"&&o!=="cdf"&&H("Invalid density method: "+o),e.resolve==="shared"&&(c||(c=ms(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=cC(h,a)[o],g=e.counts?h.length:1,m=c||ms(h);b2(p,m,f,d).forEach(y=>{const v={};for(let x=0;x<s.length;++x)v[s[x]]=h.dims[x];v[l[0]]=y[0],v[l[1]]=y[1]*g,u.push(Ue(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function tB(e){Ze.call(this,null,KQ,e)}ne(tB,Ze);function KQ(e){return this.value&&!e.modified()?this.value:B$(e.fields,e.flat)}function nB(e){G.call(this,[],e),this._pending=null}ne(nB,G,{transform(e,t){const n=t.dataflow;return this._pending?n5(this,t,this._pending):ZQ(e)?t.StopPropagation:e.values?n5(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=le(i.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(r=>n5(this,t,le(r.data)))}});function ZQ(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function n5(e,t,n){n.forEach(Ue);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function zC(e){G.call(this,{},e)}zC.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};ne(zC,G,{transform(e,t){const n=e.fields,r=e.index,i=e.values,s=e.default==null?null:e.default,a=e.modified(),o=n.length;let l=a?t.SOURCE:t.ADD,u=t,c=e.as,f,d,h;return i?(d=i.length,o>1&&!c&&H('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==o*d&&H('The "as" parameter has too few output field names.'),c=c||i.map(ft),f=function(p){for(var g=0,m=0,y,v;g<o;++g)if(v=r.get(n[g](p)),v==null)for(y=0;y<d;++y,++m)p[c[m]]=s;else for(y=0;y<d;++y,++m)p[c[m]]=i[y](v)}):(c||H("Missing output field names."),f=function(p){for(var g=0,m;g<o;++g)m=r.get(n[g](p)),p[c[g]]=m??s}),a?u=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),l|=h?t.MOD:0),t.visit(l,f),u.modifies(c)}});function rB(e){Ze.call(this,null,QQ,e)}ne(rB,Ze);function QQ(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,s,a;for(s=0;s<n;++s)a=t[s],a[0]<r&&(r=a[0]),a[1]>i&&(i=a[1]);return[r,i]}function iB(e){Ze.call(this,null,eee,e)}ne(iB,Ze);function eee(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function sB(e){G.call(this,null,e)}ne(sB,G,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function BC(e){Po.call(this,e)}BC.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Y0,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};ne(BC,Po,{_transform:Po.prototype.transform,transform(e,t){return this._transform(tee(e,t),t)}});function tee(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",s=sn(n).concat(sn(r)),a=ree(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>i),fields:a.map(o=>nee(o,n,r,s)),as:a.map(o=>o+""),modified:e.modified.bind(e)}}function nee(e,t,n,r){return ar(i=>t(i)===e?n(i):NaN,r,e+"")}function ree(e,t,n){const r={},i=[];return n.visit(n.SOURCE,s=>{const a=e(s);r[a]||(r[a]=1,i.push(a))}),i.sort(n2),t?i.slice(0,t):i}function aB(e){x2.call(this,e)}ne(aB,x2,{transform(e,t){const n=e.subflow,r=e.field,i=s=>this.subflow(me(s),n,t,s);return(e.modified("field")||r&&t.modified(sn(r)))&&H("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,s=>{const a=i(s);r(s).forEach(o=>a.mod(o))}),t.visit(t.ADD,s=>{const a=i(s);r(s).forEach(o=>a.add(Ue(o)))}),t.visit(t.REM,s=>{const a=i(s);r(s).forEach(o=>a.rem(o))})):(t.visit(t.MOD,s=>i(s).mod(s)),t.visit(t.ADD,s=>i(s).add(s)),t.visit(t.REM,s=>i(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function UC(e){G.call(this,null,e)}UC.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};ne(UC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=Xz(e.fields,e.as||[]),s=r?(o,l)=>iee(o,l,r,i):d2;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,o=>{const l=me(o);n.rem.push(a[l]),a[l]=null}),t.visit(t.ADD,o=>{const l=s(o,Ue({}));a[me(o)]=l,n.add.push(l)}),t.visit(t.MOD,o=>{n.mod.push(s(o,a[me(o)]))}),n}});function iee(e,t,n,r){for(let i=0,s=n.length;i<s;++i)t[r[i]]=n[i](e);return t}function oB(e){G.call(this,null,e)}ne(oB,G,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function jC(e){G.call(this,null,e)}jC.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const see=1e-14;ne(jC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,s=CC(i,e.groupby,e.field),a=(e.groupby||[]).map(ft),o=[],l=e.step||.01,u=e.probs||_r(l/2,1-see,l),c=u.length;return s.forEach(f=>{const d=sC(f,u);for(let h=0;h<c;++h){const p={};for(let g=0;g<a.length;++g)p[a[g]]=f.dims[g];p[r[0]]=u[h],p[r[1]]=d[h],o.push(Ue(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}});function lB(e){G.call(this,null,e)}ne(lB,G,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const s=me(i);n.rem.push(r[s]),r[s]=null}),t.visit(t.ADD,i=>{const s=nC(i);r[me(i)]=s,n.add.push(s)}),t.visit(t.MOD,i=>{const s=r[me(i)];for(const a in i)s[a]=i[a],n.modifies(a);n.mod.push(s)})),n}});function qC(e){G.call(this,[],e),this.count=0}qC.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};ne(qC,G,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,s=this.value.reduce((c,f)=>(c[me(f)]=1,c),{});let a=this.value,o=this.count,l=0;function u(c){let f,d;a.length<i?a.push(c):(d=~~((o+1)*ei()),d<a.length&&d>=l&&(f=a[d],s[me(f)]&&n.rem.push(f),a[d]=c)),++o}if(t.rem.length&&(t.visit(t.REM,c=>{const f=me(c);s[f]&&(s[f]=-1,n.rem.push(c)),--o}),a=a.filter(c=>s[me(c)]!==-1)),(t.rem.length||r)&&a.length<i&&t.source&&(l=o=a.length,t.visit(t.SOURCE,c=>{s[me(c)]||u(c)}),l=-1),r&&a.length>i){const c=a.length-i;for(let f=0;f<c;++f)s[me(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[me(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=a.filter(c=>!s[me(c)])),this.count=o,this.value=n.source=a,n}});function GC(e){G.call(this,null,e)}GC.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};ne(GC,G,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=_r(e.start,e.stop,e.step||1).map(i=>{const s={};return s[r]=i,Ue(s)}),n.add=t.add.concat(this.value),n}});function uB(e){G.call(this,null,e),this.modified(!0)}ne(uB,G,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function WC(e){G.call(this,null,e)}const cB=["unit0","unit1"];WC.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:V$,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:cB}]};ne(WC,G,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",s=this._floor(e,t),a=(i?nh:th)(s.unit).offset,o=e.as||cB,l=o[0],u=o[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(sn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,y;g==null?(p[l]=null,r&&(p[u]=null)):(p[l]=m=y=s(g),r&&(p[u]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),s.start=f,s.stop=d,t.modifies(r?o:l)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:ez({extent:e.extent||ms(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=J$(r),a=this.value||{},o=(n?WL:GL)(s,i);return o.unit=Oe(s),o.units=s,o.step=i,o.start=a.start,o.stop=a.stop,this.value=o}});function fB(e){G.call(this,Zd(),e)}ne(fB,G,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,s=o=>i.set(r(o),o);let a=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,o=>i.delete(r(o))),t.visit(t.ADD,s)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function dB(e){G.call(this,null,e)}ne(dB,G,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Uc(e.sort)):t.source).map(e.field))}});function aee(e,t,n,r){const i=p0[e](t,n);return{init:i.init||yo,update:function(s,a){a[r]=i.next(s)}}}const p0={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=p0.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||H("ntile num must be greater than zero.");const n=p0.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||H("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=oee(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function oee(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const lee=Object.keys(p0);function hB(e){const t=le(e.ops),n=le(e.fields),r=le(e.params),i=le(e.as),s=this.outputs=[],a=this.windows=[],o={},l={},u=[],c=[];let f=!0;function d(h){le(sn(h)).forEach(p=>o[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=ft(g),y=jz(h,m,i[p]);if(d(g),s.push(y),ve(p0,h))a.push(aee(h,n[p],r[p],y));else{if(g==null&&h!=="count"&&H("Null aggregate field specified."),h==="count"){u.push(y);return}f=!1;let v=l[m];v||(v=l[m]=[],v.field=g,c.push(v)),v.push(qz(h,y))}}),(u.length||c.length)&&(this.cell=uee(c,u,f)),this.inputs=Object.keys(o)}const pB=hB.prototype;pB.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};pB.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,s=r&&r.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(i[a]);for(a=e.p1;a<e.i1;++a)n.add(i[a]);n.set(t)}for(a=0;a<s;++a)r[a].update(e,t)};function uee(e,t,n){e=e.map(l=>Wz(l,l.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,s=r.agg=Array(i),a=0;a<i;++a)s[a]=new e[a](r);if(r.store)var o=r.data=new _C;return r.add=function(l){if(r.num+=1,!n){o&&o.add(l);for(let u=0;u<i;++u)s[u].add(s[u].get(l),l)}},r.rem=function(l){if(r.num-=1,!n){o&&o.rem(l);for(let u=0;u<i;++u)s[u].rem(s[u].get(l),l)}},r.set=function(l){let u,c;for(o&&o.values(),u=0,c=t.length;u<c;++u)l[t[u]]=r.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},r.init=function(){r.num=0,o&&o.reset();for(let l=0;l<i;++l)s[l].init()},r}function HC(e){G.call(this,{},e),this._mlen=0,this._mods=[]}HC.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:lee.concat(Y0)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};ne(HC,G,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=Uc(e.sort),i=RA(e.groupby),s=o=>this.group(i(o));let a=this.state;(!a||n)&&(a=this.state=new hB(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,o=>s(o).add(o))):(t.visit(t.REM,o=>s(o).remove(o)),t.visit(t.ADD,o=>s(o).add(o)));for(let o=0,l=this._mlen;o<l;++o)cee(this._mods[o],a,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=Hz(me),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function cee(e,t,n,r){const i=r.sort,s=i&&!r.ignorePeers,a=r.frame||[null,0],o=e.data(n),l=o.length,u=s?W0(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:i||cn(-1)};t.init();for(let f=0;f<l;++f)fee(c,a,f,l),s&&dee(c,u),t.update(c,o[f])}function fee(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function dee(e,t){const n=e.i0,r=e.i1-1,i=e.compare,s=e.data,a=s.length-1;n>0&&!i(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<a&&!i(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}const hee=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Po,bin:EC,collect:kC,compare:Vz,countpattern:SC,cross:AC,density:$C,dotbin:MC,expression:Zz,extent:TC,facet:x2,field:Qz,filter:FC,flatten:DC,fold:OC,formula:RC,generate:eB,impute:PC,joinaggregate:IC,kde:LC,key:tB,load:nB,lookup:zC,multiextent:rB,multivalues:iB,params:sB,pivot:BC,prefacet:aB,project:UC,proxy:oB,quantile:jC,relay:lB,sample:qC,sequence:GC,sieve:uB,subflow:NC,timeunit:WC,tupleindex:fB,values:dB,window:HC},Symbol.toStringTag,{value:"Module"}));function We(e){return function(){return e}}const HF=Math.abs,Yt=Math.atan2,Fu=Math.cos,pee=Math.max,r5=Math.min,Ki=Math.sin,Zu=Math.sqrt,Kt=1e-12,_d=Math.PI,Cv=_d/2,gB=2*_d;function gee(e){return e>1?0:e<-1?_d:Math.acos(e)}function VF(e){return e>=1?Cv:e<=-1?-Cv:Math.asin(e)}const PA=Math.PI,IA=2*PA,Gu=1e-6,mee=IA-Gu;function mB(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function yee(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return mB;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let VC=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mB:yee(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,u=i-n,c=a-t,f=o-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>Gu)if(!(Math.abs(f*l-u*c)>Gu)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-a,p=i-o,g=l*l+u*u,m=h*h+p*p,y=Math.sqrt(g),v=Math.sqrt(d),x=s*Math.tan((PA-Math.acos((g+d-m)/(2*y*v)))/2),_=x/v,w=x/y;Math.abs(_-1)>Gu&&this._append`L${t+_*c},${n+_*f}`,this._append`A${s},${s},0,0,${+(f*h>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=t+o,c=n+l,f=1^a,d=a?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Gu||Math.abs(this._y1-c)>Gu)&&this._append`L${u},${c}`,r&&(d<0&&(d=d%IA+IA),d>mee?this._append`A${r},${r},0,1,${f},${t-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:d>Gu&&this._append`A${r},${r},0,${+(d>=PA)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function w2(){return new VC}w2.prototype=VC.prototype;function _2(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new VC(t)}function vee(e){return e.innerRadius}function bee(e){return e.outerRadius}function xee(e){return e.startAngle}function wee(e){return e.endAngle}function _ee(e){return e&&e.padAngle}function Eee(e,t,n,r,i,s,a,o){var l=n-e,u=r-t,c=a-i,f=o-s,d=f*l-c*u;if(!(d*d<Kt))return d=(c*(t-s)-f*(e-i))/d,[e+d*l,t+d*u]}function uy(e,t,n,r,i,s,a){var o=e-n,l=t-r,u=(a?s:-s)/Zu(o*o+l*l),c=u*l,f=-u*o,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,y=(h+g)/2,v=p-d,x=g-h,_=v*v+x*x,w=i-s,k=d*g-p*h,E=(x<0?-1:1)*Zu(pee(0,w*w*_-k*k)),A=(k*x-v*E)/_,z=(-k*v-x*E)/_,D=(k*x+v*E)/_,R=(-k*v+x*E)/_,j=A-m,O=z-y,L=D-m,P=R-y;return j*j+O*O>L*L+P*P&&(A=D,z=R),{cx:A,cy:z,x01:-c,y01:-f,x11:A*(i/w-1),y11:z*(i/w-1)}}function kee(){var e=vee,t=bee,n=We(0),r=null,i=xee,s=wee,a=_ee,o=null,l=_2(u);function u(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-Cv,g=s.apply(this,arguments)-Cv,m=HF(g-p),y=g>p;if(o||(o=c=l()),h<d&&(f=h,h=d,d=f),!(h>Kt))o.moveTo(0,0);else if(m>gB-Kt)o.moveTo(h*Fu(p),h*Ki(p)),o.arc(0,0,h,p,g,!y),d>Kt&&(o.moveTo(d*Fu(g),d*Ki(g)),o.arc(0,0,d,g,p,y));else{var v=p,x=g,_=p,w=g,k=m,E=m,A=a.apply(this,arguments)/2,z=A>Kt&&(r?+r.apply(this,arguments):Zu(d*d+h*h)),D=r5(HF(h-d)/2,+n.apply(this,arguments)),R=D,j=D,O,L;if(z>Kt){var P=VF(z/d*Ki(A)),B=VF(z/h*Ki(A));(k-=P*2)>Kt?(P*=y?1:-1,_+=P,w-=P):(k=0,_=w=(p+g)/2),(E-=B*2)>Kt?(B*=y?1:-1,v+=B,x-=B):(E=0,v=x=(p+g)/2)}var U=h*Fu(v),q=h*Ki(v),X=d*Fu(w),ae=d*Ki(w);if(D>Kt){var fe=h*Fu(x),we=h*Ki(x),Te=d*Fu(_),Se=d*Ki(_),je;if(m<_d)if(je=Eee(U,q,Te,Se,fe,we,X,ae)){var Ln=U-je[0],fn=q-je[1],dn=fe-je[0],ue=we-je[1],he=1/Ki(gee((Ln*dn+fn*ue)/(Zu(Ln*Ln+fn*fn)*Zu(dn*dn+ue*ue)))/2),ke=Zu(je[0]*je[0]+je[1]*je[1]);R=r5(D,(d-ke)/(he-1)),j=r5(D,(h-ke)/(he+1))}else R=j=0}E>Kt?j>Kt?(O=uy(Te,Se,U,q,h,j,y),L=uy(fe,we,X,ae,h,j,y),o.moveTo(O.cx+O.x01,O.cy+O.y01),j<D?o.arc(O.cx,O.cy,j,Yt(O.y01,O.x01),Yt(L.y01,L.x01),!y):(o.arc(O.cx,O.cy,j,Yt(O.y01,O.x01),Yt(O.y11,O.x11),!y),o.arc(0,0,h,Yt(O.cy+O.y11,O.cx+O.x11),Yt(L.cy+L.y11,L.cx+L.x11),!y),o.arc(L.cx,L.cy,j,Yt(L.y11,L.x11),Yt(L.y01,L.x01),!y))):(o.moveTo(U,q),o.arc(0,0,h,v,x,!y)):o.moveTo(U,q),!(d>Kt)||!(k>Kt)?o.lineTo(X,ae):R>Kt?(O=uy(X,ae,fe,we,d,-R,y),L=uy(U,q,Te,Se,d,-R,y),o.lineTo(O.cx+O.x01,O.cy+O.y01),R<D?o.arc(O.cx,O.cy,R,Yt(O.y01,O.x01),Yt(L.y01,L.x01),!y):(o.arc(O.cx,O.cy,R,Yt(O.y01,O.x01),Yt(O.y11,O.x11),!y),o.arc(0,0,d,Yt(O.cy+O.y11,O.cx+O.x11),Yt(L.cy+L.y11,L.cx+L.x11),y),o.arc(L.cx,L.cy,R,Yt(L.y11,L.x11),Yt(L.y01,L.x01),!y))):o.arc(0,0,d,w,_,y)}if(o.closePath(),c)return o=null,c+""||null}return u.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-_d/2;return[Fu(f)*c,Ki(f)*c]},u.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:We(+c),u):e},u.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:We(+c),u):t},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:We(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:We(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:We(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:We(+c),u):s},u.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:We(+c),u):a},u.context=function(c){return arguments.length?(o=c??null,u):o},u}function yB(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vB(e){this._context=e}vB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function JC(e){return new vB(e)}function bB(e){return e[0]}function xB(e){return e[1]}function wB(e,t){var n=We(!0),r=null,i=JC,s=null,a=_2(o);e=typeof e=="function"?e:e===void 0?bB:We(e),t=typeof t=="function"?t:t===void 0?xB:We(t);function o(l){var u,c=(l=yB(l)).length,f,d=!1,h;for(r==null&&(s=i(h=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,u,l),+t(f,u,l));if(h)return s=null,h+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:We(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:We(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:We(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function _B(e,t,n){var r=null,i=We(!0),s=null,a=JC,o=null,l=_2(u);e=typeof e=="function"?e:e===void 0?bB:We(+e),t=typeof t=="function"?t:We(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?xB:We(+n);function u(f){var d,h,p,g=(f=yB(f)).length,m,y=!1,v,x=new Array(g),_=new Array(g);for(s==null&&(o=a(v=l())),d=0;d<=g;++d){if(!(d<g&&i(m=f[d],d,f))===y)if(y=!y)h=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=d-1;p>=h;--p)o.point(x[p],_[p]);o.lineEnd(),o.areaEnd()}y&&(x[d]=+e(m,d,f),_[d]=+t(m,d,f),o.point(r?+r(m,d,f):x[d],n?+n(m,d,f):_[d]))}if(v)return o=null,v+""||null}function c(){return wB().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:We(+f),r=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:We(+f),u):e},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:We(+f),u):r},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:We(+f),n=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:We(+f),u):t},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:We(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:We(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}const See={draw(e,t){const n=Zu(t/_d);e.moveTo(n,0),e.arc(0,0,n,0,gB)}};function Aee(e,t){let n=null,r=_2(i);e=typeof e=="function"?e:We(e||See),t=typeof t=="function"?t:We(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:We(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:We(+s),i):t},i.context=function(s){return arguments.length?(n=s??null,i):n},i}function Io(){}function Mv(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function E2(e){this._context=e}E2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Mv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Mv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $ee(e){return new E2(e)}function EB(e){this._context=e}EB.prototype={areaStart:Io,areaEnd:Io,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Mv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Cee(e){return new EB(e)}function kB(e){this._context=e}kB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Mv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Mee(e){return new kB(e)}function SB(e,t){this._basis=new E2(e),this._beta=t}SB.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Tee=function e(t){function n(r){return t===1?new E2(r):new SB(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Tv(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function YC(e,t){this._context=e,this._k=(1-t)/6}YC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Tv(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Tv(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Nee=function e(t){function n(r){return new YC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function XC(e,t){this._context=e,this._k=(1-t)/6}XC.prototype={areaStart:Io,areaEnd:Io,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Tv(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Fee=function e(t){function n(r){return new XC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function KC(e,t){this._context=e,this._k=(1-t)/6}KC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Tv(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Dee=function e(t){function n(r){return new KC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function ZC(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>Kt){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Kt){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function AB(e,t){this._context=e,this._alpha=t}AB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:ZC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Oee=function e(t){function n(r){return t?new AB(r,t):new YC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function $B(e,t){this._context=e,this._alpha=t}$B.prototype={areaStart:Io,areaEnd:Io,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ZC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ree=function e(t){function n(r){return t?new $B(r,t):new XC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function CB(e,t){this._context=e,this._alpha=t}CB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ZC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Pee=function e(t){function n(r){return t?new CB(r,t):new KC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function MB(e){this._context=e}MB.prototype={areaStart:Io,areaEnd:Io,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Iee(e){return new MB(e)}function JF(e){return e<0?-1:1}function YF(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(JF(s)+JF(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function XF(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function i5(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function Nv(e){this._context=e}Nv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:i5(this,this._t0,XF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,i5(this,XF(this,n=YF(this,e,t)),n);break;default:i5(this,this._t0,n=YF(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function TB(e){this._context=new NB(e)}(TB.prototype=Object.create(Nv.prototype)).point=function(e,t){Nv.prototype.point.call(this,t,e)};function NB(e){this._context=e}NB.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function Lee(e){return new Nv(e)}function zee(e){return new TB(e)}function FB(e){this._context=e}FB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=KF(e),i=KF(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function KF(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function Bee(e){return new FB(e)}function k2(e,t){this._context=e,this._t=t}k2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Uee(e){return new k2(e,.5)}function jee(e){return new k2(e,0)}function qee(e){return new k2(e,1)}function No(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Gee=()=>typeof Image<"u"?Image:null;function As(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Zo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const LA=Symbol("implicit");function QC(){var e=new pF,t=[],n=[],r=LA;function i(s){let a=e.get(s);if(a===void 0){if(r!==LA)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new pF;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return QC(t,n).unknown(r)},As.apply(i,arguments),i}function ih(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function X0(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Qo(){}var pc=.7,Ed=1/pc,id="\\s*([+-]?\\d+)\\s*",g0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wee=/^#([0-9a-f]{3,8})$/,Hee=new RegExp(`^rgb\\(${id},${id},${id}\\)$`),Vee=new RegExp(`^rgb\\(${cs},${cs},${cs}\\)$`),Jee=new RegExp(`^rgba\\(${id},${id},${id},${g0}\\)$`),Yee=new RegExp(`^rgba\\(${cs},${cs},${cs},${g0}\\)$`),Xee=new RegExp(`^hsl\\(${g0},${cs},${cs}\\)$`),Kee=new RegExp(`^hsla\\(${g0},${cs},${cs},${g0}\\)$`),ZF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ih(Qo,m0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:QF,formatHex:QF,formatHex8:Zee,formatHsl:Qee,formatRgb:eD,toString:eD});function QF(){return this.rgb().formatHex()}function Zee(){return this.rgb().formatHex8()}function Qee(){return DB(this).formatHsl()}function eD(){return this.rgb().formatRgb()}function m0(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Wee.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?tD(t):n===3?new Tt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?cy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?cy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Hee.exec(e))?new Tt(t[1],t[2],t[3],1):(t=Vee.exec(e))?new Tt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jee.exec(e))?cy(t[1],t[2],t[3],t[4]):(t=Yee.exec(e))?cy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Xee.exec(e))?iD(t[1],t[2]/100,t[3]/100,1):(t=Kee.exec(e))?iD(t[1],t[2]/100,t[3]/100,t[4]):ZF.hasOwnProperty(e)?tD(ZF[e]):e==="transparent"?new Tt(NaN,NaN,NaN,0):null}function tD(e){return new Tt(e>>16&255,e>>8&255,e&255,1)}function cy(e,t,n,r){return r<=0&&(e=t=n=NaN),new Tt(e,t,n,r)}function e9(e){return e instanceof Qo||(e=m0(e)),e?(e=e.rgb(),new Tt(e.r,e.g,e.b,e.opacity)):new Tt}function Lo(e,t,n,r){return arguments.length===1?e9(e):new Tt(e,t,n,r??1)}function Tt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ih(Tt,Lo,X0(Qo,{brighter(e){return e=e==null?Ed:Math.pow(Ed,e),new Tt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?pc:Math.pow(pc,e),new Tt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Tt(sc(this.r),sc(this.g),sc(this.b),Fv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nD,formatHex:nD,formatHex8:ete,formatRgb:rD,toString:rD}));function nD(){return`#${Qu(this.r)}${Qu(this.g)}${Qu(this.b)}`}function ete(){return`#${Qu(this.r)}${Qu(this.g)}${Qu(this.b)}${Qu((isNaN(this.opacity)?1:this.opacity)*255)}`}function rD(){const e=Fv(this.opacity);return`${e===1?"rgb(":"rgba("}${sc(this.r)}, ${sc(this.g)}, ${sc(this.b)}${e===1?")":`, ${e})`}`}function Fv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function sc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qu(e){return e=sc(e),(e<16?"0":"")+e.toString(16)}function iD(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wi(e,t,n,r)}function DB(e){if(e instanceof wi)return new wi(e.h,e.s,e.l,e.opacity);if(e instanceof Qo||(e=m0(e)),!e)return new wi;if(e instanceof wi)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new wi(a,o,l,e.opacity)}function Dv(e,t,n,r){return arguments.length===1?DB(e):new wi(e,t,n,r??1)}function wi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ih(wi,Dv,X0(Qo,{brighter(e){return e=e==null?Ed:Math.pow(Ed,e),new wi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?pc:Math.pow(pc,e),new wi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Tt(s5(e>=240?e-240:e+120,i,r),s5(e,i,r),s5(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new wi(sD(this.h),fy(this.s),fy(this.l),Fv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Fv(this.opacity);return`${e===1?"hsl(":"hsla("}${sD(this.h)}, ${fy(this.s)*100}%, ${fy(this.l)*100}%${e===1?")":`, ${e})`}`}}));function sD(e){return e=(e||0)%360,e<0?e+360:e}function fy(e){return Math.max(0,Math.min(1,e||0))}function s5(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const OB=Math.PI/180,RB=180/Math.PI,Ov=18,PB=.96422,IB=1,LB=.82521,zB=4/29,sd=6/29,BB=3*sd*sd,tte=sd*sd*sd;function UB(e){if(e instanceof fs)return new fs(e.l,e.a,e.b,e.opacity);if(e instanceof ha)return jB(e);e instanceof Tt||(e=e9(e));var t=u5(e.r),n=u5(e.g),r=u5(e.b),i=a5((.2225045*t+.7168786*n+.0606169*r)/IB),s,a;return t===n&&n===r?s=a=i:(s=a5((.4360747*t+.3850649*n+.1430804*r)/PB),a=a5((.0139322*t+.0971045*n+.7141733*r)/LB)),new fs(116*i-16,500*(s-i),200*(i-a),e.opacity)}function Rv(e,t,n,r){return arguments.length===1?UB(e):new fs(e,t,n,r??1)}function fs(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}ih(fs,Rv,X0(Qo,{brighter(e){return new fs(this.l+Ov*(e??1),this.a,this.b,this.opacity)},darker(e){return new fs(this.l-Ov*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=PB*o5(t),e=IB*o5(e),n=LB*o5(n),new Tt(l5(3.1338561*t-1.6168667*e-.4906146*n),l5(-.9787684*t+1.9161415*e+.033454*n),l5(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function a5(e){return e>tte?Math.pow(e,1/3):e/BB+zB}function o5(e){return e>sd?e*e*e:BB*(e-zB)}function l5(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function u5(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function nte(e){if(e instanceof ha)return new ha(e.h,e.c,e.l,e.opacity);if(e instanceof fs||(e=UB(e)),e.a===0&&e.b===0)return new ha(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*RB;return new ha(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Pv(e,t,n,r){return arguments.length===1?nte(e):new ha(e,t,n,r??1)}function ha(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function jB(e){if(isNaN(e.h))return new fs(e.l,0,0,e.opacity);var t=e.h*OB;return new fs(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ih(ha,Pv,X0(Qo,{brighter(e){return new ha(this.h,this.c,this.l+Ov*(e??1),this.opacity)},darker(e){return new ha(this.h,this.c,this.l-Ov*(e??1),this.opacity)},rgb(){return jB(this).rgb()}}));var qB=-.14861,t9=1.78277,n9=-.29227,S2=-.90649,y0=1.97294,aD=y0*S2,oD=y0*t9,lD=t9*n9-S2*qB;function rte(e){if(e instanceof ac)return new ac(e.h,e.s,e.l,e.opacity);e instanceof Tt||(e=e9(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(lD*r+aD*t-oD*n)/(lD+aD-oD),s=r-i,a=(y0*(n-i)-n9*s)/S2,o=Math.sqrt(a*a+s*s)/(y0*i*(1-i)),l=o?Math.atan2(a,s)*RB-120:NaN;return new ac(l<0?l+360:l,o,i,e.opacity)}function zA(e,t,n,r){return arguments.length===1?rte(e):new ac(e,t,n,r??1)}function ac(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ih(ac,zA,X0(Qo,{brighter(e){return e=e==null?Ed:Math.pow(Ed,e),new ac(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?pc:Math.pow(pc,e),new ac(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*OB,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Tt(255*(t+n*(qB*r+t9*i)),255*(t+n*(n9*r+S2*i)),255*(t+n*(y0*r)),this.opacity)}}));function GB(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function WB(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return GB((n-r/t)*t,a,i,s,o)}}function HB(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],o=e[(r+2)%t];return GB((n-r/t)*t,i,s,a,o)}}const A2=e=>()=>e;function VB(e,t){return function(n){return e+n*t}}function ite(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function $2(e,t){var n=t-e;return n?VB(e,n>180||n<-180?n-360*Math.round(n/360):n):A2(isNaN(e)?t:e)}function ste(e){return(e=+e)==1?Nt:function(t,n){return n-t?ite(t,n,e):A2(isNaN(t)?n:t)}}function Nt(e,t){var n=t-e;return n?VB(e,n):A2(isNaN(e)?t:e)}const BA=function e(t){var n=ste(t);function r(i,s){var a=n((i=Lo(i)).r,(s=Lo(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=Nt(i.opacity,s.opacity);return function(c){return i.r=a(c),i.g=o(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function JB(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=Lo(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(l){return o.r=r(l),o.g=i(l),o.b=s(l),o+""}}}var ate=JB(WB),ote=JB(HB);function r9(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function YB(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function lte(e,t){return(YB(t)?r9:XB)(e,t)}function XB(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=el(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function KB(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function bi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ZB(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=el(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var UA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,c5=new RegExp(UA.source,"g");function ute(e){return function(){return e}}function cte(e){return function(t){return e(t)+""}}function QB(e,t){var n=UA.lastIndex=c5.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=UA.exec(e))&&(i=c5.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:bi(r,i)})),n=c5.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?cte(l[0].x):ute(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)o[(f=l[c]).i]=f.x(u);return o.join("")})}function el(e,t){var n=typeof t,r;return t==null||n==="boolean"?A2(t):(n==="number"?bi:n==="string"?(r=m0(t))?(t=r,BA):QB:t instanceof m0?BA:t instanceof Date?KB:YB(t)?r9:Array.isArray(t)?XB:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ZB:bi)(e,t)}function fte(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function dte(e,t){var n=$2(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function K0(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var uD=180/Math.PI,jA={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function eU(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*uD,skewX:Math.atan(l)*uD,scaleX:a,scaleY:o}}var dy;function hte(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?jA:eU(t.a,t.b,t.c,t.d,t.e,t.f)}function pte(e){return e==null||(dy||(dy=document.createElementNS("http://www.w3.org/2000/svg","g")),dy.setAttribute("transform",e),!(e=dy.transform.baseVal.consolidate()))?jA:(e=e.matrix,eU(e.a,e.b,e.c,e.d,e.e,e.f))}function tU(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:bi(u,f)},{i:g-2,x:bi(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:bi(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function o(u,c,f,d){u!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:bi(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:bi(u,f)},{i:g-2,x:bi(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),s(u.translateX,u.translateY,c.translateX,c.translateY,f,d),a(u.rotate,c.rotate,f,d),o(u.skewX,c.skewX,f,d),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var gte=tU(hte,"px, ","px)","deg)"),mte=tU(pte,", ",")",")"),yte=1e-12;function cD(e){return((e=Math.exp(e))+1/e)/2}function vte(e){return((e=Math.exp(e))-1/e)/2}function bte(e){return((e=Math.exp(2*e))-1)/(e+1)}const xte=function e(t,n,r){function i(s,a){var o=s[0],l=s[1],u=s[2],c=a[0],f=a[1],d=a[2],h=c-o,p=f-l,g=h*h+p*p,m,y;if(g<yte)y=Math.log(d/u)/t,m=function(E){return[o+E*h,l+E*p,u*Math.exp(t*E*y)]};else{var v=Math.sqrt(g),x=(d*d-u*u+r*g)/(2*u*n*v),_=(d*d-u*u-r*g)/(2*d*n*v),w=Math.log(Math.sqrt(x*x+1)-x),k=Math.log(Math.sqrt(_*_+1)-_);y=(k-w)/t,m=function(E){var A=E*y,z=cD(w),D=u/(n*v)*(z*bte(t*A+w)-vte(w));return[o+D*h,l+D*p,u*z/cD(t*A+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return i.rho=function(s){var a=Math.max(.001,+s),o=a*a,l=o*o;return e(a,o,l)},i}(Math.SQRT2,2,4);function nU(e){return function(t,n){var r=e((t=Dv(t)).h,(n=Dv(n)).h),i=Nt(t.s,n.s),s=Nt(t.l,n.l),a=Nt(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const wte=nU($2);var _te=nU(Nt);function Ete(e,t){var n=Nt((e=Rv(e)).l,(t=Rv(t)).l),r=Nt(e.a,t.a),i=Nt(e.b,t.b),s=Nt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function rU(e){return function(t,n){var r=e((t=Pv(t)).h,(n=Pv(n)).h),i=Nt(t.c,n.c),s=Nt(t.l,n.l),a=Nt(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const kte=rU($2);var Ste=rU(Nt);function iU(e){return function t(n){n=+n;function r(i,s){var a=e((i=zA(i)).h,(s=zA(s)).h),o=Nt(i.s,s.s),l=Nt(i.l,s.l),u=Nt(i.opacity,s.opacity);return function(c){return i.h=a(c),i.s=o(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}const Ate=iU($2);var $te=iU(Nt);function i9(e,t){t===void 0&&(t=e,e=el);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function Cte(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Mte=Object.freeze(Object.defineProperty({__proto__:null,interpolate:el,interpolateArray:lte,interpolateBasis:WB,interpolateBasisClosed:HB,interpolateCubehelix:Ate,interpolateCubehelixLong:$te,interpolateDate:KB,interpolateDiscrete:fte,interpolateHcl:kte,interpolateHclLong:Ste,interpolateHsl:wte,interpolateHslLong:_te,interpolateHue:dte,interpolateLab:Ete,interpolateNumber:bi,interpolateNumberArray:r9,interpolateObject:ZB,interpolateRgb:BA,interpolateRgbBasis:ate,interpolateRgbBasisClosed:ote,interpolateRound:K0,interpolateString:QB,interpolateTransformCss:gte,interpolateTransformSvg:mte,interpolateZoom:xte,piecewise:i9,quantize:Cte},Symbol.toStringTag,{value:"Module"}));function Tte(e){return function(){return e}}function qA(e){return+e}var fD=[0,1];function Jn(e){return e}function GA(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Tte(isNaN(t)?NaN:.5)}function Nte(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Fte(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=GA(i,r),s=n(a,s)):(r=GA(r,i),s=n(s,a)),function(o){return s(r(o))}}function Dte(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=GA(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var l=H0(e,o,1,r)-1;return s[l](i[l](o))}}function Z0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function C2(){var e=fD,t=fD,n=el,r,i,s,a=Jn,o,l,u;function c(){var d=Math.min(e.length,t.length);return a!==Jn&&(a=Nte(e[0],e[d-1])),o=d>2?Dte:Fte,l=u=null,f}function f(d){return d==null||isNaN(d=+d)?s:(l||(l=o(e.map(r),t,n)))(r(a(d)))}return f.invert=function(d){return a(i((u||(u=o(t,e.map(r),bi)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,qA),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=K0,c()},f.clamp=function(d){return arguments.length?(a=d?!0:Jn,c()):a!==Jn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function sU(){return C2()(Jn,Jn)}function aU(e,t,n,r){var i=Ro(e,t,n),s;switch(r=hc(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=FL(i,a))&&(r.precision=s),W$(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=DL(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=NL(i))&&(r.precision=s-(r.type==="%")*2);break}}return r2(r)}function qc(e){var t=e.domain;return e.ticks=function(n){var r=t();return _A(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return aU(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,c=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);c-- >0;){if(u=EA(a,o,n),u===l)return r[i]=a,r[s]=o,t(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function oU(){var e=sU();return e.copy=function(){return Z0(e,oU())},As.apply(e,arguments),qc(e)}function lU(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,qA),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return lU(e).unknown(t)},e=arguments.length?Array.from(e,qA):[0,1],qc(n)}function uU(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function dD(e){return Math.log(e)}function hD(e){return Math.exp(e)}function Ote(e){return-Math.log(-e)}function Rte(e){return-Math.exp(-e)}function Pte(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Ite(e){return e===10?Pte:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Lte(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function pD(e){return(t,n)=>-e(-t,n)}function s9(e){const t=e(dD,hD),n=t.domain;let r=10,i,s;function a(){return i=Lte(r),s=Ite(r),n()[0]<0?(i=pD(i),s=pD(s),e(Ote,Rte)):e(dD,hD),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let d=i(u),h=i(c),p,g;const m=o==null?10:+o;let y=[];if(!(r%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(p=1;p<r;++p)if(g=d<0?p/s(-d):p*s(d),!(g<u)){if(g>c)break;y.push(g)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(g=d>0?p/s(-d):p*s(d),!(g<u)){if(g>c)break;y.push(g)}y.length*2<m&&(y=_A(u,c,m))}else y=_A(d,h,Math.min(h-d,m)).map(s);return f?y.reverse():y},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=hc(l)).precision==null&&(l.trim=!0),l=r2(l)),o===1/0)return l;const u=Math.max(1,r*o/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(uU(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function cU(){const e=s9(C2()).domain([1,10]);return e.copy=()=>Z0(e,cU()).base(e.base()),As.apply(e,arguments),e}function gD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function mD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function a9(e){var t=1,n=e(gD(t),mD(t));return n.constant=function(r){return arguments.length?e(gD(t=+r),mD(t)):t},qc(n)}function fU(){var e=a9(C2());return e.copy=function(){return Z0(e,fU()).constant(e.constant())},As.apply(e,arguments)}function yD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function zte(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Bte(e){return e<0?-e*e:e*e}function o9(e){var t=e(Jn,Jn),n=1;function r(){return n===1?e(Jn,Jn):n===.5?e(zte,Bte):e(yD(n),yD(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},qc(t)}function l9(){var e=o9(C2());return e.copy=function(){return Z0(e,l9()).exponent(e.exponent())},As.apply(e,arguments),e}function Ute(){return l9.apply(null,arguments).exponent(.5)}function dU(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=SL(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[H0(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ma),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return dU().domain(e).range(t).unknown(r)},As.apply(s,arguments)}function hU(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[H0(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return hU().domain([e,t]).range(i).unknown(s)},As.apply(qc(a),arguments)}function pU(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[H0(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return pU().domain(e).range(t).unknown(n)},As.apply(i,arguments)}function jte(e){return new Date(e)}function qte(e){return e instanceof Date?+e:+new Date(+e)}function u9(e,t,n,r,i,s,a,o,l,u){var c=sU(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),y=u("%a %d"),v=u("%b %d"),x=u("%B"),_=u("%Y");function w(k){return(l(k)<k?h:o(k)<k?p:a(k)<k?g:s(k)<k?m:r(k)<k?i(k)<k?y:v:n(k)<k?x:_)(k)}return c.invert=function(k){return new Date(f(k))},c.domain=function(k){return arguments.length?d(Array.from(k,qte)):d().map(jte)},c.ticks=function(k){var E=d();return e(E[0],E[E.length-1],k??10)},c.tickFormat=function(k,E){return E==null?w:u(E)},c.nice=function(k){var E=d();return(!k||typeof k.range!="function")&&(k=t(E[0],E[E.length-1],k??10)),k?d(uU(E,k)):c},c.copy=function(){return Z0(c,u9(e,t,n,r,i,s,a,o,l,u))},c}function Gte(){return As.apply(u9(XX,KX,ys,c0,Qd,ya,a2,i2,da,X$).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Wte(){return As.apply(u9(JX,YX,vs,f0,eh,Mo,o2,s2,da,K$).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function M2(){var e=0,t=1,n,r,i,s,a=Jn,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,a=f(h,p),u):[a(0),a(1)]}}return u.range=c(el),u.rangeRound=c(K0),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),u}}function tl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function c9(){var e=qc(M2()(Jn));return e.copy=function(){return tl(e,c9())},Zo.apply(e,arguments)}function gU(){var e=s9(M2()).domain([1,10]);return e.copy=function(){return tl(e,gU()).base(e.base())},Zo.apply(e,arguments)}function mU(){var e=a9(M2());return e.copy=function(){return tl(e,mU()).constant(e.constant())},Zo.apply(e,arguments)}function f9(){var e=o9(M2());return e.copy=function(){return tl(e,f9()).exponent(e.exponent())},Zo.apply(e,arguments)}function Hte(){return f9.apply(null,arguments).exponent(.5)}function T2(){var e=0,t=.5,n=1,r=1,i,s,a,o,l,u=Jn,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),s=c(t=+t),a=c(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u};function p(g){return function(m){var y,v,x;return arguments.length?([y,v,x]=m,u=i9(g,[y,v,x]),h):[u(0),u(.5),u(1)]}}return h.range=p(el),h.rangeRound=p(K0),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),s=g(t),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,h}}function yU(){var e=qc(T2()(Jn));return e.copy=function(){return tl(e,yU())},Zo.apply(e,arguments)}function vU(){var e=s9(T2()).domain([.1,1,10]);return e.copy=function(){return tl(e,vU()).base(e.base())},Zo.apply(e,arguments)}function bU(){var e=a9(T2());return e.copy=function(){return tl(e,bU()).constant(e.constant())},Zo.apply(e,arguments)}function d9(){var e=o9(T2());return e.copy=function(){return tl(e,d9()).exponent(e.exponent())},Zo.apply(e,arguments)}function Vte(){return d9.apply(null,arguments).exponent(.5)}function h9(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Jte="identity",kd="linear",Aa="log",Q0="pow",em="sqrt",N2="symlog",gc="time",mc="utc",ds="sequential",sh="diverging",Sd="quantile",F2="quantize",D2="threshold",p9="ordinal",WA="point",xU="band",g9="bin-ordinal",$t="continuous",tm="discrete",nm="discretizing",ii="interpolating",m9="temporal";function Yte(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Xte(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,a,o,l,u;for(i<r&&(o=r,r=i,i=o),l=0,u=n.length;l<u;++l)n[l]>=r&&n[l]<=i&&(s<0&&(s=l),a=l);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[a]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function y9(){const e=QC().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,a=!1,o=0,l=0,u=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=h9(f,o,l);let g=r[d-0];i=(h-g)/(p||1),a&&(i=Math.floor(i)),g+=(h-g-i*(f-o))*u,s=i*(1-o),a&&(g=Math.round(g),s=Math.round(s));const m=_r(f).map(y=>g+i*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),o=l,c()):o},e.paddingInner=function(f){return arguments.length?(o=Math.max(0,Math.min(1,f)),c()):o},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],y,v,x;if(!(g!==g||m!==m)&&(m<g&&(x=g,g=m,m=x),!(m<h[0]||g>r[1-d])))return y=Math.max(0,xv(h,g)-1),v=g===m?y:xv(h,m)-1,g-h[y]>s+1e-10&&++y,d&&(x=y,y=p-v,v=p-x),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return y9().domain(t()).range(r).round(a).paddingInner(o).paddingOuter(l).align(u)},c()}function wU(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return wU(t())},e}function Kte(){return wU(y9().paddingInner(1))}var Zte=Array.prototype.map;function Qte(e){return Zte.call(e,tn)}const ene=Array.prototype.slice;function _U(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(H0(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=Qte(r),n):e.slice()},n.range=function(r){return arguments.length?(t=ene.call(r),n):t.slice()},n.tickFormat=function(r,i){return aU(e[0],Oe(e),r??10,i)},n.copy=function(){return _U().domain(n.domain()).range(n.range())},n}const Iv=new Map,EU=Symbol("vega_scale");function kU(e){return e[EU]=!0,e}function tne(e){return e&&e[EU]===!0}function nne(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Yte(s):s.invertExtent?Xte(s):void 0),s.type=e,kU(s)};return r.metadata=Di(le(n)),r}function ze(e,t,n){return arguments.length>1?(Iv.set(e,nne(e,t,n)),this):SU(e)?Iv.get(e):void 0}ze(Jte,lU);ze(kd,oU,$t);ze(Aa,cU,[$t,Aa]);ze(Q0,l9,$t);ze(em,Ute,$t);ze(N2,fU,$t);ze(gc,Gte,[$t,m9]);ze(mc,Wte,[$t,m9]);ze(ds,c9,[$t,ii]);ze(`${ds}-${kd}`,c9,[$t,ii]);ze(`${ds}-${Aa}`,gU,[$t,ii,Aa]);ze(`${ds}-${Q0}`,f9,[$t,ii]);ze(`${ds}-${em}`,Hte,[$t,ii]);ze(`${ds}-${N2}`,mU,[$t,ii]);ze(`${sh}-${kd}`,yU,[$t,ii]);ze(`${sh}-${Aa}`,vU,[$t,ii,Aa]);ze(`${sh}-${Q0}`,d9,[$t,ii]);ze(`${sh}-${em}`,Vte,[$t,ii]);ze(`${sh}-${N2}`,bU,[$t,ii]);ze(Sd,dU,[nm,Sd]);ze(F2,hU,nm);ze(D2,pU,nm);ze(g9,_U,[tm,nm]);ze(p9,QC,tm);ze(xU,y9,tm);ze(WA,Kte,tm);function SU(e){return Iv.has(e)}function Gc(e,t){const n=Iv.get(e);return n&&n.metadata[t]}function v9(e){return Gc(e,$t)}function Ad(e){return Gc(e,tm)}function HA(e){return Gc(e,nm)}function AU(e){return Gc(e,Aa)}function rne(e){return Gc(e,m9)}function $U(e){return Gc(e,ii)}function CU(e){return Gc(e,Sd)}const ine=["clamp","base","constant","exponent"];function MU(e,t){const n=t[0],r=Oe(t)-n;return function(i){return e(n+i*r)}}function O2(e,t,n){return i9(b9(t||"rgb",n),e)}function TU(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function NU(e,t,n){const r=n-t;let i,s,a;return!r||!Number.isFinite(r)?cn(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),a=ze(s)().domain([t,n]).range([0,1]),ine.forEach(o=>e[o]?a[o](e[o]()):0),a)}function b9(e,t){const n=Mte[sne(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function sne(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const ane={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},one={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function FU(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function DU(e,t){for(const n in e)x9(n,t(e[n]))}const vD={};DU(one,FU);DU(ane,e=>O2(FU(e)));function x9(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(vD[e]=t,this):vD[e]}const Jy="symbol",lne="discrete",une="gradient",cne=e=>Y(e)?e.map(t=>String(t)):String(e),fne=(e,t)=>e[1]-t[1],dne=(e,t)=>t[1]-e[1];function w9(e,t,n){let r;return Ye(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(G0(e.domain())/n||1)))),ce(t)&&(r=t.step,t=t.interval),oe(t)&&(t=e.type===gc?th(t):e.type==mc?nh(t):H("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function OU(e,t,n){let r=e.range(),i=r[0],s=Oe(r),a=fne;if(i>s&&(r=s,s=i,i=r,a=dne),i=Math.floor(i),s=Math.ceil(s),t=t.map(o=>[o,e(o)]).filter(o=>i<=o[1]&&o[1]<=s).sort(a).map(o=>o[0]),n>0&&t.length>1){const o=[t[0],Oe(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=o)}return t}function _9(e,t){return e.bins?OU(e,e.bins):e.ticks?e.ticks(t):e.domain()}function RU(e,t,n,r,i,s){const a=t.type;let o=cne;if(a===gc||i===gc)o=e.timeFormat(r);else if(a===mc||i===mc)o=e.utcFormat(r);else if(AU(a)){const l=e.formatFloat(r);if(s||t.bins)o=l;else{const u=PU(t,n,!1);o=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();o=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(o=e.format(r));return o}function PU(e,t,n){const r=_9(e,t),i=e.base(),s=Math.log(i),a=Math.max(1,i*t/r.length),o=l=>{let u=l/Math.pow(i,Math.round(Math.log(l)/s));return u*i<i-.5&&(u*=i),u<=a};return n?r.filter(o):o}const VA={[Sd]:"quantiles",[F2]:"thresholds",[D2]:"domain"},IU={[Sd]:"quantiles",[F2]:"domain"};function LU(e,t){return e.bins?gne(e.bins):e.type===Aa?PU(e,t,!0):VA[e.type]?pne(e[VA[e.type]]()):_9(e,t)}function hne(e,t,n){const r=t[IU[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],a;for(a=1;a<i;++a)s=Math.min(s,r[a]-r[a-1]);return e.formatSpan(0,s,3*10,n)}function pne(e){const t=[-1/0].concat(e);return t.max=1/0,t}function gne(e){const t=e.slice(0,-1);return t.max=Oe(e),t}const mne=e=>VA[e.type]||e.bins;function zU(e,t,n,r,i,s,a){const o=IU[t.type]&&s!==gc&&s!==mc?hne(e,t,i):RU(e,t,n,i,s,a);return r===Jy&&mne(t)?yne(o):r===lne?vne(o):bne(o)}const yne=e=>(t,n,r)=>{const i=bD(r[n+1],bD(r.max,1/0)),s=xD(t,e),a=xD(i,e);return s&&a?s+" – "+a:a?"< "+a:"≥ "+s},bD=(e,t)=>e??t,vne=e=>(t,n)=>n?e(t):null,bne=e=>t=>e(t),xD=(e,t)=>Number.isFinite(e)?t(e):null;function xne(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+Oe(t),s=i-r;if(e.type===D2){const a=n?s/n:.1;r-=a,i+=a,s=i-r}return a=>(a-r)/s}function wne(e,t,n,r){const i=r||t.type;return oe(n)&&rne(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===gc?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===mc?e.utcFormat("%A, %d %B %Y, %X UTC"):zU(e,t,5,null,n,r,!0)}function BU(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=wne(e,t,n.format,n.formatType);if(HA(t.type)){const s=LU(t).slice(1).map(i),a=s.length;return`${a} boundar${a===1?"y":"ies"}: ${s.join(", ")}`}else if(Ad(t.type)){const s=t.domain(),a=s.length,o=a>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return`${a} value${a===1?"":"s"}: ${o}`}else{const s=t.domain();return`values from ${i(s[0])} to ${i(Oe(s))}`}}let UU=0;function _ne(){UU=0}const Lv="p_";function E9(e){return e&&e.gradient}function jU(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?Lv:"";return i||(i=e.id="gradient_"+UU++,r==="radial"?(e.x1=Zi(e.x1,.5),e.y1=Zi(e.y1,.5),e.r1=Zi(e.r1,0),e.x2=Zi(e.x2,.5),e.y2=Zi(e.y2,.5),e.r2=Zi(e.r2,.5),s=Lv):(e.x1=Zi(e.x1,0),e.y1=Zi(e.y1,0),e.x2=Zi(e.x2,1),e.y2=Zi(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function Zi(e,t){return e??t}function qU(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const wD={basis:{curve:$ee},"basis-closed":{curve:Cee},"basis-open":{curve:Mee},bundle:{curve:Tee,tension:"beta",value:.85},cardinal:{curve:Nee,tension:"tension",value:0},"cardinal-open":{curve:Dee,tension:"tension",value:0},"cardinal-closed":{curve:Fee,tension:"tension",value:0},"catmull-rom":{curve:Oee,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Ree,tension:"alpha",value:.5},"catmull-rom-open":{curve:Pee,tension:"alpha",value:.5},linear:{curve:JC},"linear-closed":{curve:Iee},monotone:{horizontal:zee,vertical:Lee},natural:{curve:Bee},step:{curve:Uee},"step-after":{curve:qee},"step-before":{curve:jee}};function k9(e,t,n){var r=ve(wD,e)&&wD[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const Ene={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},kne=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Sne=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Ane=/^((\s+,?\s*)|(,\s*))/,$ne=/^[01]/;function $d(e){const t=[];return(e.match(kne)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),a=Ene[s],o=Cne(s,a,r.slice(1).trim()),l=o.length;if(l<a||l&&l%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...o.slice(0,a)]),l!==a){s==="m"&&(i=i==="M"?"L":"l");for(let u=a;u<l;u+=a)t.push([i,...o.slice(u,u+a)])}}),t}function Cne(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const a=e==="a"&&(s===3||s===4)?$ne:Sne,o=n.slice(i).match(a);if(o===null)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const l=n.slice(i).match(Ane);l!==null&&(i+=l[0].length)}return r}const zo=Math.PI/180,Mne=1e-14,Vu=Math.PI/2,is=Math.PI*2,Pf=Math.sqrt(3)/2;var f5={},d5={},GU=[].join;function Tne(e,t,n,r,i,s,a,o,l){const u=GU.call(arguments);if(f5[u])return f5[u];const c=a*zo,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(o-e)*.5+f*(l-t)*.5,p=d*(l-t)*.5-f*(o-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=f/n,v=-f/r,x=d/r,_=m*o+y*l,w=v*o+x*l,k=m*e+y*t,E=v*e+x*t;let z=1/((k-_)*(k-_)+(E-w)*(E-w))-.25;z<0&&(z=0);let D=Math.sqrt(z);s==i&&(D=-D);const R=.5*(_+k)-D*(E-w),j=.5*(w+E)+D*(k-_),O=Math.atan2(w-j,_-R);let P=Math.atan2(E-j,k-R)-O;P<0&&s===1?P+=is:P>0&&s===0&&(P-=is);const B=Math.ceil(Math.abs(P/(Vu+.001))),U=[];for(let q=0;q<B;++q){const X=O+q*P/B,ae=O+(q+1)*P/B;U[q]=[R,j,X,ae,n,r,f,d]}return f5[u]=U}function Nne(e){const t=GU.call(e);if(d5[t])return d5[t];var n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7];const c=u*a,f=-l*o,d=l*a,h=u*o,p=Math.cos(i),g=Math.sin(i),m=Math.cos(s),y=Math.sin(s),v=.5*(s-i),x=Math.sin(v*.5),_=8/3*x*x/Math.sin(v),w=n+p-_*g,k=r+g+_*p,E=n+m,A=r+y,z=E+_*y,D=A-_*m;return d5[t]=[c*w+f*k,d*w+h*k,c*z+f*D,d*z+h*D,c*E+f*A,d*E+h*A]}const Gr=["l",0,0,0,0,0,0,0];function Fne(e,t,n){const r=Gr[0]=e[0];if(r==="a"||r==="A")Gr[1]=t*e[1],Gr[2]=n*e[2],Gr[3]=e[3],Gr[4]=e[4],Gr[5]=e[5],Gr[6]=t*e[6],Gr[7]=n*e[7];else if(r==="h"||r==="H")Gr[1]=t*e[1];else if(r==="v"||r==="V")Gr[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)Gr[i]=(i%2==1?t:n)*e[i];return Gr}function v0(e,t,n,r,i,s){var a,o=null,l=0,u=0,c=0,f=0,d,h,p,g,m=0,y=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var v=0,x=t.length;v<x;++v){switch(a=t[v],(i!==1||s!==1)&&(a=Fne(a,i,s)),a[0]){case"l":l+=a[1],u+=a[2],e.lineTo(l+n,u+r);break;case"L":l=a[1],u=a[2],e.lineTo(l+n,u+r);break;case"h":l+=a[1],e.lineTo(l+n,u+r);break;case"H":l=a[1],e.lineTo(l+n,u+r);break;case"v":u+=a[1],e.lineTo(l+n,u+r);break;case"V":u=a[1],e.lineTo(l+n,u+r);break;case"m":l+=a[1],u+=a[2],m=l,y=u,e.moveTo(l+n,u+r);break;case"M":l=a[1],u=a[2],m=l,y=u,e.moveTo(l+n,u+r);break;case"c":d=l+a[5],h=u+a[6],c=l+a[3],f=u+a[4],e.bezierCurveTo(l+a[1]+n,u+a[2]+r,c+n,f+r,d+n,h+r),l=d,u=h;break;case"C":l=a[5],u=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,c+n,f+r,l+n,u+r);break;case"s":d=l+a[3],h=u+a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,l+a[1]+n,u+a[2]+r,d+n,h+r),c=l+a[1],f=u+a[2],l=d,u=h;break;case"S":d=a[3],h=a[4],c=2*l-c,f=2*u-f,e.bezierCurveTo(c+n,f+r,a[1]+n,a[2]+r,d+n,h+r),l=d,u=h,c=a[1],f=a[2];break;case"q":d=l+a[3],h=u+a[4],c=l+a[1],f=u+a[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,d+n,h+r),l=d,u=h,c=a[1],f=a[2];break;case"t":d=l+a[1],h=u+a[2],o[0].match(/[QqTt]/)===null?(c=l,f=u):o[0]==="t"?(c=2*l-p,f=2*u-g):o[0]==="q"&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h,c=l+a[1],f=u+a[2];break;case"T":d=a[1],h=a[2],c=2*l-c,f=2*u-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),l=d,u=h;break;case"a":_D(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+l+n,a[7]+u+r]),l+=a[6],u+=a[7];break;case"A":_D(e,l+n,u+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),l=a[6],u=a[7];break;case"z":case"Z":l=m,u=y,e.closePath();break}o=a}}function _D(e,t,n,r){const i=Tne(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const a=Nne(i[s]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const ED=.5773502691896257,kD={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,is)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n,i=r-n*ED,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n,i=r-n*ED;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pf*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function WU(e){return ve(kD,e)?kD[e]:Dne(e)}var h5={};function Dne(e){if(!ve(h5,e)){const t=$d(e);h5[e]={draw:function(n,r){v0(n,t,0,0,Math.sqrt(r)/2)}}}return h5[e]}const oo=.448084975506;function One(e){return e.x}function Rne(e){return e.y}function Pne(e){return e.width}function Ine(e){return e.height}function ea(e){return typeof e=="function"?e:()=>+e}function hy(e,t,n){return Math.max(t,Math.min(e,n))}function HU(){var e=One,t=Rne,n=Pne,r=Ine,i=ea(0),s=i,a=i,o=i,l=null;function u(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),y=+r.call(this,c),v=Math.min(m,y)/2,x=hy(+i.call(this,c),0,v),_=hy(+s.call(this,c),0,v),w=hy(+a.call(this,c),0,v),k=hy(+o.call(this,c),0,v);if(l||(l=h=w2()),x<=0&&_<=0&&w<=0&&k<=0)l.rect(p,g,m,y);else{var E=p+m,A=g+y;l.moveTo(p+x,g),l.lineTo(E-_,g),l.bezierCurveTo(E-oo*_,g,E,g+oo*_,E,g+_),l.lineTo(E,A-k),l.bezierCurveTo(E,A-oo*k,E-oo*k,A,E-k,A),l.lineTo(p+w,A),l.bezierCurveTo(p+oo*w,A,p,A-oo*w,p,A-w),l.lineTo(p,g+x),l.bezierCurveTo(p,g+oo*x,p+oo*x,g,p+x,g),l.closePath()}if(h)return l=null,h+""||null}return u.x=function(c){return arguments.length?(e=ea(c),u):e},u.y=function(c){return arguments.length?(t=ea(c),u):t},u.width=function(c){return arguments.length?(n=ea(c),u):n},u.height=function(c){return arguments.length?(r=ea(c),u):r},u.cornerRadius=function(c,f,d,h){return arguments.length?(i=ea(c),s=f!=null?ea(f):i,o=d!=null?ea(d):i,a=h!=null?ea(h):s,u):i},u.context=function(c){return arguments.length?(l=c??null,u):l},u}function VU(){var e,t,n,r,i=null,s,a,o,l;function u(f,d,h){const p=h/2;if(s){var g=o-d,m=f-a;if(g||m){var y=Math.sqrt(g*g+m*m),v=(g/=y)*l,x=(m/=y)*l,_=Math.atan2(m,g);i.moveTo(a-v,o-x),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,_-Math.PI,_),i.lineTo(a+v,o+x),i.arc(a,o,l,_,_+Math.PI)}else i.arc(f,d,p,0,is);i.closePath()}else s=1;a=f,o=d,l=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=w2()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function rm(e,t){return e??t}const im=e=>e.x||0,sm=e=>e.y||0,Lne=e=>e.width||0,zne=e=>e.height||0,Bne=e=>(e.x||0)+(e.width||0),Une=e=>(e.y||0)+(e.height||0),jne=e=>e.startAngle||0,qne=e=>e.endAngle||0,Gne=e=>e.padAngle||0,Wne=e=>e.innerRadius||0,Hne=e=>e.outerRadius||0,Vne=e=>e.cornerRadius||0,Jne=e=>rm(e.cornerRadiusTopLeft,e.cornerRadius)||0,Yne=e=>rm(e.cornerRadiusTopRight,e.cornerRadius)||0,Xne=e=>rm(e.cornerRadiusBottomRight,e.cornerRadius)||0,Kne=e=>rm(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Zne=e=>rm(e.size,64),Qne=e=>e.size||1,R2=e=>e.defined!==!1,ere=e=>WU(e.shape||"circle"),tre=kee().startAngle(jne).endAngle(qne).padAngle(Gne).innerRadius(Wne).outerRadius(Hne).cornerRadius(Vne),nre=_B().x(im).y1(sm).y0(Une).defined(R2),rre=_B().y(sm).x1(im).x0(Bne).defined(R2),ire=wB().x(im).y(sm).defined(R2),sre=HU().x(im).y(sm).width(Lne).height(zne).cornerRadius(Jne,Yne,Xne,Kne),are=Aee().type(ere).size(Zne),ore=VU().x(im).y(sm).defined(R2).size(Qne);function S9(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function lre(e,t){return tre.context(e)(t)}function ure(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?rre:nre).curve(k9(r,n.orient,n.tension)).context(e)(t)}function cre(e,t){const n=t[0],r=n.interpolate||"linear";return ire.curve(k9(r,n.orient,n.tension)).context(e)(t)}function ah(e,t,n,r){return sre.context(e)(t,n,r)}function fre(e,t){return(t.mark.shape||t.shape).context(e)(t)}function dre(e,t){return are.context(e)(t)}function hre(e,t){return ore.context(e)(t)}var JU=1;function YU(){JU=1}function A9(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+JU++),a=i.clipping[s]||(i.clipping[s]={id:s});return $e(r)?a.path=r(null):S9(n)?a.path=ah(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+s+")"}function mt(e){this.clear(),e&&this.union(e)}mt.prototype={clone(){return new mt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:a}=this,o=Math.cos(e),l=Math.sin(e),u=t-t*o+n*l,c=n-t*l-n*o;return[o*r-l*i+u,l*r+o*i+c,o*r-l*a+u,l*r+o*a+c,o*s-l*i+u,l*s+o*i+c,o*s-l*a+u,l*s+o*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function P2(e){this.mark=e,this.bounds=this.bounds||new mt}function I2(e){P2.call(this,e),this.items=this.items||[]}ne(I2,P2);function $9(e){this._pending=0,this._loader=e||u2()}function SD(e){e._pending+=1}function og(e){e._pending-=1}$9.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return SD(t),t._loader.sanitize(e,{context:"href"}).then(n=>(og(t),n)).catch(()=>(og(t),null))},loadImage(e){const t=this,n=Gee();return SD(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,a=ve(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(s.crossOrigin=a),s.onload=()=>og(t),s.onerror=()=>og(t),s.src=i,s}).catch(r=>(og(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Ma(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?pre(t,r):0))}return e}function pre(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const gre=is-1e-8;let L2,Yy,Xy,ec,JA,Ky,YA,XA;const bo=(e,t)=>L2.add(e,t),Zy=(e,t)=>bo(Yy=e,Xy=t),AD=e=>bo(e,L2.y1),$D=e=>bo(L2.x1,e),Ju=(e,t)=>JA*e+YA*t,Yu=(e,t)=>Ky*e+XA*t,p5=(e,t)=>bo(Ju(e,t),Yu(e,t)),g5=(e,t)=>Zy(Ju(e,t),Yu(e,t));function am(e,t){return L2=e,t?(ec=t*zo,JA=XA=Math.cos(ec),Ky=Math.sin(ec),YA=-Ky):(JA=XA=1,ec=Ky=YA=0),mre}const mre={beginPath(){},closePath(){},moveTo:g5,lineTo:g5,rect(e,t,n,r){ec?(p5(e+n,t),p5(e+n,t+r),p5(e,t+r),g5(e,t)):(bo(e+n,t+r),Zy(e,t))},quadraticCurveTo(e,t,n,r){const i=Ju(e,t),s=Yu(e,t),a=Ju(n,r),o=Yu(n,r);CD(Yy,i,a,AD),CD(Xy,s,o,$D),Zy(a,o)},bezierCurveTo(e,t,n,r,i,s){const a=Ju(e,t),o=Yu(e,t),l=Ju(n,r),u=Yu(n,r),c=Ju(i,s),f=Yu(i,s);MD(Yy,a,l,c,AD),MD(Xy,o,u,f,$D),Zy(c,f)},arc(e,t,n,r,i,s){if(r+=ec,i+=ec,Yy=n*Math.cos(i)+e,Xy=n*Math.sin(i)+t,Math.abs(i-r)>gre)bo(e-n,t-n),bo(e+n,t+n);else{const a=u=>bo(n*Math.cos(u)+e,n*Math.sin(u)+t);let o,l;if(a(r),a(i),i!==r)if(r=r%is,r<0&&(r+=is),i=i%is,i<0&&(i+=is),i<r&&(s=!s,o=r,r=i,i=o),s)for(i-=is,o=r-r%Vu,l=0;l<4&&o>i;++l,o-=Vu)a(o);else for(o=r-r%Vu+Vu,l=0;l<4&&o<i;++l,o=o+Vu)a(o)}}};function CD(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function MD(e,t,n,r,i){const s=r-e+3*t-3*n,a=e+n-2*t,o=e-t;let l=0,u=0,c;Math.abs(s)>Mne?(c=a*a+o*s,c>=0&&(c=Math.sqrt(c),l=(-a+c)/s,u=(-a-c)/s)):l=.5*o/a,0<l&&l<1&&i(TD(l,e,t,n,r)),0<u&&u<1&&i(TD(u,e,t,n,r))}function TD(e,t,n,r,i){const s=1-e,a=s*s,o=e*e;return a*s*t+3*a*e*n+3*s*o*r+o*e*i}var Fo=(Fo=No(1,1))?Fo.getContext("2d"):null;const KA=new mt;function C9(e){return function(t,n){if(!Fo)return!0;e(Fo,t),KA.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:a}=KA;for(let o=i;o<=a;++o)for(let l=r;l<=s;++l)if(Fo.isPointInPath(l,o))return!0;return!1}}function M9(e,t){return t.contains(e.x||0,e.y||0)}function XU(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(KA.set(n,r,n+i,r+s))}function KU(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return Zf(t,n,r,i,s)}function Zf(e,t,n,r,i){const{x1:s,y1:a,x2:o,y2:l}=e,u=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-u,p=-(s-t)),m===1&&(h=u,p=o-t),m===2&&(h=-c,p=-(a-n)),m===3&&(h=c,p=l-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Cd(e,t){e.globalCompositeOperation=t.blend||"source-over"}function pi(e,t){return e??t}function ND(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function yre(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+pi(t.x1,.5)*r,n.y1+pi(t.y1,.5)*i,Math.max(r,i)*pi(t.r1,0),n.x1+pi(t.x2,.5)*r,n.y1+pi(t.y2,.5)*i,Math.max(r,i)*pi(t.r2,.5));else{const a=pi(t.x1,0),o=pi(t.y1,0),l=pi(t.x2,1),u=pi(t.y2,0);if(a===l||o===u||r===i)s=e.createLinearGradient(n.x1+a*r,n.y1+o*i,n.x1+l*r,n.y1+u*i);else{const c=No(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=ND(f.createLinearGradient(a,o,l,u),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return ND(s,t.stops)}function ZU(e,t,n){return E9(n)?yre(e,n,t.bounds):n}function zv(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=ZU(e,t,t.fill),!0):!1}var vre=[];function Md(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=ZU(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||vre),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function bre(e,t){return e.zindex-t.zindex||e.index-t.index}function T9(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(bre)}function Ri(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=T9(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function Bv(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=T9(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function N9(e){return function(t,n,r){Ri(n,i=>{(!r||r.intersects(i.bounds))&&QU(e,t,i,i)})}}function xre(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&QU(e,t,n.items[0],n.items)}}function QU(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Cd(t,n),n.fill&&zv(t,n,i)&&t.fill(),n.stroke&&Md(t,n,i)&&t.stroke()))}function z2(e){return e=e||Zr,function(t,n,r,i,s,a){return r*=t.pixelRatio,i*=t.pixelRatio,Bv(n,o=>{const l=o.bounds;if(!(l&&!l.contains(s,a)||!l)&&e(t,o,r,i,s,a))return o})}}function om(e,t){return function(n,r,i,s){var a=Array.isArray(r)?r[0]:r,o=t??a.fill,l=a.stroke&&n.isPointInStroke,u,c;return l&&(u=a.strokeWidth,c=a.strokeCap,n.lineWidth=u??1,n.lineCap=c??"butt"),e(n,r)?!1:o&&n.isPointInPath(i,s)||l&&n.isPointInStroke(i,s)}}function F9(e){return z2(om(e))}function oc(e,t){return"translate("+e+","+t+")"}function D9(e){return"rotate("+e+")"}function wre(e,t){return"scale("+e+","+t+")"}function ej(e){return oc(e.x||0,e.y||0)}function _re(e){return oc(e.x||0,e.y||0)+(e.angle?" "+D9(e.angle):"")}function Ere(e){return oc(e.x||0,e.y||0)+(e.angle?" "+D9(e.angle):"")+(e.scaleX||e.scaleY?" "+wre(e.scaleX||1,e.scaleY||1):"")}function O9(e,t,n){function r(a,o){a("transform",_re(o)),a("d",t(null,o))}function i(a,o){return t(am(a,o.angle),o),Ma(a,o).translate(o.x||0,o.y||0)}function s(a,o){var l=o.x||0,u=o.y||0,c=o.angle||0;a.translate(l,u),c&&a.rotate(c*=zo),a.beginPath(),t(a,o),c&&a.rotate(-c),a.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:N9(s),pick:F9(s),isect:n||C9(s)}}var kre=O9("arc",lre);function Sre(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,a,o;--i>=0;)e[i].defined!==!1&&(o=Math.abs(e[i][r]-n),o<s&&(s=o,a=e[i]));return a}function Are(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,a;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],a=i*i+s*s,a<n))return e[r];return null}function $re(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function R9(e,t,n){function r(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))}function i(l,u){var c=u.items;return c.length===0?l:(t(am(l),c),Ma(l,c[0]))}function s(l,u){l.beginPath(),t(l,u)}const a=om(s);function o(l,u,c,f,d,h){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=l.pixelRatio,f*=l.pixelRatio,a(l,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:xre(s),pick:o,isect:M9,tip:n}}var Cre=R9("area",ure,Sre);function Mre(e,t){var n=t.clip;e.save(),$e(n)?(e.beginPath(),n(e),e.clip()):tj(e,t.group)}function tj(e,t){e.beginPath(),S9(t)?ah(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function nj(e){const t=pi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Tre(e,t){e("transform",ej(t))}function rj(e,t){const n=nj(t);e("d",ah(null,t,n,n))}function Nre(e,t){e("class","background"),e("aria-hidden",!0),rj(e,t)}function Fre(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?rj(e,t):e("d","")}function Dre(e,t,n){const r=t.clip?A9(n,t,t):null;e("clip-path",r)}function Ore(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ma(e,t),e.translate(t.x||0,t.y||0)}function b0(e,t,n,r){const i=nj(t);e.beginPath(),ah(e,t,(n||0)+i,(r||0)+i)}const Rre=om(b0),Pre=om(b0,!1),Ire=om(b0,!0);function Lre(e,t,n){Ri(t,r=>{const i=r.x||0,s=r.y||0,a=r.strokeForeground,o=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&o&&(b0(e,r,i,s),Cd(e,r),r.fill&&zv(e,r,o)&&e.fill(),r.stroke&&!a&&Md(e,r,o)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&tj(e,r),n&&n.translate(-i,-s),Ri(r,l=>{this.draw(e,l,n)}),n&&n.translate(i,s),e.restore(),a&&r.stroke&&o&&(b0(e,r,i,s),Cd(e,r),Md(e,r,o)&&e.stroke())})}function zre(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const a=n*e.pixelRatio,o=r*e.pixelRatio;return Bv(t,l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(i,s))return;c=l.x||0,f=l.y||0;const h=c+(l.width||0),p=f+(l.height||0),g=l.clip;if(g&&(i<c||i>h||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,g&&S9(l)&&!Ire(e,l,a,o))return e.restore(),null;const m=l.strokeForeground,y=t.interactive!==!1;return y&&m&&l.stroke&&Pre(e,l,a,o)?(e.restore(),l):(u=Bv(l,v=>Bre(v,c,f)?this.pick(v,n,r,c,f):null),!u&&y&&(l.fill||!m&&l.stroke)&&Rre(e,l,a,o)&&(u=l),e.restore(),u||null)})}function Bre(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Ure={type:"group",tag:"g",nested:!1,attr:Tre,bound:Ore,draw:Lre,pick:zre,isect:XU,content:Dre,background:Nre,foreground:Fre},x0={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function P9(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function I9(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function L9(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function B2(e,t){return e==="center"?t/2:e==="right"?t:0}function U2(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function jre(e,t,n){const r=P9(t,n),i=I9(t,r),s=L9(t,r),a=(t.x||0)-B2(t.align,i),o=(t.y||0)-U2(t.baseline,s),l=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",l,x0["xmlns:xlink"],"xlink:href"),e("transform",oc(a,o)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function qre(e,t){const n=t.image,r=I9(t,n),i=L9(t,n),s=(t.x||0)-B2(t.align,r),a=(t.y||0)-U2(t.baseline,i);return e.set(s,a,s+r,a+i)}function Gre(e,t,n){Ri(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=P9(r,this);let s=I9(r,i),a=L9(r,i);if(s===0||a===0)return;let o=(r.x||0)-B2(r.align,s),l=(r.y||0)-U2(r.baseline,a),u,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,l+=(a-d)/2,a=d):(d=a*c,o+=(s-d)/2,s=d))),(i.complete||i.toDataURL)&&(Cd(e,r),e.globalAlpha=(u=r.opacity)!=null?u:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,o,l,s,a))})}var Wre={type:"image",tag:"image",nested:!1,attr:jre,bound:qre,draw:Gre,pick:z2(),isect:Zr,get:P9,xOffset:B2,yOffset:U2},Hre=R9("line",cre,Are);function Vre(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",Ere(t)),e("d",t.path)}function Qy(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,a=t.scaleY||1,o=(t.angle||0)*zo,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=$d(n)).path=n),o&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(o),v0(e,l,0,0,s,a),e.rotate(-o),e.translate(-r,-i)):v0(e,l,r,i,s,a)}function Jre(e,t){return Qy(am(e,t.angle),t)?e.set(0,0,0,0):Ma(e,t,!0)}var Yre={type:"path",tag:"path",nested:!1,attr:Vre,bound:Jre,draw:N9(Qy),pick:F9(Qy),isect:C9(Qy)};function Xre(e,t){e("d",ah(null,t))}function Kre(e,t){var n,r;return Ma(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function FD(e,t){e.beginPath(),ah(e,t)}var Zre={type:"rect",tag:"path",nested:!1,attr:Xre,bound:Kre,draw:N9(FD),pick:F9(FD),isect:XU};function Qre(e,t){e("transform",ej(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function eie(e,t){var n,r;return Ma(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function ij(e,t,n){var r,i,s,a;return t.stroke&&Md(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,a=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,a),!0):!1}function tie(e,t,n){Ri(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&ij(e,r,i)&&(Cd(e,r),e.stroke())}})}function nie(e,t,n,r){return e.isPointInStroke?ij(e,t,1)&&e.isPointInStroke(n,r):!1}var rie={type:"rule",tag:"line",nested:!1,attr:Qre,bound:eie,draw:tie,pick:z2(nie),isect:KU},iie=O9("shape",fre),sie=O9("symbol",dre,M9);const DD=dL();var Mi={height:$s,measureWidth:z9,estimateWidth:ZA,width:ZA,canvas:sj};sj(!0);function sj(e){Mi.width=e&&Fo?z9:ZA}function ZA(e,t){return aj(Uo(e,t),$s(e))}function aj(e,t){return~~(.8*e.length*t)}function z9(e,t){return $s(e)<=0||!(t=Uo(e,t))?0:oj(t,j2(e))}function oj(e,t){const n=`(${t}) ${e}`;let r=DD.get(n);return r===void 0&&(Fo.font=t,r=Fo.measureText(e).width,DD.set(n,r)),r}function $s(e){return e.fontSize!=null?+e.fontSize||0:11}function Bo(e){return e.lineHeight!=null?e.lineHeight:$s(e)+2}function aie(e){return Y(e)?e.length>1?e:e[0]:e}function lm(e){return aie(e.lineBreak&&e.text&&!Y(e.text)?e.text.split(e.lineBreak):e.text)}function B9(e){const t=lm(e);return(Y(t)?t.length-1:0)*Bo(e)}function Uo(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?lie(e,n):n}function oie(e){if(Mi.width===z9){const t=j2(e);return n=>oj(n,t)}else{const t=$s(e);return n=>aj(n,t)}}function lie(e,t){var n=+e.limit,r=oie(e);if(r(t)<n)return t;var i=e.ellipsis||"…",s=e.dir==="rtl",a=0,o=t.length,l;if(n-=r(i),s){for(;a<o;)l=a+o>>>1,r(t.slice(l))>n?a=l+1:o=l;return i+t.slice(a)}else{for(;a<o;)l=1+(a+o>>>1),r(t.slice(0,l))<n?a=l:o=l-1;return t.slice(0,a)+i}}function um(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function j2(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+$s(e)+"px "+um(e,t)}function U9(e){var t=e.baseline,n=$s(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Bo(e):t==="line-bottom"?.29*n-.5*Bo(e):0)}const uie={left:"start",center:"middle",right:"end"},Jg=new mt;function q2(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Vu,t+=r*Math.cos(i),n+=r*Math.sin(i)),Jg.x1=t,Jg.y1=n,Jg}function cie(e,t){var n=t.dx||0,r=(t.dy||0)+U9(t),i=q2(t),s=i.x1,a=i.y1,o=t.angle||0,l;e("text-anchor",uie[t.align]||"start"),o?(l=oc(s,a)+" "+D9(o),(n||r)&&(l+=" "+oc(n,r))):l=oc(s+n,a+r),e("transform",l)}function j9(e,t,n){var r=Mi.height(t),i=t.align,s=q2(t),a=s.x1,o=s.y1,l=t.dx||0,u=(t.dy||0)+U9(t)-Math.round(.8*r),c=lm(t),f;if(Y(c)?(r+=Bo(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Mi.width(t,h)),0)):f=Mi.width(t,c),i==="center"?l-=f/2:i==="right"&&(l-=f),e.set(l+=a,u+=o,l+f,u+r),t.angle&&!n)e.rotate(t.angle*zo,a,o);else if(n===2)return e.rotatedPoints(t.angle*zo,a,o);return e}function fie(e,t,n){Ri(t,r=>{var i=r.opacity==null?1:r.opacity,s,a,o,l,u,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=j2(r),e.textAlign=r.align||"left",s=q2(r),a=s.x1,o=s.y1,r.angle&&(e.save(),e.translate(a,o),e.rotate(r.angle*zo),a=o=0),a+=r.dx||0,o+=(r.dy||0)+U9(r),c=lm(r),Cd(e,r),Y(c))for(u=Bo(r),l=0;l<c.length;++l)f=Uo(r,c[l]),r.fill&&zv(e,r,i)&&e.fillText(f,a,o),r.stroke&&Md(e,r,i)&&e.strokeText(f,a,o),o+=u;else f=Uo(r,c),r.fill&&zv(e,r,i)&&e.fillText(f,a,o),r.stroke&&Md(e,r,i)&&e.strokeText(f,a,o);r.angle&&e.restore()}})}function die(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=q2(t),o=a.x1,l=a.y1,u=j9(Jg,t,1),c=-t.angle*zo,f=Math.cos(c),d=Math.sin(c),h=f*i-d*s+(o-f*o+d*l),p=d*i+f*s+(l-d*o-f*l);return u.contains(h,p)}function hie(e,t){const n=j9(Jg,e,2);return Zf(t,n[0],n[1],n[2],n[3])||Zf(t,n[0],n[1],n[4],n[5])||Zf(t,n[4],n[5],n[6],n[7])||Zf(t,n[2],n[3],n[6],n[7])}var pie={type:"text",tag:"text",nested:!1,attr:cie,bound:j9,draw:fie,pick:z2(die),isect:hie},gie=R9("trail",hre,$re),Ar={arc:kre,area:Cre,group:Ure,image:Wre,line:Hre,path:Yre,rect:Zre,rule:rie,shape:iie,symbol:sie,text:pie,trail:gie};function QA(e,t,n){var r=Ar[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new mt),e,n)}var OD={mark:null};function lj(e,t,n){var r=Ar[e.marktype],i=r.bound,s=e.items,a=s&&s.length,o,l,u,c;if(r.nested)return a?u=s[0]:(OD.mark=e,u=OD),c=QA(u,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new mt,a)for(o=0,l=s.length;o<l;++o)t.union(QA(s[o],i,n));return e.bounds=t}const mie=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function uj(e,t){return JSON.stringify(e,mie,t)}function cj(e){const t=typeof e=="string"?JSON.parse(e):e;return fj(t)}function fj(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&fj(n[i]);return t&&lj(e),e}function q9(e){arguments.length?this.root=cj(e):(this.root=dj({marktype:"group",name:"root",role:"frame"}),this.root.items=[new I2(this.root)])}q9.prototype={toJSON(e){return uj(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=dj(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function dj(e,t){const n={bounds:new mt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function xo(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function G9(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Hn(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=xo(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function _i(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function hj(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function G2(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function yie(e,t,n,r){var i=e&&e.mark,s,a;if(i&&(s=Ar[i.marktype]).tip){for(a=G2(t,n),a[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=s.tip(i.items,a)}return e}function jo(e,t){this._active=null,this._handlers={},this._loader=e||u2(),this._tooltip=t||vie}function vie(e,t,n,r){e.element().setAttribute("title",r||"")}jo.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=xo(null,"a");for(const a in r)s.setAttribute(a,r[a]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=yie(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),a=i.height();let o=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)o+=e.x||0,l+=e.y||0;return{x:o,y:l,width:s,height:a,left:o,top:l,right:o+s,bottom:l+a}}};function Cs(e){this._el=null,this._bgcolor=null,this._loader=new $9(e)}Cs.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const bie="keydown",xie="keypress",wie="keyup",pj="dragenter",ev="dragleave",gj="dragover",e4="mousedown",_ie="mouseup",Uv="mousemove",Yg="mouseout",mj="mouseover",jv="click",Eie="dblclick",kie="wheel",yj="mousewheel",qv="touchstart",Gv="touchmove",Wv="touchend",Sie=[bie,xie,wie,pj,ev,gj,e4,_ie,Uv,Yg,mj,jv,Eie,kie,yj,qv,Gv,Wv],t4=Uv,w0=Yg,n4=jv;function cm(e,t){jo.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const Aie=e=>e===qv||e===Gv||e===Wv?[qv,Gv,Wv]:[e];function RD(e,t){Aie(t).forEach(n=>$ie(e,n))}function $ie(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function PD(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function ID(e){return function(t){this.fire(e,t),this._active=null}}ne(cm,jo,{initialize(e,t,n){return this._canvas=e&&G9(e,"canvas"),[jv,e4,Uv,Yg,ev].forEach(r=>RD(this,r)),jo.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Sie,DOMMouseScroll(e){this.fire(yj,e)},mousemove:PD(Uv,mj,Yg),dragover:PD(gj,pj,ev),mouseout:ID(Yg),dragleave:ID(ev),mousedown(e){this._down=this._active,this.fire(e4,e)},click(e){this._down===this._active&&(this.fire(jv,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(qv,e,!0)},touchmove(e){this.fire(Gv,e,!0)},touchend(e){this.fire(Wv,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===n4&&r&&r.href?this.handleHref(t,r,r.href):(e===t4||e===w0)&&this.handleTooltip(t,r,e!==w0),i)for(let s=0,a=i.length;s<a;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(RD(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=G2(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return Ar[e.marktype].pick.call(this,s,e,t,n,r,i)}});function Cie(){return typeof window<"u"&&window.devicePixelRatio||1}var Mie=Cie();function Tie(e,t,n,r,i,s){const a=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,o=e.getContext("2d"),l=a?Mie:i;e.width=t*l,e.height=n*l;for(const u in s)o[u]=s[u];return a&&l!==1&&(e.style.width=t+"px",e.style.height=n+"px"),o.pixelRatio=l,o.setTransform(l,0,0,l,l*r[0],l*r[1]),e}function Hv(e){Cs.call(this,e),this._options={},this._redraw=!1,this._dirty=new mt,this._tempb=new mt}const LD=Cs.prototype,Nie=(e,t,n)=>new mt().set(0,0,t,n).translate(-e[0],-e[1]);function Fie(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}ne(Hv,Cs,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:No(1,1,this._options.type),e&&this._canvas&&(_i(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),LD.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(LD.resize.call(this,e,t,n,r),this._canvas)Tie(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||H("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,a=Nie(n,r,i);t.save();const o=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):Fie(t,a.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,o),t.restore(),s.clear(),this},draw(e,t,n){const r=Ar[t.marktype];t.clip&&Mre(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function W9(e,t){jo.call(this,e,t);const n=this;n._hrefHandler=r4(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=r4(n,(r,i)=>{n.handleTooltip(r,i,r.type!==w0)})}const r4=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};ne(W9,jo,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(n4,this._hrefHandler),r.removeEventListener(t4,this._tooltipHandler),r.removeEventListener(w0,this._tooltipHandler)),this._svg=r=e&&G9(e,"svg"),r&&(r.addEventListener(n4,this._hrefHandler),r.addEventListener(t4,this._tooltipHandler),r.addEventListener(w0,this._tooltipHandler)),jo.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:r4(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const vj="aria-hidden",H9="aria-label",V9="role",J9="aria-roledescription",bj="graphics-object",Y9="graphics-symbol",xj=(e,t,n)=>({[V9]:e,[J9]:t,[H9]:n||void 0}),Die=Di(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),zD={axis:{desc:"axis",caption:Pie},legend:{desc:"legend",caption:Iie},"title-text":{desc:"title",caption:e=>`Title text '${UD(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${UD(e)}'`}},BD={ariaRole:V9,ariaRoleDescription:J9,description:H9};function wj(e,t){const n=t.aria===!1;if(e(vj,n||void 0),n||t.description==null)for(const r in BD)e(BD[r],void 0);else{const r=t.mark.marktype;e(H9,t.description),e(V9,t.ariaRole||(r==="group"?bj:Y9)),e(J9,t.ariaRoleDescription||`${r} mark`)}}function _j(e){return e.aria===!1?{[vj]:!0}:Die[e.role]?null:zD[e.role]?Rie(e,zD[e.role]):Oie(e)}function Oie(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return xj(n?bj:Y9,`${t} mark container`,e.description)}function Rie(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return xj(t.role||Y9,t.desc,n.description||r(n))}catch{return null}}function UD(e){return le(e.text).join(" ")}function Pie(e){const t=e.datum,n=e.orient,r=t.title?Ej(e):null,i=e.context,s=i.scales[t.scale].value,a=i.dataflow.locale(),o=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Ad(o)?"discrete":o} scale with ${BU(a,s,e)}`}function Iie(e){const t=e.datum,n=t.title?Ej(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),a=e.context,o=a.scales[i[s[0]]].value,l=a.dataflow.locale();return zie(r)+(n?` titled '${n}'`:"")+` for ${Lie(s)} with ${BU(l,o,e)}`}function Ej(e){try{return le(Oe(e.items).items[0].text).join(" ")}catch{return null}}function Lie(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Oe(e)}function zie(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const kj=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Bie=e=>kj(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function X9(){let e="",t="",n="";const r=[],i=()=>t=n="",s=l=>{t&&(e+=`${t}>${n}`,i()),r.push(l)},a=(l,u)=>(u!=null&&(t+=` ${l}="${Bie(u)}"`),o),o={open(l){s(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)a(h,d[h]);return o},close(){const l=r.pop();return t?e+=t+(n?`>${n}</${l}>`:"/>"):e+=`</${l}>`,i(),o},attr:a,text:l=>(n+=kj(l),o),toString:()=>e};return o}const Sj=e=>Aj(X9(),e)+"";function Aj(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const r of n)r.nodeType===3?e.text(r.nodeValue):Aj(e,r)}return e.close()}const Vv={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Jv={blend:"mix-blend-mode"},$j={fill:"none","stroke-miterlimit":10},lg=0,jD="http://www.w3.org/2000/xmlns/",_t=x0.xmlns;function K9(e){Cs.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const m5=Cs.prototype;ne(K9,Cs,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=Hn(e,0,"svg",_t),this._svg.setAttributeNS(jD,"xmlns",_t),this._svg.setAttributeNS(jD,"xmlns:xlink",x0["xmlns:xlink"]),this._svg.setAttribute("version",x0.version),this._svg.setAttribute("class","marks"),_i(e,1),this._root=Hn(this._svg,lg,"g",_t),wo(this._root,$j),_i(this._svg,lg+1)),this.background(this._bgcolor),m5.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),m5.background.apply(this,arguments)},resize(e,t,n,r){return m5.resize.call(this,e,t,n,r),this._svg&&(wo(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Hn(e,lg,"rect",_t),wo(n,{width:this._width,height:this._height,fill:t}));const r=Sj(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),_i(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,a,o,l;for(a=0,o=e.length;a<o;++a)if(n=e[a],r=n.mark,r.marktype!==i&&(i=r.marktype,s=Ar[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,qD(n,t),r.items.forEach(u=>{u.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,qD(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Ar[t.marktype],s=t.interactive===!1?"none":null,a=i.tag==="g",o=GD(t,e,n,"g",r);o.setAttribute("class",hj(t));const l=_j(t);for(const d in l)kn(o,d,l[d]);a||kn(o,"pointer-events",s),kn(o,"clip-path",t.clip?A9(this,t,t.group):null);let u=null,c=0;const f=d=>{const h=this.isDirty(d),p=GD(d,o,u,i.tag,r);h&&(this._update(i,p,d),a&&qie(this,p,d)),u=p,++c};return i.nested?t.items.length&&f(t.items[0]):Ri(t,f),_i(o,c),o},_update(e,t,n){pa=t,Qt=t.__values__,wj(Xg,n),e.attr(Xg,n,this);const r=Wie[e.type];r&&r.call(this,e,t,n),pa&&this.style(pa,n)},style(e,t){if(t!=null){for(const n in Vv){let r=n==="font"?um(t):t[n];if(r===Qt[n])continue;const i=Vv[n];r==null?e.removeAttribute(i):(E9(r)&&(r=jU(r,this._defs.gradient,Cj())),e.setAttribute(i,r+"")),Qt[n]=r}for(const n in Jv)tv(e,Jv[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=Hn(e,lg+1,"defs",_t)),r=Uie(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=Hn(e,lg+1,"defs",_t)),r=jie(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):_i(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function qD(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function Uie(e,t,n){let r,i,s;if(t.gradient==="radial"){let a=Hn(e,n++,"pattern",_t);wo(a,{id:Lv+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Hn(a,0,"rect",_t),wo(a,{width:1,height:1,fill:`url(${Cj()}#${t.id})`}),e=Hn(e,n++,"radialGradient",_t),wo(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Hn(e,n++,"linearGradient",_t),wo(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=Hn(e,r,"stop",_t),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return _i(e,r),n}function jie(e,t,n){let r;return e=Hn(e,n,"clipPath",_t),e.setAttribute("id",t.id),t.path?(r=Hn(e,0,"path",_t),r.setAttribute("d",t.path)):(r=Hn(e,0,"rect",_t),wo(r,{x:0,y:0,width:t.width,height:t.height})),_i(e,1),n+1}function qie(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Ri(n,s=>{r=e.mark(t,s,r),++i}),_i(t,1+i)}function GD(e,t,n,r,i){let s=e._svg,a;if(!s&&(a=t.ownerDocument,s=xo(a,r,_t),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const o=xo(a,"path",_t);s.appendChild(o),o.__data__=e;const l=xo(a,"g",_t);s.appendChild(l),l.__data__=e;const u=xo(a,"path",_t);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==i||Gie(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function Gie(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let pa=null,Qt=null;const Wie={group(e,t,n){const r=pa=t.childNodes[2];Qt=r.__values__,e.foreground(Xg,n,this),Qt=t.__values__,pa=t.childNodes[1],e.content(Xg,n,this);const i=pa=t.childNodes[0];e.background(Xg,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Qt.events&&(kn(r,"pointer-events",s),kn(i,"pointer-events",s),Qt.events=s),n.strokeForeground&&n.stroke){const a=n.fill;kn(r,"display",null),this.style(i,n),kn(i,"stroke",null),a&&(n.fill=null),Qt=r.__values__,this.style(r,n),a&&(n.fill=a),pa=null}else kn(r,"display","none")},image(e,t,n){n.smooth===!1?(tv(t,"image-rendering","optimizeSpeed"),tv(t,"image-rendering","pixelated")):tv(t,"image-rendering",null)},text(e,t,n){const r=lm(n);let i,s,a,o;Y(r)?(s=r.map(l=>Uo(n,l)),i=s.join(`
`),i!==Qt.text&&(_i(t,0),a=t.ownerDocument,o=Bo(n),s.forEach((l,u)=>{const c=xo(a,"tspan",_t);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",o)),t.appendChild(c)}),Qt.text=i)):(s=Uo(n,r),s!==Qt.text&&(t.textContent=s,Qt.text=s)),kn(t,"font-family",um(n)),kn(t,"font-size",$s(n)+"px"),kn(t,"font-style",n.fontStyle),kn(t,"font-variant",n.fontVariant),kn(t,"font-weight",n.fontWeight)}};function Xg(e,t,n){t!==Qt[e]&&(n?Hie(pa,e,t,n):kn(pa,e,t),Qt[e]=t)}function tv(e,t,n){n!==Qt[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Qt[t]=n)}function wo(e,t){for(const n in t)kn(e,n,t[n])}function kn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Hie(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Cj(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Z9(e){Cs.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}ne(Z9,Cs,{svg(){return this._text},_render(e){const t=X9();t.open("svg",Ae({},x0,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",$j,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Ar[t.marktype],r=n.tag,i=[wj,n.attr];e.open("g",{class:hj(t),"clip-path":t.clip?A9(this,t,t.group):null},_j(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=a=>{const o=this.href(a);if(o&&e.open("a",o),e.open(r,this.attr(t,a,i,r!=="g"?r:null)),r==="text"){const l=lm(a);if(Y(l)){const u={x:0,dy:Bo(a)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(Uo(a,l[c])).close()}else e.text(Uo(a,l))}else if(r==="g"){const l=a.strokeForeground,u=a.fill,c=a.stroke;l&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),Ri(a,f=>this.mark(e,f)),e.close(),l&&c?(u&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),u&&(a.fill=u)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),o&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Ri(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(a,o,l,u)=>{i[u||a]=o};return Array.isArray(n)?n.forEach(a=>a(s,t,this)):n(s,t,this),r&&Vie(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],a=s.stops;s.gradient==="radial"?(e.open("pattern",{id:Lv+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let o=0;o<a.length;++o)e.open("stop",{offset:a[o].offset,"stop-color":a[o].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function Vie(e,t,n,r,i){let s;if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),r==="text"&&(e["font-family"]=um(t),e["font-size"]=$s(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in Vv){let o=t[a];const l=Vv[a];o==="transparent"&&(l==="fill"||l==="stroke")||o!=null&&(E9(o)&&(o=jU(o,i.gradient,"")),e[l]=o)}for(const a in Jv){const o=t[a];o!=null&&(s=s||[],s.push(`${Jv[a]}: ${o};`))}return s&&(e.style=s.join(" ")),e}const Mj="canvas",Tj="png",Nj="svg",Fj="none",_o={Canvas:Mj,PNG:Tj,SVG:Nj,None:Fj},Td={};Td[Mj]=Td[Tj]={renderer:Hv,headless:Hv,handler:cm};Td[Nj]={renderer:K9,headless:Z9,handler:W9};Td[Fj]={};function W2(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Td[e]=t,this):Td[e]}function Dj(e,t,n){const r=[],i=new mt().union(t),s=e.marktype;return s?Oj(e,i,n,r):s==="group"?Rj(e,i,n,r):H("Intersect scene must be mark node or group item.")}function Oj(e,t,n,r){if(Jie(e,t,n)){const i=e.items,s=e.marktype,a=i.length;let o=0;if(s==="group")for(;o<a;++o)Rj(i[o],t,n,r);else for(const l=Ar[s].isect;o<a;++o){const u=i[o];Pj(u,t,l)&&r.push(u)}}return r}function Jie(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Rj(e,t,n,r){n&&n(e.mark)&&Pj(e,t,Ar.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const a=e.x||0,o=e.y||0;t.translate(-a,-o);for(let l=0;l<s;++l)Oj(i[l],t,n,r);t.translate(a,o)}return r}function Pj(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const y5=new mt;function Ij(e){const t=e.clip;if($e(t))t(am(y5.clear()));else if(t)y5.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(y5)}const Yie=1e-9;function Q9(e,t,n){return e===t?!0:n==="path"?Lj(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ye(e)&&Ye(t)?Math.abs(e-t)<=Yie:!e||!t||!ce(e)&&!ce(t)?e==t:Xie(e,t)}function Lj(e,t){return Q9($d(e),$d(t))}function Xie(e,t){var n=Object.keys(e),r=Object.keys(t),i,s;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--)if(i=n[s],!Q9(e[i],t[i],i))return!1;return typeof e==typeof t}function Kie(){YU(),_ne()}const Nd="top",Ei="left",Si="right",qo="bottom",Zie="top-left",Qie="top-right",ese="bottom-left",tse="bottom-right",e8="start",i4="middle",Sn="end",nse="x",rse="y",H2="group",t8="axis",n8="title",ise="frame",sse="scope",r8="legend",zj="row-header",Bj="row-footer",Uj="row-title",jj="column-header",qj="column-footer",Gj="column-title",ase="padding",ose="symbol",Wj="fit",Hj="fit-x",Vj="fit-y",lse="pad",i8="none",py="all",s4="each",s8="flush",Eo="column",ko="row";function Jj(e){G.call(this,null,e)}ne(Jj,G,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,s=Ar[i],a=s.bound;let o=r.bounds,l;if(s.nested)r.items.length&&n.dirty(r.items[0]),o=gy(r,a),r.items.forEach(u=>{u.bounds.clear().union(o)});else if(i===H2||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),o.clear(),r.items.forEach(u=>o.union(gy(u,a))),r.role){case t8:case r8:case n8:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{o.union(gy(u,a))}),t.visit(t.MOD,u=>{l=l||o.alignsWith(u.bounds),n.dirty(u),o.union(gy(u,a))}),l&&(o.clear(),r.items.forEach(u=>o.union(u.bounds)));return Ij(r),t.modifies("bounds")}});function gy(e,t,n){return t(e.bounds.clear(),e,n)}const WD=":vega_identifier:";function a8(e){G.call(this,0,e)}a8.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};ne(a8,G,{transform(e,t){const n=use(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,s=>s[r]=s[r]||++i),n.set(this.value=i),t}});function use(e){return e._signals[WD]||(e._signals[WD]=e.add(0))}function Yj(e){G.call(this,null,e)}ne(Yj,G,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,cse(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===H2?I2:P2;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function cse(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Xj(e){G.call(this,null,e)}const HD={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!Kj(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},Kj=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),VD=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,s;n<r;i=s,++n)if(Kj(i,s=e[n].bounds,t))return!0},fse=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},dse=(e,t,n)=>{var r=e.range(),i=new mt;return t===Nd||t===qo?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),s=>i.encloses(s.bounds)},JD=e=>(e.forEach(t=>t.opacity=1),e),YD=(e,t)=>e.reflow(t.modified()).modifies("opacity");ne(Xj,G,{transform(e,t){const n=HD[e.method]||HD.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,s,a;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(JD(i),t=YD(t,e)),t;if(i=i.filter(fse),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),s=JD(i),t=YD(t,e),s.length>=3&&VD(s,r)){do s=n(s,r);while(s.length>=3&&VD(s,r));s.length<3&&!Oe(i).opacity&&(s.length>1&&(Oe(s).opacity=0),Oe(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=dse(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(l=>{a(l)||(l.opacity=0)}));const o=s[0].mark.bounds.clear();return i.forEach(l=>{l.opacity&&o.union(l.bounds)}),t}});function Zj(e){G.call(this,null,e)}ne(Zj,G,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const Zt=new mt;function Qf(e,t,n){return e[t]===n?0:(e[t]=n,1)}function hse(e){var t=e.items[0].orient;return t===Ei||t===Si}function pse(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function gse(e,t,n,r){var i=t.items[0],s=i.datum,a=i.translate!=null?i.translate:.5,o=i.orient,l=pse(s),u=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=s.title&&i.items[l[2]].items[0],g=i.titlePadding,m=i.bounds,y=p&&B9(p),v=0,x=0,_,w;switch(Zt.clear().union(m),m.clear(),(_=l[0])>-1&&m.union(i.items[_].bounds),(_=l[1])>-1&&m.union(i.items[_].bounds),o){case Nd:v=f||0,x=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(u,0),p&&my(e,p,w,g,y,0,-1,m);break;case Ei:v=-c,x=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,u),p&&my(e,p,w,g,y,1,-1,m);break;case Si:v=n+c,x=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,u),p&&my(e,p,w,g,y,1,1,m);break;case qo:v=f||0,x=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(u,w),p&&my(e,p,w,g,0,0,1,m);break;default:v=i.x,x=i.y}return Ma(m.translate(v,x),i),Qf(i,"x",v+a)|Qf(i,"y",x+a)&&(i.bounds=Zt,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function my(e,t,n,r,i,s,a,o){const l=t.bounds;if(t.auto){const u=a*(n+i+r);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}o.union(l)}const XD=(e,t)=>Math.floor(Math.min(e,t)),KD=(e,t)=>Math.ceil(Math.max(e,t));function mse(e){var t=e.items,n=t.length,r=0,i,s;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],s=i.items,i.marktype===H2)switch(i.role){case t8:case r8:case n8:break;case zj:a.rowheaders.push(...s);break;case Bj:a.rowfooters.push(...s);break;case jj:a.colheaders.push(...s);break;case qj:a.colfooters.push(...s);break;case Uj:a.rowtitle=s[0];break;case Gj:a.coltitle=s[0];break;default:a.marks.push(...s)}return a}function yse(e){return new mt().set(0,0,e.width||0,e.height||0)}function vse(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function it(e,t,n){const r=ce(e)?e[t]:e;return r??(n!==void 0?n:0)}function ZD(e){return e<0?Math.ceil(-e):0}function Qj(e,t,n){var r=!n.nodirty,i=n.bounds===s8?yse:vse,s=Zt.set(0,0,0,0),a=it(n.align,Eo),o=it(n.align,ko),l=it(n.padding,Eo),u=it(n.padding,ko),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),y=Array(f),v=0,x=Array(d),_=Array(d),w=Array(d),k,E,A,z,D,R,j,O,L,P,B;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)y[E]=0;for(E=0;E<d;++E)R=t[E],D=w[E]=i(R),R.x=R.x||0,x[E]=0,R.y=R.y||0,_[E]=0,A=E%c,z=~~(E/c),g=Math.max(g,j=Math.ceil(D.x2)),v=Math.max(v,O=Math.ceil(D.y2)),p[A]=Math.max(p[A],j),y[z]=Math.max(y[z],O),h[E]=l+ZD(D.x1),m[E]=u+ZD(D.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(m[E]=0);if(a===s4)for(A=1;A<c;++A){for(B=0,E=A;E<d;E+=c)B<h[E]&&(B=h[E]);for(E=A;E<d;E+=c)h[E]=B+p[A-1]}else if(a===py){for(B=0,E=0;E<d;++E)E%c&&B<h[E]&&(B=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=B+g)}else for(a=!1,A=1;A<c;++A)for(E=A;E<d;E+=c)h[E]+=p[A-1];if(o===s4)for(z=1;z<f;++z){for(B=0,E=z*c,k=E+c;E<k;++E)B<m[E]&&(B=m[E]);for(E=z*c;E<k;++E)m[E]=B+y[z-1]}else if(o===py){for(B=0,E=c;E<d;++E)B<m[E]&&(B=m[E]);for(E=c;E<d;++E)m[E]=B+v}else for(o=!1,z=1;z<f;++z)for(E=z*c,k=E+c;E<k;++E)m[E]+=y[z-1];for(L=0,E=0;E<d;++E)L=h[E]+(E%c?L:0),x[E]+=L-t[E].x;for(A=0;A<c;++A)for(P=0,E=A;E<d;E+=c)P+=m[E],_[E]+=P-t[E].y;if(a&&it(n.center,Eo)&&f>1)for(E=0;E<d;++E)D=a===py?g:p[E%c],L=D-w[E].x2-t[E].x-x[E],L>0&&(x[E]+=L/2);if(o&&it(n.center,ko)&&c!==1)for(E=0;E<d;++E)D=o===py?v:y[~~(E/c)],P=D-w[E].y2-t[E].y-_[E],P>0&&(_[E]+=P/2);for(E=0;E<d;++E)s.union(w[E].translate(x[E],_[E]));switch(L=it(n.anchor,nse),P=it(n.anchor,rse),it(n.anchor,Eo)){case Sn:L-=s.width();break;case i4:L-=s.width()/2}switch(it(n.anchor,ko)){case Sn:P-=s.height();break;case i4:P-=s.height()/2}for(L=Math.round(L),P=Math.round(P),s.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)R=t[E],R.x+=x[E]+=L,R.y+=_[E]+=P,s.union(R.mark.bounds.union(R.bounds.translate(x[E],_[E]))),r&&e.dirty(R);return s}function bse(e,t,n){var r=mse(t),i=r.marks,s=n.bounds===s8?xse:wse,a=n.offset,o=n.columns||i.length,l=o<=0?1:Math.ceil(i.length/o),u=l*o,c,f,d,h,p,g,m;const y=Qj(e,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(g=it(n.headerBand,ko,null),c=yy(e,r.rowheaders,i,o,l,-it(a,"rowHeader"),XD,0,s,"x1",0,o,1,g)),r.colheaders&&(g=it(n.headerBand,Eo,null),f=yy(e,r.colheaders,i,o,o,-it(a,"columnHeader"),XD,1,s,"y1",0,1,o,g)),r.rowfooters&&(g=it(n.footerBand,ko,null),d=yy(e,r.rowfooters,i,o,l,it(a,"rowFooter"),KD,0,s,"x2",o-1,o,1,g)),r.colfooters&&(g=it(n.footerBand,Eo,null),h=yy(e,r.colfooters,i,o,o,it(a,"columnFooter"),KD,1,s,"y2",u-o,1,o,g)),r.rowtitle&&(p=it(n.titleAnchor,ko),m=it(a,"rowTitle"),m=p===Sn?d+m:c-m,g=it(n.titleBand,ko,.5),QD(e,r.rowtitle,m,0,y,g)),r.coltitle&&(p=it(n.titleAnchor,Eo),m=it(a,"columnTitle"),m=p===Sn?h+m:f-m,g=it(n.titleBand,Eo,.5),QD(e,r.coltitle,m,1,y,g))}function xse(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function wse(e,t){return e.bounds[t]}function yy(e,t,n,r,i,s,a,o,l,u,c,f,d,h){var p=n.length,g=0,m=0,y,v,x,_,w,k,E,A,z;if(!p)return g;for(y=c;y<p;y+=f)n[y]&&(g=a(g,l(n[y],u)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=s,v=0,_=t.length;v<_;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,_=t.length;v<_;++v,y+=f){for(k=t[v],w=k.mark.bounds,x=y;x>=0&&(E=n[x])==null;x-=d);o?(A=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),z=g):(A=g,z=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),w.union(k.bounds.translate(A-(k.x||0),z-(k.y||0))),k.x=A,k.y=z,e.dirty(k),m=a(m,w[u])}return m}function QD(e,t,n,r,i,s){if(t){e.dirty(t);var a=n,o=n;r?a=Math.round(i.x1+s*i.width()):o=Math.round(i.y1+s*i.height()),t.bounds.translate(a-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=o,e.dirty(t)}}function _se(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Ese(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function kse(e,t,n,r,i,s,a){const o=_se(n,t),l=Ese(e,o("offset",0)),u=o("anchor",e8),c=u===Sn?1:u===i4?.5:0,f={align:s4,bounds:o("bounds",s8),columns:o("direction")==="vertical"?1:e.length,padding:o("margin",8),center:o("center"),nodirty:!0};switch(t){case Ei:f.anchor={x:Math.floor(r.x1)-l,column:Sn,y:c*(a||r.height()+2*r.y1),row:u};break;case Si:f.anchor={x:Math.ceil(r.x2)+l,y:c*(a||r.height()+2*r.y1),row:u};break;case Nd:f.anchor={y:Math.floor(i.y1)-l,row:Sn,x:c*(s||i.width()+2*i.x1),column:u};break;case qo:f.anchor={y:Math.ceil(i.y2)+l,x:c*(s||i.width()+2*i.x1),column:u};break;case Zie:f.anchor={x:l,y:l};break;case Qie:f.anchor={x:s-l,y:l,column:Sn};break;case ese:f.anchor={x:l,y:a-l,row:Sn};break;case tse:f.anchor={x:s-l,y:a-l,column:Sn,row:Sn};break}return f}function Sse(e,t){var n=t.items[0],r=n.datum,i=n.orient,s=n.bounds,a=n.x,o=n.y,l,u;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),$se(e,n,n.items[0].items[0]),s=Ase(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),r.type===ose&&Cse(n.items[0].items[0].items[0].items),i!==i8&&(n.x=a=0,n.y=o=0),n.width=l,n.height=u,Ma(s.set(a,o,a+l,o+u),n),n.mark.bounds.clear().union(s),n}function Ase(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function $se(e,t,n){var r=t.padding,i=r-n.x,s=r-n.y;if(!t.datum.title)(i||s)&&ug(e,n,i,s);else{var a=t.items[1].items[0],o=a.anchor,l=t.titlePadding||0,u=r-a.x,c=r-a.y;switch(a.orient){case Ei:i+=Math.ceil(a.bounds.width())+l;break;case Si:case qo:break;default:s+=a.bounds.height()+l}switch((i||s)&&ug(e,n,i,s),a.orient){case Ei:c+=If(t,n,a,o,1,1);break;case Si:u+=If(t,n,a,Sn,0,0)+l,c+=If(t,n,a,o,1,1);break;case qo:u+=If(t,n,a,o,0,0),c+=If(t,n,a,Sn,-1,0,1)+l;break;default:u+=If(t,n,a,o,0,0)}(u||c)&&ug(e,a,u,c),(u=Math.round(a.bounds.x1-r))<0&&(ug(e,n,-u,0),ug(e,a,-u,0))}}function If(e,t,n,r,i,s,a){const o=e.datum.type!=="symbol",l=n.datum.vgrad,u=o&&(s||!l)&&!a?t.items[0]:t,c=u.bounds[i?"y2":"x2"]-e.padding,f=l&&s?c:0,d=l&&s?0:c,h=i<=0?0:B9(n);return Math.round(r===e8?f:r===Sn?d-h:.5*(c-h))}function ug(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Cse(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Mse(e,t,n,r,i){var s=t.items[0],a=s.frame,o=s.orient,l=s.anchor,u=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=o===Ei||o===Si?r:n,p=0,g=0,m=0,y=0,v=0,x;if(a!==H2?o===Ei?(p=i.y2,h=i.y1):o===Si?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):o===Ei&&(p=r,h=0),x=l===e8?p:l===Sn?h:(p+h)/2,d&&d.text){switch(o){case Nd:case qo:v=f.bounds.height()+c;break;case Ei:y=f.bounds.width()+c;break;case Si:y=-f.bounds.width()-c;break}Zt.clear().union(d.bounds),Zt.translate(y-(d.x||0),v-(d.y||0)),Qf(d,"x",y)|Qf(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(Zt),d.mark.bounds.clear().union(Zt),e.dirty(d)),Zt.clear().union(d.bounds)}else Zt.clear();switch(Zt.union(f.bounds),o){case Nd:g=x,m=i.y1-Zt.height()-u;break;case Ei:g=i.x1-Zt.width()-u,m=x;break;case Si:g=i.x2+Zt.width()+u,m=x;break;case qo:g=x,m=i.y2+u;break;default:g=s.x,m=s.y}return Qf(s,"x",g)|Qf(s,"y",m)&&(Zt.translate(g,m),e.dirty(s),s.bounds.clear().union(Zt),t.bounds.clear().union(Zt),e.dirty(s)),s.bounds}function eq(e){G.call(this,null,e)}ne(eq,G,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&bse(n,r,e.layout),Nse(n,r,e)}),Tse(e.mark.group)?t.reflow():t}});function Tse(e){return e&&e.mark.role!=="legend-entry"}function Nse(e,t,n){var r=t.items,i=Math.max(0,t.width||0),s=Math.max(0,t.height||0),a=new mt().set(0,0,i,s),o=a.clone(),l=a.clone(),u=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case t8:h=hse(f)?o:l,h.union(gse(e,f,i,s));break;case n8:c=f;break;case r8:u.push(Sse(e,f));break;case ise:case sse:case zj:case Bj:case Uj:case jj:case qj:case Gj:o.union(f.bounds),l.union(f.bounds);break;default:a.union(f.bounds)}if(u.length){const m={};u.forEach(y=>{d=y.orient||Si,d!==i8&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];Qj(e,v,kse(v,y,n.legends,o,l,i,s))}u.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&(n.autosize.type===Wj||n.autosize.type===Hj||n.autosize.type===Vj))switch(y.orient){case Ei:case Si:a.add(v.x1,0).add(v.x2,0);break;case Nd:case qo:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(o).union(l),c&&a.union(Mse(e,c,i,s,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),Fse(e,t,a,n)}function Fse(e,t,n,r){const i=r.autosize||{},s=i.type;if(e._autosize<1||!s)return;let a=e._width,o=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===ase){const p=e.padding();a-=p.left+p.right,o-=p.top+p.bottom}s===i8?(u=0,f=0,l=a,c=o):s===Wj?(l=Math.max(0,a-u-d),c=Math.max(0,o-f-h)):s===Hj?(l=Math.max(0,a-u-d),o=c+f+h):s===Vj?(a=l+u+d,c=Math.max(0,o-f-h)):s===lse&&(a=l+u+d,o=c+f+h),e._resizeView(a,o,l,c,[u,f],i.resize)}const Dse=Object.freeze(Object.defineProperty({__proto__:null,bound:Jj,identifier:a8,mark:Yj,overlap:Xj,render:Zj,viewlayout:eq},Symbol.toStringTag,{value:"Module"}));function tq(e){G.call(this,null,e)}ne(tq,G,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,o=w9(s,a,e.minstep),l=e.format||RU(n,s,o,e.formatSpecifier,e.formatType,!!e.values),u=e.values?OU(s,e.values,o):_9(s,o);return i&&(r.rem=i),i=u.map((c,f)=>Ue({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&i.length&&i.push(Ue({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function nq(e){G.call(this,null,e)}function Ose(){return Ue({})}function Rse(e){const t=Zd().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}ne(nq,G,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Ose,s=e.key||me,a=this.value;return Y(r.encode)&&(r.encode=null),a&&(e.modified("key")||t.modified(s))&&H("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=Rse(s)),t.visit(t.ADD,o=>{const l=s(o);let u=a.get(l);u?u.exit?(a.empty--,r.add.push(u)):r.mod.push(u):(u=i(o),a.set(l,u),r.add.push(u)),u.datum=o,u.exit=!1}),t.visit(t.MOD,o=>{const l=s(o),u=a.get(l);u&&(u.datum=o,r.mod.push(u))}),t.visit(t.REM,o=>{const l=s(o),u=a.get(l);o===u.datum&&!u.exit&&(r.rem.push(u),u.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}});function rq(e){G.call(this,null,e)}ne(rq,G,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,s=t.encode;if(Y(s))if(n.changed()||s.every(f=>i[f]))s=s[0],n.encode=null;else return t.StopPropagation;var a=s==="enter",o=i.update||lo,l=i.enter||lo,u=i.exit||lo,c=(s&&!a?i[s]:o)||lo;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),o(f,e)}),n.modifies(l.output),n.modifies(o.output),c!==lo&&c!==o&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==lo&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),a||c!==lo){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=l(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(l.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function iq(e){G.call(this,[],e)}ne(iq,G,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.type||Jy,a=e.scale,o=+e.limit,l=w9(a,e.count==null?5:e.count,e.minstep),u=!!e.values||s===Jy,c=e.format||zU(n,a,l,s,e.formatSpecifier,e.formatType,u),f=e.values||LU(a,l),d,h,p,g,m;return i&&(r.rem=i),s===Jy?(o&&f.length>o?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,o-1),m=!0):i=f,$e(p=e.size)?(!e.values&&a(i[0])===0&&(i=i.slice(1)),g=i.reduce((y,v)=>Math.max(y,p(v,e)),0)):p=cn(g=p||8),i=i.map((y,v)=>Ue({index:v,label:c(y,v,i),value:y,offset:g,size:p(y,e)})),m&&(m=f[i.length],i.push(Ue({index:i.length,label:`…${f.length-i.length} entries`,value:m,offset:g,size:p(m,e)})))):s===une?(d=a.domain(),h=NU(a,d[0],Oe(d)),f.length<3&&!e.values&&d[0]!==Oe(d)&&(f=[d[0],Oe(d)]),i=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(p=f.length-1,h=xne(a),i=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const Pse=e=>e.source.x,Ise=e=>e.source.y,Lse=e=>e.target.x,zse=e=>e.target.y;function o8(e){G.call(this,{},e)}o8.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};ne(o8,G,{transform(e,t){var n=e.sourceX||Pse,r=e.sourceY||Ise,i=e.targetX||Lse,s=e.targetY||zse,a=e.as||"path",o=e.orient||"vertical",l=e.shape||"line",u=eO.get(l+"-"+o)||eO.get(l);return u||H("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=u(n(c),r(c),i(c),s(c))}),t.reflow(e.modified()).modifies(a)}});const sq=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Bse=(e,t,n,r)=>sq(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),aq=(e,t,n,r)=>{var i=n-e,s=r-t,a=Math.hypot(i,s)/2,o=180*Math.atan2(s,i)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+o+" 0 1 "+n+","+r},Use=(e,t,n,r)=>aq(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),oq=(e,t,n,r)=>{const i=n-e,s=r-t,a=.2*(i+s),o=.2*(s-i);return"M"+e+","+t+"C"+(e+a)+","+(t+o)+" "+(n+o)+","+(r-a)+" "+n+","+r},jse=(e,t,n,r)=>oq(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),qse=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Gse=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Wse=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*s+"A"+t+","+t+" 0 0,"+(l?1:0)+" "+t*a+","+t*o+"L"+r*a+","+r*o},Hse=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Vse=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Jse=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),a=Math.cos(n),o=Math.sin(n),l=(t+r)/2;return"M"+t*i+","+t*s+"C"+l*i+","+l*s+" "+l*a+","+l*o+" "+r*a+","+r*o},eO=Zd({line:sq,"line-radial":Bse,arc:aq,"arc-radial":Use,curve:oq,"curve-radial":jse,"orthogonal-horizontal":qse,"orthogonal-vertical":Gse,"orthogonal-radial":Wse,"diagonal-horizontal":Hse,"diagonal-vertical":Vse,"diagonal-radial":Jse});function l8(e){G.call(this,null,e)}l8.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};ne(l8,G,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.field||Yd,a=e.startAngle||0,o=e.endAngle!=null?e.endAngle:2*Math.PI,l=t.source,u=l.map(s),c=u.length,f=a,d=(o-a)/CL(u),h=_r(c),p,g,m;for(e.sort&&h.sort((y,v)=>u[y]-u[v]),p=0;p<c;++p)m=u[h[p]],g=l[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=u,t.reflow(e.modified()).modifies(n)}});const Yse=5;function Xse(e){const t=e.type;return!e.bins&&(t===kd||t===Q0||t===em)}function lq(e){return v9(e)&&e!==ds}const Kse=Di(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function uq(e){G.call(this,null,e),this.modified(!0)}ne(uq,G,{transform(e,t){var n=t.dataflow,r=this.value,i=Zse(e);(!r||i!==r.type)&&(this.value=r=ze(i)());for(i in e)if(!Kse[i]){if(i==="padding"&&lq(r.type))continue;$e(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return iae(r,e,rae(r,e,eae(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Zse(e){var t=e.type,n="",r;return t===ds?ds+"-"+kd:(Qse(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?ds+"-":r===3?sh+"-":""),(n+t||kd).toLowerCase())}function Qse(e){const t=e.type;return v9(t)&&t!==gc&&t!==mc&&(e.scheme||e.range&&e.range.length&&e.range.every(oe))}function eae(e,t,n){const r=tae(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,s=e.type,a=t.zero||t.zero===void 0&&Xse(e),o,l;if(!i)return 0;if(lq(s)&&t.padding&&i[0]!==Oe(i)&&(i=nae(s,i,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(o=(i=i.slice()).length-1||1,a&&(i[0]>0&&(i[0]=0),i[o]<0&&(i[o]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[o]=t.domainMax),t.domainMid!=null)){l=t.domainMid;const u=l>i[o]?o+1:l<i[0]?0:o;u!==o&&n.warn("Scale domainMid exceeds domain min or max.",l),i.splice(u,0,l)}return e.domain(cq(s,i,n)),s===p9&&e.unknown(t.domainImplicit?LA:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&w9(e,t.nice)||null),i.length}function tae(e,t,n){return t?(e.domain(cq(e.type,t,n)),t.length):-1}function nae(e,t,n,r,i,s){var a=Math.abs(Oe(n)-n[0]),o=a/(a-2*r),l=e===Aa?P$(t,null,o):e===em?bv(t,null,o,.5):e===Q0?bv(t,null,o,i||1):e===N2?I$(t,null,o,s||1):R$(t,null,o);return t=t.slice(),t[0]=l[0],t[t.length-1]=l[1],t}function cq(e,t,n){if(AU(e)){var r=Math.abs(t.reduce((i,s)=>i+(s<0?-1:s>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+te(t))}return t}function rae(e,t,n){let r=t.bins;if(r&&!Y(r)){const i=e.domain(),s=i[0],a=Oe(i),o=r.step;let l=r.start==null?s:r.start,u=r.stop==null?a:r.stop;o||H("Scale bins parameter missing step property."),l<s&&(l=o*Math.ceil(s/o)),u>a&&(u=o*Math.floor(a/o)),r=_r(l,u+o/2,o)}return r?e.bins=r:e.bins&&delete e.bins,e.type===g9&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function iae(e,t,n){var r=e.type,i=t.round||!1,s=t.range;if(t.rangeStep!=null)s=sae(r,t,n);else if(t.scheme&&(s=aae(r,t,n),$e(s))){if(e.interpolator)return e.interpolator(s);H(`Scale type ${r} does not support interpolating color schemes.`)}if(s&&$U(r))return e.interpolator(O2(a4(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(b9(t.interpolate,t.interpolateGamma)):$e(e.round)?e.round(i):$e(e.rangeRound)&&e.interpolate(i?K0:el),s&&e.range(a4(s,t.reverse))}function sae(e,t,n){e!==xU&&e!==WA&&H("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===WA?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*h9(n,i,r)]}function aae(e,t,n){var r=t.schemeExtent,i,s;return Y(t.scheme)?s=O2(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),s=x9(i),s||H(`Unrecognized scheme name: ${t.scheme}`)),n=e===D2?n+1:e===g9?n-1:e===Sd||e===F2?+t.schemeCount||Yse:n,$U(e)?tO(s,r,t.reverse):$e(s)?TU(tO(s,r),n):e===p9?s:s.slice(0,n)}function tO(e,t,n){return $e(e)&&(t||n)?MU(e,a4(t||[0,1],n)):e}function a4(e,t){return t?e.slice().reverse():e}function fq(e){G.call(this,null,e)}ne(fq,G,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Uc(e.sort)),this.modified(n),t}});const nO="zero",dq="center",hq="normalize",pq=["y0","y1"];function u8(e){G.call(this,null,e)}u8.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:nO,values:[nO,dq,hq]},{name:"as",type:"string",array:!0,length:2,default:pq}]};ne(u8,G,{transform(e,t){var n=e.as||pq,r=n[0],i=n[1],s=Uc(e.sort),a=e.field||Yd,o=e.offset===dq?oae:e.offset===hq?lae:uae,l,u,c,f;for(l=cae(t.source,e.groupby,s,a),u=0,c=l.length,f=l.max;u<c;++u)o(l[u],f,a,r,i);return t.reflow(e.modified()).modifies(n)}});function oae(e,t,n,r,i){for(var s=(t-e.sum)/2,a=e.length,o=0,l;o<a;++o)l=e[o],l[r]=s,l[i]=s+=Math.abs(n(l))}function lae(e,t,n,r,i){for(var s=1/e.sum,a=0,o=e.length,l=0,u=0,c;l<o;++l)c=e[l],c[r]=a,c[i]=a=s*(u+=Math.abs(n(c)))}function uae(e,t,n,r,i){for(var s=0,a=0,o=e.length,l=0,u,c;l<o;++l)c=e[l],u=+n(c),u<0?(c[r]=a,c[i]=a+=u):(c[r]=s,c[i]=s+=u)}function cae(e,t,n,r){var i=[],s=g=>g(c),a,o,l,u,c,f,d,h,p;if(t==null)i.push(e.slice());else for(a={},o=0,l=e.length;o<l;++o)c=e[o],f=t.map(s),d=a[f],d||(a[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,u=i.length;f<u;++f){for(d=i[f],o=0,h=0,l=d.length;o<l;++o)h+=Math.abs(r(d[o]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const fae=Object.freeze(Object.defineProperty({__proto__:null,axisticks:tq,datajoin:nq,encode:rq,legendentries:iq,linkpath:o8,pie:l8,scale:uq,sortitems:fq,stack:u8},Symbol.toStringTag,{value:"Module"}));var be=1e-6,Yv=1e-12,Me=Math.PI,ct=Me/2,Xv=Me/4,Dn=Me*2,ht=180/Me,Ce=Me/180,De=Math.abs,oh=Math.atan,ti=Math.atan2,xe=Math.cos,vy=Math.ceil,gq=Math.exp,o4=Math.hypot,Kv=Math.log,v5=Math.pow,ye=Math.sin,Vr=Math.sign||function(e){return e>0?1:e<0?-1:0},On=Math.sqrt,c8=Math.tan;function mq(e){return e>1?0:e<-1?Me:Math.acos(e)}function nr(e){return e>1?ct:e<-1?-ct:Math.asin(e)}function Bt(){}function Zv(e,t){e&&iO.hasOwnProperty(e.type)&&iO[e.type](e,t)}var rO={Feature:function(e,t){Zv(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Zv(n[r].geometry,t)}},iO={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){l4(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)l4(n[r],t,0)},Polygon:function(e,t){sO(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)sO(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Zv(n[r],t)}};function l4(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function sO(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)l4(e[n],t,1);t.polygonEnd()}function ua(e,t){e&&rO.hasOwnProperty(e.type)?rO[e.type](e,t):Zv(e,t)}var Qv=new Nn,eb=new Nn,yq,vq,u4,c4,f4,xs={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){Qv=new Nn,xs.lineStart=dae,xs.lineEnd=hae},polygonEnd:function(){var e=+Qv;eb.add(e<0?Dn+e:e),this.lineStart=this.lineEnd=this.point=Bt},sphere:function(){eb.add(Dn)}};function dae(){xs.point=pae}function hae(){bq(yq,vq)}function pae(e,t){xs.point=bq,yq=e,vq=t,e*=Ce,t*=Ce,u4=e,c4=xe(t=t/2+Xv),f4=ye(t)}function bq(e,t){e*=Ce,t*=Ce,t=t/2+Xv;var n=e-u4,r=n>=0?1:-1,i=r*n,s=xe(t),a=ye(t),o=f4*a,l=c4*s+o*xe(i),u=o*r*ye(i);Qv.add(ti(u,l)),u4=e,c4=s,f4=a}function gae(e){return eb=new Nn,ua(e,xs),eb*2}function tb(e){return[ti(e[1],e[0]),nr(e[2])]}function yc(e){var t=e[0],n=e[1],r=xe(n);return[r*xe(t),r*ye(t),ye(n)]}function by(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Fd(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function b5(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function xy(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function nb(e){var t=On(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ot,Gn,lt,br,Wu,xq,wq,ad,Kg,po,$a,aa={point:d4,lineStart:aO,lineEnd:oO,polygonStart:function(){aa.point=Eq,aa.lineStart=mae,aa.lineEnd=yae,Kg=new Nn,xs.polygonStart()},polygonEnd:function(){xs.polygonEnd(),aa.point=d4,aa.lineStart=aO,aa.lineEnd=oO,Qv<0?(ot=-(lt=180),Gn=-(br=90)):Kg>be?br=90:Kg<-be&&(Gn=-90),$a[0]=ot,$a[1]=lt},sphere:function(){ot=-(lt=180),Gn=-(br=90)}};function d4(e,t){po.push($a=[ot=e,lt=e]),t<Gn&&(Gn=t),t>br&&(br=t)}function _q(e,t){var n=yc([e*Ce,t*Ce]);if(ad){var r=Fd(ad,n),i=[r[1],-r[0],0],s=Fd(i,r);nb(s),s=tb(s);var a=e-Wu,o=a>0?1:-1,l=s[0]*ht*o,u,c=De(a)>180;c^(o*Wu<l&&l<o*e)?(u=s[1]*ht,u>br&&(br=u)):(l=(l+360)%360-180,c^(o*Wu<l&&l<o*e)?(u=-s[1]*ht,u<Gn&&(Gn=u)):(t<Gn&&(Gn=t),t>br&&(br=t))),c?e<Wu?vr(ot,e)>vr(ot,lt)&&(lt=e):vr(e,lt)>vr(ot,lt)&&(ot=e):lt>=ot?(e<ot&&(ot=e),e>lt&&(lt=e)):e>Wu?vr(ot,e)>vr(ot,lt)&&(lt=e):vr(e,lt)>vr(ot,lt)&&(ot=e)}else po.push($a=[ot=e,lt=e]);t<Gn&&(Gn=t),t>br&&(br=t),ad=n,Wu=e}function aO(){aa.point=_q}function oO(){$a[0]=ot,$a[1]=lt,aa.point=d4,ad=null}function Eq(e,t){if(ad){var n=e-Wu;Kg.add(De(n)>180?n+(n>0?360:-360):n)}else xq=e,wq=t;xs.point(e,t),_q(e,t)}function mae(){xs.lineStart()}function yae(){Eq(xq,wq),xs.lineEnd(),De(Kg)>be&&(ot=-(lt=180)),$a[0]=ot,$a[1]=lt,ad=null}function vr(e,t){return(t-=e)<0?t+360:t}function vae(e,t){return e[0]-t[0]}function lO(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function bae(e){var t,n,r,i,s,a,o;if(br=lt=-(ot=Gn=1/0),po=[],ua(e,aa),n=po.length){for(po.sort(vae),t=1,r=po[0],s=[r];t<n;++t)i=po[t],lO(r,i[0])||lO(r,i[1])?(vr(r[0],i[1])>vr(r[0],r[1])&&(r[1]=i[1]),vr(i[0],r[1])>vr(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(a=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(o=vr(r[1],i[0]))>a&&(a=o,ot=i[0],lt=r[1])}return po=$a=null,ot===1/0||Gn===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,Gn],[lt,br]]}var Dg,rb,ib,sb,ab,ob,lb,ub,h4,p4,g4,kq,Sq,An,$n,Cn,Ai={sphere:Bt,point:f8,lineStart:uO,lineEnd:cO,polygonStart:function(){Ai.lineStart=_ae,Ai.lineEnd=Eae},polygonEnd:function(){Ai.lineStart=uO,Ai.lineEnd=cO}};function f8(e,t){e*=Ce,t*=Ce;var n=xe(t);fm(n*xe(e),n*ye(e),ye(t))}function fm(e,t,n){++Dg,ib+=(e-ib)/Dg,sb+=(t-sb)/Dg,ab+=(n-ab)/Dg}function uO(){Ai.point=xae}function xae(e,t){e*=Ce,t*=Ce;var n=xe(t);An=n*xe(e),$n=n*ye(e),Cn=ye(t),Ai.point=wae,fm(An,$n,Cn)}function wae(e,t){e*=Ce,t*=Ce;var n=xe(t),r=n*xe(e),i=n*ye(e),s=ye(t),a=ti(On((a=$n*s-Cn*i)*a+(a=Cn*r-An*s)*a+(a=An*i-$n*r)*a),An*r+$n*i+Cn*s);rb+=a,ob+=a*(An+(An=r)),lb+=a*($n+($n=i)),ub+=a*(Cn+(Cn=s)),fm(An,$n,Cn)}function cO(){Ai.point=f8}function _ae(){Ai.point=kae}function Eae(){Aq(kq,Sq),Ai.point=f8}function kae(e,t){kq=e,Sq=t,e*=Ce,t*=Ce,Ai.point=Aq;var n=xe(t);An=n*xe(e),$n=n*ye(e),Cn=ye(t),fm(An,$n,Cn)}function Aq(e,t){e*=Ce,t*=Ce;var n=xe(t),r=n*xe(e),i=n*ye(e),s=ye(t),a=$n*s-Cn*i,o=Cn*r-An*s,l=An*i-$n*r,u=o4(a,o,l),c=nr(u),f=u&&-c/u;h4.add(f*a),p4.add(f*o),g4.add(f*l),rb+=c,ob+=c*(An+(An=r)),lb+=c*($n+($n=i)),ub+=c*(Cn+(Cn=s)),fm(An,$n,Cn)}function Sae(e){Dg=rb=ib=sb=ab=ob=lb=ub=0,h4=new Nn,p4=new Nn,g4=new Nn,ua(e,Ai);var t=+h4,n=+p4,r=+g4,i=o4(t,n,r);return i<Yv&&(t=ob,n=lb,r=ub,rb<be&&(t=ib,n=sb,r=ab),i=o4(t,n,r),i<Yv)?[NaN,NaN]:[ti(n,t)*ht,nr(r/i)*ht]}function m4(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function y4(e,t){return De(e)>Me&&(e-=Math.round(e/Dn)*Dn),[e,t]}y4.invert=y4;function $q(e,t,n){return(e%=Dn)?t||n?m4(dO(e),hO(t,n)):dO(e):t||n?hO(t,n):y4}function fO(e){return function(t,n){return t+=e,De(t)>Me&&(t-=Math.round(t/Dn)*Dn),[t,n]}}function dO(e){var t=fO(e);return t.invert=fO(-e),t}function hO(e,t){var n=xe(e),r=ye(e),i=xe(t),s=ye(t);function a(o,l){var u=xe(l),c=xe(o)*u,f=ye(o)*u,d=ye(l),h=d*n+c*r;return[ti(f*i-h*s,c*n-d*r),nr(h*i+f*s)]}return a.invert=function(o,l){var u=xe(l),c=xe(o)*u,f=ye(o)*u,d=ye(l),h=d*i-f*s;return[ti(f*i+d*s,c*n+h*r),nr(h*n-c*r)]},a}function Aae(e){e=$q(e[0]*Ce,e[1]*Ce,e.length>2?e[2]*Ce:0);function t(n){return n=e(n[0]*Ce,n[1]*Ce),n[0]*=ht,n[1]*=ht,n}return t.invert=function(n){return n=e.invert(n[0]*Ce,n[1]*Ce),n[0]*=ht,n[1]*=ht,n},t}function $ae(e,t,n,r,i,s){if(n){var a=xe(t),o=ye(t),l=r*n;i==null?(i=t+r*Dn,s=t-l/2):(i=pO(a,i),s=pO(a,s),(r>0?i<s:i>s)&&(i+=r*Dn));for(var u,c=i;r>0?c>s:c<s;c-=l)u=tb([a,-o*xe(c),-o*ye(c)]),e.point(u[0],u[1])}}function pO(e,t){t=yc(t),t[0]-=e,nb(t);var n=mq(-t[1]);return((-t[2]<0?-n:n)+Dn-be)%Dn}function Cq(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Bt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function nv(e,t){return De(e[0]-t[0])<be&&De(e[1]-t[1])<be}function wy(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Mq(e,t,n,r,i){var s=[],a=[],o,l;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],y=p[g],v;if(nv(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),o=0;o<g;++o)i.point((m=p[o])[0],m[1]);i.lineEnd();return}y[0]+=2*be}s.push(v=new wy(m,p,null,!0)),a.push(v.o=new wy(m,null,v,!1)),s.push(v=new wy(y,p,null,!1)),a.push(v.o=new wy(y,null,v,!0))}}),!!s.length){for(a.sort(t),gO(s),gO(a),o=0,l=a.length;o<l;++o)a[o].e=n=!n;for(var u=s[0],c,f;;){for(var d=u,h=!0;d.v;)if((d=d.n)===u)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,l=c.length;o<l;++o)i.point((f=c[o])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function gO(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function x5(e){return De(e[0])<=Me?e[0]:Vr(e[0])*((De(e[0])+Me)%Dn-Me)}function Cae(e,t){var n=x5(t),r=t[1],i=ye(r),s=[ye(n),-xe(n),0],a=0,o=0,l=new Nn;i===1?r=ct+be:i===-1&&(r=-ct-be);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,h=f[d-1],p=x5(h),g=h[1]/2+Xv,m=ye(g),y=xe(g),v=0;v<d;++v,p=_,m=k,y=E,h=x){var x=f[v],_=x5(x),w=x[1]/2+Xv,k=ye(w),E=xe(w),A=_-p,z=A>=0?1:-1,D=z*A,R=D>Me,j=m*k;if(l.add(ti(j*z*ye(D),y*E+j*xe(D))),a+=R?A+z*Dn:A,R^p>=n^_>=n){var O=Fd(yc(h),yc(x));nb(O);var L=Fd(s,O);nb(L);var P=(R^A>=0?-1:1)*nr(L[2]);(r>P||r===P&&(O[0]||O[1]))&&(o+=R^A>=0?1:-1)}}return(a<-be||a<be&&l<-Yv)^o&1}function Tq(e,t,n,r){return function(i){var s=t(i),a=Cq(),o=t(a),l=!1,u,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=x,c=[],u=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=$L(c);var _=Cae(u,r);c.length?(l||(i.polygonStart(),l=!0),Mq(c,Tae,_,n,i)):_&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(_,w){e(_,w)&&i.point(_,w)}function p(_,w){s.point(_,w)}function g(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function y(_,w){f.push([_,w]),o.point(_,w)}function v(){o.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),o.lineEnd();var _=o.clean(),w=a.result(),k,E=w.length,A,z,D;if(f.pop(),u.push(f),f=null,!!E){if(_&1){if(z=w[0],(A=z.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),k=0;k<A;++k)i.point((D=z[k])[0],D[1]);i.lineEnd()}return}E>1&&_&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Mae))}}return d}}function Mae(e){return e.length>1}function Tae(e,t){return((e=e.x)[0]<0?e[1]-ct-be:ct-e[1])-((t=t.x)[0]<0?t[1]-ct-be:ct-t[1])}const mO=Tq(function(){return!0},Nae,Dae,[-Me,-ct]);function Nae(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?Me:-Me,l=De(s-t);De(l-Me)<be?(e.point(t,n=(n+a)/2>0?ct:-ct),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&l>=Me&&(De(t-r)<be&&(t-=r*be),De(s-o)<be&&(s-=o*be),n=Fae(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function Fae(e,t,n,r){var i,s,a=ye(e-n);return De(a)>be?oh((ye(t)*(s=xe(r))*ye(n)-ye(r)*(i=xe(t))*ye(e))/(i*s*a)):(t+r)/2}function Dae(e,t,n,r){var i;if(e==null)i=n*ct,r.point(-Me,i),r.point(0,i),r.point(Me,i),r.point(Me,0),r.point(Me,-i),r.point(0,-i),r.point(-Me,-i),r.point(-Me,0),r.point(-Me,i);else if(De(e[0]-t[0])>be){var s=e[0]<t[0]?Me:-Me;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function Oae(e){var t=xe(e),n=6*Ce,r=t>0,i=De(t)>be;function s(c,f,d,h){$ae(h,e,n,d,c,f)}function a(c,f){return xe(c)*xe(f)>t}function o(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,y){var v=[m,y],x,_=a(m,y),w=r?_?0:u(m,y):_?u(m+(m<0?Me:-Me),y):0;if(!f&&(p=h=_)&&c.lineStart(),_!==h&&(x=l(f,v),(!x||nv(f,x)||nv(v,x))&&(v[2]=1)),_!==h)g=0,_?(c.lineStart(),x=l(v,f),c.point(x[0],x[1])):(x=l(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(i&&f&&r^_){var k;!(w&d)&&(k=l(v,f,!0))&&(g=0,r?(c.lineStart(),c.point(k[0][0],k[0][1]),c.point(k[1][0],k[1][1]),c.lineEnd()):(c.point(k[1][0],k[1][1]),c.lineEnd(),c.lineStart(),c.point(k[0][0],k[0][1],3)))}_&&(!f||!nv(f,v))&&c.point(v[0],v[1]),f=v,h=_,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function l(c,f,d){var h=yc(c),p=yc(f),g=[1,0,0],m=Fd(h,p),y=by(m,m),v=m[0],x=y-v*v;if(!x)return!d&&c;var _=t*y/x,w=-t*v/x,k=Fd(g,m),E=xy(g,_),A=xy(m,w);b5(E,A);var z=k,D=by(E,z),R=by(z,z),j=D*D-R*(by(E,E)-1);if(!(j<0)){var O=On(j),L=xy(z,(-D-O)/R);if(b5(L,E),L=tb(L),!d)return L;var P=c[0],B=f[0],U=c[1],q=f[1],X;B<P&&(X=P,P=B,B=X);var ae=B-P,fe=De(ae-Me)<be,we=fe||ae<be;if(!fe&&q<U&&(X=U,U=q,q=X),we?fe?U+q>0^L[1]<(De(L[0]-P)<be?U:q):U<=L[1]&&L[1]<=q:ae>Me^(P<=L[0]&&L[0]<=B)){var Te=xy(z,(-D+O)/R);return b5(Te,E),[L,tb(Te)]}}}function u(c,f){var d=r?e:Me-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return Tq(a,o,s,r?[0,-e]:[-Me,e-Me])}function Rae(e,t,n,r,i,s){var a=e[0],o=e[1],l=t[0],u=t[1],c=0,f=1,d=l-a,h=u-o,p;if(p=n-a,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-o,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-o,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*d,e[1]=o+c*h),f<1&&(t[0]=a+f*d,t[1]=o+f*h),!0}}}}}var Og=1e9,_y=-Og;function Nq(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function s(u,c,f,d){var h=0,p=0;if(u==null||(h=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function a(u,c){return De(u[0]-e)<be?c>0?0:3:De(u[0]-n)<be?c>0?2:1:De(u[1]-t)<be?c>0?1:0:c>0?3:2}function o(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=Cq(),d,h,p,g,m,y,v,x,_,w,k,E={point:A,lineStart:j,lineEnd:O,polygonStart:D,polygonEnd:R};function A(P,B){i(P,B)&&c.point(P,B)}function z(){for(var P=0,B=0,U=h.length;B<U;++B)for(var q=h[B],X=1,ae=q.length,fe=q[0],we,Te,Se=fe[0],je=fe[1];X<ae;++X)we=Se,Te=je,fe=q[X],Se=fe[0],je=fe[1],Te<=r?je>r&&(Se-we)*(r-Te)>(je-Te)*(e-we)&&++P:je<=r&&(Se-we)*(r-Te)<(je-Te)*(e-we)&&--P;return P}function D(){c=f,d=[],h=[],k=!0}function R(){var P=z(),B=k&&P,U=(d=$L(d)).length;(B||U)&&(u.polygonStart(),B&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),U&&Mq(d,o,P,s,u),u.polygonEnd()),c=u,d=h=p=null}function j(){E.point=L,h&&h.push(p=[]),w=!0,_=!1,v=x=NaN}function O(){d&&(L(g,m),y&&_&&f.rejoin(),d.push(f.result())),E.point=A,_&&c.lineEnd()}function L(P,B){var U=i(P,B);if(h&&p.push([P,B]),w)g=P,m=B,y=U,w=!1,U&&(c.lineStart(),c.point(P,B));else if(U&&_)c.point(P,B);else{var q=[v=Math.max(_y,Math.min(Og,v)),x=Math.max(_y,Math.min(Og,x))],X=[P=Math.max(_y,Math.min(Og,P)),B=Math.max(_y,Math.min(Og,B))];Rae(q,X,e,t,n,r)?(_||(c.lineStart(),c.point(q[0],q[1])),c.point(X[0],X[1]),U||c.lineEnd(),k=!1):U&&(c.lineStart(),c.point(P,B),k=!1)}v=P,x=B,_=U}return E}}function yO(e,t,n){var r=_r(e,t-be,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function vO(e,t,n){var r=_r(e,t-be,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function Pae(){var e,t,n,r,i,s,a,o,l=10,u=l,c=90,f=360,d,h,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return _r(vy(r/c)*c,n,c).map(p).concat(_r(vy(o/f)*f,a,f).map(g)).concat(_r(vy(t/l)*l,e,l).filter(function(x){return De(x%c)>be}).map(d)).concat(_r(vy(s/u)*u,i,u).filter(function(x){return De(x%f)>be}).map(h))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(a).slice(1),p(n).reverse().slice(1),g(o).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],o=+x[0][1],a=+x[1][1],r>n&&(x=r,r=n,n=x),o>a&&(x=o,o=a,a=x),y.precision(m)):[[r,o],[n,a]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],s=+x[0][1],i=+x[1][1],t>e&&(x=t,t=e,e=x),s>i&&(x=s,s=i,i=x),y.precision(m)):[[t,s],[e,i]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],y):[c,f]},y.stepMinor=function(x){return arguments.length?(l=+x[0],u=+x[1],y):[l,u]},y.precision=function(x){return arguments.length?(m=+x,d=yO(s,i,90),h=vO(t,e,m),p=yO(o,a,90),g=vO(r,n,m),y):m},y.extentMajor([[-180,-90+be],[180,90-be]]).extentMinor([[-180,-80-be],[180,80+be]])}const _0=e=>e;var w5=new Nn,v4=new Nn,Fq,Dq,b4,x4,vo={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){vo.lineStart=Iae,vo.lineEnd=zae},polygonEnd:function(){vo.lineStart=vo.lineEnd=vo.point=Bt,w5.add(De(v4)),v4=new Nn},result:function(){var e=w5/2;return w5=new Nn,e}};function Iae(){vo.point=Lae}function Lae(e,t){vo.point=Oq,Fq=b4=e,Dq=x4=t}function Oq(e,t){v4.add(x4*e-b4*t),b4=e,x4=t}function zae(){Oq(Fq,Dq)}const bO=vo;var Dd=1/0,cb=Dd,E0=-Dd,fb=E0,Bae={point:Uae,lineStart:Bt,lineEnd:Bt,polygonStart:Bt,polygonEnd:Bt,result:function(){var e=[[Dd,cb],[E0,fb]];return E0=fb=-(cb=Dd=1/0),e}};function Uae(e,t){e<Dd&&(Dd=e),e>E0&&(E0=e),t<cb&&(cb=t),t>fb&&(fb=t)}const db=Bae;var w4=0,_4=0,Rg=0,hb=0,pb=0,ed=0,E4=0,k4=0,Pg=0,Rq,Pq,ss,as,ki={point:vc,lineStart:xO,lineEnd:wO,polygonStart:function(){ki.lineStart=Gae,ki.lineEnd=Wae},polygonEnd:function(){ki.point=vc,ki.lineStart=xO,ki.lineEnd=wO},result:function(){var e=Pg?[E4/Pg,k4/Pg]:ed?[hb/ed,pb/ed]:Rg?[w4/Rg,_4/Rg]:[NaN,NaN];return w4=_4=Rg=hb=pb=ed=E4=k4=Pg=0,e}};function vc(e,t){w4+=e,_4+=t,++Rg}function xO(){ki.point=jae}function jae(e,t){ki.point=qae,vc(ss=e,as=t)}function qae(e,t){var n=e-ss,r=t-as,i=On(n*n+r*r);hb+=i*(ss+e)/2,pb+=i*(as+t)/2,ed+=i,vc(ss=e,as=t)}function wO(){ki.point=vc}function Gae(){ki.point=Hae}function Wae(){Iq(Rq,Pq)}function Hae(e,t){ki.point=Iq,vc(Rq=ss=e,Pq=as=t)}function Iq(e,t){var n=e-ss,r=t-as,i=On(n*n+r*r);hb+=i*(ss+e)/2,pb+=i*(as+t)/2,ed+=i,i=as*e-ss*t,E4+=i*(ss+e),k4+=i*(as+t),Pg+=i*3,vc(ss=e,as=t)}const _O=ki;function Lq(e){this._context=e}Lq.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Dn);break}}},result:Bt};var S4=new Nn,_5,zq,Bq,Ig,Lg,gb={point:Bt,lineStart:function(){gb.point=Vae},lineEnd:function(){_5&&Uq(zq,Bq),gb.point=Bt},polygonStart:function(){_5=!0},polygonEnd:function(){_5=null},result:function(){var e=+S4;return S4=new Nn,e}};function Vae(e,t){gb.point=Uq,zq=Ig=e,Bq=Lg=t}function Uq(e,t){Ig-=e,Lg-=t,S4.add(On(Ig*Ig+Lg*Lg)),Ig=e,Lg=t}const EO=gb;let kO,mb,SO,AO;class $O{constructor(t){this._append=t==null?jq:Jae(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==SO||this._append!==mb){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,SO=r,mb=this._append,AO=this._,this._=i}this._+=AO;break}}}result(){const t=this._;return this._="",t.length?t:null}}function jq(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Jae(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return jq;if(t!==kO){const n=10**t;kO=t,mb=function(i){let s=1;this._+=i[0];for(const a=i.length;s<a;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return mb}function qq(e,t){let n=3,r=4.5,i,s;function a(o){return o&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),ua(o,i(s))),s.result()}return a.area=function(o){return ua(o,i(bO)),bO.result()},a.measure=function(o){return ua(o,i(EO)),EO.result()},a.bounds=function(o){return ua(o,i(db)),db.result()},a.centroid=function(o){return ua(o,i(_O)),_O.result()},a.projection=function(o){return arguments.length?(i=o==null?(e=null,_0):(e=o).stream,a):e},a.context=function(o){return arguments.length?(s=o==null?(t=null,new $O(n)):new Lq(t=o),typeof r!="function"&&s.pointRadius(r),a):t},a.pointRadius=function(o){return arguments.length?(r=typeof o=="function"?o:(s.pointRadius(+o),+o),a):r},a.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const l=Math.floor(o);if(!(l>=0))throw new RangeError(`invalid digits: ${o}`);n=l}return t===null&&(s=new $O(n)),a},a.projection(e).digits(n).context(t)}function V2(e){return function(t){var n=new A4;for(var r in e)n[r]=e[r];return n.stream=t,n}}function A4(){}A4.prototype={constructor:A4,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function d8(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),ua(n,e.stream(db)),t(db.result()),r!=null&&e.clipExtent(r),e}function J2(e,t,n){return d8(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,l])},n)}function h8(e,t,n){return J2(e,[[0,0],t],n)}function p8(e,t,n){return d8(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function g8(e,t,n){return d8(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var CO=16,Yae=xe(30*Ce);function MO(e,t){return+t?Kae(e,t):Xae(e)}function Xae(e){return V2({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Kae(e,t){function n(r,i,s,a,o,l,u,c,f,d,h,p,g,m){var y=u-r,v=c-i,x=y*y+v*v;if(x>4*t&&g--){var _=a+d,w=o+h,k=l+p,E=On(_*_+w*w+k*k),A=nr(k/=E),z=De(De(k)-1)<be||De(s-f)<be?(s+f)/2:ti(w,_),D=e(z,A),R=D[0],j=D[1],O=R-r,L=j-i,P=v*O-y*L;(P*P/x>t||De((y*O+v*L)/x-.5)>.3||a*d+o*h+l*p<Yae)&&(n(r,i,s,a,o,l,R,j,z,_/=E,w/=E,k,g,m),m.point(R,j),n(R,j,z,_,w,k,u,c,f,d,h,p,g,m))}}return function(r){var i,s,a,o,l,u,c,f,d,h,p,g,m={point:y,lineStart:v,lineEnd:_,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(A,z){A=e(A,z),r.point(A[0],A[1])}function v(){f=NaN,m.point=x,r.lineStart()}function x(A,z){var D=yc([A,z]),R=e(A,z);n(f,d,c,h,p,g,f=R[0],d=R[1],c=A,h=D[0],p=D[1],g=D[2],CO,r),r.point(f,d)}function _(){m.point=y,r.lineEnd()}function w(){v(),m.point=k,m.lineEnd=E}function k(A,z){x(i=A,z),s=f,a=d,o=h,l=p,u=g,m.point=x}function E(){n(f,d,c,h,p,g,s,a,i,o,l,u,CO,r),m.lineEnd=_,_()}return m}}var Zae=V2({point:function(e,t){this.stream.point(e*Ce,t*Ce)}});function Qae(e){return V2({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function eoe(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function TO(e,t,n,r,i,s){if(!s)return eoe(e,t,n,r,i);var a=xe(s),o=ye(s),l=a*e,u=o*e,c=a/e,f=o/e,d=(o*n-a*t)/e,h=(o*t+a*n)/e;function p(g,m){return g*=r,m*=i,[l*g-u*m+t,n-u*g-l*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function Ms(e){return Gq(function(){return e})()}function Gq(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,l=0,u=0,c,f=0,d=1,h=1,p=null,g=mO,m=null,y,v,x,_=_0,w=.5,k,E,A,z,D;function R(P){return A(P[0]*Ce,P[1]*Ce)}function j(P){return P=A.invert(P[0],P[1]),P&&[P[0]*ht,P[1]*ht]}R.stream=function(P){return z&&D===P?z:z=Zae(Qae(c)(g(k(_(D=P)))))},R.preclip=function(P){return arguments.length?(g=P,p=void 0,L()):g},R.postclip=function(P){return arguments.length?(_=P,m=y=v=x=null,L()):_},R.clipAngle=function(P){return arguments.length?(g=+P?Oae(p=P*Ce):(p=null,mO),L()):p*ht},R.clipExtent=function(P){return arguments.length?(_=P==null?(m=y=v=x=null,_0):Nq(m=+P[0][0],y=+P[0][1],v=+P[1][0],x=+P[1][1]),L()):m==null?null:[[m,y],[v,x]]},R.scale=function(P){return arguments.length?(n=+P,O()):n},R.translate=function(P){return arguments.length?(r=+P[0],i=+P[1],O()):[r,i]},R.center=function(P){return arguments.length?(s=P[0]%360*Ce,a=P[1]%360*Ce,O()):[s*ht,a*ht]},R.rotate=function(P){return arguments.length?(o=P[0]%360*Ce,l=P[1]%360*Ce,u=P.length>2?P[2]%360*Ce:0,O()):[o*ht,l*ht,u*ht]},R.angle=function(P){return arguments.length?(f=P%360*Ce,O()):f*ht},R.reflectX=function(P){return arguments.length?(d=P?-1:1,O()):d<0},R.reflectY=function(P){return arguments.length?(h=P?-1:1,O()):h<0},R.precision=function(P){return arguments.length?(k=MO(E,w=P*P),L()):On(w)},R.fitExtent=function(P,B){return J2(R,P,B)},R.fitSize=function(P,B){return h8(R,P,B)},R.fitWidth=function(P,B){return p8(R,P,B)},R.fitHeight=function(P,B){return g8(R,P,B)};function O(){var P=TO(n,0,0,d,h,f).apply(null,t(s,a)),B=TO(n,r-P[0],i-P[1],d,h,f);return c=$q(o,l,u),E=m4(t,B),A=m4(c,E),k=MO(E,w),L()}function L(){return z=D=null,R}return function(){return t=e.apply(this,arguments),R.invert=t.invert&&j,O()}}function m8(e){var t=0,n=Me/3,r=Gq(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Ce,n=s[1]*Ce):[t*ht,n*ht]},i}function toe(e){var t=xe(e);function n(r,i){return[r*t,ye(i)/t]}return n.invert=function(r,i){return[r/t,nr(i*t)]},n}function noe(e,t){var n=ye(e),r=(n+ye(t))/2;if(De(r)<be)return toe(e);var i=1+n*(2*r-n),s=On(i)/r;function a(o,l){var u=On(i-2*r*ye(l))/r;return[u*ye(o*=r),s-u*xe(o)]}return a.invert=function(o,l){var u=s-l,c=ti(o,De(u))*Vr(u);return u*r<0&&(c-=Me*Vr(o)*Vr(u)),[c/r,nr((i-(o*o+u*u)*r*r)/(2*r))]},a}function yb(){return m8(noe).scale(155.424).center([0,33.6442])}function Wq(){return yb().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function roe(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function ioe(){var e,t,n=Wq(),r,i=yb().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=yb().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,l,u={point:function(d,h){l=[d,h]}};function c(d){var h=d[0],p=d[1];return l=null,r.point(h,p),l||(s.point(h,p),l)||(o.point(h,p),l)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=roe([n.stream(t=d),i.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(u),s=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+be,g+.12*h+be],[p-.214*h-be,g+.234*h-be]]).stream(u),o=a.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+be,g+.166*h+be],[p-.115*h-be,g+.234*h-be]]).stream(u),f()},c.fitExtent=function(d,h){return J2(c,d,h)},c.fitSize=function(d,h){return h8(c,d,h)},c.fitWidth=function(d,h){return p8(c,d,h)},c.fitHeight=function(d,h){return g8(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Hq(e){return function(t,n){var r=xe(t),i=xe(n),s=e(r*i);return s===1/0?[2,0]:[s*i*ye(t),s*ye(n)]}}function dm(e){return function(t,n){var r=On(t*t+n*n),i=e(r),s=ye(i),a=xe(i);return[ti(t*s,r*a),nr(r&&n*s/r)]}}var Vq=Hq(function(e){return On(2/(1+e))});Vq.invert=dm(function(e){return 2*nr(e/2)});function soe(){return Ms(Vq).scale(124.75).clipAngle(180-.001)}var Jq=Hq(function(e){return(e=mq(e))&&e/ye(e)});Jq.invert=dm(function(e){return e});function aoe(){return Ms(Jq).scale(79.4188).clipAngle(180-.001)}function Y2(e,t){return[e,Kv(c8((ct+t)/2))]}Y2.invert=function(e,t){return[e,2*oh(gq(t))-ct]};function ooe(){return Yq(Y2).scale(961/Dn)}function Yq(e){var t=Ms(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=l=u=null:(a=+f[0][0],o=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,o],[l,u]]};function c(){var f=Me*r(),d=t(Aae(t.rotate()).invert([0,0]));return s(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Y2?[[Math.max(d[0]-f,a),o],[Math.min(d[0]+f,l),u]]:[[a,Math.max(d[1]-f,o)],[l,Math.min(d[1]+f,u)]])}return c()}function Ey(e){return c8((ct+e)/2)}function loe(e,t){var n=xe(e),r=e===t?ye(e):Kv(n/xe(t))/Kv(Ey(t)/Ey(e)),i=n*v5(Ey(e),r)/r;if(!r)return Y2;function s(a,o){i>0?o<-ct+be&&(o=-ct+be):o>ct-be&&(o=ct-be);var l=i/v5(Ey(o),r);return[l*ye(r*a),i-l*xe(r*a)]}return s.invert=function(a,o){var l=i-o,u=Vr(r)*On(a*a+l*l),c=ti(a,De(l))*Vr(l);return l*r<0&&(c-=Me*Vr(a)*Vr(l)),[c/r,2*oh(v5(i/u,1/r))-ct]},s}function uoe(){return m8(loe).scale(109.5).parallels([30,30])}function vb(e,t){return[e,t]}vb.invert=vb;function coe(){return Ms(vb).scale(152.63)}function foe(e,t){var n=xe(e),r=e===t?ye(e):(n-xe(t))/(t-e),i=n/r+e;if(De(r)<be)return vb;function s(a,o){var l=i-o,u=r*a;return[l*ye(u),i-l*xe(u)]}return s.invert=function(a,o){var l=i-o,u=ti(a,De(l))*Vr(l);return l*r<0&&(u-=Me*Vr(a)*Vr(l)),[u/r,i-Vr(r)*On(a*a+l*l)]},s}function doe(){return m8(foe).scale(131.154).center([0,13.9389])}var Zg=1.340264,Qg=-.081106,e0=893e-6,t0=.003796,bb=On(3)/2,hoe=12;function Xq(e,t){var n=nr(bb*ye(t)),r=n*n,i=r*r*r;return[e*xe(n)/(bb*(Zg+3*Qg*r+i*(7*e0+9*t0*r))),n*(Zg+Qg*r+i*(e0+t0*r))]}Xq.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,l;s<hoe&&(o=n*(Zg+Qg*r+i*(e0+t0*r))-t,l=Zg+3*Qg*r+i*(7*e0+9*t0*r),n-=a=o/l,r=n*n,i=r*r*r,!(De(a)<Yv));++s);return[bb*e*(Zg+3*Qg*r+i*(7*e0+9*t0*r))/xe(n),nr(ye(n)/bb)]};function poe(){return Ms(Xq).scale(177.158)}function Kq(e,t){var n=xe(t),r=xe(e)*n;return[n*ye(e)/r,ye(t)/r]}Kq.invert=dm(oh);function goe(){return Ms(Kq).scale(144.049).clipAngle(60)}function moe(){var e=1,t=0,n=0,r=1,i=1,s=0,a,o,l=null,u,c,f,d=1,h=1,p=V2({point:function(_,w){var k=x([_,w]);this.stream.point(k[0],k[1])}}),g=_0,m,y;function v(){return d=e*r,h=e*i,m=y=null,x}function x(_){var w=_[0]*d,k=_[1]*h;if(s){var E=k*a-w*o;w=w*a+k*o,k=E}return[w+t,k+n]}return x.invert=function(_){var w=_[0]-t,k=_[1]-n;if(s){var E=k*a+w*o;w=w*a-k*o,k=E}return[w/d,k/h]},x.stream=function(_){return m&&y===_?m:m=p(g(y=_))},x.postclip=function(_){return arguments.length?(g=_,l=u=c=f=null,v()):g},x.clipExtent=function(_){return arguments.length?(g=_==null?(l=u=c=f=null,_0):Nq(l=+_[0][0],u=+_[0][1],c=+_[1][0],f=+_[1][1]),v()):l==null?null:[[l,u],[c,f]]},x.scale=function(_){return arguments.length?(e=+_,v()):e},x.translate=function(_){return arguments.length?(t=+_[0],n=+_[1],v()):[t,n]},x.angle=function(_){return arguments.length?(s=_%360*Ce,o=ye(s),a=xe(s),v()):s*ht},x.reflectX=function(_){return arguments.length?(r=_?-1:1,v()):r<0},x.reflectY=function(_){return arguments.length?(i=_?-1:1,v()):i<0},x.fitExtent=function(_,w){return J2(x,_,w)},x.fitSize=function(_,w){return h8(x,_,w)},x.fitWidth=function(_,w){return p8(x,_,w)},x.fitHeight=function(_,w){return g8(x,_,w)},x}function Zq(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Zq.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,a=s*s;n-=i=(n*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-t)/(1.007226+s*(.015085*3+a*(-.044475*7+.028874*9*s-.005916*11*a)))}while(De(i)>be&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function yoe(){return Ms(Zq).scale(175.295)}function Qq(e,t){return[xe(t)*ye(e),ye(t)]}Qq.invert=dm(nr);function voe(){return Ms(Qq).scale(249.5).clipAngle(90+be)}function eG(e,t){var n=xe(t),r=1+xe(e)*n;return[n*ye(e)/r,ye(t)/r]}eG.invert=dm(function(e){return 2*oh(e)});function boe(){return Ms(eG).scale(250).clipAngle(142)}function tG(e,t){return[Kv(c8((ct+t)/2)),-e]}tG.invert=function(e,t){return[-t,2*oh(gq(e))-ct]};function xoe(){var e=Yq(tG),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var woe=Math.abs,$4=Math.cos,xb=Math.sin,_oe=1e-6,nG=Math.PI,C4=nG/2,NO=Eoe(2);function FO(e){return e>1?C4:e<-1?-C4:Math.asin(e)}function Eoe(e){return e>0?Math.sqrt(e):0}function koe(e,t){var n=e*xb(t),r=30,i;do t-=i=(t+xb(t)-n)/(1+$4(t));while(woe(i)>_oe&&--r>0);return t/2}function Soe(e,t,n){function r(i,s){return[e*i*$4(s=koe(n,s)),t*xb(s)]}return r.invert=function(i,s){return s=FO(s/t),[i/(e*$4(s)),FO((2*s+xb(2*s))/n)]},r}var Aoe=Soe(NO/C4,NO,nG);function $oe(){return Ms(Aoe).scale(169.529)}const Coe=qq(),M4=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Moe(e,t){return function n(){const r=t();return r.type=e,r.path=qq().projection(r),r.copy=r.copy||function(){const i=n();return M4.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},kU(r)}}function y8(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(wb[e]=Moe(e,t),this):wb[e]||null}function rG(e){return e&&e.path||Coe}const wb={albers:Wq,albersusa:ioe,azimuthalequalarea:soe,azimuthalequidistant:aoe,conicconformal:uoe,conicequalarea:yb,conicequidistant:doe,equalEarth:poe,equirectangular:coe,gnomonic:goe,identity:moe,mercator:ooe,mollweide:$oe,naturalEarth1:yoe,orthographic:voe,stereographic:boe,transversemercator:xoe};for(const e in wb)y8(e,wb[e]);function Toe(){}const ta=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function iG(){var e=1,t=1,n=o;function r(l,u){return u.map(c=>i(l,c))}function i(l,u){var c=[],f=[];return s(l,u,d=>{n(d,l,u),Noe(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Foe((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:u,coordinates:c}}function s(l,u,c){var f=new Array,d=new Array,h,p,g,m,y,v;for(h=p=-1,m=l[0]>=u,ta[m<<1].forEach(x);++h<e-1;)g=m,m=l[h+1]>=u,ta[g|m<<1].forEach(x);for(ta[m<<0].forEach(x);++p<t-1;){for(h=-1,m=l[p*e+e]>=u,y=l[p*e]>=u,ta[m<<1|y<<2].forEach(x);++h<e-1;)g=m,m=l[p*e+e+h+1]>=u,v=y,y=l[p*e+h+1]>=u,ta[g|m<<1|y<<2|v<<3].forEach(x);ta[m|y<<3].forEach(x)}for(h=-1,y=l[p*e]>=u,ta[y<<2].forEach(x);++h<e-1;)v=y,y=l[p*e+h+1]>=u,ta[y<<2|v<<3].forEach(x);ta[y<<3].forEach(x);function x(_){var w=[_[0][0]+h,_[0][1]+p],k=[_[1][0]+h,_[1][1]+p],E=a(w),A=a(k),z,D;(z=d[E])?(D=f[A])?(delete d[z.end],delete f[D.start],z===D?(z.ring.push(k),c(z.ring)):f[z.start]=d[D.end]={start:z.start,end:D.end,ring:z.ring.concat(D.ring)}):(delete d[z.end],z.ring.push(k),d[z.end=A]=z):(z=f[A])?(D=d[E])?(delete f[z.start],delete d[D.end],z===D?(z.ring.push(k),c(z.ring)):f[D.start]=d[z.end]={start:D.start,end:z.end,ring:D.ring.concat(z.ring)}):(delete f[z.start],z.ring.unshift(w),f[z.start=E]=z):f[E]=d[A]={start:E,end:A,ring:[w,k]}}}function a(l){return l[0]*2+l[1]*(e+1)*4}function o(l,u,c){l.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,y=u[g*e+p];d>0&&d<e&&p===d&&(m=u[g*e+p-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&g===h&&(m=u[(g-1)*e+p],f[1]=h+(c-m)/(y-m)-.5)})}return r.contour=i,r.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||H("invalid size"),e=u,t=c,r},r.smooth=function(l){return arguments.length?(n=l?o:Toe,r):n===o},r}function Noe(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Foe(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=Doe(e,t[n]))return i;return 0}function Doe(e,t){for(var n=t[0],r=t[1],i=-1,s=0,a=e.length,o=a-1;s<a;o=s++){var l=e[s],u=l[0],c=l[1],f=e[o],d=f[0],h=f[1];if(Ooe(l,f,t))return 0;c>r!=h>r&&n<(d-u)*(r-c)/(h-c)+u&&(i=-i)}return i}function Ooe(e,t,n){var r;return Roe(e,t,n)&&Poe(e[r=+(e[0]===t[0])],n[r],t[r])}function Roe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Poe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function sG(e,t,n){return function(r){var i=ms(r),s=n?Math.min(i[0],0):i[0],a=i[1],o=a-s,l=t?Ro(s,a,e):o/(e+1);return _r(s+l,a,l)}}function v8(e){G.call(this,null,e)}v8.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};ne(v8,G,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||un,s=iG().smooth(e.smooth!==!1),a=e.thresholds||Ioe(r,i,e),o=e.as===null?null:e.as||"contour",l=[];return r.forEach(u=>{const c=i(u),f=s.size([c.width,c.height])(c.values,Y(a)?a:a(c.values));Loe(f,c,u,e),f.forEach(d=>{l.push(d2(u,Ue(o!=null?{[o]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function Ioe(e,t,n){const r=sG(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>ic(t(i).values)))}function Loe(e,t,n,r){let i=r.scale||t.scale,s=r.translate||t.translate;if($e(i)&&(i=i(n,r)),$e(s)&&(s=s(n,r)),(i===1||i==null)&&!s)return;const a=(Ye(i)?i:i[0])||1,o=(Ye(i)?i:i[1])||1,l=s&&s[0]||0,u=s&&s[1]||0;e.forEach(aG(t,a,o,l,u))}function aG(e,t,n,r,i){const s=e.x1||0,a=e.y1||0,o=t*n<0;function l(f){f.forEach(u)}function u(f){o&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+r,f[1]=(f[1]-a)*n+i}return function(f){return f.coordinates.forEach(l),f}}function DO(e,t,n){const r=e>=0?e:oC(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function E5(e){return $e(e)?e:cn(+e)}function oG(){var e=l=>l[0],t=l=>l[1],n=Yd,r=[-1,-1],i=960,s=500,a=2;function o(l,u){const c=DO(r[0],l,e)>>a,f=DO(r[1],l,t)>>a,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>a),g=2*h+(s>>a),m=new Float32Array(p*g),y=new Float32Array(p*g);let v=m;l.forEach(_=>{const w=d+(+e(_)>>a),k=h+(+t(_)>>a);w>=0&&w<p&&k>=0&&k<g&&(m[w+k*p]+=+n(_))}),c>0&&f>0?(Lf(p,g,m,y,c),zf(p,g,y,m,f),Lf(p,g,m,y,c),zf(p,g,y,m,f),Lf(p,g,m,y,c),zf(p,g,y,m,f)):c>0?(Lf(p,g,m,y,c),Lf(p,g,y,m,c),Lf(p,g,m,y,c),v=y):f>0&&(zf(p,g,m,y,f),zf(p,g,y,m,f),zf(p,g,m,y,f),v=y);const x=u?Math.pow(2,-2*a):1/CL(v);for(let _=0,w=p*g;_<w;++_)v[_]*=x;return{values:v,scale:1<<a,width:p,height:g,x1:d,y1:h,x2:d+(i>>a),y2:h+(s>>a)}}return o.x=function(l){return arguments.length?(e=E5(l),o):e},o.y=function(l){return arguments.length?(t=E5(l),o):t},o.weight=function(l){return arguments.length?(n=E5(l),o):n},o.size=function(l){if(!arguments.length)return[i,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||H("invalid size"),i=u,s=c,o},o.cellSize=function(l){return arguments.length?((l=+l)>=1||H("invalid cell size"),a=Math.floor(Math.log(l)/Math.LN2),o):1<<a},o.bandwidth=function(l){return arguments.length?(l=le(l),l.length===1&&(l=[+l[0],+l[0]]),l.length!==2&&H("invalid bandwidth"),r=l,o):r},o}function Lf(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<t;++a)for(let o=0,l=0;o<e+i;++o)o<e&&(l+=n[o+a*e]),o>=i&&(o>=s&&(l-=n[o-s+a*e]),r[o-i+a*e]=l/Math.min(o+1,e-1+s-o,s))}function zf(e,t,n,r,i){const s=(i<<1)+1;for(let a=0;a<e;++a)for(let o=0,l=0;o<t+i;++o)o<t&&(l+=n[a+o*e]),o>=i&&(o>=s&&(l-=n[a+(o-s)*e]),r[a+(o-i)*e]=l/Math.min(o+1,t-1+s-o,s))}function b8(e){G.call(this,null,e)}b8.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const zoe=["x","y","weight","size","cellSize","bandwidth"];function lG(e,t){return zoe.forEach(n=>t[n]!=null?e[n](t[n]):0),e}ne(b8,G,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Boe(r,e.groupby),s=(e.groupby||[]).map(ft),a=lG(oG(),e),o=e.as||"grid",l=[];function u(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return l=i.map(c=>Ue(u({[o]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}});function Boe(e,t){var n=[],r=c=>c(o),i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function x8(e){G.call(this,null,e)}x8.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};ne(x8,G,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=iG().smooth(e.smooth!==!1),i=e.values,s=e.thresholds||sG(e.count||10,e.nice,!!i),a=e.size,o,l;return i||(i=t.materialize(t.SOURCE).source,o=lG(oG(),e)(i,!0),l=aG(o,o.scale||1,o.scale||1,0,0),a=[o.width,o.height],i=o.values),s=Y(s)?s:s(i),i=r.size(a)(i,s),l&&i.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(Ue),n}});const T4="Feature",w8="FeatureCollection",Uoe="MultiPoint";function _8(e){G.call(this,null,e)}_8.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};ne(_8,G,{transform(e,t){var n=this._features,r=this._points,i=e.fields,s=i&&i[0],a=i&&i[1],o=e.geojson||!i&&un,l=t.ADD,u;u=e.modified()||t.changed(t.REM)||t.modified(sn(o))||s&&t.modified(sn(s))||a&&t.modified(sn(a)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=r=[]),o&&t.visit(l,c=>n.push(o(c))),s&&a&&(t.visit(l,c=>{var f=s(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:T4,geometry:{type:Uoe,coordinates:r}})),this.value={type:w8,features:n}}});function E8(e){G.call(this,null,e)}E8.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};ne(E8,G,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||un,s=e.as||"path",a=n.SOURCE;!r||e.modified()?(this.value=r=rG(e.projection),n.materialize().reflow()):a=i===un||t.modified(i.fields)?n.ADD_MOD:n.ADD;const o=joe(r,e.pointRadius);return n.visit(a,l=>l[s]=r(i(l))),r.pointRadius(o),n.modifies(s)}});function joe(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function k8(e){G.call(this,null,e)}k8.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};ne(k8,G,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],s=e.as||["x","y"],a=s[0],o=s[1],l;function u(c){const f=n([r(c),i(c)]);f?(c[a]=f[0],c[o]=f[1]):(c[a]=void 0,c[o]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(r.fields)||t.modified(i.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}});function S8(e){G.call(this,null,e)}S8.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};ne(S8,G,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",s=n.ADD;return(!r||e.modified())&&(this.value=r=qoe(rG(e.projection),e.field||Qn("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,a=>a[i]=r),n.modifies(i)}});function qoe(e,t,n){const r=n==null?i=>e(t(i)):i=>{var s=e.pointRadius(),a=e.pointRadius(n)(t(i));return e.pointRadius(s),a};return r.context=i=>(e.context(i),r),r}function A8(e){G.call(this,[],e),this.generator=Pae()}A8.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};ne(A8,G,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const s in e)$e(r[s])&&r[s](e[s]);return i=r(),n.length?t.mod.push(Ez(n[0],i)):t.add.push(Ue(i)),n[0]=i,t}});function $8(e){G.call(this,null,e)}$8.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};ne($8,G,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||un,s=Woe(e.opacity,e),a=Goe(e.color,e),o=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?ic(n.map(u=>ic(i(u).values))):0};return n.forEach(u=>{const c=i(u),f=Ae({},u,l);r||(f.$max=ic(c.values||[])),u[o]=Hoe(c,f,a.dep?a:cn(a(f)),s.dep?s:cn(s(f)))}),t.reflow(!0).modifies(o)}});function Goe(e,t){let n;return $e(e)?(n=r=>Lo(e(r,t)),n.dep=uG(e)):n=cn(Lo(e||"#888")),n}function Woe(e,t){let n;return $e(e)?(n=r=>e(r,t),n.dep=uG(e)):e?n=cn(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function uG(e){if(!$e(e))return!1;const t=Di(sn(e));return t.$x||t.$y||t.$value||t.$max}function Hoe(e,t,n,r){const i=e.width,s=e.height,a=e.x1||0,o=e.y1||0,l=e.x2||i,u=e.y2||s,c=e.values,f=c?m=>c[m]:yo,d=No(l-a,u-o),h=d.getContext("2d"),p=h.getImageData(0,0,l-a,u-o),g=p.data;for(let m=o,y=0;m<u;++m){t.$y=m-o;for(let v=a,x=m*i;v<l;++v,y+=4){t.$x=v-a,t.$value=f(v+x);const _=n(t);g[y+0]=_.r,g[y+1]=_.g,g[y+2]=_.b,g[y+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function cG(e){G.call(this,null,e),this.modified(!0)}ne(cG,G,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Joe(e.type),M4.forEach(r=>{e[r]!=null&&OO(n,r,e[r])})):M4.forEach(r=>{e.modified(r)&&OO(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&Voe(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Voe(e,t){const n=Yoe(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Joe(e){const t=y8((e||"mercator").toLowerCase());return t||H("Unrecognized projection type: "+e),t()}function OO(e,t,n){$e(e[t])&&e[t](n)}function Yoe(e){return e=le(e),e.length===1?e[0]:{type:w8,features:e.reduce((t,n)=>t.concat(Xoe(n)),[])}}function Xoe(e){return e.type===w8?e.features:le(e).filter(t=>t!=null).map(t=>t.type===T4?t:{type:T4,geometry:t})}const Koe=Object.freeze(Object.defineProperty({__proto__:null,contour:x8,geojson:_8,geopath:E8,geopoint:k8,geoshape:S8,graticule:A8,heatmap:$8,isocontour:v8,kde2d:b8,projection:cG},Symbol.toStringTag,{value:"Module"}));function Zoe(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,a=n.length,o,l=0,u=0;for(s=0;s<a;++s)o=n[s],l+=o.x,u+=o.y;for(l=(l/a-e)*r,u=(u/a-t)*r,s=0;s<a;++s)o=n[s],o.x-=l,o.y-=u}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Qoe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return fG(this.cover(t,n),t,n,e)}function fG(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,a={data:r},o=e._x0,l=e._y0,u=e._x1,c=e._y1,f,d,h,p,g,m,y,v;if(!s)return e._root=a,e;for(;s.length;)if((g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d,i=s,!(s=s[y=m<<1|g]))return i[y]=a,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return a.next=s,i?i[y]=a:e._root=a,e;do i=i?i[y]=new Array(4):e._root=new Array(4),(g=t>=(f=(o+u)/2))?o=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d;while((y=m<<1|g)===(v=(p>=d)<<1|h>=f));return i[v]=s,i[y]=a,e}function ele(e){var t,n,r=e.length,i,s,a=new Array(r),o=new Array(r),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(a[n]=i,o[n]=s,i<l&&(l=i),i>c&&(c=i),s<u&&(u=s),s>f&&(f=s));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<r;++n)fG(this,a[n],o[n],e[n]);return this}function tle(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var a=i-n||1,o=this._root,l,u;n>e||e>=i||r>t||t>=s;)switch(u=(t<r)<<1|e<n,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:i=n+a,s=r+a;break;case 1:n=i-a,s=r+a;break;case 2:i=n+a,r=s-a;break;case 3:n=i-a,r=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function nle(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function rle(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Mn(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ile(e,t,n){var r,i=this._x0,s=this._y0,a,o,l,u,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Mn(h,i,s,c,f)),n==null?n=1/0:(i=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(a=p.x0)>c||(o=p.y0)>f||(l=p.x1)<i||(u=p.y1)<s))if(h.length){var m=(a+l)/2,y=(o+u)/2;d.push(new Mn(h[3],m,y,l,u),new Mn(h[2],a,y,m,u),new Mn(h[1],m,o,l,y),new Mn(h[0],a,o,m,y)),(g=(t>=y)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),_=v*v+x*x;if(_<n){var w=Math.sqrt(n=_);i=e-w,s=t-w,c=e+w,f=t+w,r=h.data}}return r}function sle(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,a=this._x0,o=this._y0,l=this._x1,u=this._y1,c,f,d,h,p,g,m,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(a+l)/2))?a=d:l=d,(g=f>=(h=(o+u)/2))?o=h:u=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,y=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=s,this)}function ale(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function ole(){return this._root}function lle(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ule(e){var t=[],n,r=this._root,i,s,a,o,l;for(r&&t.push(new Mn(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,a=n.y0,o=n.x1,l=n.y1)&&r.length){var u=(s+o)/2,c=(a+l)/2;(i=r[3])&&t.push(new Mn(i,u,c,o,l)),(i=r[2])&&t.push(new Mn(i,s,c,u,l)),(i=r[1])&&t.push(new Mn(i,u,a,o,c)),(i=r[0])&&t.push(new Mn(i,s,a,u,c))}return this}function cle(e){var t=[],n=[],r;for(this._root&&t.push(new Mn(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,a=r.x0,o=r.y0,l=r.x1,u=r.y1,c=(a+l)/2,f=(o+u)/2;(s=i[0])&&t.push(new Mn(s,a,o,c,f)),(s=i[1])&&t.push(new Mn(s,c,o,l,f)),(s=i[2])&&t.push(new Mn(s,a,f,c,u)),(s=i[3])&&t.push(new Mn(s,c,f,l,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function fle(e){return e[0]}function dle(e){return arguments.length?(this._x=e,this):this._x}function hle(e){return e[1]}function ple(e){return arguments.length?(this._y=e,this):this._y}function C8(e,t,n){var r=new M8(t??fle,n??hle,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function M8(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function RO(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Pn=C8.prototype=M8.prototype;Pn.copy=function(){var e=new M8(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=RO(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=RO(r));return e};Pn.add=Qoe;Pn.addAll=ele;Pn.cover=tle;Pn.data=nle;Pn.extent=rle;Pn.find=ile;Pn.remove=sle;Pn.removeAll=ale;Pn.root=ole;Pn.size=lle;Pn.visit=ule;Pn.visitAfter=cle;Pn.x=dle;Pn.y=ple;function Tn(e){return function(){return e}}function So(e){return(e()-.5)*1e-6}function gle(e){return e.x+e.vx}function mle(e){return e.y+e.vy}function yle(e){var t,n,r,i=1,s=1;typeof e!="function"&&(e=Tn(e==null?1:+e));function a(){for(var u,c=t.length,f,d,h,p,g,m,y=0;y<s;++y)for(f=C8(t,gle,mle).visitAfter(o),u=0;u<c;++u)d=t[u],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(x,_,w,k,E){var A=x.data,z=x.r,D=g+z;if(A){if(A.index>d.index){var R=h-A.x-A.vx,j=p-A.y-A.vy,O=R*R+j*j;O<D*D&&(R===0&&(R=So(r),O+=R*R),j===0&&(j=So(r),O+=j*j),O=(D-(O=Math.sqrt(O)))/O*i,d.vx+=(R*=O)*(D=(z*=z)/(m+z)),d.vy+=(j*=O)*D,A.vx-=R*(D=1-D),A.vy-=j*D)}return}return _>h+D||k<h-D||w>p+D||E<p-D}}function o(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,c=t.length,f;for(n=new Array(c),u=0;u<c;++u)f=t[u],n[f.index]=+e(f,u,t)}}return a.initialize=function(u,c){t=u,r=c,l()},a.iterations=function(u){return arguments.length?(s=+u,a):s},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Tn(+u),l(),a):e},a}function vle(e){return e.index}function PO(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function ble(e){var t=vle,n=f,r,i=Tn(30),s,a,o,l,u,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(o[m.source.index],o[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var x=0,_,w,k,E,A,z,D;x<v;++x)_=e[x],w=_.source,k=_.target,E=k.x+k.vx-w.x-w.vx||So(u),A=k.y+k.vy-w.y-w.vy||So(u),z=Math.sqrt(E*E+A*A),z=(z-s[x])/z*m*r[x],E*=z,A*=z,k.vx-=E*(D=l[x]),k.vy-=A*D,w.vx+=E*(D=1-D),w.vy+=A*D}function h(){if(a){var m,y=a.length,v=e.length,x=new Map(a.map((w,k)=>[t(w,k,a),w])),_;for(m=0,o=new Array(y);m<v;++m)_=e[m],_.index=m,typeof _.source!="object"&&(_.source=PO(x,_.source)),typeof _.target!="object"&&(_.target=PO(x,_.target)),o[_.source.index]=(o[_.source.index]||0)+1,o[_.target.index]=(o[_.target.index]||0)+1;for(m=0,l=new Array(v);m<v;++m)_=e[m],l[m]=o[_.source.index]/(o[_.source.index]+o[_.target.index]);r=new Array(v),p(),s=new Array(v),g()}}function p(){if(a)for(var m=0,y=e.length;m<y;++m)r[m]=+n(e[m],m,e)}function g(){if(a)for(var m=0,y=e.length;m<y;++m)s[m]=+i(e[m],m,e)}return d.initialize=function(m,y){a=m,u=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Tn(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Tn(+m),g(),d):i},d}var xle={value:()=>{}};function dG(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new rv(n)}function rv(e){this._=e}function wle(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}rv.prototype=dG.prototype={constructor:rv,on:function(e,t){var n=this._,r=wle(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=_le(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=IO(n[i],e.name,t);else if(t==null)for(i in n)n[i]=IO(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new rv(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function _le(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function IO(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=xle,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Od=0,zg=0,cg=0,hG=1e3,_b,Bg,Eb=0,bc=0,X2=0,k0=typeof performance=="object"&&performance.now?performance:Date,pG=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function T8(){return bc||(pG(Ele),bc=k0.now()+X2)}function Ele(){bc=0}function kb(){this._call=this._time=this._next=null}kb.prototype=gG.prototype={constructor:kb,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?T8():+n)+(t==null?0:+t),!this._next&&Bg!==this&&(Bg?Bg._next=this:_b=this,Bg=this),this._call=e,this._time=n,N4()},stop:function(){this._call&&(this._call=null,this._time=1/0,N4())}};function gG(e,t,n){var r=new kb;return r.restart(e,t,n),r}function kle(){T8(),++Od;for(var e=_b,t;e;)(t=bc-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Od}function LO(){bc=(Eb=k0.now())+X2,Od=zg=0;try{kle()}finally{Od=0,Ale(),bc=0}}function Sle(){var e=k0.now(),t=e-Eb;t>hG&&(X2-=t,Eb=e)}function Ale(){for(var e,t=_b,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:_b=n);Bg=e,N4(r)}function N4(e){if(!Od){zg&&(zg=clearTimeout(zg));var t=e-bc;t>24?(e<1/0&&(zg=setTimeout(LO,e-k0.now()-X2)),cg&&(cg=clearInterval(cg))):(cg||(Eb=k0.now(),cg=setInterval(Sle,hG)),Od=1,pG(LO))}}function $le(e,t,n){var r=new kb,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(s,a,o){a=+a,o=o==null?T8():+o,r._restart(function l(u){u+=i,r._restart(l,i+=a,o),s(u)},a,o)},r.restart(e,t,n),r)}const Cle=1664525,Mle=1013904223,zO=4294967296;function Tle(){let e=1;return()=>(e=(Cle*e+Mle)%zO)/zO}function Nle(e){return e.x}function Fle(e){return e.y}var Dle=10,Ole=Math.PI*(3-Math.sqrt(5));function Rle(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,a=.6,o=new Map,l=gG(f),u=dG("tick","end"),c=Tle();e==null&&(e=[]);function f(){d(),u.call("tick",t),n<r&&(l.stop(),u.call("end",t))}function d(g){var m,y=e.length,v;g===void 0&&(g=1);for(var x=0;x<g;++x)for(n+=(s-n)*i,o.forEach(function(_){_(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,m=e.length,y;g<m;++g){if(y=e[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=Dle*Math.sqrt(.5+g),x=g*Ole;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),o.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(a=1-g,t):1-a},randomSource:function(g){return arguments.length?(c=g,o.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?o.delete(g):o.set(g,p(m)),t):o.get(g)},find:function(g,m,y){var v=0,x=e.length,_,w,k,E,A;for(y==null?y=1/0:y*=y,v=0;v<x;++v)E=e[v],_=g-E.x,w=m-E.y,k=_*_+w*w,k<y&&(A=E,y=k);return A},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}function Ple(){var e,t,n,r,i=Tn(-30),s,a=1,o=1/0,l=.81;function u(h){var p,g=e.length,m=C8(e,Nle,Fle).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,p=e.length,g;for(s=new Array(p),h=0;h<p;++h)g=e[h],s[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,y=0,v,x,_;if(h.length){for(v=x=_=0;_<4;++_)(g=h[_])&&(m=Math.abs(g.value))&&(p+=g.value,y+=m,v+=m*g.x,x+=m*g.y);h.x=v/y,h.y=x/y}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,x=m-p,_=y*y+v*v;if(x*x/l<_)return _<o&&(y===0&&(y=So(n),_+=y*y),v===0&&(v=So(n),_+=v*v),_<a&&(_=Math.sqrt(a*_)),t.vx+=y*h.value*r/_,t.vy+=v*h.value*r/_),!0;if(h.length||_>=o)return;(h.data!==t||h.next)&&(y===0&&(y=So(n),_+=y*y),v===0&&(v=So(n),_+=v*v),_<a&&(_=Math.sqrt(a*_)));do h.data!==t&&(x=s[h.data.index]*r/_,t.vx+=y*x,t.vy+=v*x);while(h=h.next)}return u.initialize=function(h,p){e=h,n=p,c()},u.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Tn(+h),c(),u):i},u.distanceMin=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.distanceMax=function(h){return arguments.length?(o=h*h,u):Math.sqrt(o)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u}function Ile(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vx+=(i[l]-c.x)*r[l]*o}function a(){if(n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Tn(+o),a(),s):t},s.x=function(o){return arguments.length?(e=typeof o=="function"?o:Tn(+o),a(),s):e},s}function Lle(e){var t=Tn(.1),n,r,i;typeof e!="function"&&(e=Tn(e==null?0:+e));function s(o){for(var l=0,u=n.length,c;l<u;++l)c=n[l],c.vy+=(i[l]-c.y)*r[l]*o}function a(){if(n){var o,l=n.length;for(r=new Array(l),i=new Array(l),o=0;o<l;++o)r[o]=isNaN(i[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return s.initialize=function(o){n=o,a()},s.strength=function(o){return arguments.length?(t=typeof o=="function"?o:Tn(+o),a(),s):t},s.y=function(o){return arguments.length?(e=typeof o=="function"?o:Tn(+o),a(),s):e},s}const BO={center:Zoe,collide:yle,nbody:Ple,link:ble,x:Ile,y:Lle},Ug="forces",F4=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],zle=["static","iterations"],mG=["x","y","vx","vy"];function N8(e){G.call(this,null,e)}N8.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:mG}]};ne(N8,G,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(F4),s=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&yG(n,e,0,t)):(this.value=n=Ule(t.source,e),n.on("tick",Ble(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(zle)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let o=this._argops,l=0,u=o.length,c;l<u;++l)if(c=o[l],!(c.name!==Ug||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,s=r.length,a;i<s;++i)if(r[i].name==="links"&&(a=r[i].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(mG)}});function Ble(e,t){return()=>e.touch(t).run()}function Ule(e,t){const n=Rle(e),r=n.stop,i=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,i()),n.stop=()=>(s=!0,r()),yG(n,t,!0).on("end",()=>s=!0)}function yG(e,t,n,r){var i=le(t.forces),s,a,o,l;for(s=0,a=F4.length;s<a;++s)o=F4[s],o!==Ug&&t.modified(o)&&e[o](t[o]);for(s=0,a=i.length;s<a;++s)l=Ug+s,o=n||t.modified(Ug,s)?qle(i[s]):r&&jle(i[s],r)?e.force(l):null,o&&e.force(l,o);for(a=e.numForces||0;s<a;++s)e.force(Ug+s,null);return e.numForces=i.length,e}function jle(e,t){var n,r;for(n in e)if($e(r=e[n])&&t.modified(sn(r)))return 1;return 0}function qle(e){var t,n;ve(BO,e.force)||H("Unrecognized force: "+e.force),t=BO[e.force]();for(n in e)$e(t[n])&&Gle(t[n],e[n],e);return t}function Gle(e,t,n){e($e(t)?r=>t(r,n):t)}const Wle=Object.freeze(Object.defineProperty({__proto__:null,force:N8},Symbol.toStringTag,{value:"Module"}));function Hle(e,t){return e.parent===t.parent?1:2}function Vle(e){return e.reduce(Jle,0)/e.length}function Jle(e,t){return e+t.x}function Yle(e){return 1+e.reduce(Xle,0)}function Xle(e,t){return Math.max(e,t.y)}function Kle(e){for(var t;t=e.children;)e=t[0];return e}function Zle(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Qle(){var e=Hle,t=1,n=1,r=!1;function i(s){var a,o=0;s.eachAfter(function(d){var h=d.children;h?(d.x=Vle(h),d.y=Yle(h)):(d.x=a?o+=e(d,a):0,d.y=0,a=d)});var l=Kle(s),u=Zle(s),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return s.eachAfter(r?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function eue(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function tue(){return this.eachAfter(eue)}function nue(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function rue(e,t){for(var n=this,r=[n],i,s,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function iue(e,t){for(var n=this,r=[n],i=[],s,a,o,l=-1;n=r.pop();)if(i.push(n),s=n.children)for(a=0,o=s.length;a<o;++a)r.push(s[a]);for(;n=i.pop();)e.call(t,n,++l,this);return this}function sue(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function aue(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function oue(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function lue(e){for(var t=this,n=uue(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function uue(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function cue(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function fue(){return Array.from(this)}function due(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function hue(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*pue(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function F8(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=yue)):t===void 0&&(t=mue);for(var n=new Rd(e),r,i=[n],s,a,o,l;r=i.pop();)if((a=t(r.data))&&(l=(a=Array.from(a)).length))for(r.children=a,o=l-1;o>=0;--o)i.push(s=a[o]=new Rd(a[o])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(vG)}function gue(){return F8(this).eachBefore(vue)}function mue(e){return e.children}function yue(e){return Array.isArray(e)?e[1]:null}function vue(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function vG(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Rd(e){this.data=e,this.depth=this.height=0,this.parent=null}Rd.prototype=F8.prototype={constructor:Rd,count:tue,each:nue,eachAfter:iue,eachBefore:rue,find:sue,sum:aue,sort:oue,path:lue,ancestors:cue,descendants:fue,leaves:due,links:hue,copy:gue,[Symbol.iterator]:pue};function iv(e){return e==null?null:bG(e)}function bG(e){if(typeof e!="function")throw new Error;return e}function Xu(){return 0}function Jf(e){return function(){return e}}const bue=1664525,xue=1013904223,UO=4294967296;function wue(){let e=1;return()=>(e=(bue*e+xue)%UO)/UO}function _ue(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Eue(e,t){let n=e.length,r,i;for(;n;)i=t()*n--|0,r=e[n],e[n]=e[i],e[i]=r;return e}function kue(e,t){for(var n=0,r=(e=Eue(Array.from(e),t)).length,i=[],s,a;n<r;)s=e[n],a&&xG(a,s)?++n:(a=Aue(i=Sue(i,s)),n=0);return a}function Sue(e,t){var n,r;if(k5(t,e))return[t];for(n=0;n<e.length;++n)if(ky(t,e[n])&&k5(jg(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(ky(jg(e[n],e[r]),t)&&ky(jg(e[n],t),e[r])&&ky(jg(e[r],t),e[n])&&k5(wG(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function ky(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function xG(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function k5(e,t){for(var n=0;n<t.length;++n)if(!xG(e,t[n]))return!1;return!0}function Aue(e){switch(e.length){case 1:return $ue(e[0]);case 2:return jg(e[0],e[1]);case 3:return wG(e[0],e[1],e[2])}}function $ue(e){return{x:e.x,y:e.y,r:e.r}}function jg(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,a=t.y,o=t.r,l=s-n,u=a-r,c=o-i,f=Math.sqrt(l*l+u*u);return{x:(n+s+l/f*c)/2,y:(r+a+u/f*c)/2,r:(f+i+o)/2}}function wG(e,t,n){var r=e.x,i=e.y,s=e.r,a=t.x,o=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=r-a,h=r-u,p=i-o,g=i-c,m=l-s,y=f-s,v=r*r+i*i-s*s,x=v-a*a-o*o+l*l,_=v-u*u-c*c+f*f,w=h*p-d*g,k=(p*_-g*x)/(w*2)-r,E=(g*m-p*y)/w,A=(h*x-d*_)/(w*2)-i,z=(d*y-h*m)/w,D=E*E+z*z-1,R=2*(s+k*E+A*z),j=k*k+A*A-s*s,O=-(Math.abs(D)>1e-6?(R+Math.sqrt(R*R-4*D*j))/(2*D):j/R);return{x:r+k+E*O,y:i+A+z*O,r:O}}function jO(e,t,n){var r=e.x-t.x,i,s,a=e.y-t.y,o,l,u=r*r+a*a;u?(s=t.r+n.r,s*=s,l=e.r+n.r,l*=l,s>l?(i=(u+l-s)/(2*u),o=Math.sqrt(Math.max(0,l/u-i*i)),n.x=e.x-i*r-o*a,n.y=e.y-i*a+o*r):(i=(u+s-l)/(2*u),o=Math.sqrt(Math.max(0,s/u-i*i)),n.x=t.x+i*r-o*a,n.y=t.y+i*a+o*r)):(n.x=t.x+n.r,n.y=t.y)}function qO(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function GO(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function Sy(e){this._=e,this.next=null,this.previous=null}function Cue(e,t){if(!(s=(e=_ue(e)).length))return 0;var n,r,i,s,a,o,l,u,c,f,d;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;jO(r,n,i=e[2]),n=new Sy(n),r=new Sy(r),i=new Sy(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(l=3;l<s;++l){jO(n._,r._,i=e[l]),i=new Sy(i),u=r.next,c=n.previous,f=r._.r,d=n._.r;do if(f<=d){if(qO(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue e}f+=u._.r,u=u.next}else{if(qO(c._,i._)){n=c,n.next=r,r.previous=n,--l;continue e}d+=c._.r,c=c.previous}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=GO(n);(i=i.next)!==r;)(o=GO(i))<a&&(n=i,a=o);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=kue(n,t),l=0;l<s;++l)n=e[l],n.x-=i.x,n.y-=i.y;return i.r}function Mue(e){return Math.sqrt(e.value)}function Tue(){var e=null,t=1,n=1,r=Xu;function i(s){const a=wue();return s.x=t/2,s.y=n/2,e?s.eachBefore(WO(e)).eachAfter(S5(r,.5,a)).eachBefore(HO(1)):s.eachBefore(WO(Mue)).eachAfter(S5(Xu,1,a)).eachAfter(S5(r,s.r/Math.min(t,n),a)).eachBefore(HO(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=iv(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:Jf(+s),i):r},i}function WO(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function S5(e,t,n){return function(r){if(i=r.children){var i,s,a=i.length,o=e(r)*t||0,l;if(o)for(s=0;s<a;++s)i[s].r+=o;if(l=Cue(i,n),o)for(s=0;s<a;++s)i[s].r-=o;r.r=l+o}}}function HO(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function _G(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function hm(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(r-t)/e.value;++o<l;)a=s[o],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*u}function Nue(){var e=1,t=1,n=0,r=!1;function i(a){var o=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/o,a.eachBefore(s(t,o)),r&&a.eachBefore(_G),a}function s(a,o){return function(l){l.children&&hm(l,l.x0,a*(l.depth+1)/o,l.x1,a*(l.depth+2)/o);var u=l.x0,c=l.y0,f=l.x1-n,d=l.y1-n;f<u&&(u=f=(u+f)/2),d<c&&(c=d=(c+d)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=d}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(e=+a[0],t=+a[1],i):[e,t]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}var Fue={depth:-1},VO={},A5={};function Due(e){return e.id}function Oue(e){return e.parentId}function JO(){var e=Due,t=Oue,n;function r(i){var s=Array.from(i),a=e,o=t,l,u,c,f,d,h,p,g,m=new Map;if(n!=null){const y=s.map((_,w)=>Rue(n(_,w,i))),v=y.map(YO),x=new Set(y).add("");for(const _ of v)x.has(_)||(x.add(_),y.push(_),v.push(YO(_)),s.push(A5));a=(_,w)=>y[w],o=(_,w)=>v[w]}for(c=0,l=s.length;c<l;++c)u=s[c],h=s[c]=new Rd(u),(p=a(u,c,i))!=null&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?VO:h)),(p=o(u,c,i))!=null&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(h=s[c],p=h.parent){if(d=m.get(p),!d)throw new Error("missing: "+p);if(d===VO)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===A5&&f.children.length===1;)f=f.children[0],--l;for(let y=s.length-1;y>=0&&(h=s[y],h.data===A5);--y)h.data=null}if(f.parent=Fue,f.eachBefore(function(y){y.depth=y.parent.depth+1,--l}).eachBefore(vG),f.parent=null,l>0)throw new Error("cycle");return f}return r.id=function(i){return arguments.length?(e=iv(i),r):e},r.parentId=function(i){return arguments.length?(t=iv(i),r):t},r.path=function(i){return arguments.length?(n=iv(i),r):n},r}function Rue(e){e=`${e}`;let t=e.length;return D4(e,t-1)&&!D4(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function YO(e){let t=e.length;if(t<2)return"";for(;--t>1&&!D4(e,t););return e.slice(0,t)}function D4(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if(!(n&1))return!0}return!1}function Pue(e,t){return e.parent===t.parent?1:2}function $5(e){var t=e.children;return t?t[0]:e.t}function C5(e){var t=e.children;return t?t[t.length-1]:e.t}function Iue(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Lue(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function zue(e,t,n){return e.a.parent===t.parent?e.a:n}function sv(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}sv.prototype=Object.create(Rd.prototype);function Bue(e){for(var t=new sv(e,0),n,r=[t],i,s,a,o;n=r.pop();)if(s=n._.children)for(n.children=new Array(o=s.length),a=o-1;a>=0;--a)r.push(i=n.children[a]=new sv(s[a],a)),i.parent=n;return(t.parent=new sv(null,0)).children=[t],t}function Uue(){var e=Pue,t=1,n=1,r=null;function i(u){var c=Bue(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(a),r)u.eachBefore(l);else{var f=u,d=u,h=u;u.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),y=n/(h.depth||1);u.eachBefore(function(v){v.x=(v.x+g)*m,v.y=v.depth*y})}return u}function s(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){Lue(u);var h=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+e(u._,d._),u.m=u.z-h):u.z=h}else d&&(u.z=d.z+e(u._,d._));u.parent.A=o(u,d,u.parent.A||f[0])}function a(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function o(u,c,f){if(c){for(var d=u,h=u,p=c,g=d.parent.children[0],m=d.m,y=h.m,v=p.m,x=g.m,_;p=C5(p),d=$5(d),p&&d;)g=$5(g),h=C5(h),h.a=u,_=p.z+v-d.z-m+e(p._,d._),_>0&&(Iue(zue(p,u,f),u,_),m+=_,y+=_),v+=p.m,m+=d.m,x+=g.m,y+=h.m;p&&!C5(h)&&(h.t=p,h.m+=v-y),d&&!$5(g)&&(g.t=d,g.m+=m-x,f=u)}return f}function l(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}function K2(e,t,n,r,i){for(var s=e.children,a,o=-1,l=s.length,u=e.value&&(i-n)/e.value;++o<l;)a=s[o],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*u}var EG=(1+Math.sqrt(5))/2;function kG(e,t,n,r,i,s){for(var a=[],o=t.children,l,u,c=0,f=0,d=o.length,h,p,g=t.value,m,y,v,x,_,w,k;c<d;){h=i-n,p=s-r;do m=o[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(p/h,h/p)/(g*e),k=m*m*w,_=Math.max(v/k,k/y);f<d;++f){if(m+=u=o[f].value,u<y&&(y=u),u>v&&(v=u),k=m*m*w,x=Math.max(v/k,k/y),x>_){m-=u;break}_=x}a.push(l={value:m,dice:h<p,children:o.slice(c,f)}),l.dice?hm(l,n,r,i,g?r+=p*m/g:s):K2(l,n,r,g?n+=h*m/g:i,s),g-=m,c=f}return a}const SG=function e(t){function n(r,i,s,a,o){kG(t,r,i,s,a,o)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(EG);function jue(){var e=SG,t=!1,n=1,r=1,i=[0],s=Xu,a=Xu,o=Xu,l=Xu,u=Xu;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(_G),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,y=d.y1-h;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(h=i[d.depth+1]=s(d)/2,p+=u(d)-h,g+=a(d)-h,m-=o(d)-h,y-=l(d)-h,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),e(d,p,g,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=bG(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:Jf(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:Jf(+d),c):a},c.paddingRight=function(d){return arguments.length?(o=typeof d=="function"?d:Jf(+d),c):o},c.paddingBottom=function(d){return arguments.length?(l=typeof d=="function"?d:Jf(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u=typeof d=="function"?d:Jf(+d),c):u},c}function que(e,t,n,r,i){var s=e.children,a,o=s.length,l,u=new Array(o+1);for(u[0]=l=a=0;a<o;++a)u[a+1]=l+=s[a].value;c(0,o,e.value,t,n,r,i);function c(f,d,h,p,g,m,y){if(f>=d-1){var v=s[f];v.x0=p,v.y0=g,v.x1=m,v.y1=y;return}for(var x=u[f],_=h/2+x,w=f+1,k=d-1;w<k;){var E=w+k>>>1;u[E]<_?w=E+1:k=E}_-u[w-1]<u[w]-_&&f+1<w&&--w;var A=u[w]-x,z=h-A;if(m-p>y-g){var D=h?(p*z+m*A)/h:m;c(f,w,A,p,g,D,y),c(w,d,z,D,g,m,y)}else{var R=h?(g*z+y*A)/h:y;c(f,w,A,p,g,m,R),c(w,d,z,p,R,m,y)}}}function Gue(e,t,n,r,i){(e.depth&1?K2:hm)(e,t,n,r,i)}const Wue=function e(t){function n(r,i,s,a,o){if((l=r._squarify)&&l.ratio===t)for(var l,u,c,f,d=-1,h,p=l.length,g=r.value;++d<p;){for(u=l[d],c=u.children,f=u.value=0,h=c.length;f<h;++f)u.value+=c[f].value;u.dice?hm(u,i,s,a,g?s+=(o-s)*u.value/g:o):K2(u,i,s,g?i+=(a-i)*u.value/g:a,o),g-=u.value}else r._squarify=l=kG(t,r,i,s,a,o),l.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(EG);function O4(e,t,n){const r={};return e.each(i=>{const s=i.data;n(s)&&(r[t(s)]=i)}),e.lookup=r,e}function D8(e){G.call(this,null,e)}D8.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Hue=e=>e.values;ne(D8,G,{transform(e,t){t.source||H("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),s=this.value;return(!s||r||t.changed())&&(s&&s.each(a=>{a.children&&f2(a.data)&&i.rem.push(a.data)}),this.value=s=F8({values:le(e.keys).reduce((a,o)=>(a.key(o),a),Vue()).entries(i.source)},Hue),n&&s.each(a=>{a.children&&(a=Ue(a.data),i.add.push(a),i.source.push(a))}),O4(s,me,me)),i.source.root=s,i}});function Vue(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,s){if(s>=e.length)return i;const a=i.length,o=e[s++],l={},u={};let c=-1,f,d,h;for(;++c<a;)f=o(d=i[c])+"",(h=l[f])?h.push(d):l[f]=[d];for(f in l)u[f]=n(l[f],s);return u}function r(i,s){if(++s>e.length)return i;const a=[];for(const o in i)a.push({key:o,values:r(i[o],s)});return a}return t}function Ta(e){G.call(this,null,e)}const Jue=(e,t)=>e.parent===t.parent?1:2;ne(Ta,G,{transform(e,t){(!t.source||!t.source.root)&&H(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,s=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(Uc(e.sort,a=>a.data)),Yue(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Jue:Yd);try{this.value=n(i)}catch(a){H(a)}return i.each(a=>Xue(a,r,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function Yue(e,t,n){for(let r,i=0,s=t.length;i<s;++i)r=t[i],r in n&&e[r](n[r])}function Xue(e,t,n){const r=e.data,i=t.length-1;for(let s=0;s<i;++s)r[n[s]]=e[t[s]];r[n[i]]=e.children?e.children.length:0}const R4=["x","y","r","depth","children"];function O8(e){Ta.call(this,e)}O8.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:R4.length,default:R4}]};ne(O8,Ta,{layout:Tue,params:["radius","size","padding"],fields:R4});const P4=["x0","y0","x1","y1","depth","children"];function R8(e){Ta.call(this,e)}R8.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:P4.length,default:P4}]};ne(R8,Ta,{layout:Nue,params:["size","round","padding"],fields:P4});function P8(e){G.call(this,null,e)}P8.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};ne(P8,G,{transform(e,t){t.source||H("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),s=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),s&&(n=i.source.length?O4(JO().id(e.key).parentId(e.parentKey)(i.source),e.key,Zr):O4(JO()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const XO={tidy:Uue,cluster:Qle},I4=["x","y","depth","children"];function I8(e){Ta.call(this,e)}I8.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:I4.length,default:I4}]};ne(I8,Ta,{layout(e){const t=e||"tidy";if(ve(XO,t))return XO[t]();H("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:I4});function L8(e){G.call(this,[],e)}L8.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};ne(L8,G,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),s={};return r||H("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,a=>s[me(a)]=1),r.each(a=>{const o=a.data,l=a.parent&&a.parent.data;l&&s[me(o)]&&s[me(l)]&&i.add.push(Ue({source:l,target:o}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>s[me(a)]=1),n.forEach(a=>{(s[me(a.source)]||s[me(a.target)])&&i.mod.push(a)})),i}});const KO={binary:que,dice:hm,slice:K2,slicedice:Gue,squarify:SG,resquarify:Wue},L4=["x0","y0","x1","y1","depth","children"];function z8(e){Ta.call(this,e)}z8.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:L4.length,default:L4}]};ne(z8,Ta,{layout(){const e=jue();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ve(KO,t)?e.tile(KO[t]):H("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:L4});const Kue=Object.freeze(Object.defineProperty({__proto__:null,nest:D8,pack:O8,partition:R8,stratify:P8,tree:I8,treelinks:L8,treemap:z8},Symbol.toStringTag,{value:"Module"})),M5=4278190080;function Zue(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Que(e,t,n,r,i){const s=e.width,a=e.height,o=r||i,l=No(s,a).getContext("2d"),u=No(s,a).getContext("2d"),c=o&&No(s,a).getContext("2d");n.forEach(A=>av(l,A,!1)),av(u,t,!1),o&&av(c,t,!0);const f=T5(l,s,a),d=T5(u,s,a),h=o&&T5(c,s,a),p=e.bitmap(),g=o&&e.bitmap();let m,y,v,x,_,w,k,E;for(y=0;y<a;++y)for(m=0;m<s;++m)_=y*s+m,w=f[_]&M5,E=d[_]&M5,k=o&&h[_]&M5,(w||k||E)&&(v=e(m),x=e(y),!i&&(w||E)&&p.set(v,x),o&&(w||k)&&g.set(v,x));return[p,g]}function T5(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function av(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(s=>av(e,s.items,n))}):Ar[r].draw(e,{items:n?t.map(ece):t})}function ece(e){const t=d2(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const na=5,_n=31,S0=32,go=new Uint32Array(S0+1),xi=new Uint32Array(S0+1);xi[0]=0;go[0]=~xi[0];for(let e=1;e<=S0;++e)xi[e]=xi[e-1]<<1|1,go[e]=~xi[e];function tce(e,t){const n=new Uint32Array(~~((e*t+S0)/S0));function r(s,a){n[s]|=a}function i(s,a){n[s]&=a}return{array:n,get:(s,a)=>{const o=a*e+s;return n[o>>>na]&1<<(o&_n)},set:(s,a)=>{const o=a*e+s;r(o>>>na,1<<(o&_n))},clear:(s,a)=>{const o=a*e+s;i(o>>>na,~(1<<(o&_n)))},getRange:(s,a,o,l)=>{let u=l,c,f,d,h;for(;u>=a;--u)if(c=u*e+s,f=u*e+o,d=c>>>na,h=f>>>na,d===h){if(n[d]&go[c&_n]&xi[(f&_n)+1])return!0}else{if(n[d]&go[c&_n]||n[h]&xi[(f&_n)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,a,o,l)=>{let u,c,f,d,h;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>na,d=c>>>na,f===d)r(f,go[u&_n]&xi[(c&_n)+1]);else for(r(f,go[u&_n]),r(d,xi[(c&_n)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(s,a,o,l)=>{let u,c,f,d,h;for(;a<=l;++a)if(u=a*e+s,c=a*e+o,f=u>>>na,d=c>>>na,f===d)i(f,xi[u&_n]|go[(c&_n)+1]);else for(i(f,xi[u&_n]),i(d,go[(c&_n)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(s,a,o,l)=>s<0||a<0||l>=t||o>=e}}function nce(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),s=~~((t+2*n+r)/r),a=o=>~~((o+n)/r);return a.invert=o=>o*r-n,a.bitmap=()=>tce(i,s),a.ratio=r,a.padding=n,a.width=e,a.height=t,a}function rce(e,t,n,r){const i=e.width,s=e.height;return function(a){const o=a.datum.datum.items[r].items,l=o.length,u=a.datum.fontSize,c=Mi.width(a.datum,a.datum.text);let f=0,d,h,p,g,m,y,v;for(let x=0;x<l;++x)d=o[x].x,p=o[x].y,h=o[x].x2===void 0?d:o[x].x2,g=o[x].y2===void 0?p:o[x].y2,m=(d+h)/2,y=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=u/2,d=a.x-m,h=a.x+m,p=a.y-y,g=a.y+y,a.align="center",d<0&&h<=i?a.align="left":0<=d&&i<h&&(a.align="right"),a.baseline="middle",p<0&&g<=s?a.baseline="top":0<=p&&s<g&&(a.baseline="bottom"),!0}}function Sb(e,t,n,r,i,s){let a=n/2;return e-a<0||e+a>i||t-(a=r/2)<0||t+a>s}function Ao(e,t,n,r,i,s,a,o){const l=i*s/(r*2),u=e(t-l),c=e(t+l),f=e(n-(s=s/2)),d=e(n+s);return a.outOfBounds(u,f,c,d)||a.getRange(u,f,c,d)||o&&o.getRange(u,f,c,d)}function ice(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1];function l(u,c,f,d,h){const p=e.invert(u),g=e.invert(c);let m=f,y=s,v;if(!Sb(p,g,d,h,i,s)&&!Ao(e,p,g,h,d,m,a,o)&&!Ao(e,p,g,h,d,h,a,null)){for(;y-m>=1;)v=(m+y)/2,Ao(e,p,g,h,d,v,a,o)?y=v:m=v;if(m>f)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,h=Mi.width(u.datum,u.datum.text);let p=n?d:0,g=!1,m=!1,y=0,v,x,_,w,k,E,A,z,D,R,j,O,L,P,B,U,q;for(let X=0;X<f;++X){for(v=c[X].x,_=c[X].y,x=c[X].x2===void 0?v:c[X].x2,w=c[X].y2===void 0?_:c[X].y2,v>x&&(q=v,v=x,x=q),_>w&&(q=_,_=w,w=q),D=e(v),j=e(x),R=~~((D+j)/2),O=e(_),P=e(w),L=~~((O+P)/2),A=R;A>=D;--A)for(z=L;z>=O;--z)U=l(A,z,p,h,d),U&&([u.x,u.y,p,g]=U);for(A=R;A<=j;++A)for(z=L;z<=P;++z)U=l(A,z,p,h,d),U&&([u.x,u.y,p,g]=U);!g&&!n&&(B=Math.abs(x-v+w-_),k=(v+x)/2,E=(_+w)/2,B>=y&&!Sb(k,E,h,d,i,s)&&!Ao(e,k,E,d,h,d,a,null)&&(y=B,u.x=k,u.y=E,m=!0))}return g||m?(k=h/2,E=d/2,a.setRange(e(u.x-k),e(u.y-E),e(u.x+k),e(u.y+E)),u.align="center",u.baseline="middle",!0):!1}}const sce=[-1,-1,1,1],ace=[-1,1,-1,1];function oce(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[r].items,f=c.length,d=u.datum.fontSize,h=Mi.width(u.datum,u.datum.text),p=[];let g=n?d:0,m=!1,y=!1,v=0,x,_,w,k,E,A,z,D,R,j,O,L;for(let P=0;P<f;++P){for(x=c[P].x,w=c[P].y,_=c[P].x2===void 0?x:c[P].x2,k=c[P].y2===void 0?w:c[P].y2,p.push([e((x+_)/2),e((w+k)/2)]);p.length;)if([z,D]=p.pop(),!(a.get(z,D)||o.get(z,D)||l.get(z,D))){l.set(z,D);for(let B=0;B<4;++B)E=z+sce[B],A=D+ace[B],l.outOfBounds(E,A,E,A)||p.push([E,A]);if(E=e.invert(z),A=e.invert(D),R=g,j=s,!Sb(E,A,h,d,i,s)&&!Ao(e,E,A,d,h,R,a,o)&&!Ao(e,E,A,d,h,d,a,null)){for(;j-R>=1;)O=(R+j)/2,Ao(e,E,A,d,h,O,a,o)?j=O:R=O;R>g&&(u.x=E,u.y=A,g=R,m=!0)}}!m&&!n&&(L=Math.abs(_-x+k-w),E=(x+_)/2,A=(w+k)/2,L>=v&&!Sb(E,A,h,d,i,s)&&!Ao(e,E,A,d,h,d,a,null)&&(v=L,u.x=E,u.y=A,y=!0))}return m||y?(E=h/2,A=d/2,a.setRange(e(u.x-E),e(u.y-A),e(u.x+E),e(u.y+A)),u.align="center",u.baseline="middle",!0):!1}}const lce=["right","center","left"],uce=["bottom","middle","top"];function cce(e,t,n,r){const i=e.width,s=e.height,a=t[0],o=t[1],l=r.length;return function(u){const c=u.boundary,f=u.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>s)return!1;let d=u.textWidth??0,h,p,g,m,y,v,x,_,w,k,E,A,z,D,R;for(let j=0;j<l;++j){if(h=(n[j]&3)-1,p=(n[j]>>>2&3)-1,g=h===0&&p===0||r[j]<0,m=h&&p?Math.SQRT1_2:1,y=r[j]<0?-1:1,v=c[1+h]+r[j]*h*m,E=c[4+p]+y*f*p/2+r[j]*p*m,_=E-f/2,w=E+f/2,A=e(v),D=e(_),R=e(w),!d)if(ZO(A,A,D,R,a,o,v,v,_,w,c,g))d=Mi.width(u.datum,u.datum.text);else continue;if(k=v+y*d*h/2,v=k-d/2,x=k+d/2,A=e(v),z=e(x),ZO(A,z,D,R,a,o,v,x,_,w,c,g))return u.x=h?h*y<0?x:v:k,u.y=p?p*y<0?w:_:E,u.align=lce[h*y+1],u.baseline=uce[p*y+1],a.setRange(A,D,z,R),!0}return!1}}function ZO(e,t,n,r,i,s,a,o,l,u,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&s||i).getRange(e,n,t,r))}const N5=0,F5=4,D5=8,O5=0,R5=1,P5=2,fce={"top-left":N5+O5,top:N5+R5,"top-right":N5+P5,left:F5+O5,middle:F5+R5,right:F5+P5,"bottom-left":D5+O5,bottom:D5+R5,"bottom-right":D5+P5},dce={naive:rce,"reduced-search":ice,floodfill:oce};function hce(e,t,n,r,i,s,a,o,l,u,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=pce(r,f),h=gce(i,f),p=mce(e[0].datum),g=p==="group"&&e[0].datum.items[l].marktype,m=g==="area",y=yce(p,g,o,l),v=u===null||u===1/0,x=m&&c==="naive";let _=-1,w=-1;const k=e.map(D=>{const R=v?Mi.width(D,D.text):void 0;return _=Math.max(_,R),w=Math.max(w,D.fontSize),{datum:D,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(D),textWidth:R}});u=u===null||u===1/0?Math.max(_,w)+Math.max(...r):u;const E=nce(t[0],t[1],u);let A;if(!x){n&&k.sort((j,O)=>n(j.datum,O.datum));let D=!1;for(let j=0;j<h.length&&!D;++j)D=h[j]===5||d[j]<0;const R=(p&&a||m)&&e.map(j=>j.datum);A=s.length||R?Que(E,R||[],s,D,m):Zue(E,a&&k)}const z=m?dce[c](E,A,a,l):cce(E,A,h,d);return k.forEach(D=>D.opacity=+z(D)),k}function pce(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function gce(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=fce[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function mce(e){return e&&e.mark&&e.mark.marktype}function yce(e,t,n,r){const i=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>i(s.datum):t==="line"?s=>{const a=s.datum.items[r].items;return i(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:s=>{const a=s.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:i}const z4=["x","y","opacity","align","baseline"],AG=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function B8(e){G.call(this,null,e)}B8.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:AG},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:z4.length,default:z4}]};ne(B8,G,{transform(e,t){function n(s){const a=e[s];return $e(a)&&t.modified(a.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&H("Size parameter should be specified as a [width, height] array.");const i=e.as||z4;return hce(t.materialize(t.SOURCE).source||[],e.size,e.sort,le(e.offset==null?1:e.offset),le(e.anchor||AG),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const a=s.datum;a[i[0]]=s.x,a[i[1]]=s.y,a[i[2]]=s.opacity,a[i[3]]=s.align,a[i[4]]=s.baseline}),t.reflow(r).modifies(i)}});const vce=Object.freeze(Object.defineProperty({__proto__:null,label:B8},Symbol.toStringTag,{value:"Module"}));function $G(e,t){var n=[],r=function(c){return c(o)},i,s,a,o,l,u;if(t==null)n.push(e);else for(i={},s=0,a=e.length;s<a;++s)o=e[s],l=t.map(r),u=i[l],u||(i[l]=u=[],u.dims=l,n.push(u)),u.push(o);return n}function U8(e){G.call(this,null,e)}U8.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};ne(U8,G,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=$G(r,e.groupby),s=(e.groupby||[]).map(ft),a=s.length,o=e.as||[ft(e.x),ft(e.y)],l=[];i.forEach(u=>{Uz(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[s[d]]=u.dims[d];f[o[0]]=c[0],f[o[1]]=c[1],l.push(Ue(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const B4={constant:bC,linear:xC,log:Iz,exp:Lz,pow:zz,quad:wC,poly:Bz},bce=(e,t)=>e==="poly"?t:e==="quad"?2:1;function j8(e){G.call(this,null,e)}j8.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(B4)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};ne(j8,G,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=$G(r,e.groupby),s=(e.groupby||[]).map(ft),a=e.method||"linear",o=e.order==null?3:e.order,l=bce(a,o),u=e.as||[ft(e.x),ft(e.y)],c=B4[a],f=[];let d=e.extent;ve(B4,a)||H("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=l){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,o);if(e.params){f.push(Ue({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||ms(h,e.x),y=v=>{const x={};for(let _=0;_<s.length;++_)x[s[_]]=h.dims[_];x[u[0]]=v[0],x[u[1]]=v[1],f.push(Ue(x))};a==="linear"||a==="constant"?m.forEach(v=>y([v,g.predict(v)])):b2(g.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const xce=Object.freeze(Object.defineProperty({__proto__:null,loess:U8,regression:j8},Symbol.toStringTag,{value:"Module"})),va=11102230246251565e-32,Xt=134217729,wce=(3+8*va)*va;function I5(e,t,n,r,i){let s,a,o,l,u=t[0],c=r[0],f=0,d=0;c>u==c>-u?(s=u,u=t[++f]):(s=c,c=r[++d]);let h=0;if(f<e&&d<n)for(c>u==c>-u?(a=u+s,o=s-(a-u),u=t[++f]):(a=c+s,o=s-(a-c),c=r[++d]),s=a,o!==0&&(i[h++]=o);f<e&&d<n;)c>u==c>-u?(a=s+u,l=a-s,o=s-(a-l)+(u-l),u=t[++f]):(a=s+c,l=a-s,o=s-(a-l)+(c-l),c=r[++d]),s=a,o!==0&&(i[h++]=o);for(;f<e;)a=s+u,l=a-s,o=s-(a-l)+(u-l),u=t[++f],s=a,o!==0&&(i[h++]=o);for(;d<n;)a=s+c,l=a-s,o=s-(a-l)+(c-l),c=r[++d],s=a,o!==0&&(i[h++]=o);return(s!==0||h===0)&&(i[h++]=s),h}function _ce(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function pm(e){return new Float64Array(e)}const Ece=(3+16*va)*va,kce=(2+12*va)*va,Sce=(9+64*va)*va*va,Bf=pm(4),QO=pm(8),eR=pm(12),tR=pm(16),En=pm(4);function Ace(e,t,n,r,i,s,a){let o,l,u,c,f,d,h,p,g,m,y,v,x,_,w,k,E,A;const z=e-i,D=n-i,R=t-s,j=r-s;_=z*j,d=Xt*z,h=d-(d-z),p=z-h,d=Xt*j,g=d-(d-j),m=j-g,w=p*m-(_-h*g-p*g-h*m),k=R*D,d=Xt*R,h=d-(d-R),p=R-h,d=Xt*D,g=d-(d-D),m=D-g,E=p*m-(k-h*g-p*g-h*m),y=w-E,f=w-y,Bf[0]=w-(y+f)+(f-E),v=_+y,f=v-_,x=_-(v-f)+(y-f),y=x-k,f=x-y,Bf[1]=x-(y+f)+(f-k),A=v+y,f=A-v,Bf[2]=v-(A-f)+(y-f),Bf[3]=A;let O=_ce(4,Bf),L=kce*a;if(O>=L||-O>=L||(f=e-z,o=e-(z+f)+(f-i),f=n-D,u=n-(D+f)+(f-i),f=t-R,l=t-(R+f)+(f-s),f=r-j,c=r-(j+f)+(f-s),o===0&&l===0&&u===0&&c===0)||(L=Sce*a+wce*Math.abs(O),O+=z*c+j*o-(R*u+D*l),O>=L||-O>=L))return O;_=o*j,d=Xt*o,h=d-(d-o),p=o-h,d=Xt*j,g=d-(d-j),m=j-g,w=p*m-(_-h*g-p*g-h*m),k=l*D,d=Xt*l,h=d-(d-l),p=l-h,d=Xt*D,g=d-(d-D),m=D-g,E=p*m-(k-h*g-p*g-h*m),y=w-E,f=w-y,En[0]=w-(y+f)+(f-E),v=_+y,f=v-_,x=_-(v-f)+(y-f),y=x-k,f=x-y,En[1]=x-(y+f)+(f-k),A=v+y,f=A-v,En[2]=v-(A-f)+(y-f),En[3]=A;const P=I5(4,Bf,4,En,QO);_=z*c,d=Xt*z,h=d-(d-z),p=z-h,d=Xt*c,g=d-(d-c),m=c-g,w=p*m-(_-h*g-p*g-h*m),k=R*u,d=Xt*R,h=d-(d-R),p=R-h,d=Xt*u,g=d-(d-u),m=u-g,E=p*m-(k-h*g-p*g-h*m),y=w-E,f=w-y,En[0]=w-(y+f)+(f-E),v=_+y,f=v-_,x=_-(v-f)+(y-f),y=x-k,f=x-y,En[1]=x-(y+f)+(f-k),A=v+y,f=A-v,En[2]=v-(A-f)+(y-f),En[3]=A;const B=I5(P,QO,4,En,eR);_=o*c,d=Xt*o,h=d-(d-o),p=o-h,d=Xt*c,g=d-(d-c),m=c-g,w=p*m-(_-h*g-p*g-h*m),k=l*u,d=Xt*l,h=d-(d-l),p=l-h,d=Xt*u,g=d-(d-u),m=u-g,E=p*m-(k-h*g-p*g-h*m),y=w-E,f=w-y,En[0]=w-(y+f)+(f-E),v=_+y,f=v-_,x=_-(v-f)+(y-f),y=x-k,f=x-y,En[1]=x-(y+f)+(f-k),A=v+y,f=A-v,En[2]=v-(A-f)+(y-f),En[3]=A;const U=I5(B,eR,4,En,tR);return tR[U-1]}function Ay(e,t,n,r,i,s){const a=(t-s)*(n-i),o=(e-i)*(r-s),l=a-o;if(a===0||o===0||a>0!=o>0)return l;const u=Math.abs(a+o);return Math.abs(l)>=Ece*u?l:-Ace(e,t,n,r,i,s,u)}const nR=Math.pow(2,-52),$y=new Uint32Array(512);class Ab{static from(t,n=Nce,r=Fce){const i=t.length,s=new Float64Array(i*2);for(let a=0;a<i;a++){const o=t[a];s[2*a]=n(o),s[2*a+1]=r(o)}return new Ab(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,a=t.length>>1;let o=1/0,l=1/0,u=-1/0,c=-1/0;for(let D=0;D<a;D++){const R=t[2*D],j=t[2*D+1];R<o&&(o=R),j<l&&(l=j),R>u&&(u=R),j>c&&(c=j),this._ids[D]=D}const f=(o+u)/2,d=(l+c)/2;let h=1/0,p,g,m;for(let D=0;D<a;D++){const R=L5(f,d,t[2*D],t[2*D+1]);R<h&&(p=D,h=R)}const y=t[2*p],v=t[2*p+1];h=1/0;for(let D=0;D<a;D++){if(D===p)continue;const R=L5(y,v,t[2*D],t[2*D+1]);R<h&&R>0&&(g=D,h=R)}let x=t[2*g],_=t[2*g+1],w=1/0;for(let D=0;D<a;D++){if(D===p||D===g)continue;const R=Mce(y,v,x,_,t[2*D],t[2*D+1]);R<w&&(m=D,w=R)}let k=t[2*m],E=t[2*m+1];if(w===1/0){for(let j=0;j<a;j++)this._dists[j]=t[2*j]-t[0]||t[2*j+1]-t[1];td(this._ids,this._dists,0,a-1);const D=new Uint32Array(a);let R=0;for(let j=0,O=-1/0;j<a;j++){const L=this._ids[j];this._dists[L]>O&&(D[R++]=L,O=this._dists[L])}this.hull=D.subarray(0,R),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Ay(y,v,x,_,k,E)<0){const D=g,R=x,j=_;g=m,x=k,_=E,m=D,k=R,E=j}const A=Tce(y,v,x,_,k,E);this._cx=A.x,this._cy=A.y;for(let D=0;D<a;D++)this._dists[D]=L5(t[2*D],t[2*D+1],A.x,A.y);td(this._ids,this._dists,0,a-1),this._hullStart=p;let z=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,s.fill(-1),s[this._hashKey(y,v)]=p,s[this._hashKey(x,_)]=g,s[this._hashKey(k,E)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let D=0,R,j;D<this._ids.length;D++){const O=this._ids[D],L=t[2*O],P=t[2*O+1];if(D>0&&Math.abs(L-R)<=nR&&Math.abs(P-j)<=nR||(R=L,j=P,O===p||O===g||O===m))continue;let B=0;for(let fe=0,we=this._hashKey(L,P);fe<this._hashSize&&(B=s[(we+fe)%this._hashSize],!(B!==-1&&B!==r[B]));fe++);B=n[B];let U=B,q;for(;q=r[U],Ay(L,P,t[2*U],t[2*U+1],t[2*q],t[2*q+1])>=0;)if(U=q,U===B){U=-1;break}if(U===-1)continue;let X=this._addTriangle(U,O,r[U],-1,-1,i[U]);i[O]=this._legalize(X+2),i[U]=X,z++;let ae=r[U];for(;q=r[ae],Ay(L,P,t[2*ae],t[2*ae+1],t[2*q],t[2*q+1])<0;)X=this._addTriangle(ae,O,q,i[O],-1,i[ae]),i[O]=this._legalize(X+2),r[ae]=ae,z--,ae=q;if(U===B)for(;q=n[U],Ay(L,P,t[2*q],t[2*q+1],t[2*U],t[2*U+1])<0;)X=this._addTriangle(q,O,U,-1,i[U],i[q]),this._legalize(X+2),i[q]=X,r[U]=U,z--,U=q;this._hullStart=n[O]=U,r[U]=n[ae]=O,r[O]=ae,s[this._hashKey(L,P)]=O,s[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(z);for(let D=0,R=this._hullStart;D<z;D++)this.hull[D]=R,R=r[R];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor($ce(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,a=0;for(;;){const o=r[t],l=t-t%3;if(a=l+(t+2)%3,o===-1){if(s===0)break;t=$y[--s];continue}const u=o-o%3,c=l+(t+1)%3,f=u+(o+2)%3,d=n[a],h=n[t],p=n[c],g=n[f];if(Cce(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[o]=d;const y=r[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(o,r[a]),this._link(a,f);const v=u+(o+1)%3;s<$y.length&&($y[s++]=v)}else{if(s===0)break;t=$y[--s]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,s,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=r,this._link(o,i),this._link(o+1,s),this._link(o+2,a),this.trianglesLen+=3,o}}function $ce(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function L5(e,t,n,r){const i=e-n,s=t-r;return i*i+s*s}function Cce(e,t,n,r,i,s,a,o){const l=e-a,u=t-o,c=n-a,f=r-o,d=i-a,h=s-o,p=l*l+u*u,g=c*c+f*f,m=d*d+h*h;return l*(f*m-g*h)-u*(c*m-g*d)+p*(c*h-f*d)<0}function Mce(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,d=.5/(a*u-o*l),h=(u*c-o*f)*d,p=(a*f-l*c)*d;return h*h+p*p}function Tce(e,t,n,r,i,s){const a=n-e,o=r-t,l=i-e,u=s-t,c=a*a+o*o,f=l*l+u*u,d=.5/(a*u-o*l),h=e+(u*c-o*f)*d,p=t+(a*f-l*c)*d;return{x:h,y:p}}function td(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=e[i],a=t[s];let o=i-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=s}else{const i=n+r>>1;let s=n+1,a=r;fg(e,i,s),t[e[n]]>t[e[r]]&&fg(e,n,r),t[e[s]]>t[e[r]]&&fg(e,s,r),t[e[n]]>t[e[s]]&&fg(e,n,s);const o=e[s],l=t[o];for(;;){do s++;while(t[e[s]]<l);do a--;while(t[e[a]]>l);if(a<s)break;fg(e,s,a)}e[n+1]=e[a],e[a]=o,r-s+1>=a-n?(td(e,t,s,r),td(e,t,n,a-1)):(td(e,t,n,a-1),td(e,t,s,r))}}function fg(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Nce(e){return e[0]}function Fce(e){return e[1]}const rR=1e-6;class tc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>rR||Math.abs(this._y1-s)>rR)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class U4{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let Dce=class{constructor(t,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let s,a;const o=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,m=0,y=r.length,v,x;g<y;g+=3,m+=2){const _=r[g]*2,w=r[g+1]*2,k=r[g+2]*2,E=t[_],A=t[_+1],z=t[w],D=t[w+1],R=t[k],j=t[k+1],O=z-E,L=D-A,P=R-E,B=j-A,U=(O*B-L*P)*2;if(Math.abs(U)<1e-9){if(s===void 0){s=a=0;for(const X of n)s+=t[X*2],a+=t[X*2+1];s/=n.length,a/=n.length}const q=1e9*Math.sign((s-E)*B-(a-A)*P);v=(E+R)/2-q*B,x=(A+j)/2+q*P}else{const q=1/U,X=O*O+L*L,ae=P*P+B*B;v=E+(B*X-L*ae)*q,x=A+(O*ae-P*X)*q}o[m]=v,o[m+1]=x}let l=n[n.length-1],u,c=l*4,f,d=t[2*l],h,p=t[2*l+1];i.fill(0);for(let g=0;g<n.length;++g)l=n[g],u=c,f=d,h=p,c=l*4,d=t[2*l],p=t[2*l+1],i[u+2]=i[c]=h-p,i[u+3]=i[c+1]=d-f}render(t){const n=t==null?t=new tc:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:a,vectors:o}=this;if(s.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=a[h],m=a[h+1],y=a[p],v=a[p+1];this._renderSegment(g,m,y,v,t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const f=Math.floor(i[u]/3)*2,d=a[f],h=a[f+1],p=l*4,g=this._project(d,h,o[p+2],o[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new tc:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new tc:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let a=2;a<s;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new U4;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,s){let a;const o=this._regioncode(t,n),l=this._regioncode(r,i);o===0&&l===0?(s.moveTo(t,n),s.lineTo(r,i)):(a=this._clipSegment(t,n,r,i,o,l))&&(s.moveTo(a[0],a[1]),s.lineTo(a[2],a[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let s=0,a=n.length;s<a;s+=2)for(let o=0,l=i.length;o<l;o+=2)if(n[s]===i[o]&&n[s+1]===i[o+1]&&n[(s+2)%a]===i[(o+l-2)%l]&&n[(s+3)%a]===i[(o+l-1)%l]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,a=r[t];if(a===-1)return null;const o=[];let l=a;do{const u=Math.floor(l/3);if(o.push(n[u*2],n[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==t)break;l=i[l]}while(l!==a&&l!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,s,a,o=n[r-2],l=n[r-1],u,c=this._regioncode(o,l),f,d=0;for(let h=0;h<r;h+=2)if(s=o,a=l,o=n[h],l=n[h+1],u=c,c=this._regioncode(o,l),u===0&&c===0)f=d,d=0,i?i.push(o,l):i=[o,l];else{let p,g,m,y,v;if(u===0){if((p=this._clipSegment(s,a,o,l,u,c))===null)continue;[g,m,y,v]=p}else{if((p=this._clipSegment(o,l,s,a,c,u))===null)continue;[y,v,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(y,v):i=[y,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,s,a){const o=s<a;for(o&&([t,n,r,i,s,a]=[r,i,t,n,a,s]);;){if(s===0&&a===0)return o?[r,i,t,n]:[t,n,r,i];if(s&a)return null;let l,u,c=s||a;c&8?(l=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):c&4?(l=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):c&2?(u=n+(i-n)*(this.xmax-t)/(r-t),l=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),l=this.xmin),s?(t=l,n=u,s=this._regioncode(t,n)):(r=l,i=u,a=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,s,a){let o=Array.from(n),l;if((l=this._project(o[0],o[1],r,i))&&o.unshift(l[0],l[1]),(l=this._project(o[o.length-2],o[o.length-1],s,a))&&o.push(l[0],l[1]),o=this._clipFinite(t,o))for(let u=0,c=o.length,f,d=this._edgecode(o[c-2],o[c-1]);u<c;u+=2)f=d,d=this._edgecode(o[u],o[u+1]),f&&d&&(u=this._edge(t,f,d,o,u),c=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,r,i,s){for(;n!==r;){let a,o;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,o=this.ymin;break}(i[s]!==a||i[s+1]!==o)&&this.contains(t,a,o)&&(i.splice(s,0,a,o),s+=2)}return s}_project(t,n,r,i){let s=1/0,a,o,l;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<s&&(l=this.ymin,o=t+(s=a)*r)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<s&&(l=this.ymax,o=t+(s=a)*r)}if(r>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/r)<s&&(o=this.xmax,l=n+(s=a)*i)}else if(r<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/r)<s&&(o=this.xmin,l=n+(s=a)*i)}return[o,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const Oce=2*Math.PI,Uf=Math.pow;function Rce(e){return e[0]}function Pce(e){return e[1]}function Ice(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],s=2*t[r+1],a=2*t[r+2];if((n[a]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function Lce(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class q8{static from(t,n=Rce,r=Pce,i){return new q8("length"in t?zce(t,n,r,i):Float64Array.from(Bce(t,n,r,i)))}constructor(t){this._delaunator=new Ab(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Ice(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=Lce(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new Ab(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(r[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,u=i.length;l<u;++l)o[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],a[i[0]]=1,i.length===2&&(a[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new Dce(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:a,collinear:o}=this;if(o){const f=o.indexOf(t);f>0&&(yield o[f-1]),f<o.length-1&&(yield o[f+1]);return}const l=n[t];if(l===-1)return;let u=l,c=-1;do{if(yield c=a[u],u=u%3===2?u-2:u+1,a[u]!==t)return;if(u=s[u],u===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(u!==l)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,t,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(t,n,r){const{inedges:i,hull:s,_hullIndex:a,halfedges:o,triangles:l,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let c=t,f=Uf(n-u[t*2],2)+Uf(r-u[t*2+1],2);const d=i[t];let h=d;do{let p=l[h];const g=Uf(n-u[p*2],2)+Uf(r-u[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,l[h]!==t)break;if(h=o[h],h===-1){if(h=s[(a[t]+1)%s.length],h!==p&&Uf(n-u[h*2],2)+Uf(r-u[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new tc:void 0,{points:r,halfedges:i,triangles:s}=this;for(let a=0,o=i.length;a<o;++a){const l=i[a];if(l<a)continue;const u=s[a]*2,c=s[l]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new tc:void 0,{points:i}=this;for(let s=0,a=i.length;s<a;s+=2){const o=i[s],l=i[s+1];t.moveTo(o+n,l),t.arc(o,l,n,0,Oce)}return r&&r.value()}renderHull(t){const n=t==null?t=new tc:void 0,{hull:r,points:i}=this,s=r[0]*2,a=r.length;t.moveTo(i[s],i[s+1]);for(let o=1;o<a;++o){const l=2*r[o];t.lineTo(i[l],i[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new U4;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new tc:void 0,{points:i,triangles:s}=this,a=s[t*=3]*2,o=s[t+1]*2,l=s[t+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[o],i[o+1]),n.lineTo(i[l],i[l+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new U4;return this.renderTriangle(t,n),n.value()}}function zce(e,t,n,r){const i=e.length,s=new Float64Array(i*2);for(let a=0;a<i;++a){const o=e[a];s[a*2]=t.call(r,o,a,e),s[a*2+1]=n.call(r,o,a,e)}return s}function*Bce(e,t,n,r){let i=0;for(const s of e)yield t.call(r,s,i,e),yield n.call(r,s,i,e),++i}function G8(e){G.call(this,null,e)}G8.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Uce=[-1e5,-1e5,1e5,1e5];ne(G8,G,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Uce;const s=this.value=q8.from(r,e.x,e.y).voronoi(i);for(let a=0,o=r.length;a<o;++a){const l=s.cellPolygon(a);r[a][n]=l?jce(l):null}return t.reflow(e.modified()).modifies(n)}});function jce(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const qce=Object.freeze(Object.defineProperty({__proto__:null,voronoi:G8},Symbol.toStringTag,{value:"Module"}));var z5=Math.PI/180,qg=1<<11>>5,ov=1<<11;function Gce(){var e=[256,256],t,n,r,i,s,a,o,l=CG,u=[],c=Math.random,f={};f.layout=function(){for(var p=d(No()),g=Xce((e[0]>>5)*e[1]),m=null,y=u.length,v=-1,x=[],_=u.map(k=>({text:t(k),font:n(k),style:i(k),weight:s(k),rotate:a(k),size:~~(r(k)+1e-14),padding:o(k),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:k})).sort((k,E)=>E.size-k.size);++v<y;){var w=_[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Wce(p,w,_,v),w.hasText&&h(g,w,m)&&(x.push(w),m?Vce(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return x};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(qg<<5)/g,p.height=ov/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var y=g.x,v=g.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),_=l(e),w=c()<.5?1:-1,k=-w,E,A,z;(E=_(k+=w))&&(A=~~E[0],z=~~E[1],!(Math.min(Math.abs(A),Math.abs(z))>=x));)if(g.x=y+A,g.y=v+z,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!Hce(g,p,e[0]))&&(!m||Jce(g,m))){for(var D=g.sprite,R=g.width>>5,j=e[0]>>5,O=g.x-(R<<4),L=O&127,P=32-L,B=g.y1-g.y0,U=(g.y+g.y0)*j+(O>>5),q,X=0;X<B;X++){q=0;for(var ae=0;ae<=R;ae++)p[U+ae]|=q<<P|(ae<R?(q=D[X*R+ae])>>>L:0);U+=j}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(u=p,f):u},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Du(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Du(p),f):i},f.fontWeight=function(p){return arguments.length?(s=Du(p),f):s},f.rotate=function(p){return arguments.length?(a=Du(p),f):a},f.text=function(p){return arguments.length?(t=Du(p),f):t},f.spiral=function(p){return arguments.length?(l=Kce[p]||p,f):l},f.fontSize=function(p){return arguments.length?(r=Du(p),f):r},f.padding=function(p){return arguments.length?(o=Du(p),f):o},f.random=function(p){return arguments.length?(c=p,f):c},f}function Wce(e,t,n,r){if(!t.sprite){var i=e.context,s=e.ratio;i.clearRect(0,0,(qg<<5)/s,ov/s);var a=0,o=0,l=0,u=n.length,c,f,d,h,p;for(--r;++r<u;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=i.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*z5),m=Math.cos(t.rotate*z5),y=c*m,v=c*g,x=d*m,_=d*g;c=Math.max(Math.abs(y+_),Math.abs(y-_))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>l&&(l=d),a+c>=qg<<5&&(a=0,o+=l,l=0),o+d>=ov)break;i.translate((a+(c>>1))/s,(o+(d>>1))/s),t.rotate&&i.rotate(t.rotate*z5),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=o,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var w=i.getImageData(0,0,(qg<<5)/s,ov/s).data,k=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)k[h]=0;if(a=t.xoff,a==null)return;o=t.yoff;var E=0,A=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var z=f*p+(h>>5),D=w[(o+p)*(qg<<5)+(a+h)<<2]?1<<31-h%32:0;k[z]|=D,E|=D}E?A=p:(t.y0++,d--,p--,o++)}t.y1=t.y0+A,t.sprite=k.slice(0,(t.y1-t.y0)*f)}}}function Hce(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,s=e.x-(i<<4),a=s&127,o=32-a,l=e.y1-e.y0,u=(e.y+e.y0)*n+(s>>5),c,f=0;f<l;f++){c=0;for(var d=0;d<=i;d++)if((c<<o|(d<i?(c=r[f*i+d])>>>a:0))&t[u+d])return!0;u+=n}return!1}function Vce(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Jce(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function CG(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Yce(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(s){var a=s<0?-1:1;switch(Math.sqrt(1+4*a*s)-a&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Xce(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Du(e){return typeof e=="function"?e:function(){return e}}var Kce={archimedean:CG,rectangular:Yce};const MG=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Zce=["text","font","rotate","fontSize","fontStyle","fontWeight"];function W8(e){G.call(this,Gce(),e)}W8.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:MG}]};ne(W8,G,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&H("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return $e(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||Zce.some(n)))return;const i=t.materialize(t.SOURCE).source,s=this.value,a=e.as||MG;let o=e.fontSize||14,l;if($e(o)?l=e.fontSizeRange:o=cn(o),l){const p=o,g=ze("sqrt")().domain(ms(i,p)).range(l);o=m=>g(p(m))}i.forEach(p=>{p[a[0]]=NaN,p[a[1]]=NaN,p[a[3]]=0});const u=s.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(o).random(ei).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=u.length;for(let p=0,g,m;p<h;++p)g=u[p],m=g.datum,m[a[0]]=g.x+f,m[a[1]]=g.y+d,m[a[2]]=g.font,m[a[3]]=g.size,m[a[4]]=g.style,m[a[5]]=g.weight,m[a[6]]=g.rotate;return t.reflow(r).modifies(a)}});const Qce=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:W8},Symbol.toStringTag,{value:"Module"})),efe=e=>new Uint8Array(e),tfe=e=>new Uint16Array(e),n0=e=>new Uint32Array(e);function nfe(){let e=8,t=[],n=n0(0),r=Cy(0,e),i=Cy(0,e);return{data:()=>t,seen:()=>n=rfe(n,t.length),add(s){for(let a=0,o=t.length,l=s.length,u;a<l;++a)u=s[a],u._index=o++,t.push(u)},remove(s,a){const o=t.length,l=Array(o-s),u=t;let c,f,d;for(f=0;!a[f]&&f<o;++f)l[f]=t[f],u[f]=f;for(d=f;f<o;++f)c=t[f],a[f]?u[f]=-1:(u[f]=d,r[d]=r[f],i[d]=i[f],l[d]=c,c._index=d++),r[f]=0;return t=l,u},size:()=>t.length,curr:()=>r,prev:()=>i,reset:s=>i[s]=r[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,a){r[s]|=a},clear(s,a){r[s]&=~a},resize(s,a){const o=r.length;(s>o||a>e)&&(e=Math.max(a,e),r=Cy(s,e,r),i=Cy(s,e))}}}function rfe(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Cy(e,t,n){const r=(t<257?efe:t<65537?tfe:n0)(e);return n&&r.set(n),r}function iR(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,s){const a=this,o=a.bisect(a.range,i.value),l=i.index,u=o[0],c=o[1],f=l.length;let d;for(d=0;d<u;++d)s[l[d]]|=r;for(d=c;d<f;++d)s[l[d]]|=r;return a}}}function sR(){let e=n0(0),t=[],n=0;function r(o,l,u){if(!l.length)return[];const c=n,f=l.length,d=n0(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=o(l[m]),d[m]=m;if(h=ife(h,d),c)p=t,g=e,t=Array(c+f),e=n0(c+f),sfe(u,p,g,c,h,d,f,t,e);else{if(u>0)for(m=0;m<f;++m)d[m]+=u;t=h,e=d}return n=c+f,{index:d,value:h}}function i(o,l){const u=n;let c,f,d;for(f=0;!l[e[f]]&&f<u;++f);for(d=f;f<u;++f)l[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=u-o}function s(o){for(let l=0,u=n;l<u;++l)e[l]=o[e[l]]}function a(o,l){let u;return l?u=l.length:(l=t,u=n),[EX(l,o[0],0,u),xv(l,o[1],0,u)]}return{insert:r,remove:i,bisect:a,reindex:s,index:()=>e,size:()=>n}}function ife(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],s=e[r];return i<s?-1:i>s?1:0}),AX(e,t)}function sfe(e,t,n,r,i,s,a,o,l){let u=0,c=0,f;for(f=0;u<r&&c<a;++f)t[u]<i[c]?(o[f]=t[u],l[f]=n[u++]):(o[f]=i[c],l[f]=s[c++]+e);for(;u<r;++u,++f)o[f]=t[u],l[f]=n[u];for(;c<a;++c,++f)o[f]=i[c],l[f]=s[c]+e}function H8(e){G.call(this,nfe(),e),this._indices=null,this._dims=null}H8.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};ne(H8,G,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},s=this._dims=[],a=r.length;let o=0,l,u;for(;o<a;++o)l=n[o].fname,u=i[l]||(i[l]=sR()),s.push(iR(u,o,r[o]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,s=this._indices,a=this._dims,o=this.value,l=o.curr(),u=o.prev(),c=o.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,y,v,x,_,w,k,E;if(u.set(l),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&o.add(t.add),t.mod.length)for(_={},v=t.mod,w=0,k=v.length;w<k;++w)_[v[w]._index]=1;for(w=0;w<h;++w)E=r[w],(!a[w]||e.modified("fields",w)||t.modified(E.fields))&&(y=E.fname,(g=p[y])||(s[y]=m=sR(),p[y]=g=m.insert(E,t.source,0)),a[w]=iR(m,w,i[w]).onAdd(g,l));for(w=0,k=o.data().length;w<k;++w)x[w]||(u[w]!==l[w]?f.push(w):_[w]&&l[w]!==c&&d.push(w));return o.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,s=this._dims,a=this._indices,o=e.fields,l={},u=n.add,c=i.size()+r.length,f=s.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(h=0;h<f;++h)p=o[h].fname,g=l[p]||(l[p]=a[p].insert(o[h],r,d)),s[h].onAdd(g,m);for(;d<c;++d)y[d]=v,m[d]!==v&&u.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),s=r.all(),a=e.mod;let o,l,u;for(o=0,l=a.length;o<l;++o)u=a[o]._index,i[u]!==s&&n.push(u)},remove(e,t,n){const r=this._indices,i=this.value,s=i.curr(),a=i.prev(),o=i.all(),l={},u=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,a[h]=p=s[h],s[h]=o,p!==o&&u.push(h);for(h in r)r[h].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const s=i.remove(t,n);for(const a in r)r[a].reindex(s)})},update(e,t,n){const r=this._dims,i=e.query,s=t.stamp,a=r.length;let o=0,l,u;for(n.filters=0,u=0;u<a;++u)e.modified("query",u)&&(l=u,++o);if(o===1)o=r[l].one,this.incrementOne(r[l],i[l],n.add,n.rem);else for(u=0,o=0;u<a;++u)e.modified("query",u)&&(o|=r[u].one,this.incrementAll(r[u],i[u],s,n.add),n.rem=n.add);return o},incrementAll(e,t,n,r){const i=this.value,s=i.seen(),a=i.curr(),o=i.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=u[0],p=u[1],g=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=l[m],s[v]!==n&&(o[v]=a[v],s[v]=n,r.push(v)),a[v]^=g;else if(f>h)for(m=h,y=Math.min(f,p);m<y;++m)v=l[m],s[v]!==n&&(o[v]=a[v],s[v]=n,r.push(v)),a[v]^=g;if(d>p)for(m=Math.max(f,p),y=d;m<y;++m)v=l[m],s[v]!==n&&(o[v]=a[v],s[v]=n,r.push(v)),a[v]^=g;else if(d<p)for(m=Math.max(h,d),y=p;m<y;++m)v=l[m],s[v]!==n&&(o[v]=a[v],s[v]=n,r.push(v)),a[v]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,s=i.curr(),a=e.index(),o=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=o[0],d=o[1],h=e.one;let p,g,m;if(u<f)for(p=u,g=Math.min(f,c);p<g;++p)m=a[p],s[m]^=h,n.push(m);else if(u>f)for(p=f,g=Math.min(u,d);p<g;++p)m=a[p],s[m]^=h,r.push(m);if(c>d)for(p=Math.max(u,d),g=c;p<g;++p)m=a[p],s[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=a[p],s[m]^=h,r.push(m);e.range=t.slice()}});function V8(e){G.call(this,null,e)}V8.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};ne(V8,G,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const s=t.fork(t.ALL),a=r.data(),o=r.curr(),l=r.prev(),u=c=>o[c]&n?null:a[c];return s.filter(s.MOD,u),i&i-1?(s.filter(s.ADD,c=>{const f=o[c]&n;return!f&&f^l[c]&n?a[c]:null}),s.filter(s.REM,c=>{const f=o[c]&n;return f&&!(f^(f^l[c]&n))?a[c]:null})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(o[c]&n)===i?a[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const afe=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:H8,resolvefilter:V8},Symbol.toStringTag,{value:"Module"})),ofe="RawCode",xc="Literal",lfe="Property",ufe="Identifier",cfe="ArrayExpression",ffe="BinaryExpression",TG="CallExpression",dfe="ConditionalExpression",hfe="LogicalExpression",pfe="MemberExpression",gfe="ObjectExpression",mfe="UnaryExpression";function Li(e){this.type=e}Li.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=yfe(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function yfe(e){switch(e.type){case cfe:return e.elements;case ffe:case hfe:return[e.left,e.right];case TG:return[e.callee].concat(e.arguments);case dfe:return[e.test,e.consequent,e.alternate];case pfe:return[e.object,e.property];case gfe:return e.properties;case lfe:return[e.key,e.value];case mfe:return[e.argument];case ufe:case xc:case ofe:default:return[]}}var Ts,de,W,on,Ve,Z2=1,gm=2,wc=3,nl=4,Q2=5,Wc=6,qn=7,mm=8,vfe=9;Ts={};Ts[Z2]="Boolean";Ts[gm]="<end>";Ts[wc]="Identifier";Ts[nl]="Keyword";Ts[Q2]="Null";Ts[Wc]="Numeric";Ts[qn]="Punctuator";Ts[mm]="String";Ts[vfe]="RegularExpression";var bfe="ArrayExpression",xfe="BinaryExpression",wfe="CallExpression",_fe="ConditionalExpression",NG="Identifier",Efe="Literal",kfe="LogicalExpression",Sfe="MemberExpression",Afe="ObjectExpression",$fe="Property",Cfe="UnaryExpression",Ft="Unexpected token %0",Mfe="Unexpected number",Tfe="Unexpected string",Nfe="Unexpected identifier",Ffe="Unexpected reserved word",Dfe="Unexpected end of input",j4="Invalid regular expression",B5="Invalid regular expression: missing /",FG="Octal literals are not allowed in strict mode.",Ofe="Duplicate data property in object literal not allowed in strict mode",Ut="ILLEGAL",A0="Disabled.",Rfe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Pfe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ex(e,t){if(!e)throw new Error("ASSERT: "+t)}function oa(e){return e>=48&&e<=57}function J8(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function r0(e){return"01234567".indexOf(e)>=0}function Ife(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function $0(e){return e===10||e===13||e===8232||e===8233}function ym(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Rfe.test(String.fromCharCode(e))}function $b(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Pfe.test(String.fromCharCode(e))}const Lfe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function DG(){for(;W<on;){const e=de.charCodeAt(W);if(Ife(e)||$0(e))++W;else break}}function q4(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)W<on&&J8(de[W])?(r=de[W++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Ie({},Ft,Ut);return String.fromCharCode(i)}function zfe(){var e,t,n,r;for(e=de[W],t=0,e==="}"&&Ie({},Ft,Ut);W<on&&(e=de[W++],!!J8(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Ie({},Ft,Ut),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function OG(){var e,t;for(e=de.charCodeAt(W++),t=String.fromCharCode(e),e===92&&(de.charCodeAt(W)!==117&&Ie({},Ft,Ut),++W,e=q4("u"),(!e||e==="\\"||!ym(e.charCodeAt(0)))&&Ie({},Ft,Ut),t=e);W<on&&(e=de.charCodeAt(W),!!$b(e));)++W,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),de.charCodeAt(W)!==117&&Ie({},Ft,Ut),++W,e=q4("u"),(!e||e==="\\"||!$b(e.charCodeAt(0)))&&Ie({},Ft,Ut),t+=e);return t}function Bfe(){var e,t;for(e=W++;W<on;){if(t=de.charCodeAt(W),t===92)return W=e,OG();if($b(t))++W;else break}return de.slice(e,W)}function Ufe(){var e,t,n;return e=W,t=de.charCodeAt(W)===92?OG():Bfe(),t.length===1?n=wc:Lfe.hasOwnProperty(t)?n=nl:t==="null"?n=Q2:t==="true"||t==="false"?n=Z2:n=wc,{type:n,value:t,start:e,end:W}}function U5(){var e=W,t=de.charCodeAt(W),n,r=de[W],i,s,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++W,{type:qn,value:String.fromCharCode(t),start:e,end:W};default:if(n=de.charCodeAt(W+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return W+=2,{type:qn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:W};case 33:case 61:return W+=2,de.charCodeAt(W)===61&&++W,{type:qn,value:de.slice(e,W),start:e,end:W}}}if(a=de.substr(W,4),a===">>>=")return W+=4,{type:qn,value:a,start:e,end:W};if(s=a.substr(0,3),s===">>>"||s==="<<="||s===">>=")return W+=3,{type:qn,value:s,start:e,end:W};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return W+=2,{type:qn,value:i,start:e,end:W};if(i==="//"&&Ie({},Ft,Ut),"<>=!+-*%&|^/".indexOf(r)>=0)return++W,{type:qn,value:r,start:e,end:W};Ie({},Ft,Ut)}function jfe(e){let t="";for(;W<on&&J8(de[W]);)t+=de[W++];return t.length===0&&Ie({},Ft,Ut),ym(de.charCodeAt(W))&&Ie({},Ft,Ut),{type:Wc,value:parseInt("0x"+t,16),start:e,end:W}}function qfe(e){let t="0"+de[W++];for(;W<on&&r0(de[W]);)t+=de[W++];return(ym(de.charCodeAt(W))||oa(de.charCodeAt(W)))&&Ie({},Ft,Ut),{type:Wc,value:parseInt(t,8),octal:!0,start:e,end:W}}function aR(){var e,t,n;if(n=de[W],ex(oa(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=W,e="",n!=="."){if(e=de[W++],n=de[W],e==="0"){if(n==="x"||n==="X")return++W,jfe(t);if(r0(n))return qfe(t);n&&oa(n.charCodeAt(0))&&Ie({},Ft,Ut)}for(;oa(de.charCodeAt(W));)e+=de[W++];n=de[W]}if(n==="."){for(e+=de[W++];oa(de.charCodeAt(W));)e+=de[W++];n=de[W]}if(n==="e"||n==="E")if(e+=de[W++],n=de[W],(n==="+"||n==="-")&&(e+=de[W++]),oa(de.charCodeAt(W)))for(;oa(de.charCodeAt(W));)e+=de[W++];else Ie({},Ft,Ut);return ym(de.charCodeAt(W))&&Ie({},Ft,Ut),{type:Wc,value:parseFloat(e),start:t,end:W}}function Gfe(){var e="",t,n,r,i,s=!1;for(t=de[W],ex(t==="'"||t==='"',"String literal must starts with a quote"),n=W,++W;W<on;)if(r=de[W++],r===t){t="";break}else if(r==="\\")if(r=de[W++],!r||!$0(r.charCodeAt(0)))switch(r){case"u":case"x":de[W]==="{"?(++W,e+=zfe()):e+=q4(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:r0(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),W<on&&r0(de[W])&&(s=!0,i=i*8+"01234567".indexOf(de[W++]),"0123".indexOf(r)>=0&&W<on&&r0(de[W])&&(i=i*8+"01234567".indexOf(de[W++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&de[W]===`
`&&++W;else{if($0(r.charCodeAt(0)))break;e+=r}return t!==""&&Ie({},Ft,Ut),{type:mm,value:e,octal:s,start:n,end:W}}function Wfe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";Ie({},j4)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Ie({},j4)}try{return new RegExp(e,t)}catch{return null}}function Hfe(){var e,t,n,r,i;for(e=de[W],ex(e==="/","Regular expression literal must start with a slash"),t=de[W++],n=!1,r=!1;W<on;)if(e=de[W++],t+=e,e==="\\")e=de[W++],$0(e.charCodeAt(0))&&Ie({},B5),t+=e;else if($0(e.charCodeAt(0)))Ie({},B5);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Ie({},B5),i=t.substr(1,t.length-2),{value:i,literal:t}}function Vfe(){var e,t,n;for(t="",n="";W<on&&(e=de[W],!!$b(e.charCodeAt(0)));)++W,e==="\\"&&W<on?Ie({},Ft,Ut):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Ie({},j4,n),{value:n,literal:t}}function Jfe(){var e,t,n,r;return Ve=null,DG(),e=W,t=Hfe(),n=Vfe(),r=Wfe(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:W}}function Yfe(e){return e.type===wc||e.type===nl||e.type===Z2||e.type===Q2}function RG(){if(DG(),W>=on)return{type:gm,start:W,end:W};const e=de.charCodeAt(W);return ym(e)?Ufe():e===40||e===41||e===59?U5():e===39||e===34?Gfe():e===46?oa(de.charCodeAt(W+1))?aR():U5():oa(e)?aR():U5()}function Vn(){const e=Ve;return W=e.end,Ve=RG(),W=e.end,e}function PG(){const e=W;Ve=RG(),W=e}function Xfe(e){const t=new Li(bfe);return t.elements=e,t}function oR(e,t,n){const r=new Li(e==="||"||e==="&&"?kfe:xfe);return r.operator=e,r.left=t,r.right=n,r}function Kfe(e,t){const n=new Li(wfe);return n.callee=e,n.arguments=t,n}function Zfe(e,t,n){const r=new Li(_fe);return r.test=e,r.consequent=t,r.alternate=n,r}function Y8(e){const t=new Li(NG);return t.name=e,t}function Gg(e){const t=new Li(Efe);return t.value=e.value,t.raw=de.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function lR(e,t,n){const r=new Li(Sfe);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function Qfe(e){const t=new Li(Afe);return t.properties=e,t}function uR(e,t,n){const r=new Li($fe);return r.key=t,r.value=n,r.kind=e,r}function ede(e,t){const n=new Li(Cfe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Ie(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,a)=>(ex(a<r.length,"Message reference must be in range"),r[a]));throw n=new Error(i),n.index=W,n.description=i,n}function tx(e){e.type===gm&&Ie(e,Dfe),e.type===Wc&&Ie(e,Mfe),e.type===mm&&Ie(e,Tfe),e.type===wc&&Ie(e,Nfe),e.type===nl&&Ie(e,Ffe),Ie(e,Ft,e.value)}function ln(e){const t=Vn();(t.type!==qn||t.value!==e)&&tx(t)}function nt(e){return Ve.type===qn&&Ve.value===e}function j5(e){return Ve.type===nl&&Ve.value===e}function tde(){const e=[];for(W=Ve.start,ln("[");!nt("]");)nt(",")?(Vn(),e.push(null)):(e.push(_c()),nt("]")||ln(","));return Vn(),Xfe(e)}function cR(){W=Ve.start;const e=Vn();return e.type===mm||e.type===Wc?(e.octal&&Ie(e,FG),Gg(e)):Y8(e.value)}function nde(){var e,t,n,r;if(W=Ve.start,e=Ve,e.type===wc)return n=cR(),ln(":"),r=_c(),uR("init",n,r);if(e.type===gm||e.type===qn)tx(e);else return t=cR(),ln(":"),r=_c(),uR("init",t,r)}function rde(){var e=[],t,n,r,i={},s=String;for(W=Ve.start,ln("{");!nt("}");)t=nde(),t.key.type===NG?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Ie({},Ofe):i[r]=!0,e.push(t),nt("}")||ln(",");return ln("}"),Qfe(e)}function ide(){ln("(");const e=X8();return ln(")"),e}const sde={if:1};function ade(){var e,t,n;if(nt("("))return ide();if(nt("["))return tde();if(nt("{"))return rde();if(e=Ve.type,W=Ve.start,e===wc||sde[Ve.value])n=Y8(Vn().value);else if(e===mm||e===Wc)Ve.octal&&Ie(Ve,FG),n=Gg(Vn());else{if(e===nl)throw new Error(A0);e===Z2?(t=Vn(),t.value=t.value==="true",n=Gg(t)):e===Q2?(t=Vn(),t.value=null,n=Gg(t)):nt("/")||nt("/=")?(n=Gg(Jfe()),PG()):tx(Vn())}return n}function ode(){const e=[];if(ln("("),!nt(")"))for(;W<on&&(e.push(_c()),!nt(")"));)ln(",");return ln(")"),e}function lde(){W=Ve.start;const e=Vn();return Yfe(e)||tx(e),Y8(e.value)}function ude(){return ln("."),lde()}function cde(){ln("[");const e=X8();return ln("]"),e}function fde(){var e,t,n;for(e=ade();;)if(nt("."))n=ude(),e=lR(".",e,n);else if(nt("("))t=ode(),e=Kfe(e,t);else if(nt("["))n=cde(),e=lR("[",e,n);else break;return e}function fR(){const e=fde();if(Ve.type===qn&&(nt("++")||nt("--")))throw new Error(A0);return e}function lv(){var e,t;if(Ve.type!==qn&&Ve.type!==nl)t=fR();else{if(nt("++")||nt("--"))throw new Error(A0);if(nt("+")||nt("-")||nt("~")||nt("!"))e=Vn(),t=lv(),t=ede(e.value,t);else{if(j5("delete")||j5("void")||j5("typeof"))throw new Error(A0);t=fR()}}return t}function dR(e){let t=0;if(e.type!==qn&&e.type!==nl)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function dde(){var e,t,n,r,i,s,a,o,l,u;if(e=Ve,l=lv(),r=Ve,i=dR(r),i===0)return l;for(r.prec=i,Vn(),t=[e,Ve],a=lv(),s=[l,r,a];(i=dR(Ve))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)a=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),n=oR(o,l,a),s.push(n);r=Vn(),r.prec=i,s.push(r),t.push(Ve),n=lv(),s.push(n)}for(u=s.length-1,n=s[u],t.pop();u>1;)t.pop(),n=oR(s[u-1].value,s[u-2],n),u-=2;return n}function _c(){var e,t,n;return e=dde(),nt("?")&&(Vn(),t=_c(),ln(":"),n=_c(),e=Zfe(e,t,n)),e}function X8(){const e=_c();if(nt(","))throw new Error(A0);return e}function K8(e){de=e,W=0,on=de.length,Ve=null,PG();const t=X8();if(Ve.type!==gm)throw new Error("Unexpect token after expression.");return t}var IG={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function LG(e){function t(a,o,l,u){let c=e(o[0]);return l&&(c=l+"("+c+")",l.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(u<0?"":u===0?"()":"("+o.slice(1).map(e).join(",")+")")}function n(a,o,l){return u=>t(a,u,o,l)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&H("Missing arguments to clamp function."),a.length>3&&H("Too many arguments to clamp function.");const o=a.map(e);return"Math.max("+o[1]+", Math.min("+o[2]+","+o[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(a){a.length<3&&H("Missing arguments to if function."),a.length>3&&H("Too many arguments to if function.");const o=a.map(e);return"("+o[0]+"?"+o[1]+":"+o[2]+")"}}}function hde(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function zG(e){e=e||{};const t=e.allowed?Di(e.allowed):{},n=e.forbidden?Di(e.forbidden):{},r=e.constants||IG,i=(e.functions||LG)(f),s=e.globalvar,a=e.fieldvar,o=$e(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if(oe(p))return p;const g=d[p.type];return g==null&&H("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ve(n,g)?H("Illegal identifier: "+g):ve(r,g)?r[g]:ve(t,g)?g:(l[g]=1,o(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const y=f(p.property);return m===a&&(u[hde(y)]=1),g&&(c-=1),m+(g?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&H("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,y=ve(i,g)&&i[g];return y||H("Unrecognized function: "+g),$e(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return h.functions=i,h.constants=r,h}function q5(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pde(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function gde(e){let t,n,r;e.length!==2?(t=q5,n=(o,l)=>q5(e(o),l),r=(o,l)=>e(o)-l):(t=e===q5||e===pde?e:mde,n=e,r=e);function i(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<0?u=f+1:c=f}while(u<c)}return u}function s(o,l,u=0,c=o.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(o[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(o,l,u=0,c=o.length){const f=i(o,l,u,c-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function mde(){return 0}function yde(e,...t){e=new wv(e),t=t.map(vde);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function vde(e){return e instanceof wv?e:new wv(e)}function bde(...e){const t=new wv;for(const n of e)for(const r of n)t.add(r);return t}const Z8="intersect",hR="union",xde="vlMulti",wde="vlPoint",pR="or",_de="and",rs="_vgsid_",C0=Qn(rs),Ede="E",kde="R",Sde="R-E",Ade="R-LE",$de="R-RE",Cb="index:unit";function gR(e,t){for(var n=t.fields,r=t.values,i=n.length,s=0,a,o;s<i;++s)if(o=n[s],o.getter=Qn.getter||Qn(o.field),a=o.getter(e),Co(a)&&(a=tn(a)),Co(r[s])&&(r[s]=tn(r[s])),Co(r[s][0])&&(r[s]=r[s].map(tn)),o.type===Ede){if(Y(r[s])?r[s].indexOf(a)<0:a!==r[s])return!1}else if(o.type===kde){if(!Kf(a,r[s]))return!1}else if(o.type===$de){if(!Kf(a,r[s],!0,!1))return!1}else if(o.type===Sde){if(!Kf(a,r[s],!1,!1))return!1}else if(o.type===Ade&&!Kf(a,r[s],!1,!0))return!1;return!0}function Cde(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],s=r?r[Cb]&&r[Cb].value:void 0,a=n===Z8,o=i.length,l=0,u,c,f,d,h;l<o;++l)if(u=i[l],s&&a){if(c=c||{},f=c[d=u.unit]||0,f===-1)continue;if(h=gR(t,u),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=gR(t,u),a^h)return h;return o&&a}const BG=gde(C0),Mde=BG.left,Tde=BG.right;function Nde(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],s=r?r[Cb]&&r[Cb].value:void 0,a=n===Z8,o=C0(t),l=Mde(i,o);if(l===i.length||C0(i[l])!==o)return!1;if(s&&a){if(s.size===1)return!0;if(Tde(i,o)-l<s.size)return!1}return!0}function Fde(e,t){return e.map(n=>Ae(t.fields?{values:t.fields.map(r=>(r.getter||(r.getter=Qn(r.field)))(n.datum))}:{[rs]:C0(n.datum)},t))}function Dde(e,t,n,r){for(var i=this.context.data[e],s=i?i.values.value:[],a={},o={},l={},u,c,f,d,h,p,g,m,y,v,x=s.length,_=0,w,k;_<x;++_)if(u=s[_],d=u.unit,c=u.fields,f=u.values,c&&f){for(w=0,k=c.length;w<k;++w)h=c[w],g=a[h.field]||(a[h.field]={}),m=g[d]||(g[d]=[]),l[h.field]=y=h.type.charAt(0),v=G5[`${y}_union`],g[d]=v(m,le(f[w]));n&&(m=o[d]||(o[d]=[]),m.push(le(f).reduce((E,A,z)=>(E[c[z].field]=A,E),{})))}else h=rs,p=C0(u),g=a[h]||(a[h]={}),m=g[d]||(g[d]=[]),m.push(p),n&&(m=o[d]||(o[d]=[]),m.push({[rs]:p}));if(t=t||hR,a[rs]?a[rs]=G5[`${rs}_${t}`](...Object.values(a[rs])):Object.keys(a).forEach(E=>{a[E]=Object.keys(a[E]).map(A=>a[E][A]).reduce((A,z)=>A===void 0?z:G5[`${l[E]}_${t}`](A,z))}),s=Object.keys(o),n&&s.length){const E=r?wde:xde;a[E]=t===hR?{[pR]:s.reduce((A,z)=>(A.push(...o[z]),A),[])}:{[_de]:s.map(A=>({[pR]:o[A]}))}}return a}var G5={[`${rs}_union`]:bde,[`${rs}_intersect`]:yde,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=tn(t[0]),r=tn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=tn(t[0]),r=tn(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Ode=":",Rde="@";function Q8(e,t,n,r){t[0].type!==xc&&H("First argument to selection functions must be a string literal.");const i=t[0].value,s=t.length>=2&&Oe(t).value,a="unit",o=Rde+a,l=Ode+i;s===Z8&&!ve(r,o)&&(r[o]=n.getData(i).indataRef(n,a)),ve(r,l)||(r[l]=n.getData(i).tuplesRef())}function UG(e){const t=this.context.data[e];return t?t.values.value:[]}function Pde(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function Ide(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(Zr).insert(t)),1}function Lde(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const vm=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},zde=vm("format"),jG=vm("timeFormat"),Bde=vm("utcFormat"),Ude=vm("timeParse"),jde=vm("utcParse"),My=new Date(2e3,0,1);function nx(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(My.setYear(2e3),My.setMonth(e),My.setDate(t),jG.call(this,My,n))}function qde(e){return nx.call(this,e,1,"%B")}function Gde(e){return nx.call(this,e,1,"%b")}function Wde(e){return nx.call(this,0,2+e,"%A")}function Hde(e){return nx.call(this,0,2+e,"%a")}const Vde=":",Jde="@",G4="%",qG="$";function e6(e,t,n,r){t[0].type!==xc&&H("First argument to data functions must be a string literal.");const i=t[0].value,s=Vde+i;if(!ve(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function Yde(e,t,n,r){t[0].type!==xc&&H("First argument to indata must be a string literal."),t[1].type!==xc&&H("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,a=Jde+s;ve(a,r)||(r[a]=n.getData(i).indataRef(n,s))}function Yn(e,t,n,r){if(t[0].type===xc)mR(n,r,t[0].value);else for(e in n.scales)mR(n,r,e)}function mR(e,t,n){const r=G4+n;if(!ve(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Na(e,t){if($e(e))return e;if(oe(e)){const n=t.scales[e];return n&&tne(n.value)?n.value:void 0}}function Xde(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Yn,n._range=Yn,n._scale=Yn;const r=i=>"_["+(i.type===xc?te(G4+i.value):te(G4)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function t6(e,t){return function(n,r,i){if(n){const s=Na(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const Kde=t6("area",gae),Zde=t6("bounds",bae),Qde=t6("centroid",Sae);function ehe(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function n6(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function the(){return n6(this.context.dataflow,"warn",arguments)}function nhe(){return n6(this.context.dataflow,"info",arguments)}function rhe(){return n6(this.context.dataflow,"debug",arguments)}function W5(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function W4(e){const t=Lo(e),n=W5(t.r),r=W5(t.g),i=W5(t.b);return .2126*n+.7152*r+.0722*i}function ihe(e,t){const n=W4(e),r=W4(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function she(){const e=[].slice.call(arguments);return e.unshift({}),Ae(...e)}function GG(e,t){return e===t||e!==e&&t!==t?!0:Y(e)?Y(t)&&e.length===t.length?ahe(e,t):!1:ce(e)&&ce(t)?WG(e,t):!1}function ahe(e,t){for(let n=0,r=e.length;n<r;++n)if(!GG(e[n],t[n]))return!1;return!0}function WG(e,t){for(const n in e)if(!GG(e[n],t[n]))return!1;return!0}function yR(e){return t=>WG(e,t)}function ohe(e,t,n,r,i,s){const a=this.context.dataflow,o=this.context.data[e],l=o.input,u=a.stamp();let c=o.changes,f,d;if(a._trigger===!1||!(l.value.length||t||r))return 0;if((!c||c.stamp<u)&&(o.changes=c=a.changeset(),c.stamp=u,a.runAfter(()=>{o.modified=!0,a.pulse(l,c).run()},!0,1)),n&&(f=n===!0?Zr:Y(n)||f2(n)?n:yR(n),c.remove(f)),t&&c.insert(t),r&&(f=yR(r),l.value.some(f)?c.remove(f):c.insert(r)),i)for(d in s)c.modify(i,d,s[d]);return 1}function lhe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.hypot(n,r)}function uhe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const vR={};function che(e,t){const n=vR[t]||(vR[t]=Qn(t));return Y(e)?e.map(n):n(e)}function r6(e){return Y(e)||ArrayBuffer.isView(e)?e:null}function i6(e){return r6(e)||(oe(e)?e:null)}function fhe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return r6(e).join(...n)}function dhe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i6(e).indexOf(...n)}function hhe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i6(e).lastIndexOf(...n)}function phe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i6(e).slice(...n)}function ghe(e,t,n){return $e(n)&&H("Function argument passed to replace."),String(e).replace(t,n)}function mhe(e){return r6(e).slice().reverse()}function yhe(e,t,n){return h9(e||0,t||0,n||0)}function vhe(e,t){const n=Na(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function bhe(e,t){const n=Na(e,(t||this).context);return n?n.copy():void 0}function xhe(e,t){const n=Na(e,(t||this).context);return n?n.domain():[]}function whe(e,t,n){const r=Na(e,(n||this).context);return r?Y(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function _he(e,t){const n=Na(e,(t||this).context);return n&&n.range?n.range():[]}function Ehe(e,t,n){const r=Na(e,(n||this).context);return r?r(t):void 0}function khe(e,t,n,r,i){e=Na(e,(i||this).context);const s=qU(t,n);let a=e.domain(),o=a[0],l=Oe(a),u=un;return l-o?u=NU(e,o,l):e=(e.interpolator?ze("sequential")().interpolator(e.interpolator()):ze("linear")().interpolate(e.interpolate()).range(e.range())).domain([o=0,l=1]),e.ticks&&(a=e.ticks(+r||15),o!==a[0]&&a.unshift(o),l!==Oe(a)&&a.push(l)),a.forEach(c=>s.stop(u(c),e(c))),s}function She(e,t,n){const r=Na(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Ahe(e){let t=null;return function(n){return n?v0(n,t=t||$d(e)):e}}const HG=e=>e.data;function VG(e,t){const n=UG.call(t,e);return n.root&&n.root.lookup||{}}function $he(e,t,n){const r=VG(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(HG):void 0}function Che(e,t){const n=VG(e,this)[t];return n?n.ancestors().map(HG):void 0}const JG=()=>typeof window<"u"&&window||null;function Mhe(){const e=JG();return e?e.screen:{}}function The(){const e=JG();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Nhe(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function YG(e,t,n){if(!e)return[];const[r,i]=e,s=new mt().set(r[0],r[1],i[0],i[1]),a=n||this.context.dataflow.scenegraph().root;return Dj(a,s,Fhe(t))}function Fhe(e){let t=null;if(e){const n=le(e.marktype),r=le(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}function Dhe(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=le(e);const i=e[e.length-1];return i===void 0||Math.hypot(i[0]-t,i[1]-n)>r?[...e,[t,n]]:e}function Ohe(e){return le(e).reduce((t,n,r)=>{let[i,s]=n;return t+=r==0?`M ${i},${s} `:r===e.length-1?" Z":`L ${i},${s} `},"")}function Rhe(e,t,n){const{x:r,y:i,mark:s}=n,a=new mt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<a.x1&&(a.x1=l),l>a.x2&&(a.x2=l),u<a.y1&&(a.y1=u),u>a.y2&&(a.y2=u);return a.translate(r,i),YG([[a.x1,a.y1],[a.x2,a.y2]],e,s).filter(l=>Phe(l.x,l.y,t))}function Phe(e,t,n){let r=0;for(let i=0,s=n.length-1;i<n.length;s=i++){const[a,o]=n[s],[l,u]=n[i];u>t!=o>t&&e<(a-l)*(t-u)/(o-u)+l&&r++}return r&1}const M0={random(){return ei()},cumulativeNormal:m2,cumulativeLogNormal:hC,cumulativeUniform:yC,densityNormal:lC,densityLogNormal:dC,densityUniform:mC,quantileNormal:y2,quantileLogNormal:pC,quantileUniform:vC,sampleNormal:g2,sampleLogNormal:fC,sampleUniform:gC,isArray:Y,isBoolean:Ko,isDate:Co,isDefined(e){return e!==void 0},isNumber:Ye,isObject:ce,isRegExp:cL,isString:oe,isTuple:f2,isValid(e){return e!=null&&e===e},toBoolean:U$,toDate(e){return j$(e)},toNumber:tn,toString:q$,indexof:dhe,join:fhe,lastindexof:hhe,replace:ghe,reverse:mhe,slice:phe,flush:lL,lerp:fL,merge:she,pad:pL,peek:Oe,pluck:che,span:G0,inrange:Kf,truncate:gL,rgb:Lo,lab:Rv,hcl:Pv,hsl:Dv,luminance:W4,contrast:ihe,sequence:_r,format:zde,utcFormat:Bde,utcParse:jde,utcOffset:JL,utcSequence:KL,timeFormat:jG,timeParse:Ude,timeOffset:VL,timeSequence:XL,timeUnitSpecifier:PL,monthFormat:qde,monthAbbrevFormat:Gde,dayFormat:Wde,dayAbbrevFormat:Hde,quarter:iL,utcquarter:sL,week:LL,utcweek:UL,dayofyear:IL,utcdayofyear:BL,warn:the,info:nhe,debug:rhe,extent(e){return ms(e)},inScope:ehe,intersect:YG,clampRange:aL,pinchDistance:lhe,pinchAngle:uhe,screen:Mhe,containerSize:Nhe,windowSize:The,bandspace:yhe,setdata:Ide,pathShape:Ahe,panLinear:eL,panLog:tL,panPow:nL,panSymlog:rL,zoomLinear:R$,zoomLog:P$,zoomPow:bv,zoomSymlog:I$,encode:Lde,modify:ohe,lassoAppend:Dhe,lassoPath:Ohe,intersectLasso:Rhe},Ihe=["view","item","group","xy","x","y"],Lhe="event.vega.",XG="this.",s6={},KG={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${te(qG+e)}]`,functions:zhe,constants:IG,visitors:s6},H4=zG(KG);function zhe(e){const t=LG(e);Ihe.forEach(n=>t[n]=Lhe+n);for(const n in M0)t[n]=XG+n;return Ae(t,Xde(e,M0,s6)),t}function vt(e,t,n){return arguments.length===1?M0[e]:(M0[e]=t,n&&(s6[e]=n),H4&&(H4.functions[e]=XG+e),this)}vt("bandwidth",vhe,Yn);vt("copy",bhe,Yn);vt("domain",xhe,Yn);vt("range",_he,Yn);vt("invert",whe,Yn);vt("scale",Ehe,Yn);vt("gradient",khe,Yn);vt("geoArea",Kde,Yn);vt("geoBounds",Zde,Yn);vt("geoCentroid",Qde,Yn);vt("geoShape",She,Yn);vt("indata",Pde,Yde);vt("data",UG,e6);vt("treePath",$he,e6);vt("treeAncestors",Che,e6);vt("vlSelectionTest",Cde,Q8);vt("vlSelectionIdTest",Nde,Q8);vt("vlSelectionResolve",Dde,Q8);vt("vlSelectionTuples",Fde);function ws(e,t){const n={};let r;try{e=oe(e)?e:te(e)+"",r=K8(e)}catch{H("Expression parse error: "+e)}r.visit(s=>{if(s.type!==TG)return;const a=s.callee.name,o=KG.visitors[a];o&&o(a,s.arguments,t,n)});const i=H4(r);return i.globals.forEach(s=>{const a=qG+s;!ve(n,a)&&t.getSignal(s)&&(n[a]=t.signalRef(s))}),{$expr:Ae({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function Bhe(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const Uhe=Di(["rule"]),bR=Di(["group","image","rect"]);function jhe(e,t){let n="";return Uhe[t]||(e.x2&&(e.x?(bR[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(bR[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function a6(e){return(e+"").toLowerCase()}function qhe(e){return a6(e)==="operator"}function Ghe(e){return a6(e)==="collect"}function dg(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Whe(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var Hhe={operator:(e,t)=>dg(e,["_"],t.code),parameter:(e,t)=>dg(e,["datum","_"],t.code),event:(e,t)=>dg(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return dg(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const s in r){const a="o["+te(s)+"]";i+=`$=${r[s].code};if(${a}!==$)${a}=$,m=1;`}return i+=jhe(r,n),i+="return m;",dg(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(te).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(s,a)=>{const o=t[a];let l,u;return s.path?(l=`a${s.path}`,u=`b${s.path}`):((n=n||{})["f"+a]=s,l=`this.f${a}(a)`,u=`this.f${a}(b)`),Whe(l,u,-o,o)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Vhe(e){const t=this;qhe(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Jhe(e){const t=this;if(e.params){const n=t.get(e.id);n||H("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Yhe(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=Y(i)?i.map(s=>xR(s,n,t)):xR(i,n,t)}return t}function xR(e,t,n){if(!e||!ce(e))return e;for(let r=0,i=wR.length,s;r<i;++r)if(s=wR[r],ve(e,s.key))return s.parse(e,t,n);return e}var wR=[{key:"$ref",parse:Xhe},{key:"$key",parse:Zhe},{key:"$expr",parse:Khe},{key:"$field",parse:Qhe},{key:"$encode",parse:tpe},{key:"$compare",parse:epe},{key:"$context",parse:npe},{key:"$subflow",parse:rpe},{key:"$tupleid",parse:ipe}];function Xhe(e,t){return t.get(e.$ref)||H("Operator not defined: "+e.$ref)}function Khe(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=ar(t.parameterExpression(e.$expr),e.$fields))}function Zhe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=B$(e.$key,e.$flat,t.expr.codegen))}function Qhe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Qn(e.$field,e.$name,t.expr.codegen))}function epe(e,t){const n="c:"+e.$compare+"_"+e.$order,r=le(e.$compare).map(i=>i&&i.$tupleid?me:i);return t.fn[n]||(t.fn[n]=L$(r,e.$order,t.expr.codegen))}function tpe(e,t){const n=e.$encode,r={};for(const i in n){const s=n[i];r[i]=ar(t.encodeExpression(s.$expr),s.$fields),r[i].output=s.$output}return r}function npe(e,t){return t}function rpe(e,t){const n=e.$subflow;return function(r,i,s){const a=t.fork().parse(n),o=a.get(n.operators[0].id),l=a.signals.parent;return l&&l.set(s),o.detachSubflow=()=>t.detach(a),o}}function ipe(){return me}function spe(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(s=>t.get(s)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(s=>t.get(s)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&H("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function ape(e){var t=this,n=ce(n=e.source)?n.$ref:n,r=t.get(n),i=null,s=e.update,a=void 0;r||H("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(a=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,r,i,s,a)}const ope={skip:!0};function lpe(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(s=>{const a=t.signals[s];e.signals(s,a)&&(r[s]=a.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(s=>{const a=t.data[s];e.data(s,a)&&(i[s]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function upe(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(s=>{n.update(t.signals[s],i[s],ope)}),Object.keys(r||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Zr).insert(r[s]))}),(e.subcontext||[]).forEach((s,a)=>{const o=t.subcontext[a];o&&o.setState(s)})}function ZG(e,t,n,r){return new QG(e,t,n,r)}function QG(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Hhe,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function _R(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}QG.prototype=_R.prototype={fork(){const e=new _R(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),Ghe(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const a=n.data[s]||(n.data[s]={});e.data[s].forEach(o=>a[o]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[a6(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Bhe,parseOperator:Vhe,parseOperatorParameters:Jhe,parseParameters:Yhe,parseStream:spe,parseUpdate:ape,getState:lpe,setState:upe};function cpe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),eW(t,e.description()))}function eW(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function fpe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const H5="default";function dpe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:H5,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,s=i?oe(i)?i:i.user:H5,a=r.item&&r.item.cursor||null;return i&&s===i.user&&a==i.item?i:{user:s,item:a}}),e.add(null,function(n){let r=n.cursor,i=this.value;return oe(r)||(i=r.item,r=r.user),V4(e,r&&r!==H5?r:i||r),i},{cursor:t})}function V4(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Mb(e,t){var n=e._runtime.data;return ve(n,t)||H("Unrecognized data set: "+t),n[t]}function hpe(e,t){return arguments.length<2?Mb(this,e).values.value:rx.call(this,e,jc().remove(Zr).insert(t))}function rx(e,t){kz(t)||H("Second argument to changes must be a changeset.");const n=Mb(this,e);return n.modified=!0,this.pulse(n.input,t)}function ppe(e,t){return rx.call(this,e,jc().insert(t))}function gpe(e,t){return rx.call(this,e,jc().remove(t))}function tW(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function nW(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function ix(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function mpe(e){var t=ix(e),n=tW(e),r=nW(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(s){e.error(s)}})}function ype(e,t,n){var r=e._renderer,i=r&&r.canvas(),s,a,o;return i&&(o=ix(e),a=t.changedTouches?t.changedTouches[0]:t,s=G2(a,i),s[0]-=o[0],s[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=vpe(e,n,s),t}function vpe(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(a){var o=r,l;if(a){for(l=t;l;l=l.mark.group)if(l.mark.name===a){o=l;break}}return o&&o.mark&&o.mark.interactive?o:{}}function s(a){if(!a)return n;oe(a)&&(a=i(a));const o=n.slice();for(;a;)o[0]-=a.x||0,o[1]-=a.y||0,a=a.mark&&a.mark.group;return o}return{view:cn(e),item:cn(t||{}),group:i,xy:s,x:a=>s(a)[0],y:a=>s(a)[1]}}const ER="view",bpe="timer",xpe="window",wpe={trap:!1};function _pe(e){const t=Ae({defaults:{}},e),n=(r,i)=>{i.forEach(s=>{Y(r[s])&&(r[s]=Di(r[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function rW(e,t,n,r){e._eventListeners.push({type:n,sources:le(t),handler:r})}function Epe(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function Ty(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||ce(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function kpe(e,t,n){var r=this,i=new p2(n),s=function(u,c){r.runAsync(null,()=>{e===ER&&Epe(r,t)&&u.preventDefault(),i.receive(ype(r,u,c))})},a;if(e===bpe)Ty(r,"timer",t)&&r.timer(s,t);else if(e===ER)Ty(r,"view",t)&&r.addEventListener(t,s,wpe);else if(e===xpe?Ty(r,"window",t)&&typeof window<"u"&&(a=[window]):typeof document<"u"&&Ty(r,"selector",t)&&(a=Array.from(document.querySelectorAll(e))),!a)r.warn("Can not resolve event source: "+e);else{for(var o=0,l=a.length;o<l;++o)a[o].addEventListener(t,s);rW(r,a,t,s)}return i}function kR(e){return e.item}function SR(e){return e.item.mark.source}function AR(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Spe(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",kR),SR,AR(e)),this.on(this.events("view","mouseout",kR),SR,AR(t)),this}function Ape(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,s;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(s=n[r],i=s.sources.length;--i>=0;)s.sources[i].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function Er(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const $pe="vega-bind",Cpe="vega-bind-name",Mpe="vega-bind-radio";function Tpe(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,a)})}},r.debounce&&(i.update=z$(r.debounce,i.update))),(r.input==null&&r.element?Npe:Dpe)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Npe(e,t,n,r){const i=n.event||"input",s=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,s),rW(r,t,i,s),e.set=a=>{t.value=a,t.dispatchEvent(Fpe(i))}}function Fpe(e){return typeof Event<"u"?new Event(e):{type:e}}function Dpe(e,t,n,r){const i=r.signal(n.signal),s=Er("div",{class:$pe}),a=n.input==="radio"?s:s.appendChild(Er("label"));a.appendChild(Er("span",{class:Cpe},n.name||n.signal)),t.appendChild(s);let o=Ope;switch(n.input){case"checkbox":o=Rpe;break;case"select":o=Ppe;break;case"radio":o=Ipe;break;case"range":o=Lpe;break}o(e,a,n,i)}function Ope(e,t,n,r){const i=Er("input");for(const s in n)s!=="signal"&&s!=="element"&&i.setAttribute(s==="input"?"type":s,n[s]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=s=>i.value=s}function Rpe(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const s=Er("input",i);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=a=>s.checked=!!a||null}function Ppe(e,t,n,r){const i=Er("select",{name:n.signal}),s=n.labels||[];n.options.forEach((a,o)=>{const l={value:a};Tb(a,r)&&(l.selected=!0),i.appendChild(Er("option",l,(s[o]||a)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=a=>{for(let o=0,l=n.options.length;o<l;++o)if(Tb(n.options[o],a)){i.selectedIndex=o;return}}}function Ipe(e,t,n,r){const i=Er("span",{class:Mpe}),s=n.labels||[];t.appendChild(i),e.elements=n.options.map((a,o)=>{const l={type:"radio",name:n.signal,value:a};Tb(a,r)&&(l.checked=!0);const u=Er("input",l);u.addEventListener("change",()=>e.update(a));const c=Er("label",{},(s[o]||a)+"");return c.prepend(u),i.appendChild(c),u}),e.set=a=>{const o=e.elements,l=o.length;for(let u=0;u<l;++u)Tb(o[u].value,a)&&(o[u].checked=!0)}}function Lpe(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,i,+r)||0,a=n.step||Ro(s,i,100),o=Er("input",{type:"range",name:n.signal,min:s,max:i,step:a});o.value=r;const l=Er("span",{},+r);t.appendChild(o),t.appendChild(l);const u=()=>{l.textContent=o.value,e.update(+o.value)};o.addEventListener("input",u),o.addEventListener("change",u),e.elements=[o],e.set=c=>{o.value=c,l.textContent=c}}function Tb(e,t){return e===t||e+""==t+""}function iW(e,t,n,r,i,s){return t=t||new r(e.loader()),t.initialize(n,tW(e),nW(e),ix(e),i,s).background(e.background())}function o6(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function zpe(e,t,n,r){const i=new r(e.loader(),o6(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,ix(e),e);return t&&t.handlers().forEach(s=>{i.on(s.type,s.handler)}),i}function Bpe(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,s=W2(r);e=n._el=e?V5(n,e,!0):null,cpe(n),s||n.error("Unrecognized renderer type: "+r);const a=s.handler||cm,o=e?s.renderer:s.headless;return n._renderer=o?iW(n,n._renderer,e,o):null,n._handler=zpe(n,n._handler,e,a),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=V5(n,t,!0):e.appendChild(Er("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&i!=="container"&&(l.element=V5(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{Tpe(n,l.element||t,l)})),n}function V5(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(r){t=null,e.error(r)}return t}const hg=e=>+e||0,Upe=e=>({top:e,bottom:e,left:e,right:e});function $R(e){return ce(e)?{top:hg(e.top),bottom:hg(e.bottom),left:hg(e.left),right:hg(e.right)}:Upe(hg(e))}async function l6(e,t,n,r){const i=W2(t),s=i&&i.headless;return s||H("Unrecognized renderer type: "+t),await e.runAsync(),iW(e,null,null,s,n,r).renderAsync(e._scenegraph.root)}async function jpe(e,t){e!==_o.Canvas&&e!==_o.SVG&&e!==_o.PNG&&H("Unrecognized image type: "+e);const n=await l6(this,e,t);return e===_o.SVG?qpe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function qpe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Gpe(e,t){return(await l6(this,_o.Canvas,e,t)).canvas()}async function Wpe(e){return(await l6(this,_o.SVG,e)).svg()}function Hpe(e,t,n){return ZG(e,wd,M0,n).parse(t)}function Vpe(e){var t=this._runtime.scales;return ve(t,e)||H("Unrecognized scale or projection: "+e),t[e].value}var sW="width",aW="height",u6="padding",CR={skip:!0};function oW(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===u6?r.left+r.right:0)}function lW(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===u6?r.top+r.bottom:0)}function Jpe(e){var t=e._signals,n=t[sW],r=t[aW],i=t[u6];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,o=>{e._width=o.size,e._viewWidth=oW(e,o.size),s()},{size:n}),e._resizeHeight=e.add(null,o=>{e._height=o.size,e._viewHeight=lW(e,o.size),s()},{size:r});const a=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}function Ype(e,t,n,r,i,s){this.runAfter(a=>{let o=0;a._autosize=0,a.width()!==n&&(o=1,a.signal(sW,n,CR),a._resizeWidth.skip(!0)),a.height()!==r&&(o=1,a.signal(aW,r,CR),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==i[0]||a._origin[1]!==i[1])&&(a._resize=1,a._origin=i),o&&a.run("enter"),s&&a.runAfter(l=>l.resize())},!1,1)}function Xpe(e){return this._runtime.getState(e||{data:Kpe,signals:Zpe,recurse:!0})}function Kpe(e,t){return t.modified&&Y(t.input.value)&&e.indexOf("_:vega:_")}function Zpe(e,t){return!(e==="parent"||t instanceof wd.proxy)}function Qpe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function ege(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push($le(n,t))}function tge(e,t,n,r){const i=e.element();i&&i.setAttribute("title",nge(r))}function nge(e){return e==null?"":Y(e)?uW(e):ce(e)&&!Co(e)?rge(e):e+""}function rge(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Y(n)?uW(n):cW(n))}).join(`
`)}function uW(e){return"["+e.map(cW).join(", ")+"]"}function cW(e){return Y(e)?"[…]":ce(e)&&!Co(e)?"{…}":e}function fW(e,t){const n=this;if(t=t||{},rd.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=Ae({},e.locale,t.locale);n.locale(pz(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||_o.Canvas,n._scenegraph=new q9;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||tge,n._redraw=!0,n._handler=new cm().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=_pe(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=Hpe(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:Ae({},s)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=oW(n,n._width),n._viewHeight=lW(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Jpe(n),fpe(n),dpe(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function Ny(e,t){return ve(e._signals,t)?e._signals[t]:H("Unrecognized signal name: "+te(t))}function dW(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function MR(e,t,n,r){let i=dW(n,r);return i||(i=o6(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function TR(e,t,n){const r=dW(t,n);return r&&t._targets.remove(r),e}ne(fW,rd,{async evaluate(e,t,n){if(await rd.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,mpe(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Hy(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&eW(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=Ny(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",$R(e)):$R(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(W2(e)||H("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(rd.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Ny(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Ype,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=o6(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,s;--r>=0;)if(s=n[r].type,i=n[r].handler,e===s&&(t===i||t===i.raw)){this._handler.off(s,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return MR(this,e,Ny(this,e),t)},removeSignalListener(e,t){return TR(this,Ny(this,e),t)},addDataListener(e,t){return MR(this,e,Mb(this,e).values,t)},removeDataListener(e,t){return TR(this,Mb(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=V4(this,null);this._globalCursor=!!e,t&&V4(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:ege,events:kpe,finalize:Ape,hover:Spe,data:hpe,change:rx,insert:ppe,remove:gpe,scale:Vpe,initialize:Bpe,toImageURL:jpe,toCanvas:Gpe,toSVG:Wpe,getState:Xpe,setState:Qpe});const ige="view",Nb="[",Fb="]",hW="{",pW="}",sge=":",gW=",",age="@",oge=">",lge=/[[\]{}]/,uge={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let mW,yW;function rl(e,t,n){return mW=t||ige,yW=n||uge,vW(e.trim()).map(J4)}function cge(e){return yW[e]}function i0(e,t,n,r,i){const s=e.length;let a=0,o;for(;t<s;++t){if(o=e[t],!a&&o===n)return t;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return t}function vW(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=i0(e,i,gW,Nb+hW,Fb+pW),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function J4(e){return e[0]==="["?fge(e):dge(e)}function fge(e){const t=e.length;let n=1,r;if(n=i0(e,n,Fb,Nb,Fb),n===t)throw"Empty between selector: "+e;if(r=vW(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==oge)throw"Expected '>' after between selector: "+e;r=r.map(J4);const i=J4(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function dge(e){const t={source:mW},n=[];let r=[0,0],i=0,s=0,a=e.length,o=0,l,u;if(e[a-1]===pW){if(o=e.lastIndexOf(hW),o>=0){try{r=hge(e.substring(o+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,o).trim(),a=e.length}else throw"Unmatched right brace: "+e;o=0}if(!a)throw e;if(e[0]===age&&(i=++o),l=i0(e,o,sge),l<a&&(n.push(e.substring(s,l).trim()),s=o=++l),o=i0(e,o,Nb),o===a)n.push(e.substring(s,a).trim());else if(n.push(e.substring(s,o).trim()),u=[],s=++o,s===a)throw"Unmatched left bracket: "+e;for(;o<a;){if(o=i0(e,o,Fb),o===a)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,o).trim()),o<a-1&&e[++o]!==Nb)throw"Expected left bracket: "+e;s=++o}if(!(a=n.length)||lge.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],i?t.markname=n[0].slice(1):cge(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),u!=null&&(t.filter=u),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function hge(e){const t=e.split(gW);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function pge(e){return ce(e)?e:{type:e||"pad"}}const pg=e=>+e||0,gge=e=>({top:e,bottom:e,left:e,right:e});function mge(e){return ce(e)?e.signal?e:{top:pg(e.top),bottom:pg(e.bottom),left:pg(e.left),right:pg(e.right)}:gge(pg(e))}const Dt=e=>ce(e)&&!Y(e)?Ae({},e):{value:e};function NR(e,t,n,r){return n!=null?(ce(n)&&!Y(n)||Y(n)&&n.length&&ce(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Gt(e,t,n){for(const r in t)NR(e,r,t[r]);for(const r in n)NR(e,r,n[r],"update")}function lh(e,t,n){for(const r in t)n&&ve(n,r)||(e[r]=Ae(e[r]||{},t[r]));return e}function Yf(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const c6="mark",f6="frame",d6="scope",yge="axis",vge="axis-domain",bge="axis-grid",xge="axis-label",wge="axis-tick",_ge="axis-title",Ege="legend",kge="legend-band",Sge="legend-entry",Age="legend-gradient",bW="legend-label",$ge="legend-symbol",Cge="legend-title",Mge="title",Tge="title-text",Nge="title-subtitle";function Fge(e,t,n,r,i){const s={},a={};let o,l,u,c;l="lineBreak",t==="text"&&i[l]!=null&&!Yf(l,e)&&J5(s,l,i[l]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===f6?i.group:n===c6?Ae({},i.mark,i[t]):null;for(l in c)u=Yf(l,e)||(l==="fill"||l==="stroke")&&(Yf("fill",e)||Yf("stroke",e)),u||J5(s,l,c[l]);le(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)Yf(h,e)||J5(s,h,d[h])}),e=Ae({},e);for(l in s)c=s[l],c.signal?(o=o||{})[l]=c:a[l]=c;return e.enter=Ae(a,e.enter),o&&(e.update=Ae(o,e.update)),e}function J5(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const xW=e=>oe(e)?te(e):e.signal?`(${e.signal})`:wW(e);function sx(e){if(e.gradient!=null)return Oge(e);let t=e.signal?`(${e.signal})`:e.color?Dge(e.color):e.field!=null?wW(e.field):e.value!==void 0?te(e.value):void 0;return e.scale!=null&&(t=Rge(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${uv(e.exponent)})`),e.mult!=null&&(t+=`*${uv(e.mult)}`),e.offset!=null&&(t+=`+${uv(e.offset)}`),e.round&&(t=`round(${t})`),t}const Fy=(e,t,n,r)=>`(${e}(${[t,n,r].map(sx).join(",")})+'')`;function Dge(e){return e.c?Fy("hcl",e.h,e.c,e.l):e.h||e.s?Fy("hsl",e.h,e.s,e.l):e.l||e.a?Fy("lab",e.l,e.a,e.b):e.r||e.g||e.b?Fy("rgb",e.r,e.g,e.b):null}function Oge(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:te(n));for(;t.length&&Oe(t)==null;)t.pop();return t.unshift(xW(e.gradient)),`gradient(${t.join(",")})`}function uv(e){return ce(e)?"("+sx(e)+")":e}function wW(e){return _W(ce(e)?e:{datum:e})}function _W(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):H("Invalid field reference: "+te(e));return e.signal||(r=oe(r)?Ss(r).map(te).join("]["):_W(r)),t+"["+r+"]"}function Rge(e,t){const n=xW(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+uv(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Pge(e){let t="";return e.forEach(n=>{const r=sx(n);t+=n.test?`(${n.test})?${r}:`:r}),Oe(t)===":"&&(t+="null"),t}function EW(e,t,n,r,i,s){const a={};s=s||{},s.encoders={$encode:a},e=Fge(e,t,n,r,i.config);for(const o in e)a[o]=Ige(e[o],t,s,i);return s}function Ige(e,t,n,r){const i={},s={};for(const a in e)e[a]!=null&&(i[a]=zge(Lge(e[a]),r,n,s));return{$expr:{marktype:t,channels:i},$fields:Object.keys(s),$output:Object.keys(e)}}function Lge(e){return Y(e)?Pge(e):sx(e)}function zge(e,t,n,r){const i=ws(e,t);return i.$fields.forEach(s=>r[s]=1),Ae(n,i.$params),i.$expr}const Bge="outer",Uge=["value","update","init","react","bind"];function FR(e,t){H(e+' for "outer" push: '+te(t))}function kW(e,t){const n=e.name;if(e.push===Bge)t.signals[n]||FR("No prior signal definition",n),Uge.forEach(r=>{e[r]!==void 0&&FR("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Y4(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function ax(e,t,n,r){return new Y4(e,t,n,r)}function Db(e,t){return ax("operator",e,t)}function ge(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function T0(e,t){return t?{$field:e,$name:t}:{$field:e}}const X4=T0("key");function DR(e,t){return{$compare:e,$order:t}}function jge(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const qge="ascending",Gge="descending";function Wge(e){return ce(e)?(e.order===Gge?"-":"+")+ox(e.op,e.field):""}function ox(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const h6="scope",K4="view";function St(e){return e&&e.signal}function Hge(e){return e&&e.expr}function cv(e){if(St(e))return!0;if(ce(e)){for(const t in e)if(cv(e[t]))return!0}return!1}function vi(e,t){return e??t}function lc(e){return e&&e.signal||e}const OR="timer";function N0(e,t){return(e.merge?Jge:e.stream?Yge:e.type?Xge:H("Invalid stream specification: "+te(e)))(e,t)}function Vge(e){return e===h6?K4:e||K4}function Jge(e,t){const n=e.merge.map(i=>N0(i,t)),r=p6({merge:n},e,t);return t.addStream(r).id}function Yge(e,t){const n=N0(e.stream,t),r=p6({stream:n},e,t);return t.addStream(r).id}function Xge(e,t){let n;e.type===OR?(n=t.event(OR,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Vge(e.source),e.type);const r=p6({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function p6(e,t,n){let r=t.between;return r&&(r.length!==2&&H('Stream "between" parameter must have 2 entries: '+te(t)),e.between=[N0(r[0],n),N0(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Kge(t.marktype,t.markname,t.markrole)),t.source===h6&&r.push("inScope(event.item)"),r.length&&(e.filter=ws("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Kge(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Zge={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Qge(e,t,n){const r=e.encode,i={target:n};let s=e.events,a=e.update,o=[];s||H("Signal update missing events specification."),oe(s)&&(s=rl(s,t.isSubscope()?h6:K4)),s=le(s).filter(l=>l.signal||l.scale?(o.push(l),0):1),o.length>1&&(o=[t0e(o)]),s.length&&o.push(s.length>1?{merge:s}:s[0]),r!=null&&(a&&H("Signal encode and update are mutually exclusive."),a="encode(item(),"+te(r)+")"),i.update=oe(a)?ws(a,t):a.expr!=null?ws(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:Zge,$params:{$value:t.signalRef(a.signal)}}:H("Invalid signal update specification."),e.force&&(i.options={force:!0}),o.forEach(l=>t.addUpdate(Ae(e0e(l,t),i)))}function e0e(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):N0(e,t)}}function t0e(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function n0e(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?H("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=ws(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Qge(i,t,n.id))}const Xe=e=>(t,n,r)=>ax(e,n,t||void 0,r),SW=Xe("aggregate"),r0e=Xe("axisticks"),AW=Xe("bound"),zi=Xe("collect"),RR=Xe("compare"),i0e=Xe("datajoin"),$W=Xe("encode"),s0e=Xe("expression"),a0e=Xe("facet"),o0e=Xe("field"),l0e=Xe("key"),u0e=Xe("legendentries"),c0e=Xe("load"),f0e=Xe("mark"),d0e=Xe("multiextent"),h0e=Xe("multivalues"),p0e=Xe("overlap"),g0e=Xe("params"),CW=Xe("prefacet"),m0e=Xe("projection"),y0e=Xe("proxy"),v0e=Xe("relay"),MW=Xe("render"),b0e=Xe("scale"),Hc=Xe("sieve"),x0e=Xe("sortitems"),TW=Xe("viewlayout"),w0e=Xe("values");let _0e=0;const NW={min:"min",max:"max",count:"sum"};function E0e(e,t){const n=e.type||"linear";SU(n)||H("Unrecognized scale type: "+te(n)),t.addScale(e.name,{type:n,domain:void 0})}function k0e(e,t){const n=t.getScale(e.name).params;let r;n.domain=FW(e.domain,e,t),e.range!=null&&(n.range=OW(e,t,n)),e.interpolate!=null&&O0e(e.interpolate,n),e.nice!=null&&(n.nice=D0e(e.nice)),e.bins!=null&&(n.bins=F0e(e.bins,t));for(r in e)ve(n,r)||r==="name"||(n[r]=Jr(e[r],t))}function Jr(e,t){return ce(e)?e.signal?t.signalRef(e.signal):H("Unsupported object: "+te(e)):e}function fv(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Jr(n,t))}function lx(e){H("Can not find data set: "+te(e))}function FW(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&H("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Y(e)?S0e:e.fields?$0e:A0e)(e,t,n)}function S0e(e,t,n){return e.map(r=>Jr(r,n))}function A0e(e,t,n){const r=n.getData(e.data);return r||lx(e.data),Ad(t.type)?r.valuesRef(n,e.field,DW(e.sort,!1)):CU(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function $0e(e,t,n){const r=e.data,i=e.fields.reduce((s,a)=>(a=oe(a)?{data:r,field:a}:Y(a)||a.signal?C0e(a,n):a,s.push(a),s),[]);return(Ad(t.type)?M0e:CU(t.type)?T0e:N0e)(e,n,i)}function C0e(e,t){const n="_:vega:_"+_0e++,r=zi({});if(Y(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+te(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Hc({})]),{data:n,field:"data"}}function M0e(e,t,n){const r=DW(e.sort,!0);let i,s;const a=n.map(u=>{const c=t.getData(u.data);return c||lx(u.data),c.countsRef(t,u.field,r)}),o={groupby:X4,pulse:a};r&&(i=r.op||"count",s=r.field?ox(i,r.field):"count",o.ops=[NW[i]],o.fields=[t.fieldRef(s)],o.as=[s]),i=t.add(SW(o));const l=t.add(zi({pulse:ge(i)}));return s=t.add(w0e({field:X4,sort:t.sortRef(r),pulse:ge(l)})),ge(s)}function DW(e,t){return e&&(!e.field&&!e.op?ce(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?H("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!NW[e.op]&&H("Multiple domain scales can not be sorted using "+e.op)),e}function T0e(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||lx(i.data),s.domainRef(t,i.field)});return ge(t.add(h0e({values:r})))}function N0e(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||lx(i.data),s.extentRef(t,i.field)});return ge(t.add(d0e({extents:r})))}function F0e(e,t){return e.signal||Y(e)?fv(e,t):t.objectProperty(e)}function D0e(e){return ce(e)?{interval:Jr(e.interval),step:Jr(e.step)}:Jr(e)}function O0e(e,t){t.interpolate=Jr(e.type||e),e.gamma!=null&&(t.interpolateGamma=Jr(e.gamma))}function OW(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(oe(i)){if(r&&ve(r,i))return e=Ae({},e,{range:r[i]}),OW(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Ad(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:H("Unrecognized scale range value: "+te(i))}else if(i.scheme){n.scheme=Y(i.scheme)?fv(i.scheme,t):Jr(i.scheme,t),i.extent&&(n.schemeExtent=fv(i.extent,t)),i.count&&(n.schemeCount=Jr(i.count,t));return}else if(i.step){n.rangeStep=Jr(i.step,t);return}else{if(Ad(e.type)&&!Y(i))return FW(i,e,t);Y(i)||H("Unsupported range type: "+te(i))}return i.map(s=>(Y(s)?fv:Jr)(s,t))}function R0e(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=Z4(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=Z4(n[i],i,t));t.addProjection(e.name,r)}function Z4(e,t,n){return Y(e)?e.map(r=>Z4(r,t,n)):ce(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:H("Unsupported parameter object: "+te(e)):e}const Bi="top",uh="left",ch="right",Go="bottom",RW="center",P0e="vertical",I0e="start",L0e="middle",z0e="end",Q4="index",g6="label",B0e="offset",Pd="perc",U0e="perc2",Xr="value",bm="guide-label",m6="guide-title",j0e="group-title",q0e="group-subtitle",PR="symbol",dv="gradient",e$="discrete",t$="size",G0e="shape",W0e="fill",H0e="stroke",V0e="strokeWidth",J0e="strokeDash",Y0e="opacity",y6=[t$,G0e,W0e,H0e,V0e,J0e,Y0e],xm={name:1,style:1,interactive:1},Pe={value:0},Kr={value:1},ux="group",PW="rect",v6="rule",X0e="symbol",Vc="text";function F0(e){return e.type=ux,e.interactive=e.interactive||!1,e}function or(e,t){const n=(r,i)=>vi(e[r],vi(t[r],i));return n.isVertical=r=>P0e===vi(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>vi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>vi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>vi(e.columns,vi(t.columns,+n.isVertical(!0))),n}function IW(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function K0e(e,t,n){const r=t.config.style[n];return r&&r[e]}function cx(e,t,n){return`item.anchor === '${I0e}' ? ${e} : item.anchor === '${z0e}' ? ${t} : ${n}`}const b6=cx(te(uh),te(ch),te(RW));function Z0e(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},ce(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function LW(e,t){return t?e?ce(e)?Object.assign({},e,{offset:LW(e.offset,t)}):{value:e,offset:t}:t:e}function $r(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=lh(e.encode,t,xm)):e.interactive=!1,e}function Q0e(e,t,n,r){const i=or(e,n),s=i.isVertical(),a=i.gradientThickness(),o=i.gradientLength();let l,u,c,f,d;s?(u=[0,1],c=[0,0],f=a,d=o):(u=[0,0],c=[1,0],f=o,d=a);const h={enter:l={opacity:Pe,x:Pe,y:Pe,width:Dt(f),height:Dt(d)},update:Ae({},l,{opacity:Kr,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:Pe}};return Gt(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),$r({type:PW,role:Age,encode:h},r)}function eme(e,t,n,r,i){const s=or(e,n),a=s.isVertical(),o=s.gradientThickness(),l=s.gradientLength();let u,c,f,d,h="";a?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:Pe,fill:{scale:t,field:Xr}};p[u]={signal:h+"datum."+Pd,mult:l},p[c]=Pe,p[f]={signal:h+"datum."+U0e,mult:l},p[d]=Dt(o);const g={enter:p,update:Ae({},p,{opacity:Kr}),exit:{opacity:Pe}};return Gt(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),$r({type:PW,role:kge,key:Xr,from:i,encode:g},r)}const tme=`datum.${Pd}<=0?"${uh}":datum.${Pd}>=1?"${ch}":"${RW}"`,nme=`datum.${Pd}<=0?"${Go}":datum.${Pd}>=1?"${Bi}":"${L0e}"`;function IR(e,t,n,r){const i=or(e,t),s=i.isVertical(),a=Dt(i.gradientThickness()),o=i.gradientLength();let l=i("labelOverlap"),u,c,f,d,h="";const p={enter:u={opacity:Pe},update:c={opacity:Kr,text:{field:g6}},exit:{opacity:Pe}};return Gt(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:vi(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:nme},f="y",d="x",h="1-"):(u.align=c.align={signal:tme},u.baseline={value:"top"},f="x",d="y"),u[f]=c[f]={signal:h+"datum."+Pd,mult:o},u[d]=c[d]=a,a.offset=vi(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:i("labelSeparation"),method:l,order:"datum."+Q4}:void 0,$r({type:Vc,role:bW,style:bm,key:Xr,from:r,encode:p,overlap:l},n)}function rme(e,t,n,r,i){const s=or(e,t),a=n.entries,o=!!(a&&a.interactive),l=a?a.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${B0e} : datum.${t$}`,h=u?Dt(u):{field:t$},p=`datum.${Q4}`,g=`max(1, ${i})`;let m,y,v,x,_;h.mult=.5,m={enter:y={opacity:Pe,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Kr,x:y.x,y:y.y},exit:{opacity:Pe}};let w=null,k=null;e.fill||(w=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),Gt(m,{fill:s("symbolFillColor",w),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",k),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),y6.forEach(D=>{e[D]&&(v[D]=y[D]={scale:e[D],field:Xr})});const E=$r({type:X0e,role:$ge,key:Xr,from:f,clip:u?!0:void 0,encode:m},n.symbols),A=Dt(c);A.offset=s("labelOffset"),m={enter:y={opacity:Pe,x:{signal:d,offset:A},y:h},update:v={opacity:Kr,text:{field:g6},x:y.x,y:y.y},exit:{opacity:Pe}},Gt(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const z=$r({type:Vc,role:bW,style:bm,key:Xr,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:Pe,height:u?Dt(u):Pe,opacity:Pe},exit:{opacity:Pe},update:v={opacity:Kr,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(x=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${x}`,v.column.signal=`floor(${p} / ${x})`,_={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,_={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:Q4}},F0({role:d6,from:r,encode:lh(m,a,xm),marks:[E,z],name:l,interactive:o,sort:_})}function ime(e,t){const n=or(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const x6='item.orient === "left"',w6='item.orient === "right"',fx=`(${x6} || ${w6})`,sme=`datum.vgrad && ${fx}`,ame=cx('"top"','"bottom"','"middle"'),ome=cx('"right"','"left"','"center"'),lme=`datum.vgrad && ${w6} ? (${ome}) : (${fx} && !(datum.vgrad && ${x6})) ? "left" : ${b6}`,ume=`item._anchor || (${fx} ? "middle" : "start")`,cme=`${sme} ? (${x6} ? -90 : 90) : 0`,fme=`${fx} ? (datum.vgrad ? (${w6} ? "bottom" : "top") : ${ame}) : "top"`;function dme(e,t,n,r){const i=or(e,t),s={enter:{opacity:Pe},update:{opacity:Kr,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Pe}};return Gt(s,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:ume},angle:{signal:cme},align:{signal:lme},baseline:{signal:fme},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),$r({type:Vc,role:Cge,style:m6,from:r,encode:s},n)}function hme(e,t){let n;return ce(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+LR(e.path)+")":e.sphere&&(n="geoShape("+LR(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function LR(e){return ce(e)&&e.signal?e.signal:te(e)}function zW(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===ux?d6:t||c6}function pme(e){return{marktype:e.type,name:e.name||void 0,role:e.role||zW(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function gme(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function _6(e,t){const n=$z(e.type);n||H("Unrecognized transform type: "+te(e.type));const r=ax(n.type.toLowerCase(),null,BW(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function BW(e,t,n){const r={},i=e.params.length;for(let s=0;s<i;++s){const a=e.params[s];r[a.name]=mme(a,t,n)}return r}function mme(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return yme(e,t,n);if(i===void 0){e.required&&H("Missing required "+te(t.type)+" parameter: "+te(e.name));return}else{if(r==="param")return vme(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!St(i)?i.map(s=>zR(e,s,n)):zR(e,i,n)}function zR(e,t,n){const r=e.type;if(St(t))return UR(r)?H("Expression references can not be signals."):Y5(r)?n.fieldRef(t):jR(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||Y5(r);return i&&bme(t)?n.exprRef(t.expr,t.as):i&&xme(t)?T0(t.field,t.as):UR(r)?ws(t,n):wme(r)?ge(n.getData(t).values):Y5(r)?T0(t):jR(r)?n.compareRef(t):t}}function yme(e,t,n){return oe(t.from)||H('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function vme(e,t,n){const r=t[e.name];return e.array?(Y(r)||H("Expected an array of sub-parameters. Instead: "+te(r)),r.map(i=>BR(e,i,n))):BR(e,r,n)}function BR(e,t,n){const r=e.params.length;let i;for(let a=0;a<r;++a){i=e.params[a];for(const o in i.key)if(i.key[o]!==t[o]){i=null;break}if(i)break}i||H("Unsupported parameter: "+te(t));const s=Ae(BW(i,t,n),i.key);return ge(n.add(g0e(s)))}const bme=e=>e&&e.expr,xme=e=>e&&e.field,wme=e=>e==="data",UR=e=>e==="expr",Y5=e=>e==="field",jR=e=>e==="compare";function _me(e,t,n){let r,i,s,a,o;return e?(r=e.facet)&&(t||H("Only group marks can be faceted."),r.field!=null?a=o=hv(r,n):(e.data?o=ge(n.getData(e.data).aggregate):(s=_6(Ae({type:"aggregate",groupby:le(r.groupby)},r.aggregate),n),s.params.key=n.keyRef(r.groupby),s.params.pulse=hv(r,n),a=o=ge(n.add(s))),i=n.keyRef(r.groupby,!0))):a=ge(n.add(zi(null,[{}]))),a||(a=hv(e,n)),{key:i,pulse:a,parent:o}}function hv(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ge(t.getData(e.data).output)}function Ec(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Ec.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let s=t[0],a=null,o=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);o<n;++o)t[o].params.pulse=ge(t[o-1]),e.add(t[o]),t[o].type==="aggregate"&&(a=t[o]);return new Ec(e,s,i,r,a)};function UW(e){return oe(e)?e:null}function qR(e,t,n){const r=ox(n.op,n.field);let i;if(t.ops){for(let s=0,a=t.as.length;s<a;++s)if(t.as[s]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function gg(e,t,n,r,i,s,a){const o=t[n]||(t[n]={}),l=Wge(s);let u=UW(i),c,f;if(u!=null&&(e=t.scope,u=u+(l?"|"+l:""),c=o[u]),!c){const d=s?{field:X4,pulse:t.countsRef(e,i,s)}:{field:e.fieldRef(i),pulse:ge(t.output)};l&&(d.sort=e.sortRef(s)),f=e.add(ax(r,void 0,d)),a&&(t.index[i]=f),c=ge(f),u!=null&&(o[u]=c)}return c}Ec.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),s=UW(t);let a,o,l;return s!=null&&(e=r.scope,a=i[s]),a?n&&n.field&&qR(e,a.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:ge(r.output)},n&&n.field&&qR(e,l,n),o=e.add(SW(l)),a=e.add(zi({pulse:ge(o)})),a={agg:o,ref:ge(a)},s!=null&&(i[s]=a)),a.ref},tuplesRef(){return ge(this.values)},extentRef(e,t){return gg(e,this,"extent","extent",t,!1)},domainRef(e,t){return gg(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return gg(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return gg(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return gg(e,this,"indata","tupleindex",t,!0,!0)}};function Eme(e,t,n){const r=e.from.facet,i=r.name,s=hv(r,t);let a;r.name||H("Facet must have a name: "+te(r)),r.data||H("Facet must reference a data set: "+te(r)),r.field?a=t.add(CW({field:t.fieldRef(r.field),pulse:s})):r.groupby?a=t.add(a0e({key:t.keyRef(r.groupby),group:ge(t.proxy(n.parent)),pulse:s})):H("Facet must specify groupby or field: "+te(r));const o=t.fork(),l=o.add(zi()),u=o.add(Hc({pulse:ge(l)}));o.addData(i,new Ec(o,l,l,u)),o.addSignal("parent",null),a.params.subflow={$subflow:o.parse(e).toRuntime()}}function kme(e,t,n){const r=t.add(CW({pulse:n.pulse})),i=t.fork();i.add(Hc()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function jW(e,t,n){const r=e.remove,i=e.insert,s=e.toggle,a=e.modify,o=e.values,l=t.add(Db()),u="if("+e.trigger+',modify("'+n+'",'+[i,r,s,a,o].map(f=>f??"null").join(",")+"),0)",c=ws(u,t);l.update=c.$expr,l.params=c.$params}function dx(e,t){const n=zW(e),r=e.type===ux,i=e.from&&e.from.facet,s=e.overlap;let a=e.layout||n===d6||n===f6,o,l,u,c,f,d,h;const p=n===c6||a||i,g=_me(e.from,r,t);l=t.add(i0e({key:g.key||(e.key?T0(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ge(l);l=u=t.add(zi({pulse:m})),l=t.add(f0e({markdef:pme(e),interactive:gme(e.interactive,t),clip:hme(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ge(l)}));const y=ge(l);l=c=t.add($W(EW(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(k=>{const E=_6(k,t),A=E.metadata;(A.generates||A.changes)&&H("Mark transforms should not generate new data."),A.nomod||(c.params.mod=!0),E.params.pulse=ge(l),t.add(l=E)}),e.sort&&(l=t.add(x0e({sort:t.compareRef(e.sort),pulse:ge(l)})));const v=ge(l);(i||a)&&(a=t.add(TW({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ge(a));const x=t.add(AW({mark:y,pulse:d||v}));h=ge(x),r&&(p&&(o=t.operators,o.pop(),a&&o.pop()),t.pushState(v,d||h,m),i?Eme(e,t,g):p?kme(e,t,g):t.parse(e),t.popState(),p&&(a&&o.push(a),o.push(x))),s&&(h=Sme(s,h,t));const _=t.add(MW({pulse:h})),w=t.add(Hc({pulse:ge(_)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Ec(t,u,_,w)),e.on&&e.on.forEach(k=>{(k.insert||k.remove||k.toggle)&&H("Marks only support modify triggers."),jW(k,t,f)}))}function Sme(e,t,n){const r=e.method,i=e.bound,s=e.separation,a={separation:St(s)?n.signalRef(s.signal):s,method:St(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),i){const o=i.tolerance;a.boundTolerance=St(o)?n.signalRef(o.signal):+o,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return ge(n.add(p0e(a)))}function Ame(e,t){const n=t.config.legend,r=e.encode||{},i=or(e,n),s=r.legend||{},a=s.name||void 0,o=s.interactive,l=s.style,u={};let c=0,f,d,h;y6.forEach(x=>e[x]?(u[x]=e[x],c=c||e[x]):0),c||H("Missing valid scale for legend.");const p=$me(e,t.scaleType(c)),g={title:e.title!=null,scales:u,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ge(t.add(zi(null,[g]))),y={enter:{x:{value:0},y:{value:0}}},v=ge(t.add(u0e(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===dv?(h=[Q0e(e,c,n,r.gradient),IR(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${lc(i.gradientLength())})/100))`)):p===e$?h=[eme(e,c,n,r.gradient,v),IR(e,n,r.labels,v)]:(f=ime(e,n),h=[rme(e,n,r,v,lc(f.columns))],d.size=Tme(e,t,h[0].marks)),h=[F0({role:Sge,from:m,encode:y,marks:h,layout:f,interactive:o})],g.title&&h.push(dme(e,n,r.title,m)),dx(F0({role:Ege,from:m,encode:lh(Mme(i,e,n),s,xm),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:a,interactive:o,style:l}),t)}function $me(e,t){let n=e.type||PR;return!e.type&&Cme(e)===1&&(e.fill||e.stroke)&&(n=v9(t)?dv:HA(t)?e$:PR),n!==dv?n:HA(t)?e$:dv}function Cme(e){return y6.reduce((t,n)=>t+(e[n]?1:0),0)}function Mme(e,t,n){const r={enter:{},update:{}};return Gt(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function Tme(e,t,n){const r=lc(GR("size",e,n)),i=lc(GR("strokeWidth",e,n)),s=lc(Nme(n[1].encode,t,bm));return ws(`max(ceil(sqrt(${r})+${i}),${s})`,t)}function GR(e,t,n){return t[e]?`scale("${t[e]}",datum)`:IW(e,n[0].encode)}function Nme(e,t,n){return IW("fontSize",e)||K0e("fontSize",t,n)}const Fme=`item.orient==="${uh}"?-90:item.orient==="${ch}"?90:0`;function Dme(e,t){e=oe(e)?{text:e}:e;const n=or(e,t.config.title),r=e.encode||{},i=r.group||{},s=i.name||void 0,a=i.interactive,o=i.style,l=[],u={},c=ge(t.add(zi(null,[u])));return l.push(Pme(e,n,Ome(e),c)),e.subtitle&&l.push(Ime(e,n,r.subtitle,c)),dx(F0({role:Mge,from:c,encode:Rme(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:a,style:o}),t)}function Ome(e){const t=e.encode;return t&&t.title||Ae({name:e.name,interactive:e.interactive,style:e.style},t)}function Rme(e,t){const n={enter:{},update:{}};return Gt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:b6},angle:{signal:Fme},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),lh(n,t,xm)}function Pme(e,t,n,r){const i={value:0},s=e.text,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Gt(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$r({type:Vc,role:Tge,style:j0e,from:r,encode:a},n)}function Ime(e,t,n,r){const i={value:0},s=e.subtitle,a={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Gt(a,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$r({type:Vc,role:Nge,style:q0e,from:r,encode:a},n)}function Lme(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(_6(r,t))}),e.on&&e.on.forEach(r=>{jW(r,t,e.name)}),t.addDataPipeline(e.name,zme(e,t,n))}function zme(e,t,n){const r=[];let i=null,s=!1,a=!1,o,l,u,c,f;for(e.values?St(e.values)||cv(e.format)?(r.push(WR(t,e)),r.push(i=Ou())):r.push(i=Ou({$ingest:e.values,$format:e.format})):e.url?cv(e.url)||cv(e.format)?(r.push(WR(t,e)),r.push(i=Ou())):r.push(i=Ou({$request:e.url,$format:e.format})):e.source&&(i=o=le(e.source).map(d=>ge(t.getData(d).output)),r.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!i&&!f.source&&r.push(i=Ou()),r.push(c),f.generates&&(a=!0),f.modifies&&!a&&(s=!0),f.source?i=c:f.changes&&(i=null);return o&&(u=o.length-1,r[0]=v0e({derive:s,pulse:u?o:o[0]}),(s||u)&&r.splice(1,0,Ou())),i||r.push(Ou()),r.push(Hc({})),r}function Ou(e){const t=zi({},e);return t.metadata={source:!0},t}function WR(e,t){return c0e({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const qW=e=>e===Go||e===Bi,hx=(e,t,n)=>St(e)?qme(e.signal,t,n):e===uh||e===Bi?t:n,Ot=(e,t,n)=>St(e)?Ume(e.signal,t,n):qW(e)?t:n,Ti=(e,t,n)=>St(e)?jme(e.signal,t,n):qW(e)?n:t,GW=(e,t,n)=>St(e)?Gme(e.signal,t,n):e===Bi?{value:t}:{value:n},Bme=(e,t,n)=>St(e)?Wme(e.signal,t,n):e===ch?{value:t}:{value:n},Ume=(e,t,n)=>WW(`${e} === '${Bi}' || ${e} === '${Go}'`,t,n),jme=(e,t,n)=>WW(`${e} !== '${Bi}' && ${e} !== '${Go}'`,t,n),qme=(e,t,n)=>E6(`${e} === '${uh}' || ${e} === '${Bi}'`,t,n),Gme=(e,t,n)=>E6(`${e} === '${Bi}'`,t,n),Wme=(e,t,n)=>E6(`${e} === '${ch}'`,t,n),WW=(e,t,n)=>(t=t!=null?Dt(t):t,n=n!=null?Dt(n):n,HR(t)&&HR(n)?(t=t?t.signal||te(t.value):null,n=n?n.signal||te(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ae({test:e},t)].concat(n||[])),HR=e=>e==null||Object.keys(e).length===1,E6=(e,t,n)=>({signal:`${e} ? (${nd(t)}) : (${nd(n)})`}),Hme=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${uh}' ? (${nd(r)}) : `:"")+(n!=null?`${e} === '${Go}' ? (${nd(n)}) : `:"")+(i!=null?`${e} === '${ch}' ? (${nd(i)}) : `:"")+(t!=null?`${e} === '${Bi}' ? (${nd(t)}) : `:"")+"(null)"}),nd=e=>St(e)?e.signal:e==null?null:te(e),Vme=(e,t)=>t===0?0:St(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},od=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function jf(e,t,n,r){let i;if(t&&ve(t,e))return t[e];if(ve(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[m6][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[bm][i]}return null}function VR(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function Jme(e,t){var n=t.config,r=n.style,i=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,o,l,u;if(St(a)){const f=VR([n.axisX,n.axisY]),d=VR([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);o={};for(u of f)o[u]=Ot(a,jf(u,n.axisX,i,r),jf(u,n.axisY,i,r));l={};for(u of d)l[u]=Hme(a.signal,jf(u,n.axisTop,i,r),jf(u,n.axisBottom,i,r),jf(u,n.axisLeft,i,r),jf(u,n.axisRight,i,r))}else o=a===Bi||a===Go?n.axisX:n.axisY,l=n["axis"+a[0].toUpperCase()+a.slice(1)];return o||l||s?Ae({},i,o,l,s):i}function Yme(e,t,n,r){const i=or(e,t),s=e.orient;let a,o;const l={enter:a={opacity:Pe},update:o={opacity:Kr},exit:{opacity:Pe}};Gt(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=JR(e,0),c=JR(e,1);return a.x=o.x=Ot(s,u,Pe),a.x2=o.x2=Ot(s,c),a.y=o.y=Ti(s,u,Pe),a.y2=o.y2=Ti(s,c),$r({type:v6,role:vge,from:r,encode:l},n)}function JR(e,t){return{scale:e.scale,range:t}}function Xme(e,t,n,r,i){const s=or(e,t),a=e.orient,o=e.gridScale,l=hx(a,1,-1),u=Kme(e.offset,l);let c,f,d;const h={enter:c={opacity:Pe},update:d={opacity:Kr},exit:f={opacity:Pe}};Gt(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Xr,band:i.band,extra:i.extra,offset:i.offset,round:s("tickRound")},g=Ot(a,{signal:"height"},{signal:"width"}),m=o?{scale:o,range:0,mult:l,offset:u}:{value:0,offset:u},y=o?{scale:o,range:1,mult:l,offset:u}:Ae(g,{mult:l,offset:u});return c.x=d.x=Ot(a,p,m),c.y=d.y=Ti(a,p,m),c.x2=d.x2=Ti(a,y),c.y2=d.y2=Ot(a,y),f.x=Ot(a,p),f.y=Ti(a,p),$r({type:v6,role:bge,key:Xr,from:r,encode:h},n)}function Kme(e,t){if(t!==1)if(!ce(e))e=St(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ae({},e);for(;n.mult!=null;)if(ce(n.mult))n=n.mult=Ae({},n.mult);else return n.mult=St(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Zme(e,t,n,r,i,s){const a=or(e,t),o=e.orient,l=hx(o,-1,1);let u,c,f;const d={enter:u={opacity:Pe},update:f={opacity:Kr},exit:c={opacity:Pe}};Gt(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Dt(i);h.mult=l;const p={scale:e.scale,field:Xr,band:s.band,extra:s.extra,offset:s.offset,round:a("tickRound")};return f.y=u.y=Ot(o,Pe,p),f.y2=u.y2=Ot(o,h),c.x=Ot(o,p),f.x=u.x=Ti(o,Pe,p),f.x2=u.x2=Ti(o,h),c.y=Ti(o,p),$r({type:v6,role:wge,key:Xr,from:r,encode:d},n)}function X5(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Qme(e,t,n,r,i,s){const a=or(e,t),o=e.orient,l=e.scale,u=hx(o,-1,1),c=lc(a("labelFlush")),f=lc(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let p=c===0||!!c,g;const m=Dt(i);m.mult=u,m.offset=Dt(a("labelPadding")||0),m.offset.mult=u;const y={scale:l,field:Xr,band:.5,offset:LW(s.offset,a("labelOffset"))},v=Ot(o,p?X5(l,c,'"left"','"right"','"center"'):{value:"center"},Bme(o,"left","right")),x=Ot(o,GW(o,"bottom","top"),p?X5(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),_=X5(l,c,`-(${f})`,f,0);p=p&&f;const w={opacity:Pe,x:Ot(o,y,m),y:Ti(o,y,m)},k={enter:w,update:g={opacity:Kr,text:{field:g6},x:w.x,y:w.y,align:v,baseline:x},exit:{opacity:Pe,x:w.x,y:w.y}};Gt(k,{dx:!d&&p?Ot(o,_):null,dy:!h&&p?Ti(o,_):null}),Gt(k,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const E=a("labelBound");let A=a("labelOverlap");return A=A||E?{separation:a("labelSeparation"),method:A,order:"datum.index",bound:E?{scale:l,orient:o,tolerance:E}:null}:void 0,g.align!==v&&(g.align=od(g.align,v)),g.baseline!==x&&(g.baseline=od(g.baseline,x)),$r({type:Vc,role:xge,style:bm,key:Xr,from:r,encode:k,overlap:A},n)}function e1e(e,t,n,r){const i=or(e,t),s=e.orient,a=hx(s,-1,1);let o,l;const u={enter:o={opacity:Pe,anchor:Dt(i("titleAnchor",null)),align:{signal:b6}},update:l=Ae({},o,{opacity:Kr,text:Dt(e.title)}),exit:{opacity:Pe}},c={signal:`lerp(range("${e.scale}"), ${cx(0,1,.5)})`};return l.x=Ot(s,c),l.y=Ti(s,c),o.angle=Ot(s,Pe,Vme(a,90)),o.baseline=Ot(s,GW(s,Go,Bi),{value:Go}),l.angle=o.angle,l.baseline=o.baseline,Gt(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),t1e(i,s,u,n),u.update.align=od(u.update.align,o.align),u.update.angle=od(u.update.angle,o.angle),u.update.baseline=od(u.update.baseline,o.baseline),$r({type:Vc,role:_ge,style:m6,from:r,encode:u},n)}function t1e(e,t,n,r){const i=(o,l)=>o!=null?(n.update[l]=od(Dt(o),n.update[l]),!1):!Yf(l,r),s=i(e("titleX"),"x"),a=i(e("titleY"),"y");n.enter.auto=a===s?Dt(a):Ot(t,Dt(a),Dt(s))}function n1e(e,t){const n=Jme(e,t),r=e.encode||{},i=r.axis||{},s=i.name||void 0,a=i.interactive,o=i.style,l=or(e,n),u=Z0e(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:e.title!=null},f=ge(t.add(zi({},[c]))),d=ge(t.add(r0e({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Xme(e,n,r.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(Zme(e,n,r.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(Qme(e,n,r.labels,d,p,u))),c.domain&&h.push(Yme(e,n,r.domain,f)),c.title&&h.push(e1e(e,n,r.title,f)),dx(F0({role:yge,from:f,encode:lh(r1e(l,e),i,xm),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:a,style:o}),t)}function r1e(e,t){const n={enter:{},update:{}};return Gt(n,{orient:e("orient"),offset:e("offset")||0,position:vi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function HW(e,t,n){const r=le(e.signals),i=le(e.scales);return n||r.forEach(s=>kW(s,t)),le(e.projections).forEach(s=>R0e(s,t)),i.forEach(s=>E0e(s,t)),le(e.data).forEach(s=>Lme(s,t)),i.forEach(s=>k0e(s,t)),(n||r).forEach(s=>n0e(s,t)),le(e.axes).forEach(s=>n1e(s,t)),le(e.marks).forEach(s=>dx(s,t)),le(e.legends).forEach(s=>Ame(s,t)),e.title&&Dme(e.title,t),t.parseLambdas(),t}const i1e=e=>lh({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function s1e(e,t){const n=t.config,r=ge(t.root=t.add(Db())),i=a1e(e,n);i.forEach(u=>kW(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(zi()),a=t.add($W(EW(i1e(e.encode),ux,f6,e.style,t,{pulse:ge(s)}))),o=t.add(TW({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ge(a)}));t.operators.pop(),t.pushState(ge(a),ge(o),null),HW(e,t,i),t.operators.push(o);let l=t.add(AW({mark:r,pulse:ge(o)}));return l=t.add(MW({pulse:ge(l)})),l=t.add(Hc({pulse:ge(l)})),t.addData("root",new Ec(t,s,s,l)),t}function mg(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function a1e(e,t){const n=a=>vi(e[a],t[a]),r=[mg("background",n("background")),mg("autosize",pge(n("autosize"))),mg("padding",mge(n("padding"))),mg("width",n("width")||0),mg("height",n("height")||0)],i=r.reduce((a,o)=>(a[o.name]=o,a),{}),s={};return le(e.signals).forEach(a=>{ve(i,a.name)?a=Ae(i[a.name],a):r.push(a),s[a.name]=a}),le(t.signals).forEach(a=>{!ve(s,a.name)&&!ve(i,a.name)&&r.push(a)}),r}function VW(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function YR(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}VW.prototype=YR.prototype={parse(e){return HW(e,this)},fork(){return new YR(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Y4?ge(e):e;return this.add(y0e({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,s){let a,o;r&&(a=r.data||(r.data={}),o=a[i]||(a[i]=[]),o.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ge(this.add(Hc({pulse:e})))),this._parent.push(t),this._lookup.push(n?ge(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Oe(this._parent)},encode(){return Oe(this._encode)},lookup(){return Oe(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(oe(e))return T0(e,t);e.signal||H("Unsupported field reference: "+te(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ge(this.add(o0e(i)))}return r},compareRef(e){let t=!1;const n=s=>St(s)?(t=!0,this.signalRef(s.signal)):Hge(s)?(t=!0,this.exprRef(s.expr)):s,r=le(e.field).map(n),i=le(e.order).map(n);return t?ge(this.add(RR({fields:r,orders:i}))):DR(r,i)},keyRef(e,t){let n=!1;const r=s=>St(s)?(n=!0,ge(i[s.signal])):s,i=this.signals;return e=le(e).map(r),n?ge(this.add(l0e({fields:e,flat:t}))):jge(e,t)},sortRef(e){if(!e)return e;const t=ox(e.op,e.field),n=e.order||qge;return n.signal?ge(this.add(RR({fields:t,orders:this.signalRef(n.signal)}))):DR(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return ve(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&H("Duplicate signal name: "+te(e));const n=t instanceof Y4?t:this.add(Db(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||H("Unrecognized signal name: "+te(e)),this.signals[e]},signalRef(e){return this.signals[e]?ge(this.signals[e]):(ve(this.lambdas,e)||(this.lambdas[e]=this.add(Db(null))),ge(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=ws(r,this),s=this.lambdas[r];s.params=i.$params,s.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!ce(e)?e:this.signalRef(e.signal||k6(e))},exprRef(e,t){const n={expr:ws(e,this)};return t&&(n.expr.$name=t),ge(this.add(s0e(n)))},addBinding(e,t){this.bindings||H("Nested signals do not support binding: "+te(e)),this.bindings.push(Ae({signal:e},t))},addScaleProj(e,t){ve(this.scales,e)&&H("Duplicate scale or projection name: "+te(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,b0e(t))},addProjection(e,t){this.addScaleProj(e,m0e(t))},getScale(e){return this.scales[e]||H("Unrecognized scale name: "+te(e)),this.scales[e]},scaleRef(e){return ge(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ve(this.data,e)&&H("Duplicate data set name: "+te(e)),this.data[e]=t},getData(e){return this.data[e]||H("Undefined data set name: "+te(e)),this.data[e]},addDataPipeline(e,t){return ve(this.data,e)&&H("Duplicate data set name: "+te(e)),this.addData(e,Ec.fromEntries(this,t))}};function k6(e){return(Y(e)?o1e:l1e)(e)}function o1e(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(ce(i)?i.signal||k6(i):te(i))}return n+"]"}function l1e(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+te(r)+":"+(ce(i)?i.signal||k6(i):te(i));return t+"}"}function u1e(){const e="sans-serif",r="#4c78a8",i="#000",s="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function c1e(e,t,n){return ce(e)||H("Input Vega specification must be an object."),t=Xd(u1e(),t,e.config),s1e(e,new VW(t,n)).toRuntime()}var f1e="5.25.0";Ae(wd,hee,Dse,fae,Koe,Wle,vce,Kue,xce,qce,Qce,afe);const d1e=Object.freeze(Object.defineProperty({__proto__:null,Bounds:mt,CanvasHandler:cm,CanvasRenderer:Hv,DATE:tr,DAY:en,DAYOFYEAR:bs,Dataflow:rd,Debug:YI,Error:F$,EventStream:p2,Gradient:qU,GroupItem:I2,HOURS:kr,Handler:jo,Info:JI,Item:P2,MILLISECONDS:Oi,MINUTES:Sr,MONTH:an,Marks:Ar,MultiPulse:rC,None:VI,Operator:Ze,Parameters:h2,Pulse:To,QUARTER:er,RenderType:_o,Renderer:Cs,ResourceLoader:$9,SECONDS:Qr,SVGHandler:W9,SVGRenderer:K9,SVGStringRenderer:Z9,Scenegraph:q9,TIME_UNITS:V$,Transform:G,View:fW,WEEK:Et,Warn:D$,YEAR:jt,accessor:ar,accessorFields:sn,accessorName:ft,array:le,ascending:n2,bandwidthNRD:oC,bin:Tz,bootstrapCI:Nz,boundClip:Ij,boundContext:am,boundItem:QA,boundMark:lj,boundStroke:Ma,changeset:jc,clampRange:aL,codegenExpression:zG,compare:L$,constant:cn,cumulativeLogNormal:hC,cumulativeNormal:m2,cumulativeUniform:yC,dayofyear:IL,debounce:z$,defaultLocale:Z$,definition:$z,densityLogNormal:dC,densityNormal:lC,densityUniform:mC,domChild:Hn,domClear:_i,domCreate:xo,domFind:G9,dotbin:Fz,error:H,expressionFunction:vt,extend:Ae,extent:ms,extentIndex:oL,falsy:lo,fastmap:Zd,field:Qn,flush:lL,font:j2,fontFamily:um,fontSize:$s,format:Wy,formatLocale:Av,formats:tC,hasOwnProperty:ve,id:q0,identity:un,inferType:mz,inferTypes:yz,ingest:Ue,inherits:ne,inrange:Kf,interpolate:b9,interpolateColors:O2,interpolateRange:MU,intersect:Dj,intersectBoxLine:Zf,intersectPath:C9,intersectPoint:M9,intersectRule:KU,isArray:Y,isBoolean:Ko,isDate:Co,isFunction:$e,isIterable:uL,isNumber:Ye,isObject:ce,isRegExp:cL,isString:oe,isTuple:f2,key:B$,lerp:fL,lineHeight:Bo,loader:u2,locale:pz,logger:O$,lruCache:dL,markup:X9,merge:hL,mergeConfig:Xd,multiLineOffset:B9,one:Yd,pad:pL,panLinear:eL,panLog:tL,panPow:nL,panSymlog:rL,parse:c1e,parseExpression:K8,parseSelector:rl,path:w2,pathCurves:k9,pathEqual:Lj,pathParse:$d,pathRectangle:HU,pathRender:v0,pathSymbols:WU,pathTrail:VU,peek:Oe,point:G2,projection:y8,quantileLogNormal:pC,quantileNormal:y2,quantileUniform:vC,quantiles:sC,quantizeInterpolator:TU,quarter:iL,quartiles:aC,get random(){return ei},randomInteger:yQ,randomKDE:cC,randomLCG:mQ,randomLogNormal:Oz,randomMixture:Rz,randomNormal:uC,randomUniform:Pz,read:xz,regressionConstant:bC,regressionExp:Lz,regressionLinear:xC,regressionLoess:Uz,regressionLog:Iz,regressionPoly:Bz,regressionPow:zz,regressionQuad:wC,renderModule:W2,repeat:Sg,resetDefaultLocale:hZ,resetSVGClipId:YU,resetSVGDefIds:Kie,responseType:bz,runtimeContext:ZG,sampleCurve:b2,sampleLogNormal:fC,sampleNormal:g2,sampleUniform:gC,scale:ze,sceneEqual:Q9,sceneFromJSON:cj,scenePickVisit:Bv,sceneToJSON:uj,sceneVisit:Ri,sceneZOrder:T9,scheme:x9,serializeXML:Sj,setRandom:pQ,span:G0,splitAccessPath:Ss,stringValue:te,textMetrics:Mi,timeBin:ez,timeFloor:GL,timeFormatLocale:d0,timeInterval:th,timeOffset:VL,timeSequence:XL,timeUnitSpecifier:PL,timeUnits:J$,toBoolean:U$,toDate:j$,toNumber:tn,toSet:Di,toString:q$,transform:Cz,transforms:wd,truncate:gL,truthy:Zr,tupleid:me,typeParsers:OA,utcFloor:WL,utcInterval:nh,utcOffset:JL,utcSequence:KL,utcdayofyear:BL,utcquarter:sL,utcweek:UL,version:f1e,visitArray:fo,week:LL,writeConfig:Kd,zero:yo,zoomLinear:R$,zoomLog:P$,zoomPow:bv,zoomSymlog:I$},Symbol.toStringTag,{value:"Module"}));function h1e(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var p1e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},g1e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},m1e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const y1e=Array.prototype.slice,Ru=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,y1e.call(t,1))},v1e=(e,t,n,r,i,s,a)=>new Date(e,t||0,n??1,r||0,i||0,s||0,a||0);var b1e={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:v1e,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Ru("join",arguments)},indexof:function(){return Ru("indexOf",arguments)},lastindexof:function(){return Ru("lastIndexOf",arguments)},slice:function(){return Ru("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Ru("substring",arguments,String)},split:function(){return Ru("split",arguments,String)},replace:function(){return Ru("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const x1e=["view","item","group","xy","x","y"],n$=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&n$.add(setImmediate);const w1e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:p1e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const i=e(t.property);if(n&&(e.memberDepth-=1),n$.has(r[i])){console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`);return}return r[i]},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),r==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||b1e[r]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>g1e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>m1e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,r)=>{e.memberDepth+=1;const i=e(r.key);return e.memberDepth-=1,n$.has(e(r.value))?console.error(`Prevented interpretation of property "${i}" which could lead to insecure code execution`):n[i]=e(r.value),n},{})};function yg(e,t,n,r,i,s){const a=o=>w1e[o.type](a,o);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=r,a.event=i,a.item=s,x1e.forEach(o=>a.fn[o]=function(){return i.vega[o](...arguments)}),a(e)}var _1e={operator(e,t){const n=t.ast,r=e.functions;return i=>yg(n,r,i)},parameter(e,t){const n=t.ast,r=e.functions;return(i,s)=>yg(n,r,s,i)},event(e,t){const n=t.ast,r=e.functions;return i=>yg(n,r,void 0,void 0,i)},handler(e,t){const n=t.ast,r=e.functions;return(i,s)=>{const a=s.item&&s.item.datum;return yg(n,r,i,a,s)}},encode(e,t){const{marktype:n,channels:r}=t,i=e.functions,s=n==="group"||n==="image"||n==="rect";return(a,o)=>{const l=a.datum;let u=0,c;for(const f in r)c=yg(r[f].ast,i,o,l,void 0,a),a[f]!==c&&(a[f]=c,u=1);return n!=="rule"&&h1e(a,r,s),u}}};const E1e="vega-lite",k1e='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',S1e="5.9.0",A1e=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],$1e="https://vega.github.io/vega-lite/",C1e="Vega-Lite is a concise high-level language for interactive visualization.",M1e=["vega","chart","visualization"],T1e="build/vega-lite.js",N1e="build/vega-lite.min.js",F1e="build/vega-lite.min.js",D1e="build/src/index",O1e="build/src/index.d.ts",R1e={vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},P1e=["bin","build","src","vega-lite*","tsconfig.json"],I1e={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},L1e={type:"git",url:"https://github.com/vega/vega-lite.git"},z1e="BSD-3-Clause",B1e={url:"https://github.com/vega/vega-lite/issues"},U1e={"@babel/core":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-alias":"^5.0.0","@rollup/plugin-babel":"^6.0.3","@rollup/plugin-commonjs":"^24.1.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@types/chai":"^4.3.4","@types/d3":"^7.4.0","@types/jest":"^27.4.1","@types/pako":"^2.0.0","@typescript-eslint/eslint-plugin":"^5.59.1","@typescript-eslint/parser":"^5.59.1","ajv-formats":"^2.1.1",ajv:"^8.12.0",chai:"^4.3.7",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^2.2.2",d3:"^7.8.4","del-cli":"^5.0.0","eslint-config-prettier":"^8.8.0","eslint-plugin-jest":"^27.2.1","eslint-plugin-prettier":"^4.2.1",eslint:"^8.39.0","highlight.js":"^11.7.0","jest-dev-server":"^6.1.1",jest:"^27.5.1",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^2.8.8",puppeteer:"^15.0.0","release-it":"^15.10.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3",rollup:"^3.21.0",serve:"^14.2.0",terser:"^5.17.1","ts-jest":"^29.1.0","ts-json-schema-generator":"^1.2.0",typescript:"~4.9.5","vega-cli":"^5.25.0","vega-datasets":"^2.7.0","vega-embed":"^6.22.1","vega-tooltip":"^0.32.0","yaml-front-matter":"^4.1.1"},j1e={"@types/clone":"~2.1.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.5.0","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.1"},q1e={vega:"^5.24.0"},G1e={node:">=16"},W1e={name:E1e,author:k1e,version:S1e,collaborators:A1e,homepage:$1e,description:C1e,keywords:M1e,main:T1e,unpkg:N1e,jsdelivr:F1e,module:D1e,types:O1e,bin:R1e,files:P1e,scripts:I1e,repository:L1e,license:z1e,bugs:B1e,devDependencies:U1e,dependencies:j1e,peerDependencies:q1e,engines:G1e};var JW={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],x=typeof Buffer<"u";typeof h>"u"&&(h=!0),typeof p>"u"&&(p=1/0);function _(w,k){if(w===null)return null;if(k===0)return w;var E,A;if(typeof w!="object")return w;if(n(w,r))E=new r;else if(n(w,i))E=new i;else if(n(w,s))E=new s(function(U,q){w.then(function(X){U(_(X,k-1))},function(X){q(_(X,k-1))})});else if(a.__isArray(w))E=[];else if(a.__isRegExp(w))E=new RegExp(w.source,f(w)),w.lastIndex&&(E.lastIndex=w.lastIndex);else if(a.__isDate(w))E=new Date(w.getTime());else{if(x&&Buffer.isBuffer(w))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(w.length):E=new Buffer(w.length),w.copy(E),E;n(w,Error)?E=Object.create(w):typeof g>"u"?(A=Object.getPrototypeOf(w),E=Object.create(A)):(E=Object.create(g),A=g)}if(h){var z=y.indexOf(w);if(z!=-1)return v[z];y.push(w),v.push(E)}n(w,r)&&w.forEach(function(U,q){var X=_(q,k-1),ae=_(U,k-1);E.set(X,ae)}),n(w,i)&&w.forEach(function(U){var q=_(U,k-1);E.add(q)});for(var D in w){var R;A&&(R=Object.getOwnPropertyDescriptor(A,D)),!(R&&R.set==null)&&(E[D]=_(w[D],k-1))}if(Object.getOwnPropertySymbols)for(var j=Object.getOwnPropertySymbols(w),D=0;D<j.length;D++){var O=j[D],L=Object.getOwnPropertyDescriptor(w,O);L&&!L.enumerable&&!m||(E[O]=_(w[O],k-1),L.enumerable||Object.defineProperty(E,O,{enumerable:!1}))}if(m)for(var P=Object.getOwnPropertyNames(w),D=0;D<P.length;D++){var B=P[D],L=Object.getOwnPropertyDescriptor(w,B);L&&L.enumerable||(E[B]=_(w[B],k-1),Object.defineProperty(E,B,{enumerable:!1}))}return E}return _(d,p)}a.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function o(d){return Object.prototype.toString.call(d)}a.__objToStr=o;function l(d){return typeof d=="object"&&o(d)==="[object Date]"}a.__isDate=l;function u(d){return typeof d=="object"&&o(d)==="[object Array]"}a.__isArray=u;function c(d){return typeof d=="object"&&o(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(JW);var H1e=JW.exports;const V1e=Qb(H1e);var J1e=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var a=s[i];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n};const YW=Qb(J1e);var Y1e=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(s){return function(a){return function(o,l){var u={key:o,value:a[o]},c={key:l,value:a[l]};return s(u,c)}}}(t.cmp),i=[];return function s(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var o,l;if(Array.isArray(a)){for(l="[",o=0;o<a.length;o++)o&&(l+=","),l+=s(a[o])||"null";return l+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(a)-1,c=Object.keys(a).sort(r&&r(a));for(l="",o=0;o<c.length;o++){var f=c[o],d=s(a[f]);d&&(l&&(l+=","),l+=JSON.stringify(f)+":"+d)}return i.splice(u,1),"{"+l+"}"}}(e)};const S6=Qb(Y1e);function A6(e){return!!e.or}function $6(e){return!!e.and}function C6(e){return!!e.not}function pv(e,t){if(C6(e))pv(e.not,t);else if($6(e))for(const n of e.and)pv(n,t);else if(A6(e))for(const n of e.or)pv(n,t);else t(e)}function ld(e,t){return C6(e)?{not:ld(e.not,t)}:$6(e)?{and:e.and.map(n=>ld(n,t))}:A6(e)?{or:e.or.map(n=>ld(n,t))}:t(e)}const os=YW,Ee=V1e;function XW(e){throw new Error(e)}function Id(e,t){const n={};for(const r of t)ve(e,r)&&(n[r]=e[r]);return n}function Xn(e,t){const n={...e};for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>S6(e)).join(",")})`};const et=S6;function Re(e){if(Ye(e))return e;const t=oe(e)?e:S6(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function r$(e){return e===!1||e===null}function Fe(e,t){return e.includes(t)}function kc(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function M6(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function KW(e,...t){for(const n of t)X1e(e,n??{});return e}function X1e(e,t){for(const n of K(t))Kd(e,n,t[n],!0)}function ls(e,t){const n=[],r={};let i;for(const s of e)i=t(s),!(i in r)&&(r[i]=1,n.push(s));return n}function K1e(e,t){const n=K(e),r=K(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}function ZW(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function T6(e,t){for(const n of e)if(t.has(n))return!0;return!1}function i$(e){const t=new Set;for(const n of e){const i=Ss(n).map((a,o)=>o===0?a:`[${a}]`),s=i.map((a,o)=>i.slice(0,o+1).join(""));for(const a of s)t.add(a)}return t}function N6(e,t){return e===void 0||t===void 0?!0:T6(i$(e),i$(t))}function Je(e){return K(e).length===0}const K=Object.keys,qt=Object.values,Wo=Object.entries;function D0(e){return e===!0||e===!1}function st(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function s0(e,t){return C6(e)?`!(${s0(e.not,t)})`:$6(e)?`(${e.and.map(n=>s0(n,t)).join(") && (")})`:A6(e)?`(${e.or.map(n=>s0(n,t)).join(") || (")})`:t(e)}function Ob(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Ob(e[n],t)&&delete e[n],Je(e)}function wm(e){return e.charAt(0).toUpperCase()+e.substr(1)}function F6(e,t="datum"){const n=Ss(e),r=[];for(let i=1;i<=n.length;i++){const s=`[${n.slice(0,i).map(te).join("][")}]`;r.push(`${t}${s}`)}return r.join(" && ")}function QW(e,t="datum"){return`${t}[${te(Ss(e).join("."))}]`}function Z1e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ni(e){return`${Ss(e).map(Z1e).join("\\.")}`}function Sc(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function D6(e){return`${Ss(e).join(".")}`}function Ld(e){return e?Ss(e).length:0}function yt(...e){for(const t of e)if(t!==void 0)return t}let eH=42;function tH(e){const t=++eH;return e?String(e)+t:t}function Q1e(){eH=42}function nH(e){return rH(e)?e:`__${e}`}function rH(e){return e.startsWith("__")}function O0(e){if(e!==void 0)return(e%360+360)%360}function px(e){return Ye(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const ba="row",xa="column",gx="facet",at="x",Rt="y",Ui="x2",Ns="y2",il="xOffset",fh="yOffset",ji="radius",Fa="radius2",si="theta",Da="theta2",qi="latitude",Gi="longitude",Wi="latitude2",ri="longitude2",rr="color",Fs="fill",Ds="stroke",ir="shape",Oa="size",Jc="angle",Ra="opacity",sl="fillOpacity",al="strokeOpacity",ol="strokeWidth",ll="strokeDash",_m="text",Em="order",km="detail",mx="key",Ac="tooltip",yx="href",vx="url",bx="description",eye={x:1,y:1,x2:1,y2:1},iH={theta:1,theta2:1,radius:1,radius2:1};function sH(e){return e in iH}const O6={longitude:1,longitude2:1,latitude:1,latitude2:1};function aH(e){switch(e){case qi:return"y";case Wi:return"y2";case Gi:return"x";case ri:return"x2"}}function oH(e){return e in O6}const tye=K(O6),R6={...eye,...iH,...O6,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function ud(e){return e===rr||e===Fs||e===Ds}const lH={row:1,column:1,facet:1},Yr=K(lH),P6={...R6,...lH},nye=K(P6),{order:L5e,detail:z5e,tooltip:B5e,...rye}=P6,{row:U5e,column:j5e,facet:q5e,...iye}=rye;function sye(e){return!!iye[e]}function uH(e){return!!P6[e]}const aye=[Ui,Ns,Wi,ri,Da,Fa];function cH(e){return Yc(e)!==e}function Yc(e){switch(e){case Ui:return at;case Ns:return Rt;case Wi:return qi;case ri:return Gi;case Da:return si;case Fa:return ji}return e}function Ho(e){if(sH(e))switch(e){case si:return"startAngle";case Da:return"endAngle";case ji:return"outerRadius";case Fa:return"innerRadius"}return e}function Os(e){switch(e){case at:return Ui;case Rt:return Ns;case qi:return Wi;case Gi:return ri;case si:return Da;case ji:return Fa}}function sr(e){switch(e){case at:case Ui:return"width";case Rt:case Ns:return"height"}}function fH(e){switch(e){case at:return"xOffset";case Rt:return"yOffset";case Ui:return"x2Offset";case Ns:return"y2Offset";case si:return"thetaOffset";case ji:return"radiusOffset";case Da:return"theta2Offset";case Fa:return"radius2Offset"}}function I6(e){switch(e){case at:return"xOffset";case Rt:return"yOffset"}}function dH(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const oye=K(R6),{x:G5e,y:W5e,x2:H5e,y2:V5e,xOffset:J5e,yOffset:Y5e,latitude:X5e,longitude:K5e,latitude2:Z5e,longitude2:Q5e,theta:eAe,theta2:tAe,radius:nAe,radius2:rAe,...L6}=R6,lye=K(L6),z6={x:1,y:1},Rs=K(z6);function Pt(e){return e in z6}const B6={theta:1,radius:1},uye=K(B6);function xx(e){return e==="width"?at:Rt}const hH={xOffset:1,yOffset:1};function dh(e){return e in hH}const{text:iAe,tooltip:sAe,href:aAe,url:oAe,description:lAe,detail:uAe,key:cAe,order:fAe,...pH}=L6,cye=K(pH);function fye(e){return!!L6[e]}function dye(e){switch(e){case rr:case Fs:case Ds:case Oa:case ir:case Ra:case ol:case ll:return!0;case sl:case al:case Jc:return!1}}const gH={...z6,...B6,...hH,...pH},wx=K(gH);function Pa(e){return!!gH[e]}function hye(e,t){return gye(e)[t]}const mH={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:dAe,...pye}=mH;function gye(e){switch(e){case rr:case Fs:case Ds:case bx:case km:case mx:case Ac:case yx:case Em:case Ra:case sl:case al:case ol:case gx:case ba:case xa:return mH;case at:case Rt:case il:case fh:case qi:case Gi:return pye;case Ui:case Ns:case Wi:case ri:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Oa:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case ll:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ir:return{point:"always",geoshape:"always"};case _m:return{text:"always"};case Jc:return{point:"always",square:"always",text:"always"};case vx:return{image:"always"};case si:return{text:"always",arc:"always"};case ji:return{text:"always",arc:"always"};case Da:case Fa:return{arc:"always"}}}function K5(e){switch(e){case at:case Rt:case si:case ji:case il:case fh:case Oa:case Jc:case ol:case Ra:case sl:case al:case Ui:case Ns:case Da:case Fa:return;case gx:case ba:case xa:case ir:case ll:case _m:case Ac:case yx:case vx:case bx:return"discrete";case rr:case Fs:case Ds:return"flexible";case qi:case Gi:case Wi:case ri:case km:case mx:case Em:return}}const mye={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},yye={count:1,min:1,max:1};function Ca(e){return!!e&&!!e.argmin}function ul(e){return!!e&&!!e.argmax}function U6(e){return oe(e)&&!!mye[e]}const vye=new Set(["count","valid","missing","distinct"]);function yH(e){return oe(e)&&vye.has(e)}function bye(e){return oe(e)&&Fe(["min","max"],e)}const xye=new Set(["count","sum","distinct","valid","missing"]),wye=new Set(["mean","average","median","q1","q3","min","max"]);function vH(e){return Ko(e)&&(e=Dx(e,void 0)),"bin"+K(e).map(t=>_x(e[t])?st(`_${t}_${Wo(e[t])}`):st(`_${t}_${e[t]}`)).join("")}function tt(e){return e===!0||Xc(e)&&!e.binned}function zt(e){return e==="binned"||Xc(e)&&e.binned===!0}function Xc(e){return ce(e)}function _x(e){return e==null?void 0:e.param}function XR(e){switch(e){case ba:case xa:case Oa:case rr:case Fs:case Ds:case ol:case Ra:case sl:case al:case ir:return 6;case ll:return 4;default:return 10}}function Sm(e){return!!(e!=null&&e.expr)}function Wn(e){const t=K(e||{}),n={};for(const r of t)n[r]=xr(e[r]);return n}function bH(e){const{anchor:t,frame:n,offset:r,orient:i,angle:s,limit:a,color:o,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,m={...g,...o?{fill:o}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...s!==void 0?{angle:s}:{},...a!==void 0?{limit:a}:{}},v={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},x=Id(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMarkTitleProperties:y,subtitle:v}}function mo(e){return oe(e)||Y(e)&&oe(e[0])}function pe(e){return!!(e!=null&&e.signal)}function cl(e){return!!e.step}function _ye(e){return Y(e)?!1:"fields"in e&&!("data"in e)}function Eye(e){return Y(e)?!1:"fields"in e&&"data"in e}function ga(e){return Y(e)?!1:"field"in e&&"data"in e}const kye={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Sye=K(kye),Aye={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},s$=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function xH(e){const t=Y(e.condition)?e.condition.map(KR):KR(e.condition);return{...xr(e),condition:t}}function xr(e){if(Sm(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function KR(e){if(Sm(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function rt(e){if(Sm(e)){const{expr:t,...n}=e;return{signal:t,...n}}return pe(e)?e:e!==void 0?{value:e}:void 0}function $ye(e){return pe(e)?e.signal:te(e)}function ZR(e){return pe(e)?e.signal:te(e.value)}function wa(e){return pe(e)?e.signal:e==null?null:te(e)}function Cye(e,t,n){for(const r of n){const i=$c(r,t.markDef,t.config);i!==void 0&&(e[r]=rt(i))}return e}function wH(e){return[].concat(e.type,e.style??[])}function He(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:s}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:s&&(!i||i===e)?void 0:$c(e,t,n,r)}function $c(e,t,n,{vgChannel:r}={}){return yt(r?Rb(e,t,n.style):void 0,Rb(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function Rb(e,t,n){return _H(e,wH(t),n)}function _H(e,t,n){t=le(t);let r;for(const i of t){const s=n[i];s&&s[e]!==void 0&&(r=s[e])}return r}function EH(e,t){return le(e).reduce((n,r)=>(n.field.push(se(r,t)),n.order.push(r.sort??"ascending"),n),{field:[],order:[]})}function kH(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(os(i,r))return;n.push(r)}),n}function SH(e,t){return os(e,t)||!t?e:e?[...le(e),...le(t)].join(", "):t}function AH(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((mo(n)||pe(n))&&(mo(r)||pe(r)))return{explicit:e.explicit,value:SH(n,r)};if(mo(n)||pe(n))return{explicit:e.explicit,value:n};if(mo(r)||pe(r))return{explicit:e.explicit,value:r};if(!mo(n)&&!pe(n)&&!mo(r)&&!pe(r))return{explicit:e.explicit,value:kH(n,r)};throw new Error("It should never reach here")}function j6(e){return`Invalid specification ${et(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Mye='Autosize "fit" only works for single views and layered views.';function QR(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function eP(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function tP(e){return e?`Dropping "fit-${e}" because spec has discrete ${sr(e)}.`:'Dropping "fit" because spec has discrete size.'}function q6(e){return`Unknown field for ${e}. Cannot calculate view size.`}function nP(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Tye(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Nye(e){return`The "nearest" transform is not supported for ${e} marks.`}function $H(e){return`Selection not supported for ${e} yet.`}function Fye(e){return`Cannot find a selection named "${e}".`}const Dye="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Oye="Legend bindings are only supported for selections over an individual field or encoding channel.";function Rye(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Pye(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Iye="The same selection must be used to override scale domains in a layered view.",Lye='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function zye(e){return`Unknown repeated value "${e}".`}function rP(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Bye="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Uye(e){return`Unrecognized parse "${e}".`}function iP(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const jye="Attempt to add the same child twice.";function qye(e){return`Ignoring an invalid transform: ${et(e)}.`}const Gye='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function sP(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Wye(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${et(t)} is overridden by a child projection ${et(n)}.`}const Hye="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Vye(e){return`${e}Offset dropped because ${e} is continuous`}function Jye(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function Yye(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${et(n)}}.`}function CH(e){return`Invalid field type "${e}".`}function Xye(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Kye(e){return`Invalid aggregation operator "${e}".`}function MH(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Zye(e){return`Position range does not support relative band size for ${e}.`}function a$(e,t){return`Dropping ${et(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Qye="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Ex(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function eve(e){return`${e} encoding has no scale, so specified scale is ignored.`}function tve(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function nve(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function rve(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function ive(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Z5(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function sve(e){return`The ${e} for range marks cannot be an expression`}function ave(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function ove(e,t){return`Specified orient "${e}" overridden with "${t}".`}function lve(e){return`Cannot use the scale property "${e}" with non-color channel.`}function uve(e){return`Cannot use the relative band size with ${e} scale.`}function cve(e){return`Using unaggregated domain with raw field has no effect (${et(e)}).`}function fve(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function dve(e){return`Unaggregated domain is currently unsupported for log scale (${et(e)}).`}function hve(e){return`Cannot apply size to non-oriented mark "${e}".`}function pve(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function gve(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function TH(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function NH(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function mve(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${et(n)} and ${et(r)}). Using ${et(n)}.`}function yve(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${et(n)} and ${et(r)}). Using the union of the two domains.`}function vve(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function bve(e){return`Dropping sort property ${et(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const aP="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",xve="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",wve="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",_ve="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function Eve(e){return`Cannot stack "${e}" if there is already "${e}2".`}function kve(e){return`Cannot stack non-linear scale (${e}).`}function Sve(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Pb(e,t){return`Invalid ${e}: ${et(t)}.`}function Ave(e){return`Dropping day from datetime ${et(e)} as day cannot be combined with other units.`}function $ve(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Cve(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Mve(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function oP(e){return`1D error band does not support ${e}.`}function FH(e){return`Channel ${e} is required for "binned" bin.`}function Tve(e){return`Channel ${e} should not be used with "binned" bin.`}function Nve(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const DH=O$(D$);let zd=DH;function Fve(e){return zd=e,zd}function Dve(){return zd=DH,zd}function Q(...e){zd.warn(...e)}function Ove(...e){zd.debug(...e)}function Kc(e){if(e&&ce(e)){for(const t of W6)if(t in e)return!0}return!1}const OH=["january","february","march","april","may","june","july","august","september","october","november","december"],Rve=OH.map(e=>e.substr(0,3)),RH=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Pve=RH.map(e=>e.substr(0,3));function Ive(e){if(px(e)&&(e=+e),Ye(e))return e>4&&Q(Pb("quarter",e)),e-1;throw new Error(Pb("quarter",e))}function Lve(e){if(px(e)&&(e=+e),Ye(e))return e-1;{const t=e.toLowerCase(),n=OH.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Rve.indexOf(r);if(i!==-1)return i;throw new Error(Pb("month",e))}}function zve(e){if(px(e)&&(e=+e),Ye(e))return e%7;{const t=e.toLowerCase(),n=RH.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=Pve.indexOf(r);if(i!==-1)return i;throw new Error(Pb("day",e))}}function G6(e,t){const n=[];if(t&&e.day!==void 0&&K(e).length>1&&(Q(Ave(e)),e=Ee(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?Lve(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?Ive(e.quarter):e.quarter;n.push(Ye(r)?r*3:`${r}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?zve(e.day):e.day;n.push(Ye(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function Cc(e){const n=G6(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Bve(e){const n=G6(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Uve(e){const t=G6(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const PH={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},W6=K(PH);function jve(e){return!!PH[e]}function H6(e){return e.startsWith("utc")}function qve(e){return e.substr(3)}const Gve={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function kx(e){return W6.filter(t=>IH(e,t))}function Wve(e){const t=kx(e);return t[t.length-1]}function IH(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Hve(e,t,{end:n}={end:!1}){const r=F6(t),i=H6(e)?"utc":"";function s(l){return l==="quarter"?`(${i}quarter(${r})-1)`:`${i}${l}(${r})`}let a;const o={};for(const l of W6)IH(e,l)&&(o[l]=s(l),a=l);return n&&(o[a]+="+1"),Bve(o)}function LH(e){if(!e)return;const t=kx(e);return`timeUnitSpecifier(${et(t)}, ${et(Gve)})`}function Vve(e,t,n){if(!e)return;const r=LH(e);return`${n||H6(e)?"utc":"time"}Format(${t}, ${r})`}function Wt(e){if(!e)return;let t;return oe(e)?t={unit:e}:ce(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),H6(t.unit)&&(t.utc=!0,t.unit=qve(t.unit)),t}function Jve(e){const{utc:t,...n}=Wt(e);return n.unit?(t?"utc":"")+K(n).map(r=>st(`${r==="unit"?"":`_${r}_`}${n[r]}`)).join(""):(t?"utc":"")+"timeunit"+K(n).map(r=>st(`_${r}_${n[r]}`)).join("")}function zH(e,t=n=>n){const n=Wt(e),r=Wve(n.unit);if(r&&r!=="day"){const i={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},s=n.step||1,a={...i,...r==="quarter"?{month:+i.month+s*3}:{[r]:+i[r]+s}};return`${t(Cc(a))} - ${t(Cc(i))}`}}function Yve(e){return e==null?void 0:e.param}function V6(e){return!!(e!=null&&e.field)&&e.equal!==void 0}function J6(e){return!!(e!=null&&e.field)&&e.lt!==void 0}function Y6(e){return!!(e!=null&&e.field)&&e.lte!==void 0}function X6(e){return!!(e!=null&&e.field)&&e.gt!==void 0}function K6(e){return!!(e!=null&&e.field)&&e.gte!==void 0}function Z6(e){if(e!=null&&e.field){if(Y(e.range)&&e.range.length===2)return!0;if(pe(e.range))return!0}return!1}function Q6(e){return!!(e!=null&&e.field)&&(Y(e.oneOf)||Y(e.in))}function Xve(e){return!!(e!=null&&e.field)&&e.valid!==void 0}function BH(e){return Q6(e)||V6(e)||Z6(e)||J6(e)||X6(e)||Y6(e)||K6(e)}function Qi(e,t){return Ox(e,{timeUnit:t,wrapTime:!0})}function Kve(e,t){return e.map(n=>Qi(n,t))}function UH(e,t=!0){var s;const{field:n}=e,r=(s=Wt(e.timeUnit))==null?void 0:s.unit,i=r?`time(${Hve(r,n)})`:se(e,{expr:"datum"});if(V6(e))return`${i}===${Qi(e.equal,r)}`;if(J6(e)){const a=e.lt;return`${i}<${Qi(a,r)}`}else if(X6(e)){const a=e.gt;return`${i}>${Qi(a,r)}`}else if(Y6(e)){const a=e.lte;return`${i}<=${Qi(a,r)}`}else if(K6(e)){const a=e.gte;return`${i}>=${Qi(a,r)}`}else{if(Q6(e))return`indexof([${Kve(e.oneOf,r).join(",")}], ${i}) !== -1`;if(Xve(e))return eM(i,e.valid);if(Z6(e)){const{range:a}=e,o=pe(a)?{signal:`${a.signal}[0]`}:a[0],l=pe(a)?{signal:`${a.signal}[1]`}:a[1];if(o!==null&&l!==null&&t)return"inrange("+i+", ["+Qi(o,r)+", "+Qi(l,r)+"])";const u=[];return o!==null&&u.push(`${i} >= ${Qi(o,r)}`),l!==null&&u.push(`${i} <= ${Qi(l,r)}`),u.length>0?u.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${et(e)}`)}function eM(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Zve(e){var t;return BH(e)&&e.timeUnit?{...e,timeUnit:(t=Wt(e.timeUnit))==null?void 0:t.unit}:e}const Am={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Qve(e){return e==="quantitative"||e==="temporal"}function jH(e){return e==="ordinal"||e==="nominal"}const Mc=Am.quantitative,tM=Am.ordinal,Bd=Am.temporal,nM=Am.nominal,hh=Am.geojson;function ebe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Mc:return"quantitative";case"t":case Bd:return"temporal";case"o":case tM:return"ordinal";case"n":case nM:return"nominal";case hh:return"geojson"}}const Kn={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},o$={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function tbe(e,t){const n=o$[e],r=o$[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const nbe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function lP(e){return nbe[e]}const qH=new Set(["linear","log","pow","sqrt","symlog"]),GH=new Set([...qH,"time","utc"]);function WH(e){return qH.has(e)}const HH=new Set(["quantile","quantize","threshold"]),rbe=new Set([...GH,...HH,"sequential","identity"]),ibe=new Set(["ordinal","bin-ordinal","point","band"]);function It(e){return ibe.has(e)}function Cr(e){return rbe.has(e)}function $i(e){return GH.has(e)}function Ud(e){return HH.has(e)}const sbe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0};function abe(e){return!oe(e)&&!!e.name}function VH(e){return e==null?void 0:e.param}function obe(e){return e==null?void 0:e.unionWith}function lbe(e){return ce(e)&&"field"in e}const ube={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:hAe,domain:pAe,range:gAe,rangeMax:mAe,rangeMin:yAe,scheme:vAe,...cbe}=ube,fbe=K(cbe);function l$(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return $i(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return $i(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return $i(e);case"nice":return $i(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Cr(e)&&!Fe(["log","time","utc","threshold","quantile"],e)}}function JH(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return ud(e)?void 0:lve(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function dbe(e,t){return Fe([tM,nM],t)?e===void 0||It(e):t===Bd?Fe([Kn.TIME,Kn.UTC,void 0],e):t===Mc?WH(e)||Ud(e)||e===void 0:!0}function hbe(e,t,n=!1){if(!Pa(e))return!1;switch(e){case at:case Rt:case il:case fh:case si:case ji:return $i(t)||t==="band"?!0:t==="point"?!n:!1;case Oa:case ol:case Ra:case sl:case al:case Jc:return $i(t)||Ud(t)||Fe(["band","point","ordinal"],t);case rr:case Fs:case Ds:return t!=="band";case ll:case ir:return t==="ordinal"||Ud(t)}}const In={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},YH=In.arc,Sx=In.area,Ax=In.bar,pbe=In.image,$x=In.line,Cx=In.point,gbe=In.rect,Ib=In.rule,XH=In.text,rM=In.tick,mbe=In.trail,iM=In.circle,sM=In.square,KH=In.geoshape;function fl(e){return["line","area","trail"].includes(e)}function ZH(e){return["rect","bar","image","arc"].includes(e)}const ybe=new Set(K(In));function _s(e){return e.type}const vbe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],bbe=["fill","fillOpacity"],xbe=[...vbe,...bbe],wbe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},uP=K(wbe),_be={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Ebe={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},kbe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},QH=K(kbe);function Tc(e){return e&&e.band!=null}const Sbe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},eV=5,Abe={binSpacing:1,continuousBandSize:eV,timeUnitBandPosition:.5},$be={binSpacing:0,continuousBandSize:eV,timeUnitBandPosition:.5},Cbe={thickness:1};function Mbe(e){return _s(e)?e.type:e}function aM(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:s}=e,a=lM(e);return ee(n)&&!yH(n.aggregate)&&i&&$i(i.get("type"))?Tbe({fieldDef:n,channel:t,markDef:r,ref:a,config:s}):a}function Tbe({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return fl(n.type)?r:He("invalid",n,i)===null?[Nbe(e,t),r]:r}function Nbe(e,t){const n=oM(e,!0),i=Yc(t)==="y"?{field:{group:"height"}}:{value:0};return{test:n,...i}}function oM(e,t=!0){return eM(oe(e)?e:se(e,{expr:"datum"}),!t)}function Fbe(e){const{datum:t}=e;return Kc(t)?Cc(t):`${et(t)}`}function uc(e,t,n,r){const i={};if(t&&(i.scale=t),Ps(e)){const{datum:s}=e;Kc(s)?i.signal=Cc(s):pe(s)?i.signal=s.signal:Sm(s)?i.signal=s.expr:i.value=s}else i.field=se(e,n);if(r){const{offset:s,band:a}=r;s&&(i.offset=s),a&&(i.band=a)}return i}function Lb({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:s=.5}){const a=0<s&&s<1?"datum":void 0,o=se(t,{expr:a,suffix:i}),l=n!==void 0?se(n,{expr:a}):se(t,{suffix:"end",expr:a}),u={};if(s===0||s===1){u.scale=e;const c=s===0?o:l;u.field=c}else{const c=pe(s)?`${s.signal} * ${o} + (1-${s.signal}) * ${l}`:`${s} * ${o} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return r&&(u.offset=r),u}function lM({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u,bandPosition:c}){if(t){if(_e(t)){const f=a==null?void 0:a.get("type");if(Rn(t)){c??(c=lV({fieldDef:t,fieldDef2:n,markDef:r,config:i}));const{bin:d,timeUnit:h,type:p}=t;if(tt(d)||c&&h&&p===Bd)return o!=null&&o.impute?uc(t,s,{binSuffix:"mid"},{offset:l}):c&&!It(f)?Lb({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):uc(t,s,Tm(t,e)?{binSuffix:"range"}:{},{offset:l});if(zt(d)){if(ee(n))return Lb({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});Q(FH(e===at?Ui:Ns))}}return uc(t,s,It(f)?{binSuffix:"range"}:{},{offset:l,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(Pi(t)){const f=t.value,d=l?{offset:l}:{};return{...a0(e,f),...d}}}return $e(u)&&(u=u()),u&&{...u,...l?{offset:l}:{}}}function a0(e,t){return Fe(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Fe(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:rt(t)}function Nc(e){return e&&e!=="number"&&e!=="time"}function tV(e,t,n){return`${e}(${t}${n?`, ${et(n)}`:""})`}const Dbe=" – ";function uM({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s}){var l,u;if(Nc(n))return Ci({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:s});const a=nV(e,r,i),o=jd(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(o==="quantitative"){if(i&&s.normalizedNumberFormatType)return Ci({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:r,config:s});if(s.numberFormatType)return Ci({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:r,config:s})}if(o==="temporal"&&s.timeFormatType&&ee(e)&&e.timeUnit===void 0)return Ci({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:r,config:s})}if(Gd(e)){const c=Rbe({field:a,timeUnit:ee(e)?(l=Wt(e.timeUnit))==null?void 0:l.unit:void 0,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:Zc(e)&&((u=e.scale)==null?void 0:u.type)===Kn.UTC});return c?{signal:c}:void 0}if(t=u$({type:o,specifiedFormat:t,config:s,normalizeStack:i}),ee(e)&&tt(e.bin)){const c=se(e,{expr:r,binSuffix:"end"});return{signal:$m(a,c,t,n,s)}}else return t||jd(e)==="quantitative"?{signal:`${sV(a,t)}`}:{signal:`isValid(${a}) ? ${a} : ""+${a}`}}function nV(e,t,n){return ee(e)?n?`${se(e,{expr:t,suffix:"end"})}-${se(e,{expr:t,suffix:"start"})}`:se(e,{expr:t}):Fbe(e)}function Ci({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s,field:a}){if(a??(a=nV(e,r,i)),a!=="datum.value"&&ee(e)&&tt(e.bin)){const o=se(e,{expr:r,binSuffix:"end"});return{signal:$m(a,o,t,n,s)}}return{signal:tV(n,a,t)}}function rV(e,t,n,r,i,s){var a;if(!(oe(r)&&Nc(r))&&!(n===void 0&&r===void 0&&i.customFormatTypes&&jd(e)==="quantitative"&&(i.normalizedNumberFormatType&&qd(e)&&e.stack==="normalize"||i.numberFormatType))){if(qd(e)&&e.stack==="normalize"&&i.normalizedNumberFormat)return u$({type:"quantitative",config:i,normalizeStack:!0});if(Gd(e)){const o=ee(e)?(a=Wt(e.timeUnit))==null?void 0:a.unit:void 0;return o===void 0&&i.customFormatTypes&&i.timeFormatType?void 0:Obe({specifiedFormat:n,timeUnit:o,config:i,omitTimeFormatConfig:s})}return u$({type:t,specifiedFormat:n,config:i})}}function iV(e,t,n){var r;if(e&&(pe(e)||e==="number"||e==="time"))return e;if(Gd(t)&&n!=="time"&&n!=="utc")return ee(t)&&((r=Wt(t==null?void 0:t.timeUnit))!=null&&r.utc)?"utc":"time"}function u$({type:e,specifiedFormat:t,config:n,normalizeStack:r}){if(oe(t))return t;if(e===Mc)return r?n.normalizedNumberFormat:n.numberFormat}function Obe({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:r}){return e||(t?{signal:LH(t)}:r?void 0:n.timeFormat)}function sV(e,t){return`format(${e}, "${t||""}")`}function cP(e,t,n,r){return Nc(n)?tV(n,e,t):sV(e,(oe(t)?t:void 0)??r.numberFormat)}function $m(e,t,n,r,i){if(n===void 0&&r===void 0&&i.customFormatTypes&&i.numberFormatType)return $m(e,t,i.numberFormat,i.numberFormatType,i);const s=cP(e,n,r,i),a=cP(t,n,r,i);return`${eM(e,!1)} ? "null" : ${s} + "${Dbe}" + ${a}`}function Rbe({field:e,timeUnit:t,format:n,formatType:r,rawTimeFormat:i,isUTCScale:s}){return!t||n?!t&&r?`${r}(${e}, '${n}')`:(n=oe(n)?n:i,`${s?"utc":"time"}Format(${e}, '${n}')`):Vve(t,e,s)}const Mx="min",Pbe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function fP(e){return e in Pbe}function aV(e){return!!(e!=null&&e.encoding)}function hs(e){return e&&(e.op==="count"||!!e.field)}function oV(e){return e&&Y(e)}function Cm(e){return"row"in e||"column"in e}function cM(e){return!!e&&"header"in e}function Tx(e){return"facet"in e}function Ibe(e){return e.param}function Lbe(e){return e&&!oe(e)&&"repeat"in e}function dP(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:t}}function fM(e){return"sort"in e}function lV({fieldDef:e,fieldDef2:t,markDef:n,config:r}){if(_e(e)&&e.bandPosition!==void 0)return e.bandPosition;if(ee(e)){const{timeUnit:i,bin:s}=e;if(i&&!t)return ZH(n.type)?0:$c("timeUnitBandPosition",n,r);if(tt(s))return .5}}function uV({channel:e,fieldDef:t,fieldDef2:n,markDef:r,config:i,scaleType:s,useVlSizeChannel:a}){var u,c,f;const o=sr(e),l=He(a?"size":o,r,i,{vgChannel:o});if(l!==void 0)return l;if(ee(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:$c("timeUnitBandSize",r,i)};if(tt(h)&&!It(s))return{band:1}}if(ZH(r.type))return s?It(s)?((u=i[r.type])==null?void 0:u.discreteBandSize)||{band:1}:(c=i[r.type])==null?void 0:c.continuousBandSize:(f=i[r.type])==null?void 0:f.discreteBandSize}function cV(e,t,n,r){return tt(e.bin)||e.timeUnit&&Rn(e)&&e.type==="temporal"?lV({fieldDef:e,fieldDef2:t,markDef:n,config:r})!==void 0:!1}function Nx(e){return e&&"condition"in e}function Fx(e){const t=e==null?void 0:e.condition;return!!t&&!Y(t)&&ee(t)}function Mm(e){const t=e==null?void 0:e.condition;return!!t&&!Y(t)&&_e(t)}function zbe(e){const t=e==null?void 0:e.condition;return!!t&&(Y(t)||Pi(t))}function ee(e){return e&&(!!e.field||e.aggregate==="count")}function jd(e){return e==null?void 0:e.type}function Ps(e){return e&&"datum"in e}function $o(e){return Rn(e)&&!Bb(e)||zb(e)}function hP(e){return Rn(e)&&e.type==="quantitative"&&!e.bin||zb(e)}function zb(e){return Ps(e)&&Ye(e.datum)}function _e(e){return ee(e)||Ps(e)}function Rn(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function Pi(e){return e&&"value"in e&&"value"in e}function Zc(e){return e&&("scale"in e||"sort"in e)}function qd(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function fV(e){return e&&"legend"in e}function dV(e){return e&&("format"in e||"formatType"in e)}function Bbe(e){return Xn(e,["legend","axis","header","scale"])}function Ube(e){return"op"in e}function se(e,t={}){let n=e.field;const r=t.prefix;let i=t.suffix,s="";if(qbe(e))n=nH("count");else{let a;if(!t.nofn)if(Ube(e))a=e.op;else{const{bin:o,aggregate:l,timeUnit:u}=e;tt(o)?(a=vH(o),i=(t.binSuffix??"")+(t.suffix??"")):l?ul(l)?(s=`["${n}"]`,n=`argmax_${l.argmax}`):Ca(l)?(s=`["${n}"]`,n=`argmin_${l.argmin}`):a=String(l):u&&(a=Jve(u),i=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}a&&(n=n?`${a}_${n}`:a)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),t.forAs?D6(n):t.expr?QW(n,t.expr)+s:ni(n)+s}function Bb(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ee(e)&&!!e.bin;case"temporal":return!1}throw new Error(CH(e.type))}function jbe(e){var t;return Zc(e)&&Ud((t=e.scale)==null?void 0:t.type)}function qbe(e){return e.aggregate==="count"}function Gbe(e,t){var a;const{field:n,bin:r,timeUnit:i,aggregate:s}=e;if(s==="count")return t.countTitle;if(tt(r))return`${n} (binned)`;if(i){const o=(a=Wt(i))==null?void 0:a.unit;if(o)return`${n} (${kx(o).join("-")})`}else if(s)return ul(s)?`${n} for max ${s.argmax}`:Ca(s)?`${n} for min ${s.argmin}`:`${wm(s)} of ${n}`;return n}function Wbe(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(ul(t))return`${i} for argmax(${t.argmax})`;if(Ca(t))return`${i} for argmin(${t.argmin})`;const s=Wt(r),a=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||tt(n)&&"bin";return a?`${a.toUpperCase()}(${i})`:i}const hV=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Wbe(e);default:return Gbe(e,t)}};let pV=hV;function gV(e){pV=e}function Hbe(){gV(hV)}function cd(e,t,{allowDisabling:n,includeDefault:r=!0}){var o;const i=(o=dM(e))==null?void 0:o.title;if(!ee(e))return i??e.title;const s=e,a=r?hM(s,t):void 0;return n?yt(i,s.title,a):i??s.title??a}function dM(e){if(qd(e)&&e.axis)return e.axis;if(fV(e)&&e.legend)return e.legend;if(cM(e)&&e.header)return e.header}function hM(e,t){return pV(e,t)}function Ub(e){if(dV(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=dM(e)??{},{format:n,formatType:r}=t;return{format:n,formatType:r}}}function Vbe(e,t){var s;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(fM(e)&&Y(e.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=e;if(i)return"temporal";if(r||n&&!ul(n)&&!Ca(n))return"quantitative";if(Zc(e)&&((s=e.scale)!=null&&s.type))switch(o$[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Es(e){if(ee(e))return e;if(Fx(e))return e.condition}function kt(e){if(_e(e))return e;if(Mm(e))return e.condition}function mV(e,t,n,r={}){if(oe(e)||Ye(e)||Ko(e)){const i=oe(e)?"string":Ye(e)?"number":"boolean";return Q(Yye(t,i,e)),{value:e}}return _e(e)?jb(e,t,n,r):Mm(e)?{...e,condition:jb(e.condition,t,n,r)}:e}function jb(e,t,n,r){if(dV(e)){const{format:i,formatType:s,...a}=e;if(Nc(s)&&!n.customFormatTypes)return Q(sP(t)),jb(a,t,n,r)}else{const i=qd(e)?"axis":fV(e)?"legend":cM(e)?"header":null;if(i&&e[i]){const{format:s,formatType:a,...o}=e[i];if(Nc(a)&&!n.customFormatTypes)return Q(sP(t)),jb({...e,[i]:o},t,n,r)}}return ee(e)?pM(e,t,r):Jbe(e)}function Jbe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Ye(n)?"quantitative":oe(n)?"nominal":Kc(n)?"temporal":void 0,{...e,type:t}}function pM(e,t,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:s,field:a}=e,o={...e};if(!n&&r&&!U6(r)&&!ul(r)&&!Ca(r)&&(Q(Kye(r)),delete o.aggregate),i&&(o.timeUnit=Wt(i)),a&&(o.field=`${a}`),tt(s)&&(o.bin=Dx(s,t)),zt(s)&&!Pt(t)&&Q(Tve(t)),Rn(o)){const{type:l}=o,u=ebe(l);l!==u&&(o.type=u),l!=="quantitative"&&yH(r)&&(Q(Xye(l,r)),o.type="quantitative")}else if(!cH(t)){const l=Vbe(o,t);o.type=l}if(Rn(o)){const{compatible:l,warning:u}=Ybe(o,t)||{};l===!1&&Q(u)}if(fM(o)&&oe(o.sort)){const{sort:l}=o;if(fP(l))return{...o,sort:{encoding:l}};const u=l.substr(1);if(l.charAt(0)==="-"&&fP(u))return{...o,sort:{encoding:u,order:"descending"}}}if(cM(o)){const{header:l}=o;if(l){const{orient:u,...c}=l;if(u)return{...o,header:{...c,labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u}}}}return o}function Dx(e,t){return Ko(e)?{maxbins:XR(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:XR(t)}:e}const qf={compatible:!0};function Ybe(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ba:case xa:case gx:return Bb(e)?qf:{compatible:!1,warning:nve(t)};case at:case Rt:case il:case fh:case rr:case Fs:case Ds:case _m:case km:case mx:case Ac:case yx:case vx:case Jc:case si:case ji:case bx:return qf;case Gi:case ri:case qi:case Wi:return n!==Mc?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:qf;case Ra:case sl:case al:case ol:case Oa:case Da:case Fa:case Ui:case Ns:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:qf;case ir:case ll:return!Bb(e)&&!jbe(e)?{compatible:!1,warning:rve(t)}:qf;case Em:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:qf}}function Gd(e){const{formatType:t}=Ub(e);return t==="time"||!t&&Xbe(e)}function Xbe(e){return e&&(e.type==="temporal"||ee(e)&&!!e.timeUnit)}function Ox(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var l;const s=t&&((l=Wt(t))==null?void 0:l.unit);let a=s||n==="temporal",o;return Sm(e)?o=e.expr:pe(e)?o=e.signal:Kc(e)?(a=!0,o=Cc(e)):(oe(e)||Ye(e))&&a&&(o=`datetime(${et(e)})`,jve(s)&&(Ye(e)&&e<1e4||oe(e)&&isNaN(Date.parse(e)))&&(o=Cc({[s]:e}))),o?r&&a?`time(${o})`:o:i?void 0:et(e)}function yV(e,t){const{type:n}=e;return t.map(r=>{const i=Ox(r,{timeUnit:ee(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Tm(e,t){return tt(e.bin)?Pa(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const pP={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Nm(e){return e==null?void 0:e.condition}const vV=["domain","grid","labels","ticks","title"],Kbe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},bV={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Zbe={...bV,style:1,labelExpr:1,encoding:1};function gP(e){return!!Zbe[e]}const Qbe={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},xV=K(Qbe);function Ia(e){return"mark"in e}class Rx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Ia(t)?Mbe(t.mark)===this.name:!1}}function cc(e,t){const n=e&&e[t];return n?Y(n)?kc(n,r=>!!r.field):ee(n)||Fx(n):!1}function wV(e,t){const n=e&&e[t];return n?Y(n)?kc(n,r=>!!r.field):ee(n)||Ps(n)||Mm(n):!1}function c$(e,t){if(Pt(t)){const n=e[t];if((ee(n)||Ps(n))&&(jH(n.type)||ee(n)&&n.timeUnit)){const r=I6(t);return wV(e,r)}}return!1}function gM(e){return kc(nye,t=>{if(cc(e,t)){const n=e[t];if(Y(n))return kc(n,r=>!!r.aggregate);{const r=Es(n);return r&&!!r.aggregate}}return!1})}function _V(e,t){const n=[],r=[],i=[],s=[],a={};return mM(e,(o,l)=>{if(ee(o)){const{field:u,aggregate:c,bin:f,timeUnit:d,...h}=o;if(c||d||f){const p=dM(o),g=p==null?void 0:p.title;let m=se(o,{forAs:!0});const y={...g?[]:{title:cd(o,t,{allowDisabling:!0})},...h,field:m};if(c){let v;if(ul(c)?(v="argmax",m=se({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${u}`):Ca(c)?(v="argmin",m=se({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${u}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:m};u&&(x.field=u),s.push(x)}}else if(n.push(m),Rn(o)&&tt(f)){if(r.push({bin:f,field:u,as:m}),n.push(se(o,{binSuffix:"end"})),Tm(o,l)&&n.push(se(o,{binSuffix:"range"})),Pt(l)){const v={field:`${m}_end`};a[`${l}2`]=v}y.bin="binned",cH(l)||(y.type=Mc)}else if(d){i.push({timeUnit:d,field:u,as:m});const v=Rn(o)&&o.type!==Bd&&"time";v&&(l===_m||l===Ac?y.formatType=v:fye(l)?y.legend={formatType:v,...y.legend}:Pt(l)&&(y.axis={formatType:v,...y.axis}))}a[l]=y}else n.push(u),a[l]=e[l]}else a[l]=e[l]}),{bins:r,timeUnits:i,aggregate:s,groupby:n,encoding:a}}function e2e(e,t,n){const r=hye(t,n);if(r){if(r==="binned"){const i=e[t===Ui?at:Rt];return!!(ee(i)&&ee(e[t])&&zt(i.bin))}}else return!1;return!0}function t2e(e,t,n,r){const i={};for(const s of K(e))uH(s)||Q(tve(s));for(let s of oye){if(!e[s])continue;const a=e[s];if(dh(s)){const o=dH(s),l=i[o];if(ee(l)){if(Qve(l.type)&&ee(a)&&!l.timeUnit){Q(Vye(o));continue}}else s=o,Q(Jye(o))}if(s==="angle"&&t==="arc"&&!e.theta&&(Q(Hye),s=si),!e2e(e,s,t)){Q(Ex(s,t));continue}if(s===Oa&&t==="line"){const o=Es(e[s]);if(o!=null&&o.aggregate){Q(Qye);continue}}if(s===rr&&(n?"fill"in e:"stroke"in e)){Q(MH("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===km||s===Em&&!Y(a)&&!Pi(a)||s===Ac&&Y(a))a&&(i[s]=le(a).reduce((o,l)=>(ee(l)?o.push(pM(l,s)):Q(a$(l,s)),o),[]));else{if(s===Ac&&a===null)i[s]=null;else if(!ee(a)&&!Ps(a)&&!Pi(a)&&!Nx(a)&&!pe(a)){Q(a$(a,s));continue}i[s]=mV(a,s,r)}}return i}function Px(e,t){const n={};for(const r of K(e)){const i=mV(e[r],r,t,{compositeMark:!0});n[r]=i}return n}function n2e(e){const t=[];for(const n of K(e))if(cc(e,n)){const r=e[n],i=le(r);for(const s of i)ee(s)?t.push(s):Fx(s)&&t.push(s.condition)}return t}function mM(e,t,n){if(e)for(const r of K(e)){const i=e[r];if(Y(i))for(const s of i)t.call(n,s,r);else t.call(n,i,r)}}function r2e(e,t,n,r){return e?K(e).reduce((i,s)=>{const a=e[s];return Y(a)?a.reduce((o,l)=>t.call(r,o,l,s),i):t.call(r,i,a,s)},n):n}function EV(e,t){return K(t).reduce((n,r)=>{switch(r){case at:case Rt:case yx:case bx:case vx:case Ui:case Ns:case il:case fh:case si:case Da:case ji:case Fa:case qi:case Gi:case Wi:case ri:case _m:case ir:case Jc:case Ac:return n;case Em:if(e==="line"||e==="trail")return n;case km:case mx:{const i=t[r];if(Y(i)||ee(i))for(const s of le(i))s.aggregate||n.push(se(s,{}));return n}case Oa:if(e==="trail")return n;case rr:case Fs:case Ds:case Ra:case sl:case al:case ll:case ol:{const i=Es(t[r]);return i&&!i.aggregate&&n.push(se(i,{})),n}}},[])}function i2e(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let r,i;if(Y(t)){for(const s of t)s.aggregate?(r||(r=[]),r.push(s)):(i||(i=[]),i.push(s));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return Y(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function f$(e,t,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=e.map(({fieldPrefix:a,titlePrefix:o})=>{const l=r?` of ${yM(t)}`:"";return{field:a+t.field,type:t.type,title:pe(o)?{signal:`${o}"${escape(l)}"`}:o+l}}),s=n2e(n).map(Bbe);return{tooltip:[...i,...ls(s,Re)]}}function yM(e){const{title:t,field:n}=e;return yt(t,n)}function vM(e,t,n,r,i){const{scale:s,axis:a}=n;return({partName:o,mark:l,positionPrefix:u,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=yM(n);return kV(e,o,i,{mark:l,encoding:{[t]:{field:`${u}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...s!==void 0?{scale:s}:{},...a!==void 0?{axis:a}:{}},...oe(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...r,...f}})}}function kV(e,t,n,r){const{clip:i,color:s,opacity:a}=e,o=e.type;return e[t]||e[t]===void 0&&n[t]?[{...r,mark:{...n[t],...i?{clip:i}:{},...s?{color:s}:{},...a?{opacity:a}:{},..._s(r.mark)?r.mark:{type:r.mark},style:`${o}-${String(t)}`,...Ko(e[t])?{}:e[t]}}]:[]}function SV(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",s=r[i],a=r[`${i}2`],o=r[`${i}Error`],l=r[`${i}Error2`];return{continuousAxisChannelDef:Dy(s,n),continuousAxisChannelDef2:Dy(a,n),continuousAxisChannelDefError:Dy(o,n),continuousAxisChannelDefError2:Dy(l,n),continuousAxis:i}}function Dy(e,t){if(e!=null&&e.aggregate){const{aggregate:n,...r}=e;return n!==t&&Q(Mve(n,t)),r}else return e}function AV(e,t){const{mark:n,encoding:r}=e,{x:i,y:s}=r;if(_s(n)&&n.orient)return n.orient;if($o(i)){if($o(s)){const a=ee(i)&&i.aggregate,o=ee(s)&&s.aggregate;if(!a&&o===t)return"vertical";if(!o&&a===t)return"horizontal";if(a===t&&o===t)throw new Error("Both x and y cannot have aggregate");return Gd(s)&&!Gd(i)?"horizontal":"vertical"}return"horizontal"}else{if($o(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const qb="boxplot",s2e=["box","median","outliers","rule","ticks"],a2e=new Rx(qb,CV);function $V(e){return Ye(e)?"tukey":e}function CV(e,{config:t}){e={...e,encoding:Px(e.encoding,t)};const{mark:n,encoding:r,params:i,projection:s,...a}=e,o=_s(n)?n:{type:n};i&&Q($H("boxplot"));const l=o.extent??t.boxplot.extent,u=He("size",o,t),c=o.invalid,f=$V(l),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:y,aggregate:v,encodingWithoutContinuousAxis:x,ticksOrient:_,boxOrient:w,customTooltipWithoutAggregatedField:k}=o2e(e,l,t),{color:E,size:A,...z}=x,D=bt=>vM(o,m,g,bt,t.boxplot),R=D(z),j=D(x),O=D({...z,...A?{size:A}:{}}),L=f$([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,x),P={type:"tick",color:"black",opacity:1,orient:_,invalid:c,aria:!1},B=f==="min-max"?L:f$([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,x),U=[...R({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:B}),...R({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:B}),...R({partName:"ticks",mark:P,positionPrefix:"lower_whisker",extraEncoding:B}),...R({partName:"ticks",mark:P,positionPrefix:"upper_whisker",extraEncoding:B})],q=[...f!=="tukey"?U:[],...j({partName:"box",mark:{type:"bar",...u?{size:u}:{},orient:w,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:L}),...O({partName:"median",mark:{type:"tick",invalid:c,...ce(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...u?{size:u}:{},orient:_,aria:!1},positionPrefix:"mid_box",extraEncoding:L})];if(f==="min-max")return{...a,transform:(a.transform??[]).concat(p),layer:q};const X=`datum["lower_box_${g.field}"]`,ae=`datum["upper_box_${g.field}"]`,fe=`(${ae} - ${X})`,we=`${X} - ${l} * ${fe}`,Te=`${ae} + ${l} * ${fe}`,Se=`datum["${g.field}"]`,je={joinaggregate:MV(g.field),groupby:y},Ln={transform:[{filter:`(${we} <= ${Se}) && (${Se} <= ${Te})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${g.field}`},{op:"max",field:g.field,as:`upper_whisker_${g.field}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${g.field}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${g.field}`},...v],groupby:y}],layer:U},{tooltip:fn,...dn}=z,{scale:ue,axis:he}=g,ke=yM(g),Z=Xn(he,["title"]),dt=kV(o,"outliers",t.boxplot,{transform:[{filter:`(${Se} < ${we}) || (${Se} > ${Te})`}],mark:"point",encoding:{[m]:{field:g.field,type:g.type,...ke!==void 0?{title:ke}:{},...ue!==void 0?{scale:ue}:{},...Je(Z)?{}:{axis:Z}},...dn,...E?{color:E}:{},...k?{tooltip:k}:{}}})[0];let Ne;const gt=[...d,...h,je];return dt?Ne={transform:gt,layer:[dt,Ln]}:(Ne=Ln,Ne.transform.unshift(...gt)),{...a,layer:[Ne,{transform:p,layer:q}]}}function MV(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function o2e(e,t,n){const r=AV(e,qb),{continuousAxisChannelDef:i,continuousAxis:s}=SV(e,r,qb),a=i.field,o=$V(t),l=[...MV(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(o==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(o==="min-max"?"upper_whisker_":"max_")+a}],u=o==="min-max"||o==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[s]:c,...f}=e.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:h}=i2e(f),{bins:p,timeUnits:g,aggregate:m,groupby:y,encoding:v}=_V(h,n),x=r==="vertical"?"horizontal":"vertical",_=r,w=[...p,...g,{aggregate:[...m,...l],groupby:y},...u];return{bins:p,timeUnits:g,transform:w,groupby:y,aggregate:m,continuousAxisChannelDef:i,continuousAxis:s,encodingWithoutContinuousAxis:v,ticksOrient:x,boxOrient:_,customTooltipWithoutAggregatedField:d}}const bM="errorbar",l2e=["ticks","rule"],u2e=new Rx(bM,TV);function TV(e,{config:t}){e={...e,encoding:Px(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,ticksOrient:a,markDef:o,outerSpec:l,tooltipEncoding:u}=NV(e,bM,t);delete s.size;const c=vM(o,i,r,s,t.errorbar),f=o.thickness,d=o.size,h={type:"tick",orient:a,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...l,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function c2e(e,t){const{encoding:n}=e;if(f2e(n))return{orient:AV(e,t),inputType:"raw"};const r=d2e(n),i=h2e(n),s=n.x,a=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const o=n.x2,l=n.y2;if(_e(o)&&_e(l))throw new Error(`${t} cannot have both x2 and y2`);if(_e(o)){if($o(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(_e(l)){if($o(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const o=n.xError,l=n.xError2,u=n.yError,c=n.yError2;if(_e(l)&&!_e(o))throw new Error(`${t} cannot have xError2 without xError`);if(_e(c)&&!_e(u))throw new Error(`${t} cannot have yError2 without yError`);if(_e(o)&&_e(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(_e(o)){if($o(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(_e(u)){if($o(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function f2e(e){return(_e(e.x)||_e(e.y))&&!_e(e.x2)&&!_e(e.y2)&&!_e(e.xError)&&!_e(e.xError2)&&!_e(e.yError)&&!_e(e.yError2)}function d2e(e){return _e(e.x2)||_e(e.y2)}function h2e(e){return _e(e.xError)||_e(e.xError2)||_e(e.yError)||_e(e.yError2)}function NV(e,t,n){const{mark:r,encoding:i,params:s,projection:a,...o}=e,l=_s(r)?r:{type:r};s&&Q($H(t));const{orient:u,inputType:c}=c2e(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=SV(e,u,t),{errorBarSpecificAggregate:m,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:x}=p2e(l,f,d,h,p,c,t,n),{[g]:_,[g==="x"?"x2":"y2"]:w,[g==="x"?"xError":"yError"]:k,[g==="x"?"xError2":"yError2"]:E,...A}=i,{bins:z,timeUnits:D,aggregate:R,groupby:j,encoding:O}=_V(A,n),L=[...R,...m],P=c!=="raw"?[]:j,B=f$(v,f,O,x);return{transform:[...o.transform??[],...z,...D,...L.length===0?[]:[{aggregate:L,groupby:P}],...y],groupby:P,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:O,ticksOrient:u==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:o,tooltipEncoding:B}}function p2e(e,t,n,r,i,s,a,o){let l=[],u=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":o.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Q(Cve(h,p,a)),p==="stderr"||p==="stdev")l=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:wm(h)},{fieldPrefix:"upper_",titlePrefix:mP(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:mP(h,p,"-")}],d=!0;else{let g,m,y;p==="ci"?(g="mean",m="ci0",y="ci1"):(g="median",m="q1",y="q3"),l=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:cd({field:c,aggregate:y,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:cd({field:c,aggregate:m,type:"quantitative"},o,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:cd({field:c,aggregate:g,type:"quantitative"},o,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Q($ve(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const h of u)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Sc(Sc(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}function mP(e,t,n){return`${wm(e)} ${n} ${t}`}const xM="errorband",g2e=["band","borders"],m2e=new Rx(xM,FV);function FV(e,{config:t}){e={...e,encoding:Px(e.encoding,t)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,markDef:a,outerSpec:o,tooltipEncoding:l}=NV(e,xM,t),u=a,c=vM(u,i,r,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):u.interpolate?Q(oP("interpolate")):u.tension&&Q(oP("tension")),{...o,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:l})]}}const DV={};function wM(e,t,n){const r=new Rx(e,t);DV[e]={normalizer:r,parts:n}}function y2e(){return K(DV)}wM(qb,CV,s2e);wM(bM,TV,l2e);wM(xM,FV,g2e);const v2e=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],OV={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},RV={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},b2e=K(OV),x2e=K(RV),w2e={header:1,headerRow:1,headerColumn:1,headerFacet:1},PV=K(w2e),IV=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],_2e={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},E2e={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Ii="_vgsid_",k2e={point:{on:"click",fields:[Ii],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function _M(e){return e==="legend"||!!(e!=null&&e.legend)}function Q5(e){return _M(e)&&ce(e)}function EM(e){return!!(e!=null&&e.select)}function LV(e){const t=[];for(const n of e||[]){if(EM(n))continue;const{expr:r,bind:i,...s}=n;if(i&&r){const a={...s,bind:i,init:r};t.push(a)}else{const a={...s,...r?{update:r}:{},...i?{bind:i}:{}};t.push(a)}}return t}function S2e(e){return Ix(e)||SM(e)||kM(e)}function kM(e){return"concat"in e}function Ix(e){return"vconcat"in e}function SM(e){return"hconcat"in e}function zV({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function ks(e){return ce(e)&&e.step!==void 0}function yP(e){return e.view||e.width||e.height}const vP=20,A2e={align:1,bounds:1,center:1,columns:1,spacing:1},$2e=K(A2e);function C2e(e,t,n){const r=n[t],i={},{spacing:s,columns:a}=r;s!==void 0&&(i.spacing=s),a!==void 0&&(Tx(e)&&!Cm(e.facet)||kM(e))&&(i.columns=a),Ix(e)&&(i.columns=1);for(const o of $2e)if(e[o]!==void 0)if(o==="spacing"){const l=e[o];i[o]=Ye(l)?l:{row:l.row??s,column:l.column??s}}else i[o]=e[o];return i}function d$(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function Gb(e,t){const n=Wb(e,t);return ks(n)?n.step:BV}function Wb(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return yt(n,{step:e.step})}const BV=20,M2e={continuousWidth:200,continuousHeight:200,step:BV},T2e={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:M2e,mark:Ebe,arc:{},area:{},bar:Abe,circle:{},geoshape:{},image:{},line:{},point:{},rect:$be,rule:{color:"black"},square:{},text:{color:"black"},tick:Cbe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:sbe,projection:{},legend:_2e,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:k2e,style:{},title:{},facet:{spacing:vP},concat:{spacing:vP},normalizedNumberFormat:".0%"},ra=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],bP={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},xP={blue:ra[0],orange:ra[1],red:ra[2],teal:ra[3],green:ra[4],yellow:ra[5],purple:ra[6],pink:ra[7],brown:ra[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function N2e(e={}){return{signals:[{name:"color",value:ce(e)?{...xP,...e}:xP}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function F2e(e){return{signals:[{name:"fontSize",value:ce(e)?{...bP,...e}:bP}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function D2e(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function UV(e){const t=K(e||{}),n={};for(const r of t){const i=e[r];n[r]=Nm(i)?xH(i):xr(i)}return n}function O2e(e){const t=K(e),n={};for(const r of t)n[r]=UV(e[r]);return n}const R2e=[...QH,...xV,...PV,"background","padding","legend","lineBreak","scale","style","title","view"];function jV(e={}){const{color:t,font:n,fontSize:r,selection:i,...s}=e,a=Xd({},Ee(T2e),n?D2e(n):{},t?N2e(t):{},r?F2e(r):{},s||{});i&&Kd(a,"selection",i,!0);const o=Xn(a,R2e);for(const l of["background","lineBreak","padding"])a[l]&&(o[l]=xr(a[l]));for(const l of QH)a[l]&&(o[l]=Wn(a[l]));for(const l of xV)a[l]&&(o[l]=UV(a[l]));for(const l of PV)a[l]&&(o[l]=Wn(a[l]));return a.legend&&(o.legend=Wn(a.legend)),a.scale&&(o.scale=Wn(a.scale)),a.style&&(o.style=O2e(a.style)),a.title&&(o.title=Wn(a.title)),a.view&&(o.view=Wn(a.view)),o}const P2e=new Set(["view",...ybe]),I2e=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],L2e={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],..._be};function z2e(e){e=Ee(e);for(const t of I2e)delete e[t];if(e.axis)for(const t in e.axis)Nm(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of v2e)delete e.legend[t];if(e.mark){for(const t of uP)delete e.mark[t];e.mark.tooltip&&ce(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(LV(e.params)),delete e.params);for(const t of P2e){for(const r of uP)delete e[t][r];const n=L2e[t];if(n)for(const r of n)delete e[t][r];U2e(e,t)}for(const t of y2e())delete e[t];B2e(e);for(const t in e)ce(e[t])&&Je(e[t])&&delete e[t];return Je(e)?void 0:e}function B2e(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=bH(e.title);Je(t)||(e.style["group-title"]={...e.style["group-title"],...t}),Je(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),Je(r)?delete e.title:e.title=r}function U2e(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const s={...i,...e.style[n??t]};Je(s)||(e.style[n??t]=s),r||delete e[t]}function Lx(e){return"layer"in e}function j2e(e){return"repeat"in e}function q2e(e){return!Y(e.repeat)&&e.repeat.layer}class AM{map(t,n){return Tx(t)?this.mapFacet(t,n):j2e(t)?this.mapRepeat(t,n):SM(t)?this.mapHConcat(t,n):Ix(t)?this.mapVConcat(t,n):kM(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Lx(t))return this.mapLayer(t,n);if(Ia(t))return this.mapUnit(t,n);throw new Error(j6(t))}mapLayer(t,n){return{...t,layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(r=>this.map(r,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(r=>this.map(r,n))}}mapConcat(t,n){const{concat:r,...i}=t;return{...i,concat:r.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const G2e={zero:1,center:1,normalize:1};function W2e(e){return e in G2e}const H2e=new Set([YH,Ax,Sx,Ib,Cx,iM,sM,$x,XH,rM]),V2e=new Set([Ax,Sx,YH]);function Gf(e){return ee(e)&&jd(e)==="quantitative"&&!e.bin}function wP(e,t,{orient:n,type:r}){const i=t==="x"?"y":"radius",s=t==="x",a=e[t],o=e[i];if(ee(a)&&ee(o))if(Gf(a)&&Gf(o)){if(a.stack)return t;if(o.stack)return i;const l=ee(a)&&!!a.aggregate,u=ee(o)&&!!o.aggregate;if(l!==u)return l?t:i;if(s&&r==="bar"){if(n==="vertical")return i;if(n==="horizontal")return t}}else{if(Gf(a))return t;if(Gf(o))return i}else{if(Gf(a))return t;if(Gf(o))return i}}function J2e(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function qV(e,t){var d,h;const n=_s(e)?e:{type:e},r=n.type;if(!H2e.has(r))return null;const i=wP(t,"x",n)||wP(t,"theta",n);if(!i)return null;const s=t[i],a=ee(s)?se(s,{}):void 0,o=J2e(i),l=[],u=new Set;if(t[o]){const p=t[o],g=ee(p)?se(p,{}):void 0;g&&g!==a&&(l.push(o),u.add(g));const m=o==="x"?"xOffset":"yOffset",y=t[m],v=ee(y)?se(y,{}):void 0;v&&v!==a&&(l.push(m),u.add(v))}const c=lye.reduce((p,g)=>{if(g!=="tooltip"&&cc(t,g)){const m=t[g];for(const y of le(m)){const v=Es(y);if(v.aggregate)continue;const x=se(v,{});(!x||!u.has(x))&&p.push({channel:g,fieldDef:v})}}return p},[]);let f;return s.stack!==void 0?Ko(s.stack)?f=s.stack?"zero":null:f=s.stack:V2e.has(r)&&(f="zero"),!f||!W2e(f)||gM(t)&&c.length===0?null:(d=s==null?void 0:s.scale)!=null&&d.type&&((h=s==null?void 0:s.scale)==null?void 0:h.type)!==Kn.LINEAR?(s!=null&&s.stack&&Q(kve(s.scale.type)),null):_e(t[Os(i)])?(s.stack!==void 0&&Q(Eve(i)),null):(ee(s)&&s.aggregate&&!xye.has(s.aggregate)&&Q(Sve(s.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:i,impute:s.impute===null?!1:fl(r),stackBy:c,offset:f})}function Y2e(e){const{point:t,line:n,...r}=e;return K(r).length>1?r:r.type}function X2e(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:Xn(e[t],["point","line"])});return e}function eA(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ce(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ce(t.point)?t.point:{}:void 0}function _P(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class K2e{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Ia(t)){const{mark:r,encoding:i}=t,s=_s(r)?r:{type:r};switch(s.type){case"line":case"rule":case"trail":return!!eA(s,n[s.type],i);case"area":return!!eA(s,n[s.type],i)||!!_P(s,n[s.type])}}return!1}run(t,n,r){const{config:i}=n,{params:s,projection:a,mark:o,name:l,encoding:u,...c}=t,f=Px(u,i),d=_s(o)?o:{type:o},h=eA(d,i[d.type],f),p=d.type==="area"&&_P(d,i[d.type]),g=[{name:l,...s?{params:s}:{},mark:Y2e({...d.type==="area"&&d.opacity===void 0&&d.fillOpacity===void 0?{opacity:.7}:{},...d}),encoding:Xn(f,["shape"])}],m=qV(d,f);let y=f;if(m){const{fieldChannel:v,offset:x}=m;y={...f,[v]:{...f[v],...x?{stack:x}:{}}}}return y=Xn(y,["y2","x2"]),p&&g.push({...a?{projection:a}:{},mark:{type:"line",...Id(d,["clip","interpolate","tension","tooltip"]),...p},encoding:y}),h&&g.push({...a?{projection:a}:{},mark:{type:"point",opacity:1,filled:!0,...Id(d,["clip","tooltip"]),...h},encoding:y}),r({...c,layer:g},{...n,config:X2e(i)})}}function Z2e(e,t){return t?Cm(e)?WV(e,t):GV(e,t):e}function tA(e,t){return t?WV(e,t):e}function h$(e,t,n){const r=t[e];if(Lbe(r)){if(r.repeat in n)return{...t,[e]:n[r.repeat]};Q(zye(r.repeat));return}return t}function GV(e,t){if(e=h$("field",e,t),e!==void 0){if(e===null)return null;if(fM(e)&&hs(e.sort)){const n=h$("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function EP(e,t){if(ee(e))return GV(e,t);{const n=h$("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function kP(e,t){if(_e(e)){const n=EP(e,t);if(n)return n;if(Nx(e))return{condition:e.condition}}else{if(Mm(e)){const n=EP(e.condition,t);if(n)return{...e,condition:n};{const{condition:r,...i}=e;return i}}return e}}function WV(e,t){const n={};for(const r in e)if(ve(e,r)){const i=e[r];if(Y(i))n[r]=i.map(s=>kP(s,t)).filter(s=>s);else{const s=kP(i,t);s!==void 0&&(n[r]=s)}}return n}class Q2e{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Ia(t)){const{encoding:n,mark:r}=t;if(r==="line"||_s(r)&&r.type==="line")for(const i of aye){const s=Yc(i),a=n[s];if(n[i]&&(ee(a)&&!zt(a.bin)||Ps(a)))return!0}}return!1}run(t,n,r){const{encoding:i,mark:s}=t;return Q(ave(!!i.x2,!!i.y2)),r({...t,mark:ce(s)?{...s,type:"rule"}:"rule"},n)}}class exe extends AM{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[a2e,u2e,m2e,new K2e,new Q2e]}map(t,n){if(Ia(t)){const r=cc(t.encoding,ba),i=cc(t.encoding,xa),s=cc(t.encoding,gx);if(r||i||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,s=tA(t.encoding,n.repeater),a={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(l=>l).join("_")}:{},...s?{encoding:s}:{}};if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(a,n.config))return l.run(a,n,o);return a}mapRepeat(t,n){return q2e(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i,...s}=t,{row:a,column:o,layer:l}=r,{repeater:u={},repeaterPrefix:c=""}=n;return a||o?this.mapRepeat({...t,repeat:{...a?{row:a}:{},...o?{column:o}:{}},spec:{repeat:{layer:l},spec:i}},n):{...s,layer:l.map(f=>{const d={...u,layer:f},h=`${(i.name?`${i.name}_`:"")+c}child__layer_${st(f)}`,p=this.mapLayerOrUnit(i,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:r,spec:i,data:s,...a}=t;!Y(r)&&t.columns&&(t=Xn(t,["columns"]),Q(rP("repeat")));const o=[],{repeater:l={},repeaterPrefix:u=""}=n,c=!Y(r)&&r.row||[l?l.row:null],f=!Y(r)&&r.column||[l?l.column:null],d=Y(r)&&r||[l?l.repeat:null];for(const p of d)for(const g of c)for(const m of f){const y={repeat:p,row:g,column:m,layer:l.layer},v=(i.name?`${i.name}_`:"")+u+"child__"+(Y(r)?`${st(p)}`:(r.row?`row_${st(g)}`:"")+(r.column?`column_${st(m)}`:"")),x=this.map(i,{...n,repeater:y,repeaterPrefix:v});x.name=v,o.push(Xn(x,["data"]))}const h=Y(r)?t.columns:r.column?r.column.length:1;return{data:i.data??s,align:"all",...a,columns:h,concat:o}}mapFacet(t,n){const{facet:r}=t;return Cm(r)&&t.columns&&(t=Xn(t,["columns"]),Q(rP("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:s,parentProjection:a,config:o}=n,l=AP({parentProjection:a,projection:i}),u=SP({parentEncoding:s,encoding:tA(r,n.repeater)});return this.mapUnit({...t,...l?{projection:l}:{},...u?{encoding:u}:{}},{config:o})}mapFacetedUnit(t,n){const{row:r,column:i,facet:s,...a}=t.encoding,{mark:o,width:l,projection:u,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:s},n),y=tA(a,n.repeater);return this.mapFacet({...p,...m,facet:g,spec:{...l?{width:l}:{},...c?{height:c}:{},...f?{view:f}:{},...u?{projection:u}:{},mark:o,encoding:y,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:r,column:i,facet:s}=t;if(r||i){s&&Q(ive([...r?[ba]:[],...i?[xa]:[]]));const a={},o={};for(const l of[ba,xa]){const u=t[l];if(u){const{align:c,center:f,spacing:d,columns:h,...p}=u;a[l]=p;for(const g of["align","center","spacing"])u[g]!==void 0&&(o[g]??(o[g]={}),o[g][l]=u[g])}}return{facetMapping:a,layout:o}}else{const{align:a,center:o,spacing:l,columns:u,...c}=s;return{facetMapping:Z2e(c,n.repeater),layout:{...a?{align:a}:{},...o?{center:o}:{},...l?{spacing:l}:{},...u?{columns:u}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:r,...i}){const{encoding:s,projection:a,...o}=t,l={...i,parentEncoding:SP({parentEncoding:n,encoding:s,layer:!0}),parentProjection:AP({parentProjection:r,projection:a})};return super.mapLayer({...o,...t.name?{name:[l.repeaterPrefix,t.name].filter(u=>u).join("_")}:{}},l)}}function SP({parentEncoding:e,encoding:t={},layer:n}){let r={};if(e){const i=new Set([...K(e),...K(t)]);for(const s of i){const a=t[s],o=e[s];if(_e(a)){const l={...o,...a};r[s]=l}else Mm(a)?r[s]={...a,condition:{...o,...a.condition}}:a||a===null?r[s]=a:(n||Pi(o)||pe(o)||_e(o)||Y(o))&&(r[s]=o)}}else r=t;return!r||Je(r)?void 0:r}function AP(e){const{parentProjection:t,projection:n}=e;return t&&n&&Q(Wye({parentProjection:t,projection:n})),n??t}function $M(e){return"filter"in e}function txe(e){return(e==null?void 0:e.stop)!==void 0}function HV(e){return"lookup"in e}function nxe(e){return"data"in e}function rxe(e){return"param"in e}function ixe(e){return"pivot"in e}function sxe(e){return"density"in e}function axe(e){return"quantile"in e}function oxe(e){return"regression"in e}function lxe(e){return"loess"in e}function uxe(e){return"sample"in e}function cxe(e){return"window"in e}function fxe(e){return"joinaggregate"in e}function dxe(e){return"flatten"in e}function hxe(e){return"calculate"in e}function VV(e){return"bin"in e}function pxe(e){return"impute"in e}function gxe(e){return"timeUnit"in e}function mxe(e){return"aggregate"in e}function yxe(e){return"stack"in e}function vxe(e){return"fold"in e}function bxe(e){return e.map(t=>$M(t)?{filter:ld(t.filter,Zve)}:t)}class xxe extends AM{map(t,n){return n.emptySelections??(n.emptySelections={}),n.selectionPredicates??(n.selectionPredicates={}),t=$P(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=$P(t,n),t.encoding){const r={};for(const[i,s]of Wo(t.encoding))r[i]=JV(s,n);t={...t,encoding:r}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:r,...i}=t;return r?{...i,params:Wo(r).map(([s,a])=>{const{init:o,bind:l,empty:u,...c}=a;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=u!=="none";for(const f of qt(n.selectionPredicates[s]??{}))f.empty=u!=="none";return{name:s,value:o,select:c,bind:l}})}:t}}function $P(e,t){const{transform:n,...r}=e;if(n){const i=n.map(s=>{if($M(s))return{filter:p$(s,t)};if(VV(s)&&Xc(s.bin))return{...s,bin:YV(s.bin)};if(HV(s)){const{selection:a,...o}=s.from;return a?{...s,from:{param:a,...o}}:s}return s});return{...r,transform:i}}return e}function JV(e,t){var r,i;const n=Ee(e);if(ee(n)&&Xc(n.bin)&&(n.bin=YV(n.bin)),Zc(n)&&((i=(r=n.scale)==null?void 0:r.domain)!=null&&i.selection)){const{selection:s,...a}=n.scale.domain;n.scale.domain={...a,...s?{param:s}:{}}}if(Nx(n))if(Y(n.condition))n.condition=n.condition.map(s=>{const{selection:a,param:o,test:l,...u}=s;return o?s:{...u,test:p$(s,t)}});else{const{selection:s,param:a,test:o,...l}=JV(n.condition,t);n.condition=a?n.condition:{...l,test:p$(n.condition,t)}}return n}function YV(e){const t=e.extent;if(t!=null&&t.selection){const{selection:n,...r}=t;return{...e,extent:{...r,param:n}}}return e}function p$(e,t){const n=r=>ld(r,i=>{var s;const a=t.emptySelections[i]??!0,o={param:i,empty:a};return(s=t.selectionPredicates)[i]??(s[i]=[]),t.selectionPredicates[i].push(o),o});return e.selection?n(e.selection):ld(e.test||e.filter,r=>r.selection?n(r.selection):r)}class g$ extends AM{map(t,n){const r=n.selections??[];if(t.params&&!Ia(t)){const i=[];for(const s of t.params)EM(s)?r.push(s):i.push(s);t.params=i}return n.selections=r,super.map(t,n)}mapUnit(t,n){const r=n.selections;if(!r||!r.length)return t;const i=(n.path??[]).concat(t.name),s=[];for(const a of r)if(!a.views||!a.views.length)s.push(a);else for(const o of a.views)(oe(o)&&(o===t.name||i.includes(o))||Y(o)&&o.map(l=>i.indexOf(l)).every((l,u,c)=>l!==-1&&(u===0||l>c[u-1])))&&s.push(a);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=g$.prototype[e];g$.prototype[e]=function(n,r){return t.call(this,n,wxe(n,r))}}function wxe(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function XV(e,t){t===void 0&&(t=jV(e.config));const n=Sxe(e,t),{width:r,height:i}=e,s=Axe(n,{width:r,height:i,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const _xe=new exe,Exe=new xxe,kxe=new g$;function Sxe(e,t={}){const n={config:t};return kxe.map(_xe.map(Exe.map(e,n),n),n)}function CP(e){return oe(e)?{type:e}:e??{}}function Axe(e,t,n){let{width:r,height:i}=t;const s=Ia(e)||Lx(e),a={};s?r=="container"&&i=="container"?(a.type="fit",a.contains="padding"):r=="container"?(a.type="fit-x",a.contains="padding"):i=="container"&&(a.type="fit-y",a.contains="padding"):(r=="container"&&(Q(QR("width")),r=void 0),i=="container"&&(Q(QR("height")),i=void 0));const o={type:"pad",...a,...n?CP(n.autosize):{},...CP(e.autosize)};if(o.type==="fit"&&!s&&(Q(Mye),o.type="pad"),r=="container"&&!(o.type=="fit"||o.type=="fit-x")&&Q(eP("width")),i=="container"&&!(o.type=="fit"||o.type=="fit-y")&&Q(eP("height")),!os(o,{type:"pad"}))return o}function $xe(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Cxe(e){return e?`fit-${xx(e)}`:"fit"}const Mxe=["background","padding"];function MP(e,t){const n={};for(const r of Mxe)e&&e[r]!==void 0&&(n[r]=xr(e[r]));return t&&(n.params=e.params),n}class La{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new La(Ee(this.explicit),Ee(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return yt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:r}){n!==void 0&&this.set(t,n,r)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:r}){n[t]!==void 0?this.set(t,n[t],!0):r[t]!==void 0&&this.set(t,r[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of K(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function ns(e){return{explicit:!0,value:e}}function yr(e){return{explicit:!1,value:e}}function KV(e){return(t,n,r,i)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:zx(t,n,r,i)}}function zx(e,t,n,r){return e.explicit&&t.explicit&&Q(mve(n,r,e.value,t.value)),e}function Vo(e,t,n,r,i=zx){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:os(e.value,t.value)?e:i(e,t,n,r)}class Txe extends La{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Wd(e){return"url"in e}function R0(e){return"values"in e}function ZV(e){return"name"in e&&!Wd(e)&&!R0(e)&&!Do(e)}function Do(e){return e&&(QV(e)||eJ(e)||CM(e))}function QV(e){return"sequence"in e}function eJ(e){return"sphere"in e}function CM(e){return"graticule"in e}var Qe;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Qe||(Qe={}));function tJ(e){const{signals:t,hasLegend:n,index:r,...i}=e;return i.field=ni(i.field),i}function Fc(e,t=!0,n=un){if(Y(e)){const r=e.map(i=>Fc(i,t,n));return t?`[${r.join(", ")}]`:r}else if(Kc(e))return n(t?Cc(e):Uve(e));return t?n(et(e)):e}function Nxe(e,t){for(const n of qt(e.component.selection??{})){const r=n.name;let i=`${r}${Yo}, ${n.resolve==="global"?"true":`{unit: ${fc(e)}}`}`;for(const s of Ux)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(i=s.modifyExpr(e,n,i)));t.push({name:r+uwe,on:[{events:{signal:n.name+Yo},update:`modify(${te(n.name+Dc)}, ${i})`}]})}return MM(t)}function Fxe(e,t){if(e.component.selection&&K(e.component.selection).length){const n=te(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:rl("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return MM(t)}function Dxe(e,t){let n=!1;for(const r of qt(e.component.selection??{})){const i=r.name,s=te(i+Dc);if(t.filter(o=>o.name===i).length===0){const o=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${vJ}(${s}, ${te(o)}${l}`})}n=!0;for(const o of Ux)o.defined(r)&&o.topLevelSignals&&(t=o.topLevelSignals(e,r,t))}return n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),MM(t)}function Oxe(e,t){const n=[...t],r=fc(e,{escape:!1});for(const i of qt(e.component.selection??{})){const s={name:i.name+Dc};if(i.project.hasSelectionId&&(s.transform=[{type:"collect",sort:{field:Ii}}]),i.init){const o=i.project.items.map(tJ);s.values=i.project.hasSelectionId?i.init.map(l=>({unit:r,[Ii]:Fc(l,!1)[0]})):i.init.map(l=>({unit:r,fields:o,values:Fc(l,!1)}))}n.filter(o=>o.name===i.name+Dc).length||n.push(s)}return n}function nJ(e,t){for(const n of qt(e.component.selection??{}))for(const r of Ux)r.defined(n)&&r.marks&&(t=r.marks(e,n,t));return t}function Rxe(e,t){for(const n of e.children)pt(n)&&(t=nJ(n,t));return t}function Pxe(e,t,n,r){const i=EJ(e,t.param,t);return{signal:Cr(n.get("type"))&&Y(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}function MM(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ke{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){Q(jye);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this);const r=t.parent.removeChild(t);this._parent=n,n.addChild(this,r),t.parent=this}}class Fn extends Ke{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${tH()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class ps extends Ke{clone(){return new ps(null,Ee(this.formula))}constructor(t,n){super(t),this.formula=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s)=>{const{field:a,timeUnit:o}=s;if(o){const l=se(s,{forAs:!0});i[Re({as:l,field:a,timeUnit:o})]={as:l,field:a,timeUnit:o}}return i},{});return Je(r)?null:new ps(t,r)}static makeFromTransform(t,n){const{timeUnit:r,...i}={...n},s=Wt(r),a={...i,timeUnit:s};return new ps(t,{[Re(a)]:a})}merge(t){this.formula={...this.formula};for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[r,i]of Wo(this.formula))t.has(i.as)||(n[r]=i);this.formula=n}producedFields(){return new Set(qt(this.formula).map(t=>t.as))}dependentFields(){return new Set(qt(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${Re(this.formula)}`}assemble(){const t=[];for(const n of qt(this.formula)){const{field:r,as:i,timeUnit:s}=n,{unit:a,utc:o,...l}=Wt(s);t.push({field:ni(r),type:"timeunit",...a?{units:kx(a)}:{},...o?{timezone:"utc"}:{},...l,as:[i,`${i}_end`]})}return t}}const Fm="_tuple_fields";class Ixe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const Lxe={defined:()=>!0,parse:(e,t,n)=>{const r=t.name,i=t.project??(t.project=new Ixe),s={},a={},o=new Set,l=(p,g)=>{const m=g==="visual"?p.channel:p.field;let y=st(`${r}_${m}`);for(let v=1;o.has(y);v++)y=st(`${r}_${m}_${v}`);return o.add(y),{[g]:y}},u=t.type,c=e.config.selection[u],f=n.value!==void 0?le(n.value):null;let{fields:d,encodings:h}=ce(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(ce(p))for(const g of K(p))sye(g)?(h||(h=[])).push(g):u==="interval"?(Q(Lye),h=c.encodings):(d??(d=[])).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let m=g.field;if(g.aggregate){Q(Tye(p,g.aggregate));continue}else if(!m){Q(nP(p));continue}if(g.timeUnit){m=e.vgField(p);const y={timeUnit:g.timeUnit,as:m,field:g.field};a[Re(y)]=y}if(!s[m]){const y=u==="interval"&&Pa(p)&&Cr(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:m,channel:p,type:y,index:i.items.length};v.signals={...l(v,"data"),...l(v,"visual")},i.items.push(s[m]=v),i.hasField[m]=s[m],i.hasSelectionId=i.hasSelectionId||m===Ii,oH(p)?(v.geoChannel=p,v.channel=aH(p),i.hasChannel[v.channel]=s[m]):i.hasChannel[p]=s[m]}}else Q(nP(p))}for(const p of d??[]){if(i.hasField[p])continue;const g={type:"E",field:p,index:i.items.length};g.signals={...l(g,"data")},i.items.push(g),i.hasField[p]=g,i.hasSelectionId=i.hasSelectionId||p===Ii}f&&(t.init=f.map(p=>i.items.map(g=>ce(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),Je(a)||(i.timeUnit=new ps(null,a))},signals:(e,t,n)=>{const r=t.name+Fm;return n.filter(s=>s.name===r).length>0||t.project.hasSelectionId?n:n.concat({name:r,value:t.project.items.map(tJ)})}},_a={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Pa(i))continue;const s=e.getScaleComponent(i),a=s?s.get("type"):void 0;if(!s||!Cr(a)){Q(Dye);continue}s.set("selectionExtent",{param:t.name,field:r.field},!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(a=>n.filter(o=>o.name===a.signals.data).length===0);if(!e.parent||TP(e)||r.length===0)return n;const i=n.filter(a=>a.name===t.name)[0];let s=i.update;if(s.indexOf(vJ)>=0)i.update=`{${r.map(a=>`${te(ni(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of r){const o=`${te(ni(a.field))}: ${a.signals.data}`;s.includes(o)||(s=`${s.substring(0,s.length-1)}, ${o}}`)}i.update=s}return n.concat(r.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!TP(e))for(const r of t.scales){const i=n.filter(s=>s.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function m$(e,t){return`domain(${te(e.scaleName(t))})`}function TP(e){return e.parent&&vh(e.parent)&&!e.parent.parent}const fd="_brush",rJ="_scale_trigger",vg="geo_interval_init_tick",iJ="_init",zxe="_center",Bxe={defined:e=>e.type==="interval",parse:(e,t,n)=>{var r;if(e.hasProjection){const i={...ce(n.select)?n.select:{}};i.fields=[Ii],i.encodings||(i.encodings=n.value?K(n.value):[Gi,qi]),n.select={type:"interval",...i}}if(t.translate&&!_a.defined(t)){const i=`!event.item || event.item.mark.name !== ${te(t.name+fd)}`;for(const s of t.events){if(!s.between){Q(`${s} is not an ordered event stream for interval selections.`);continue}const a=le((r=s.between[0]).filter??(r.filter=[]));a.indexOf(i)<0&&a.push(i)}}},signals:(e,t,n)=>{const r=t.name,i=r+Yo,s=qt(t.project.hasChannel).filter(o=>o.channel===at||o.channel===Rt),a=t.init?t.init[0]:null;if(n.push(...s.reduce((o,l)=>o.concat(Uxe(e,t,l,a&&a[l.index])),[])),e.hasProjection){const o=te(e.projectionName()),l=e.projectionName()+zxe,{x:u,y:c}=t.project.hasChannel,f=u&&u.signals.visual,d=c&&c.signals.visual,h=u?a&&a[u.index]:`${l}[0]`,p=c?a&&a[c.index]:`${l}[1]`,g=w=>e.getSizeSignalRef(w).signal,m=`[[${f?f+"[0]":"0"}, ${d?d+"[0]":"0"}],[${f?f+"[1]":g("width")}, ${d?d+"[1]":g("height")}]]`;a&&(n.unshift({name:r+iJ,init:`[scale(${o}, [${u?h[0]:h}, ${c?p[0]:p}]), scale(${o}, [${u?h[1]:h}, ${c?p[1]:p}])]`}),(!u||!c)&&(n.find(k=>k.name===l)||n.unshift({name:l,update:`invert(${o}, [${g("width")}/2, ${g("height")}/2])`})));const y=`intersect(${m}, {markname: ${te(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${fc(e)}}`,x=`vlSelectionTuples(${y}, ${v})`,_=s.map(w=>w.signals.visual);return n.concat({name:i,on:[{events:[..._.length?[{signal:_.join(" || ")}]:[],...a?[{signal:vg}]:[]],update:x}]})}else{if(!_a.defined(t)){const u=r+rJ,c=s.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=te(e.scaleName(d)),m=e.getScaleComponent(d).get("type"),y=Cr(m)?"+":"";return`(!isArray(${h}) || (${y}invert(${g}, ${p})[0] === ${y}${h}[0] && ${y}invert(${g}, ${p})[1] === ${y}${h}[1]))`});c.length&&n.push({name:u,value:{},on:[{events:s.map(f=>({scale:e.scaleName(f.channel)})),update:c.join(" && ")+` ? ${u} : {}`}]})}const o=s.map(u=>u.signals.data),l=`unit: ${fc(e)}, fields: ${r+Fm}, values`;return n.concat({name:i,...a?{init:`{${l}: ${Fc(a)}}`}:{},...o.length?{on:[{events:[{signal:o.join(" || ")}],update:`${o.join(" && ")} ? {${l}: [${o}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(pt(e)&&e.hasProjection&&t.init&&(n.filter(i=>i.name===vg).length||n.unshift({name:vg,value:null,on:[{events:"timer{1}",update:`${vg} === null ? {} : ${vg}`}]})),n),marks:(e,t,n)=>{const r=t.name,{x:i,y:s}=t.project.hasChannel,a=i==null?void 0:i.signals.visual,o=s==null?void 0:s.signals.visual,l=`data(${te(t.name+Dc)})`;if(_a.defined(t)||!i&&!s)return n;const u={x:i!==void 0?{signal:`${a}[0]`}:{value:0},y:s!==void 0?{signal:`${o}[0]`}:{value:0},x2:i!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${o}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const g of K(u))u[g]=[{test:`${l}.length && ${l}[0].unit === ${fc(e)}`,...u[g]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=K(h).reduce((g,m)=>(g[m]=[{test:[i!==void 0&&`${a}[0] !== ${a}[1]`,s!==void 0&&`${o}[0] !== ${o}[1]`].filter(y=>y).join(" && "),value:h[m]},{value:null}],g),{});return[{name:`${r+fd}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:u}},...n,{name:r+fd,type:"rect",clip:!0,encode:{enter:{...d?{cursor:{value:d}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}};function Uxe(e,t,n,r){const i=!e.hasProjection,s=n.channel,a=n.signals.visual,o=te(i?e.scaleName(s):e.projectionName()),l=d=>`scale(${o}, ${d})`,u=e.getSizeSignalRef(s===at?"width":"height").signal,c=`${s}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${a}[0], clamp(${c}, 0, ${u})]`}],[]);if(i){const d=n.signals.data,h=_a.defined(t),p=e.getScaleComponent(s),g=p?p.get("type"):void 0,m=r?{init:Fc(r,!0,l)}:{value:[]};return f.push({events:{signal:t.name+rJ},update:Cr(g)?`[${l(`${d}[0]`)}, ${l(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:a,...m,on:f},{name:d,...r?{init:Fc(r)}:{},on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${o}, ${a})`}]}]}else{const d=s===at?0:1,h=t.name+iJ,p=r?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:a,...p,on:f}]}}const jxe={defined:e=>e.type==="point",signals:(e,t,n)=>{const r=t.name,i=r+Fm,s=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=qt(e.component.selection??{}).reduce((f,d)=>d.type==="interval"?f.concat(d.name+fd):f,[]).map(f=>`indexof(item().mark.name, '${f}') < 0`).join(" && "),l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${o?` && ${o}`:""}`;let u=`unit: ${fc(e)}, `;if(t.project.hasSelectionId)u+=`${Ii}: ${a}[${te(Ii)}]`;else{const f=s.items.map(d=>{const h=e.fieldDef(d.channel);return h!=null&&h.bin?`[${a}[${te(e.vgField(d.channel,{}))}], ${a}[${te(e.vgField(d.channel,{binSuffix:"end"}))}]]`:`${a}[${te(d.field)}]`}).join(", ");u+=`fields: ${i}, values: [${f}]`}const c=t.events;return n.concat([{name:r+Yo,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}};function ph(e,t,n,r){const i=Nx(t)&&t.condition,s=r(t);if(i){const o=le(i).map(l=>{const u=r(l);if(Ibe(l)){const{param:c,empty:f}=l;return{test:_J(e,{param:c,empty:f}),...u}}else return{test:Jb(e,l.test),...u}});return{[n]:[...o,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function TM(e,t="text"){const n=e.encoding[t];return ph(e,n,t,r=>Bx(r,e.config))}function Bx(e,t,n="datum"){if(e){if(Pi(e))return rt(e.value);if(_e(e)){const{format:r,formatType:i}=Ub(e);return uM({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function sJ(e,t={}){const{encoding:n,markDef:r,config:i,stack:s}=e,a=n.tooltip;if(Y(a))return{tooltip:NP({tooltip:a},s,i,t)};{const o=t.reactiveGeom?"datum.datum":"datum";return ph(e,a,"tooltip",l=>{const u=Bx(l,i,o);if(u)return u;if(l===null)return;let c=He("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),oe(c))return{value:c};if(ce(c))return pe(c)?c:c.content==="encoding"?NP(n,s,i,t):{signal:o}})}}function aJ(e,t,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},s={},a=r?"datum.datum":"datum",o=[];function l(c,f){const d=Yc(f),h=Rn(c)?c:{...c,type:e[d].type},p=h.title||hM(h,i),g=le(p).join(", ");let m;if(Pt(f)){const y=f==="x"?"x2":"y2",v=Es(e[y]);if(zt(h.bin)&&v){const x=se(h,{expr:a}),_=se(v,{expr:a}),{format:w,formatType:k}=Ub(h);m=$m(x,_,w,k,i),s[y]=!0}}if((Pt(f)||f===si||f===ji)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:y,formatType:v}=Ub(h);m=uM({fieldOrDatumDef:h,format:y,formatType:v,expr:a,config:i,normalizeStack:!0}).signal}m??(m=Bx(h,i,a).signal),o.push({channel:f,key:g,value:m})}mM(e,(c,f)=>{ee(c)?l(c,f):Fx(c)&&l(c.condition,f)});const u={};for(const{channel:c,key:f,value:d}of o)!s[c]&&!u[f]&&(u[f]=d);return u}function NP(e,t,n,{reactiveGeom:r}={}){const i=aJ(e,t,n,{reactiveGeom:r}),s=Wo(i).map(([a,o])=>`"${a}": ${o}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function qxe(e){const{markDef:t,config:n}=e,r=He("aria",t,n);return r===!1?{}:{...r?{aria:r}:{},...Gxe(e),...Wxe(e)}}function Gxe(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=He("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in Aye?{}:{ariaRoleDescription:{value:t}}}function Wxe(e){const{encoding:t,markDef:n,config:r,stack:i}=e,s=t.description;if(s)return ph(e,s,"description",l=>Bx(l,e.config));const a=He("description",n,r);if(a!=null)return{description:rt(a)};if(r.aria===!1)return{};const o=aJ(t,i,r);if(!Je(o))return{description:{signal:Wo(o).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}function Mt(e,t,n={}){const{markDef:r,encoding:i,config:s}=t,{vgChannel:a}=n;let{defaultRef:o,defaultValue:l}=n;o===void 0&&(l??(l=He(e,r,s,{vgChannel:a,ignoreVgConfig:!0})),l!==void 0&&(o=rt(l)));const u=i[e];return ph(t,u,a??e,c=>lM({channel:e,channelDef:c,markDef:r,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:o}))}function oJ(e,t={filled:void 0}){const{markDef:n,encoding:r,config:i}=e,{type:s}=n,a=t.filled??He("filled",n,i),o=Fe(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,l=He(a===!0?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[a===!0&&"color"]??o,u=He(a===!1?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[a===!1&&"color"],c=a?"fill":"stroke",f={...l?{fill:rt(l)}:{},...u?{stroke:rt(u)}:{}};return n.color&&(a?n.fill:n.stroke)&&Q(MH("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Mt("color",e,{vgChannel:c,defaultValue:a?l:u}),...Mt("fill",e,{defaultValue:r.fill?l:void 0}),...Mt("stroke",e,{defaultValue:r.stroke?u:void 0})}}function Hxe(e){const{encoding:t,mark:n}=e,r=t.order;return!fl(n)&&Pi(r)?ph(e,r,"zindex",i=>rt(i.value)):{}}function P0({channel:e,markDef:t,encoding:n={},model:r,bandPosition:i}){const s=`${e}Offset`,a=t[s],o=n[s];if((s==="xOffset"||s==="yOffset")&&o)return{offsetType:"encoding",offset:lM({channel:s,channelDef:o,markDef:t,config:r==null?void 0:r.config,scaleName:r.scaleName(s),scale:r.getScaleComponent(s),stack:null,defaultRef:rt(a),bandPosition:i})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function nn(e,t,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:s,config:a,stack:o}=t,l=i[e],u=i[Os(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=P0({channel:e,markDef:s,encoding:i,model:t,bandPosition:.5}),p=NM({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!l&&Pt(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:Vxe({channel:e,channelDef:l,channel2Def:u,markDef:s,config:a,scaleName:c,scale:f,stack:o,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[r||e]:g}:void 0}function Vxe(e){const{channel:t,channelDef:n,scaleName:r,stack:i,offset:s,markDef:a}=e;if(_e(n)&&i&&t===i.fieldChannel){if(ee(n)){let o=n.bandPosition;if(o===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(o=.5),o!==void 0)return Lb({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:o,offset:s})}return uc(n,r,{suffix:"end"},{offset:s})}return aM(e)}function NM({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:s,config:a}=e;return()=>{const o=Yc(n),l=Ho(n),u=He(n,s,a,{vgChannel:l});if(u!==void 0)return a0(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!Fe([Kn.LOG,Kn.TIME,Kn.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return o==="y"?{field:{group:"height"}}:{value:0};switch(o){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...e[sr(n)],mult:.5}}}}const Jxe={left:"x",center:"xc",right:"x2"},Yxe={top:"y",middle:"yc",bottom:"y2"};function lJ(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Ho(e);const i=e==="x"?"align":"baseline",s=He(i,t,n);let a;return pe(s)?(Q(sve(i)),a=void 0):a=s,e==="x"?Jxe[a||(r==="top"?"left":"center")]:Yxe[a||r]}function Hb(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?uJ(e,t,{defaultPos:n,defaultPos2:r}):nn(e,t,{defaultPos:n})}function uJ(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:s}=t,a=Os(e),o=sr(e),l=Xxe(t,r,a),u=l[o]?lJ(e,i,s):Ho(e);return{...nn(e,t,{defaultPos:n,vgChannel:u}),...l}}function Xxe(e,t,n){const{encoding:r,mark:i,markDef:s,stack:a,config:o}=e,l=Yc(n),u=sr(n),c=Ho(n),f=r[l],d=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=n in r||n in s?P0({channel:n,markDef:s,encoding:r,model:e}):P0({channel:l,markDef:s,encoding:r,model:e});if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude)){const m=sr(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const g=Kxe({channel:n,channelDef:f,channel2Def:r[n],markDef:s,config:o,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:Oy(n,s)||Oy(n,{[n]:Rb(n,s,o.style),[u]:Rb(u,s,o.style)})||Oy(n,o[i])||Oy(n,o.mark)||{[c]:NM({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Kxe({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:a,stack:o,offset:l,defaultRef:u}){return _e(t)&&o&&e.charAt(0)===o.fieldChannel.charAt(0)?uc(t,s,{suffix:"start"},{offset:l}):aM({channel:e,channelDef:n,scaleName:s,scale:a,stack:o,markDef:r,config:i,offset:l,defaultRef:u})}function Oy(e,t){const n=sr(e),r=Ho(e);if(t[r]!==void 0)return{[r]:a0(e,t[r])};if(t[e]!==void 0)return{[r]:a0(e,t[e])};if(t[n]){const i=t[n];if(Tc(i))Q(Zye(n));else return{[n]:a0(e,i)}}}function Jo(e,t){const{config:n,encoding:r,markDef:i}=e,s=i.type,a=Os(t),o=sr(t),l=r[t],u=r[a],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=i.orient,h=r[o]??r.size??He("size",i,n,{vgChannel:o}),p=fH(t),g=s==="bar"&&(t==="x"?d==="vertical":d==="horizontal");return ee(l)&&(tt(l.bin)||zt(l.bin)||l.timeUnit&&!u)&&!(h&&!Tc(h))&&!r[p]&&!It(f)?ewe({fieldDef:l,fieldDef2:u,channel:t,model:e}):(_e(l)&&It(f)||g)&&!u?Qxe(l,t,e):uJ(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Zxe(e,t,n,r,i){if(Tc(i))if(n){const a=n.get("type");if(a==="band"){let o=`bandwidth('${t}')`;return i.band!==1&&(o=`${i.band} * ${o}`),{signal:`max(0.25, ${o})`}}else i.band!==1&&(Q(uve(a)),i=void 0)}else return{mult:i.band,field:{group:e}};else{if(pe(i))return i;if(i)return{value:i}}if(n){const a=n.get("range");if(cl(a)&&Ye(a.step))return{value:a.step-2}}return{value:Gb(r.view,e)-2}}function Qxe(e,t,n){const{markDef:r,encoding:i,config:s,stack:a}=n,o=r.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=sr(t),f=Os(t),d=fH(t),h=n.scaleName(d),p=n.getScaleComponent(I6(t)),g=o==="horizontal"&&t==="y"||o==="vertical"&&t==="x";let m;(i.size||r.size)&&(g?m=Mt("size",n,{vgChannel:c,defaultRef:rt(r.size)}):Q(hve(r.type)));const y=!!m,v=uV({channel:t,fieldDef:e,markDef:r,config:s,scaleType:u==null?void 0:u.get("type"),useVlSizeChannel:g});m=m||{[c]:Zxe(c,h||l,p||u,s,v)};const x=(u==null?void 0:u.get("type"))==="band"&&Tc(v)&&!y?"top":"middle",_=lJ(t,r,s,x),w=_==="xc"||_==="yc",{offset:k,offsetType:E}=P0({channel:t,markDef:r,encoding:i,model:n,bandPosition:w?.5:0}),A=aM({channel:t,channelDef:e,markDef:r,config:s,scaleName:l,scale:u,stack:a,offset:k,defaultRef:NM({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:w?E==="encoding"?0:.5:pe(v)?{signal:`(1-${v})/2`}:Tc(v)?(1-v.band)/2:0});if(c)return{[_]:A,...m};{const z=Ho(f),D=m[c],R=k?{...D,offset:k}:D;return{[_]:A,[z]:Y(A)?[A[0],{...A[1],offset:R}]:{...A,offset:R}}}}function bg(e,t,n,r,i){if(sH(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(pe(n)||pe(i)||pe(r)){const a=wa(n),o=wa(i),l=wa(r),u=l?`${l} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=o?`(${o} + ${s})`:s;return{signal:u+c+f}}else return i=i||0,r+(n?-i-s:+i+s)}function ewe({fieldDef:e,fieldDef2:t,channel:n,model:r}){var _;const{config:i,markDef:s,encoding:a}=r,o=r.getScaleComponent(n),l=r.scaleName(n),u=o?o.get("type"):void 0,c=o.get("reverse"),f=uV({channel:n,fieldDef:e,markDef:s,config:i,scaleType:u}),d=(_=r.component.axes[n])==null?void 0:_[0],h=(d==null?void 0:d.get("translate"))??.5,p=Pt(n)?He("binSpacing",s,i)??0:0,g=Os(n),m=Ho(n),y=Ho(g),{offset:v}=P0({channel:n,markDef:s,encoding:a,model:r,bandPosition:0}),x=pe(f)?{signal:`(1-${f.signal})/2`}:Tc(f)?(1-f.band)/2:.5;if(tt(e.bin)||e.timeUnit)return{[y]:FP({fieldDef:e,scaleName:l,bandPosition:x,offset:bg(g,p,c,h,v)}),[m]:FP({fieldDef:e,scaleName:l,bandPosition:pe(x)?{signal:`1-${x.signal}`}:1-x,offset:bg(n,p,c,h,v)})};if(zt(e.bin)){const w=uc(e,l,{},{offset:bg(g,p,c,h,v)});if(ee(t))return{[y]:w,[m]:uc(t,l,{},{offset:bg(n,p,c,h,v)})};if(Xc(e.bin)&&e.bin.step)return{[y]:w,[m]:{signal:`scale("${l}", ${se(e,{expr:"datum"})} + ${e.bin.step})`,offset:bg(n,p,c,h,v)}}}Q(FH(g))}function FP({fieldDef:e,scaleName:t,bandPosition:n,offset:r}){return Lb({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:r})}const twe=new Set(["aria","width","height"]);function ai(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?oJ(e):{};return{...nwe(e.markDef,t),...DP(e,"fill",n),...DP(e,"stroke",r),...Mt("opacity",e),...Mt("fillOpacity",e),...Mt("strokeOpacity",e),...Mt("strokeWidth",e),...Mt("strokeDash",e),...Hxe(e),...sJ(e),...TM(e,"href"),...qxe(e)}}function DP(e,t,n){const{config:r,mark:i,markDef:s}=e;if(He("invalid",s,r)==="hide"&&n&&!fl(i)){const o=rwe(e,{invalid:!0,channels:wx});if(o)return{[t]:[{test:o,value:null},...le(n)]}}return n?{[t]:n}:{}}function nwe(e,t){return Sye.reduce((n,r)=>(!twe.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=rt(e[r])),n),{})}function rwe(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{const o=e.getScaleComponent(a);if(o){const l=o.get("type"),u=e.vgField(a,{expr:"datum"});u&&Cr(l)&&(s[u]=!0)}return s},{}),i=K(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>oM(a,t)).join(` ${s} `)}}function FM(e){const{config:t,markDef:n}=e;if(He("invalid",n,t)){const i=iwe(e,{channels:Rs});if(i)return{defined:{signal:i}}}return{}}function iwe(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,a)=>{var l;const o=e.getScaleComponent(a);if(o){const u=o.get("type"),c=e.vgField(a,{expr:"datum",binSuffix:(l=e.stack)!=null&&l.impute?"mid":void 0});c&&Cr(u)&&(s[c]=!0)}return s},{}),i=K(r);if(i.length>0){const s=t?"||":"&&";return i.map(a=>oM(a,t)).join(` ${s} `)}}function OP(e,t){if(t!==void 0)return{[e]:rt(t)}}const nA="voronoi",cJ={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(nA)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,s=e.mark;if(fl(s))return Q(Nye(s)),n;const a={name:e.getName(nA),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...sJ(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let o=0,l=!1;return n.forEach((u,c)=>{const f=u.name??"";f===e.component.mark[0].name?o=c:f.indexOf(nA)>=0&&(l=!0)}),l||n.splice(o+1,0,a),n}},fJ={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!_M(e.bind),parse:(e,t,n)=>bJ(t,n),topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,s=t.bind,a=t.init&&t.init[0],o=cJ.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((l,u)=>{const c=st(`${r}_${l.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...a?{init:Fc(a[u])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${o}[${te(l.field)}] : null`}]:[],bind:s[l.field]??s[l.channel]??s})}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.filter(u=>u.name===r+Yo)[0],a=r+Fm,o=i.items.map(u=>st(`${r}_${u.field}`)),l=o.map(u=>`${u} !== null`).join(" && ");return o.length&&(s.update=`${l} ? {fields: ${a}, values: [${o.join(", ")}]} : null`),delete s.value,delete s.on,n}},Vb="_toggle",dJ={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Vb,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Yo,r=t.name+Vb;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${fc(e)}}, `)+`${r} ? ${n} : null`}},swe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=oe(t.clear)?rl(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(fJ.defined(t))for(const r of t.project.items){const i=n.findIndex(s=>s.name===st(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,s){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const i of t.project.items){const s=n.findIndex(a=>a.name===i.signals.visual);if(r(s,"[0, 0]"),s===-1){const a=n.findIndex(o=>o.name===i.signals.data);r(a,"null")}}else{let i=n.findIndex(s=>s.name===t.name+Yo);r(i,"null"),dJ.defined(t)&&(i=n.findIndex(s=>s.name===t.name+Vb),r(i,"false"))}return n}},hJ={defined:e=>{const t=e.resolve==="global"&&e.bind&&_M(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Ii;return t&&!n&&Q(Oye),t&&n},parse:(e,t,n)=>{const r=Ee(n);if(r.select=oe(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},bJ(t,r),ce(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const o of t.events)o.filter=le(o.filter??[]),o.filter.includes(a)||o.filter.push(a)}const i=Q5(t.bind)?t.bind.legend:"click",s=oe(i)?rl(i,"view"):le(i);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=Q5(t.bind)&&t.bind.legend,s=a=>o=>{const l=Ee(o);return l.markname=a,l};for(const a of t.project.items){if(!a.hasLegend)continue;const o=`${st(a.field)}_legend`,l=`${r}_${o}`;if(n.filter(c=>c.name===l).length===0){const c=i.merge.map(s(`${o}_symbols`)).concat(i.merge.map(s(`${o}_labels`))).concat(i.merge.map(s(`${o}_entries`)));n.unshift({name:l,...t.init?{}:{value:null},on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]})}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.find(d=>d.name===r+Yo),a=r+Fm,o=i.items.filter(d=>d.hasLegend).map(d=>st(`${r}_${st(d.field)}_legend`)),u=`${o.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${o.join(", ")}]} : null`;t.events&&o.length>0?s.on.push({events:o.map(d=>({signal:d})),update:u}):o.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(d=>d.name===r+Vb),f=Q5(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function awe(e,t,n){var i;const r=(i=e.fieldDef(t))==null?void 0:i.field;for(const s of qt(e.component.selection??{})){const a=s.project.hasField[r]??s.project.hasChannel[t];if(a&&hJ.defined(s)){const o=n.get("selections")??[];o.push(s.name),n.set("selections",o,!1),a.hasLegend=!0}}}const pJ="_translate_anchor",gJ="_translate_delta",owe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=_a.defined(t),s=r+pJ,{x:a,y:o}=t.project.hasChannel;let l=rl(t.translate,"scope");return i||(l=l.map(u=>(u.between[0].markname=r+fd,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${i?m$(e,at):`slice(${a.signals.visual})`}`:"")+(o!==void 0?`, extent_y: ${i?m$(e,Rt):`slice(${o.signals.visual})`}`:"")+"}"}]},{name:r+gJ,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),a!==void 0&&RP(e,t,a,"width",n),o!==void 0&&RP(e,t,o,"height",n),n}};function RP(e,t,n,r,i){const s=t.name,a=s+pJ,o=s+gJ,l=n.channel,u=_a.defined(t),c=i.filter(w=>w.name===n.signals[u?"data":"visual"])[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(l),h=d&&d.get("type"),p=d&&d.get("reverse"),g=u?l===at?p?"":"-":p?"-":"":"",m=`${a}.extent_${l}`,y=`${g}${o}.${l} / ${u?`${f}`:`span(${m})`}`,v=!u||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",x=u?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",_=`${v}(${m}, ${y}${x})`;c.on.push({events:{signal:o},update:u?_:`clampRange(${_}, 0, ${f})`})}const mJ="_zoom_anchor",yJ="_zoom_delta",lwe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=_a.defined(t),s=r+yJ,{x:a,y:o}=t.project.hasChannel,l=te(e.scaleName(at)),u=te(e.scaleName(Rt));let c=rl(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+fd,f))),n.push({name:r+mJ,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&PP(e,t,a,"width",n),o!==void 0&&PP(e,t,o,"height",n),n}};function PP(e,t,n,r,i){const s=t.name,a=n.channel,o=_a.defined(t),l=i.filter(v=>v.name===n.signals[o?"data":"visual"])[0],u=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(a),f=c&&c.get("type"),d=o?m$(e,a):l.name,h=s+yJ,p=`${s}${mJ}.${a}`,g=!o||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",m=o?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${g}(${d}, ${p}, ${h}${m})`;l.on.push({events:{signal:h},update:o?y:`clampRange(${y}, 0, ${u})`})}const Dc="_store",Yo="_tuple",uwe="_modify",vJ="vlSelectionResolve",Ux=[jxe,Bxe,Lxe,dJ,fJ,_a,hJ,swe,owe,lwe,cJ];function cwe(e){let t=e.parent;for(;t&&!Fi(t);)t=t.parent;return t}function fc(e,{escape:t}={escape:!0}){let n=t?te(e.name):e.name;const r=cwe(e);if(r){const{facet:i}=r;for(const s of Yr)i[s]&&(n+=` + '__facet_${s}_' + (facet[${te(r.vgField(s))}])`)}return n}function DM(e){return qt(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function bJ(e,t){(oe(t.select)||!t.select.on)&&delete e.events,(oe(t.select)||!t.select.clear)&&delete e.clear,(oe(t.select)||!t.select.toggle)&&delete e.toggle}function y$(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...y$(e.object)),t.push(...y$(e.property))),t)}function xJ(e){return e.object.type==="MemberExpression"?xJ(e.object):e.object.name==="datum"}function wJ(e){const t=K8(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&xJ(r)&&n.add(y$(r).slice(1).join("."))}),n}class gh extends Ke{clone(){return new gh(null,this.model,Ee(this.filter))}constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=Jb(this.model,this.filter,this),this._dependentFields=wJ(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function fwe(e,t){const n={},r=e.config.selection;if(!t||!t.length)return n;for(const i of t){const s=st(i.name),a=i.select,o=oe(a)?a:a.type,l=ce(a)?Ee(a):{type:o},u=r[o];for(const d in u)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]={...u[d],...l[d]}),(l[d]===void 0||l[d]===!0)&&(l[d]=Ee(u[d]??l[d])));const c=n[s]={...l,name:s,type:o,init:i.value,bind:i.bind,events:oe(l.on)?rl(l.on,"scope"):le(Ee(l.on))},f=Ee(i);for(const d of Ux)d.defined(c)&&d.parse&&d.parse(e,c,f)}return n}function _J(e,t,n,r="datum"){const i=oe(t)?t:t.param,s=st(i),a=te(s+Dc);let o;try{o=e.getSelectionComponent(s,i)}catch{return`!!${s}`}if(o.project.timeUnit){const d=n??e.component.data.raw,h=o.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const l=o.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",u=o.resolve==="global"?")":`, ${te(o.resolve)})`,c=`${l}${a}, ${r}${u}`,f=`length(data(${a}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function EJ(e,t,n){const r=st(t),i=n.encoding;let s=n.field,a;try{a=e.getSelectionComponent(r,t)}catch{return r}if(!i&&!s)s=a.project.items[0].field,a.project.items.length>1&&Q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${te(s)}.`);else if(i&&!s){const o=a.project.items.filter(l=>l.channel===i);!o.length||o.length>1?(s=a.project.items[0].field,Q((o.length?"Multiple ":"No ")+`matching ${te(i)} encoding found for selection ${te(n.param)}. Using "field": ${te(s)}.`)):s=o[0].field}return`${a.name}[${te(ni(s))}]`}function dwe(e,t){for(const[n,r]of Wo(e.component.selection??{})){const i=e.getName(`lookup_${n}`);e.component.data.outputNodes[i]=r.materialized=new Fn(new gh(t,e,{param:n}),i,Qe.Lookup,e.component.data.outputNodeRefCounts)}}function Jb(e,t,n){return s0(t,r=>oe(r)?r:Yve(r)?_J(e,r,n):UH(r))}function hwe(e,t){if(e)return Y(e)&&!mo(e)?e.map(n=>hM(n,t)).join(", "):e}function rA(e,t,n,r){var i,s;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=r}function Wg(e,t,n,r={header:!1}){var f,d;const{disable:i,orient:s,scale:a,labelExpr:o,title:l,zindex:u,...c}=e.combine();if(!i){for(const h in c){const p=Kbe[h],g=c[h];if(p&&p!==t&&p!=="both")delete c[h];else if(Nm(g)){const{condition:m,...y}=g,v=le(m),x=pP[h];if(x){const{vgProp:_,part:w}=x,k=[...v.map(E=>{const{test:A,...z}=E;return{test:Jb(null,A),...z}}),y];rA(c,w,_,k),delete c[h]}else if(x===null){const _={signal:v.map(w=>{const{test:k,...E}=w;return`${Jb(null,k)} ? ${ZR(E)} : `}).join("")+ZR(y)};c[h]=_}}else if(pe(g)){const m=pP[h];if(m){const{vgProp:y,part:v}=m;rA(c,v,y,g),delete c[h]}}Fe(["labelAlign","labelBaseline"],h)&&c[h]===null&&delete c[h]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:h}=c.encode;c.encode={...h?{grid:h}:{}},Je(c.encode)&&delete c.encode}return{scale:a,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:yt(u,0)}}else{if(!r.header&&e.mainExtracted)return;if(o!==void 0){let p=o;(d=(f=c.encode)==null?void 0:f.labels)!=null&&d.update&&pe(c.encode.labels.update.text)&&(p=Sc(o,"datum.label",c.encode.labels.update.text.signal)),rA(c,"labels","text",{signal:p})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const p of vV)e.hasAxisPart(p)||delete c.encode[p];Je(c.encode)&&delete c.encode}const h=hwe(l,n);return{scale:a,orient:s,grid:!1,...h?{title:h}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:yt(u,0)}}}}function kJ(e){const{axes:t}=e.component,n=[];for(const r of Rs)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const s=r==="x"?"height":"width",a=e.getSizeSignalRef(s).signal;s!==a&&n.push({name:s,update:a})}}return n}function pwe(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>Wg(i,"grid",t)),...r.map(i=>Wg(i,"grid",t)),...n.map(i=>Wg(i,"main",t)),...r.map(i=>Wg(i,"main",t))].filter(i=>i)}function IP(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const s=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},o=t[n==="x"?"axisTop":"axisRight"]||{},l=new Set([...K(a),...K(o)]),u={};for(const c of l.values())u[c]={signal:`${r.signal} === "${s}" ? ${wa(a[c])} : ${wa(o[c])}`};return u}return t[i]})])}function gwe(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:WH(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",a=pe(n)?"axisOrient":`axis${wm(n)}`,o=[...i,...i.map(u=>s+u.substr(4))],l=["axis",a,s];return{vlOnlyAxisConfig:IP(o,r,e,n),vgAxisConfig:IP(l,r,e,n),axisConfigStyle:mwe([...l,...o],r)}}function mwe(e,t){var r;const n=[{}];for(const i of e){let s=(r=t[i])==null?void 0:r.style;if(s){s=le(s);for(const a of s)n.push(t.style[a])}}return Object.assign.apply(null,n)}function v$(e,t,n,r={}){var s;const i=_H(e,n,t);if(i!==void 0)return{configFrom:"style",configValue:i};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((s=r[a])==null?void 0:s[e])!==void 0)return{configFrom:a,configValue:r[a][e]};return{}}const LP={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??ywe(n,e),gridScale:({model:e,channel:t})=>vwe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||AJ(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||SJ(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??xwe(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??wwe(t.type,n,ee(t)&&!!t.timeUnit,ee(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const s=e==="x"?"width":e==="y"?"height":void 0,a=s?t.getSizeSignalRef(s):void 0;return n.tickCount??Ewe({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},tickMinStep:kwe,title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=$J(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),s=n==="x"?"x2":"y2",a=t.fieldDef(s);return kH(i?[dP(i)]:[],ee(a)?[dP(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Swe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??Awe(n,t)};function ywe(e,t){return!It(e)&&ee(t)&&!tt(t==null?void 0:t.bin)&&!zt(t==null?void 0:t.bin)}function vwe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function bwe(e,t,n,r,i){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return pe(s)?s:O0(s);{const{configValue:a}=v$("labelAngle",r,t==null?void 0:t.style,i);return a!==void 0?O0(a):n===at&&Fe([nM,tM],e.type)&&!(ee(e)&&e.timeUnit)?270:void 0}}function b$(e){return`(((${e.signal} % 360) + 360) % 360)`}function SJ(e,t,n,r){if(e!==void 0)if(n==="x"){if(pe(e)){const i=b$(e),s=pe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(pe(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(pe(e)){const i=b$(e),s=pe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(pe(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function AJ(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,s=r?"bottom":"left";if(pe(e)){const a=b$(e),o=pe(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${i?`(${a} + 90)`:a} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${a} && ${a} < ${180+i}) === ${o} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(pe(t)){const a=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${a} "${s}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===s)?"left":"right"}function xwe(e,t){if(t==="x"&&Fe(["quantitative","temporal"],e))return!0}function wwe(e,t,n,r){if(n&&!ce(r)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function _we(e){return e==="x"?"bottom":"left"}function Ewe({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!It(t)&&t!=="log"){if(ee(e)){if(tt(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Fe(["month","hours","day","quarter"],(i=Wt(e.timeUnit))==null?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function kwe({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(ee(t)){const{timeUnit:n}=t;if(n){const r=zH(n);if(r)return{signal:r}}}}function $J(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),s=r?r.title:void 0,a=i?i.title:void 0;if(s&&a)return SH(s,a);if(s)return s;if(a)return a;if(s!==void 0)return s;if(a!==void 0)return a}function Swe(e,t){const n=e.values;if(Y(n))return yV(t,n);if(pe(n))return n}function Awe(e,t){return e==="rect"&&Bb(t)?1:0}class Hd extends Ke{clone(){return new Hd(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=wJ(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(Zc(r)&&oV(r.sort)){const{field:s,timeUnit:a}=r,o=r.sort,l=o.map((u,c)=>`${UH({field:s,timeUnit:a,equal:u})} ? ${c} : `).join("")+o.length;t=new Hd(t,{calculate:l,as:Vd(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Re(this.transform)}`}}function Vd(e,t,n){return se(e,{prefix:t,suffix:"sort_index",...n??{}})}function jx(e,t){return Fe(["top","bottom"],t)?"column":Fe(["left","right"],t)||e==="row"?"row":"column"}function Jd(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return yt((t||{})[e],i[e],n.header[e])}function qx(e,t,n,r){const i={};for(const s of e){const a=Jd(s,t||{},n,r);a!==void 0&&(i[s]=a)}return i}const OM=["row","column"],RM=["header","footer"];function $we(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:a,titleOrient:o}=qx(["titleAnchor","titleAngle","titleOrient"],i.header,r,t),l=jx(t,o),u=O0(a);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...MJ(u,l),...CJ(l,u,s),...TJ(r,i,t,b2e,OV)}}}function CJ(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=AJ(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function MJ(e,t){const n=SJ(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Cwe(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of RM)if(n[i])for(const s of n[i]){const a=Twe(e,t,i,n,s);a!=null&&r.push(a)}return r}function Mwe(e,t){const{sort:n}=e;return hs(n)?{field:se(n,{expr:"datum"}),order:n.order??"ascending"}:Y(n)?{field:Vd(e,t,{expr:"datum"}),order:"ascending"}:{field:se(e,{expr:"datum"}),order:n??"ascending"}}function x$(e,t,n){const{format:r,formatType:i,labelAngle:s,labelAnchor:a,labelOrient:o,labelExpr:l}=qx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=uM({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=jx(t,o);return{text:{signal:l?Sc(Sc(l,"datum.label",u),"datum.value",se(e,{expr:"parent"})):u},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...MJ(s,c),...CJ(c,s,a),...TJ(n,e,t,x2e,RV)}}function Twe(e,t,n,r,i){if(i){let s=null;const{facetFieldDef:a}=r,o=e.config?e.config:void 0;if(a&&i.labels){const{labelOrient:f}=qx(["labelOrient"],a.header,o,t);(t==="row"&&!Fe(["top","bottom"],f)||t==="column"&&!Fe(["left","right"],f))&&(s=x$(a,t,o))}const l=Fi(e)&&!Cm(e.facet),u=i.axes,c=(u==null?void 0:u.length)>0;if(s||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...r.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Mwe(a,t)}:{},...c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const Nwe={column:{start:0,end:1},row:{start:1,end:0}};function Fwe(e,t){return Nwe[t][e]}function Dwe(e,t){const n={};for(const r of Yr){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:s,titleOrient:a}=qx(["titleAnchor","titleOrient"],i.facetFieldDef.header,t,r),o=jx(r,a),l=Fwe(s,o);l!==void 0&&(n[o]=l)}}return Je(n)?void 0:n}function TJ(e,t,n,r,i){const s={};for(const a of r){if(!i[a])continue;const o=Jd(a,t==null?void 0:t.header,e,n);o!==void 0&&(s[i[a]]=o)}return s}function PM(e){return[...Ry(e,"width"),...Ry(e,"height"),...Ry(e,"childWidth"),...Ry(e,"childHeight")]}function Ry(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const s=e.getScaleComponent(n);if(s){const a=s.get("type"),o=s.get("range");if(It(a)&&cl(o)){const l=e.scaleName(n);return Fi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[zP(l,o)]:[zP(l,o),{name:i,update:NJ(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const s=i.endsWith("width"),a=s?"containerSize()[0]":"containerSize()[1]",o=d$(e.config.view,s?"width":"height"),l=`isFinite(${a}) ? ${a} : ${o}`;return[{name:i,init:l,on:[{update:l,events:"window:resize"}]}]}else return[{name:i,value:r}]}function zP(e,t){const n=`${e}_step`;return pe(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function NJ(e,t,n){const r=t.get("type"),i=t.get("padding"),s=yt(t.get("paddingOuter"),i);let a=t.get("paddingInner");return a=r==="band"?a!==void 0?a:i:1,`bandspace(${n}, ${wa(a)}, ${wa(s)}) * ${e}_step`}function FJ(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function DJ(e,t){return K(e).reduce((n,r)=>{const i=e[r];return{...n,...ph(t,i,r,s=>rt(s.value))}},{})}function OJ(e,t){if(Fi(t))return e==="theta"?"independent":"shared";if(vh(t))return"shared";if(qM(t))return Pt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function IM(e,t){const n=e.scale[t],r=Pt(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Q(vve(t)),"independent"):e[r][t]||"shared"}const Owe={...E2e,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},RJ=K(Owe);class Rwe extends La{}const BP={symbols:Pwe,gradient:Iwe,labels:Lwe,entries:zwe};function Pwe(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:s}){if(s!=="symbol")return;const{markDef:a,encoding:o,config:l,mark:u}=n,c=a.filled&&u!=="trail";let f={...Cye({},n,xbe),...oJ(n,{filled:c})};const d=i.get("symbolOpacity")??l.legend.symbolOpacity,h=i.get("symbolFillColor")??l.legend.symbolFillColor,p=i.get("symbolStrokeColor")??l.legend.symbolStrokeColor,g=d===void 0?PJ(o.opacity)??a.opacity:void 0;if(f.fill){if(r==="fill"||c&&r===rr)delete f.fill;else if(f.fill.field)h?delete f.fill:(f.fill=rt(l.legend.symbolBaseFillColor??"black"),f.fillOpacity=rt(g??1));else if(Y(f.fill)){const m=w$(o.fill??o.color)??a.fill??(c&&a.color);m&&(f.fill=rt(m))}}if(f.stroke){if(r==="stroke"||!c&&r===rr)delete f.stroke;else if(f.stroke.field||p)delete f.stroke;else if(Y(f.stroke)){const m=yt(w$(o.stroke||o.color),a.stroke,c?a.color:void 0);m&&(f.stroke={value:m})}}if(r!==Ra){const m=ee(t)&&LJ(n,i,t);m?f.opacity=[{test:m,...rt(g??1)},rt(l.legend.unselectedOpacity)]:g&&(f.opacity=rt(g))}return f={...f,...e},Je(f)?void 0:f}function Iwe(e,{model:t,legendType:n,legendCmpt:r}){if(n!=="gradient")return;const{config:i,markDef:s,encoding:a}=t;let o={};const u=(r.get("gradientOpacity")??i.legend.gradientOpacity)===void 0?PJ(a.opacity)||s.opacity:void 0;return u&&(o.opacity=rt(u)),o={...o,...e},Je(o)?void 0:o}function Lwe(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const s=n.legend(r)||{},a=n.config,o=ee(t)?LJ(n,i,t):void 0,l=o?[{test:o,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s;let f;Nc(c)?f=Ci({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:a}):u===void 0&&c===void 0&&a.customFormatTypes&&(t.type==="quantitative"&&a.numberFormatType?f=Ci({fieldOrDatumDef:t,field:"datum.value",format:a.numberFormat,formatType:a.numberFormatType,config:a}):t.type==="temporal"&&a.timeFormatType&&ee(t)&&t.timeUnit===void 0&&(f=Ci({fieldOrDatumDef:t,field:"datum.value",format:a.timeFormat,formatType:a.timeFormatType,config:a})));const d={...l?{opacity:l}:{},...f?{text:f}:{},...e};return Je(d)?void 0:d}function zwe(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?{...e,fill:{value:"transparent"}}:e}function PJ(e){return IJ(e,(t,n)=>Math.max(t,n.value))}function w$(e){return IJ(e,(t,n)=>yt(t,n.value))}function IJ(e,t){if(zbe(e))return le(e.condition).reduce(t,e.value);if(Pi(e))return e.value}function LJ(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=te(n.field);return r.map(s=>`(!length(data(${te(st(s)+Dc)})) || (${s}[${i}] && indexof(${s}[${i}], datum.value) >= 0))`).join(" || ")}const UP={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return rV(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return iV(r,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??Hwe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??Vwe(n),symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>e.symbolType??Uwe(t.type,n,r.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>cd(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(ud(n)&&$i(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Bwe(t,e)};function Bwe(e,t){const n=e.values;if(Y(n))return yV(t,n);if(pe(n))return n}function Uwe(e,t,n,r){if(t!=="shape"){const i=w$(n)??r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function jwe(e){const{legend:t}=e;return yt(t.type,qwe(e))}function qwe({channel:e,timeUnit:t,scaleType:n}){if(ud(e)){if(Fe(["quarter","month","day"],t))return"symbol";if($i(n))return"gradient"}return"symbol"}function Gwe({legendConfig:e,legendType:t,orient:n,legend:r}){return r.direction??e[t?"gradientDirection":"symbolDirection"]??Wwe(n,t)}function Wwe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Hwe({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:a,gradientVerticalMaxLength:o,gradientVerticalMinLength:l}=e;if($i(i))return n==="horizontal"?r==="top"||r==="bottom"?jP(t,"width",a,s):a:jP(t,"height",l,o)}function jP(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function Vwe(e){if(Fe(["quantile","threshold","log","symlog"],e))return"greedy"}function zJ(e){const t=pt(e)?Jwe(e):Zwe(e);return e.component.legends=t,t}function Jwe(e){const{encoding:t}=e,n={};for(const r of[rr,...IV]){const i=kt(t[r]);!i||!e.getScaleComponent(r)||r===ir&&ee(i)&&i.type===hh||(n[r]=Kwe(e,r))}return n}function Ywe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Xwe(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function Kwe(e,t){var _;let n=e.legend(t);const{markDef:r,encoding:i,config:s}=e,a=s.legend,o=new Rwe({},Ywe(e,t));awe(e,t,o);const l=n!==void 0?!n:a.disable;if(o.set("disable",l,n!==void 0),l)return o;n=n||{};const u=e.getScaleComponent(t).get("type"),c=kt(i[t]),f=ee(c)?(_=Wt(c.timeUnit))==null?void 0:_.unit:void 0,d=n.orient||s.legend.orient||"right",h=jwe({legend:n,channel:t,timeUnit:f,scaleType:u}),p=Gwe({legend:n,legendType:h,orient:d,legendConfig:a}),g={legend:n,channel:t,model:e,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:a,config:s,scaleType:u,orient:d,legendType:h,direction:p};for(const w of RJ){if(h==="gradient"&&w.startsWith("symbol")||h==="symbol"&&w.startsWith("gradient"))continue;const k=w in UP?UP[w](g):n[w];if(k!==void 0){const E=Xwe(k,w,n,e.fieldDef(t));(E||s.legend[w]===void 0)&&o.set(w,k,E)}}const m=(n==null?void 0:n.encoding)??{},y=o.get("selections"),v={},x={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:o,legendType:h};for(const w of["labels","legend","title","symbols","gradient","entries"]){const k=DJ(m[w]??{},e),E=w in BP?BP[w](k,x):k;E!==void 0&&!Je(E)&&(v[w]={...y!=null&&y.length&&ee(c)?{name:`${st(c.field)}_legend_${w}`}:{},...y!=null&&y.length?{interactive:!!y}:{},update:E})}return Je(v)||o.set("encode",v,!!(n!=null&&n.encoding)),o}function Zwe(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){zJ(r);for(const i of K(r.component.legends))n.legend[i]=IM(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=BJ(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of K(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function BJ(e,t){var s,a,o,l;if(!e)return t.clone();const n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const u of RJ){const c=Vo(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,d)=>{switch(u){case"symbolType":return Qwe(f,d);case"title":return AH(f,d);case"type":return i=!0,yr("symbol")}return zx(f,d,u,"legend")});e.setWithExplicit(u,c)}return i&&((a=(s=e.implicit)==null?void 0:s.encode)!=null&&a.gradient&&Ob(e.implicit,["encode","gradient"]),(l=(o=e.explicit)==null?void 0:o.encode)!=null&&l.gradient&&Ob(e.explicit,["encode","gradient"])),e}function Qwe(e,t){return t.value==="circle"?t:e}function e_e(e,t,n,r){var i,s;e.encode??(e.encode={}),(i=e.encode)[t]??(i[t]={}),(s=e.encode[t]).update??(s.update={}),e.encode[t].update[n]=r}function UJ(e){const t=e.component.legends,n={};for(const i of K(t)){const s=e.getScaleComponent(i),a=et(s.get("domains"));if(n[a])for(const o of n[a])BJ(o,t[i])||n[a].push(t[i]);else n[a]=[t[i].clone()]}return qt(n).flat().map(i=>t_e(i,e.config)).filter(i=>i!==void 0)}function t_e(e,t){var a,o,l;const{disable:n,labelExpr:r,selections:i,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),(a=s.encode)!=null&&a.symbols){const u=s.encode.symbols.update;u.fill&&u.fill.value!=="transparent"&&!u.stroke&&!s.stroke&&(u.stroke={value:"transparent"});for(const c of IV)s[c]&&delete u[c]}if(s.title||delete s.title,r!==void 0){let u=r;(l=(o=s.encode)==null?void 0:o.labels)!=null&&l.update&&pe(s.encode.labels.update.text)&&(u=Sc(r,"datum.label",s.encode.labels.update.text.signal)),e_e(s,"labels","text",{signal:u})}return s}}function n_e(e){return vh(e)||qM(e)?r_e(e):jJ(e)}function r_e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),jJ(e))}function jJ(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},s=t.data.reduce((a,o)=>{const l=pe(o)?o.signal:`data('${e.lookupDataSource(o)}')`;return Fe(a,l)||a.push(l),a},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const i_e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class qJ extends La{constructor(t,n,r,i){super({...n},{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function GJ(e){e.component.projection=pt(e)?s_e(e):l_e(e)}function s_e(e){if(e.hasProjection){const t=Wn(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?a_e(e):void 0,s=new qJ(e.projectionName(!0),{...Wn(e.config.projection)??{},...t??{}},r,i);return s.get("type")||s.set("type","equalEarth",!1),s}}function a_e(e){const t=[],{encoding:n}=e;for(const r of[[Gi,qi],[ri,Wi]])(kt(n[r[0]])||kt(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(ir)&&e.typedFieldDef(ir).type===hh&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Qe.Main)),t}function o_e(e,t){const n=M6(i_e,i=>!!(!ve(e.explicit,i)&&!ve(t.explicit,i)||ve(e.explicit,i)&&ve(t.explicit,i)&&os(e.get(i),t.get(i))));if(os(e.size,t.size)){if(n)return e;if(os(e.explicit,{}))return t;if(os(t.explicit,{}))return e}return null}function l_e(e){if(e.children.length===0)return;let t;for(const r of e.children)GJ(r);const n=M6(e.children,r=>{const i=r.component.projection;if(i)if(t){const s=o_e(t,i);return s&&(t=s),!!s}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new qJ(r,t.specifiedProjection,t.size,Ee(t.data));for(const s of e.children){const a=s.component.projection;a&&(a.isFit&&i.data.push(...s.component.projection.data),s.renameProjection(a.get("name"),r),a.merged=!0)}return i}}function u_e(e,t,n,r){if(Tm(t,n)){const i=pt(e)?e.axis(n)??e.legend(n)??{}:{},s=se(t,{expr:"datum"}),a=se(t,{expr:"datum",binSuffix:"end"});return{formulaAs:se(t,{binSuffix:"range",forAs:!0}),formula:$m(s,a,i.format,i.formatType,r)}}return{}}function WJ(e,t){return`${vH(e)}_${t}`}function c_e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function LM(e,t,n){const r=Dx(n,void 0)??{},i=WJ(r,t);return e.getName(`${i}_bins`)}function f_e(e){return"as"in e}function qP(e,t,n){let r,i;f_e(e)?r=oe(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[se(e,{forAs:!0}),se(e,{binSuffix:"end",forAs:!0})];const s={...Dx(t,void 0)},a=WJ(s,e.field),{signal:o,extentSignal:l}=c_e(n,a);if(_x(s.extent)){const c=s.extent;i=EJ(n,c.param,c),delete s.extent}const u={bin:s,field:e.field,as:[r],...o?{signal:o}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}};return{key:a,binComponent:u}}class gs extends Ke{clone(){return new gs(null,Ee(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,a)=>{if(Rn(s)&&tt(s.bin)){const{key:o,binComponent:l}=qP(s,s.bin,n);i[o]={...l,...i[o],...u_e(n,s,a,n.config)}}return i},{});return Je(r)?null:new gs(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:s}=qP(n,n.bin,r);return new gs(t,{[i]:s})}merge(t,n){for(const r of K(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=ls([...this.bins[r].as,...t.bins[r].as],Re)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(qt(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(qt(this.bins).map(t=>t.field))}hash(){return`Bin ${Re(this.bins)}`}assemble(){return qt(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,{extent:s,...a}=t.bin,o={type:"bin",field:ni(t.field),as:r,signal:t.signal,..._x(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...a};!s&&t.extentSignal&&(n.push({type:"extent",field:ni(t.field),signal:t.extentSignal}),o.extent={signal:t.extentSignal}),n.push(o);for(const l of i)for(let u=0;u<2;u++)n.push({type:"formula",expr:se({field:r[u]},{expr:"datum"}),as:l[u]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function d_e(e,t,n,r){var s;const i=pt(r)?r.encoding[Os(t)]:void 0;if(Rn(n)&&pt(r)&&cV(n,i,r.markDef,r.config))e.add(se(n,{})),e.add(se(n,{suffix:"end"})),n.bin&&Tm(n,t)&&e.add(se(n,{binSuffix:"range"}));else if(oH(t)){const a=aH(t);e.add(r.getName(a))}else e.add(se(n));return Zc(n)&&lbe((s=n.scale)==null?void 0:s.range)&&e.add(n.scale.range.field),e}function h_e(e,t){for(const n of K(t)){const r=t[n];for(const i of K(r))n in e?e[n][i]=new Set([...e[n][i]??[],...r[i]]):e[n]={[i]:r[i]}}}class Ni extends Ke{clone(){return new Ni(null,new Set(this.dimensions),Ee(this.measures))}constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(a=>{a.aggregate&&(r=!0)});const i={},s=new Set;return!r||(n.forEachFieldDef((a,o)=>{const{aggregate:l,field:u}=a;if(l)if(l==="count")i["*"]??(i["*"]={}),i["*"].count=new Set([se(a,{forAs:!0})]);else{if(Ca(l)||ul(l)){const c=Ca(l)?"argmin":"argmax",f=l[c];i[f]??(i[f]={}),i[f][c]=new Set([se({op:c,field:f},{forAs:!0})])}else i[u]??(i[u]={}),i[u][l]=new Set([se(a,{forAs:!0})]);Pa(o)&&n.scaleDomain(o)==="unaggregated"&&(i[u]??(i[u]={}),i[u].min=new Set([se({field:u,aggregate:"min"},{forAs:!0})]),i[u].max=new Set([se({field:u,aggregate:"max"},{forAs:!0})]))}else d_e(s,o,a,n)}),s.size+K(i).length===0)?null:new Ni(t,s,i)}static makeFromTransform(t,n){const r=new Set,i={};for(const s of n.aggregate){const{op:a,field:o,as:l}=s;a&&(a==="count"?(i["*"]??(i["*"]={}),i["*"].count=new Set([l||se(s,{forAs:!0})])):(i[o]??(i[o]={}),i[o][a]=new Set([l||se(s,{forAs:!0})])))}for(const s of n.groupby??[])r.add(s);return r.size+K(i).length===0?null:new Ni(t,r,i)}merge(t){return ZW(this.dimensions,t.dimensions)?(h_e(this.measures,t.measures),!0):(Ove("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...K(this.measures)])}producedFields(){const t=new Set;for(const n of K(this.measures))for(const r of K(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${Re({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const s of K(this.measures))for(const a of K(this.measures[s]))for(const o of this.measures[s][a])r.push(o),t.push(a),n.push(s==="*"?null:ni(s));return{type:"aggregate",groupby:[...this.dimensions].map(ni),ops:t,fields:n,as:r}}}class mh extends Ke{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const s of Yr){const a=n.facet[s];if(a){const{bin:o,sort:l}=a;this[s]={name:n.getName(`${s}_domain`),fields:[se(a),...tt(o)?[se(a,{binSuffix:"end"})]:[]],...hs(l)?{sortField:l}:Y(l)?{sortIndexField:Vd(a,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Yr)this[n]&&(t+=` ${n.charAt(0)}:${Re(this[n])}`);return t}get fields(){var n;const t=[];for(const r of Yr)(n=this[r])!=null&&n.fields&&t.push(...this[r].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Yr)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Rs){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(It(i)&&cl(s)){const a=Gx(this.childModel,n),o=jM(a);o?t[n]=o:Q(q6(n))}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x",facet:void 0}[t],s=[],a=[],o=[];i&&r&&r[i]&&(n?(s.push(`distinct_${r[i]}`),a.push("max")):(s.push(r[i]),a.push("distinct")),o.push(`distinct_${r[i]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=Mx,field:f}=l;s.push(f),a.push(c),o.push(se(l,{forAs:!0}))}else u&&(s.push(u),a.push("max"),o.push(u));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:a,as:o}:{}}]}}assembleFacetHeaderData(t){var l;const{columns:n}=this.model.layout,{layoutHeaders:r}=this.model.component,i=[],s={};for(const u of OM){for(const c of RM){const f=(r[u]&&r[u][c])??[];for(const d of f)if(((l=d.axes)==null?void 0:l.length)>0){s[u]=!0;break}}if(s[u]){const c=`length(data("${this.facet.name}"))`,f=u==="row"?n?{signal:`ceil(${c} / ${n})`}:1:n?{signal:`min(${c}, ${n})`}:{signal:c};i.push({name:`${this.facet.name}_${u}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:a,column:o}=s;return(a||o)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,t)),i}assemble(){const t=[];let n=null;const r=this.getChildIndependentFieldsWithStep(),{column:i,row:s,facet:a}=this;if(i&&s&&(r.x||r.y)){n=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(r.x??[],r.y??[]),l=o.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:l}]})}for(const o of[xa,ba])this[o]&&t.push(this.assembleRowColumnHeaderData(o,n,r));if(a){const o=this.assembleFacetHeaderData(r);o&&t.push(...o)}return t}}function GP(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function p_e(e,t){const n=F6(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const r=GP(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.startsWith("utc:")){const r=GP(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Q(Uye(t)),null}function g_e(e){const t={};return pv(e.filter,n=>{if(BH(n)){let r=null;V6(n)?r=xr(n.equal):Y6(n)?r=xr(n.lte):J6(n)?r=xr(n.lt):X6(n)?r=xr(n.gt):K6(n)?r=xr(n.gte):Z6(n)?r=n.range[0]:Q6(n)&&(r=(n.oneOf??n.in)[0]),r&&(Kc(r)?t[n.field]="date":Ye(r)?t[n.field]="number":oe(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function m_e(e){const t={};function n(r){Gd(r)?t[r.field]="date":r.type==="quantitative"&&bye(r.aggregate)?t[r.field]="number":Ld(r.field)>1?r.field in t||(t[r.field]="flatten"):Zc(r)&&hs(r.sort)&&Ld(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((pt(e)||Fi(e))&&e.forEachFieldDef((r,i)=>{if(Rn(r))n(r);else{const s=Yc(i),a=e.fieldDef(s);n({...r,type:a.type})}}),pt(e)){const{mark:r,markDef:i,encoding:s}=e;if(fl(r)&&!e.encoding.order){const a=i.orient==="horizontal"?"y":"x",o=s[a];ee(o)&&o.type==="quantitative"&&!(o.field in t)&&(t[o.field]="number")}}return t}function y_e(e){const t={};if(pt(e)&&e.component.selection)for(const n of K(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&Ld(i.field)>1&&(t[i.field]="flatten")}return t}class rn extends Ke{clone(){return new rn(null,Ee(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${Re(this._parse)}`}static makeExplicit(t,n,r){var a;let i={};const s=n.data;return!Do(s)&&((a=s==null?void 0:s.format)!=null&&a.parse)&&(i=s.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const o of K(r)){const l=i.getWithExplicit(o);l.value!==void 0&&(l.explicit||l.value===r[o]||l.value==="derived"||r[o]==="flatten"?delete r[o]:Q(iP(o,r[o],l.value)))}for(const o of K(n)){const l=i.get(o);l!==void 0&&(l===n[o]?delete n[o]:Q(iP(o,n[o],l)))}const s=new La(n,r);i.copyAll(s);const a={};for(const o of K(s.combine())){const l=s.get(o);l!==null&&(a[o]=l)}return K(a).length===0||i.parseNothing?null:new rn(t,a)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of K(this._parse)){const r=this._parse[n];Ld(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(K(this._parse))}dependentFields(){return new Set(K(this._parse))}assembleTransforms(t=!1){return K(this._parse).filter(n=>t?Ld(n)>1:!0).map(n=>{const r=p_e(n,this._parse[n]);return r?{type:"formula",expr:r,as:D6(n)}:null}).filter(n=>n!==null)}}class Xo extends Ke{clone(){return new Xo(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Ii])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Ii}}}class Dm extends Ke{clone(){return new Dm(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Re(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class Om extends Ke{clone(){return new Om(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${Re(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Oc extends Ke{constructor(t){super(null),t??(t={name:"source"});let n;if(Do(t)||(n=t.format?{...Xn(t.format,["parse"])}:{}),R0(t))this._data={values:t.values};else if(Wd(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];Fe(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else eJ(t)?this._data={values:[{type:"Sphere"}]}:(ZV(t)||Do(t))&&(this._data={});this._generator=Do(t),t.name&&(this._name=t.name),n&&!Je(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var WP=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,n):i?i.value=n:t.set(e,n),n},v_e=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},Hg;function zM(e){return e instanceof Oc||e instanceof Dm||e instanceof Om}class BM{constructor(){Hg.set(this,void 0),WP(this,Hg,!1,"f")}setModified(){WP(this,Hg,!0,"f")}get modifiedFlag(){return v_e(this,Hg,"f")}}Hg=new WeakMap;class Qc extends BM{getNodeDepths(t,n,r){r.set(t,n);for(const i of t.children)this.getNodeDepths(i,n+1,r);return r}optimize(t){const r=[...this.getNodeDepths(t,0,new Map).entries()].sort((i,s)=>s[1]-i[1]);for(const i of r)this.run(i[0]);return this.modifiedFlag}}class UM extends BM{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class b_e extends UM{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of K(r))r[i].length>1&&(this.setModified(),this.mergeNodes(t,r[i]))}}class x_e extends UM{constructor(t){super(),this.requiresSelectionId=t&&DM(t)}run(t){t instanceof Xo&&(this.requiresSelectionId&&(zM(t.parent)||t.parent instanceof Ni||t.parent instanceof rn)||(this.setModified(),t.remove()))}}class w_e extends BM{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let r=new Set;t instanceof ps&&(r=t.producedFields(),T6(r,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const i of t.children)this.run(i,new Set([...n,...r]))}}class __e extends UM{constructor(){super()}run(t){t instanceof Fn&&!t.isRequired()&&(this.setModified(),t.remove())}}class E_e extends Qc{run(t){if(!zM(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof rn)if(t instanceof rn)this.setModified(),t.merge(n);else{if(N6(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class k_e extends Qc{run(t){const n=[...t.children],r=t.children.filter(i=>i instanceof rn);if(t.numChildren()>1&&r.length>=1){const i={},s=new Set;for(const a of r){const o=a.parse;for(const l of K(o))l in i?i[l]!==o[l]&&s.add(l):i[l]=o[l]}for(const a of s)delete i[a];if(!Je(i)){this.setModified();const a=new rn(t,i);for(const o of n){if(o instanceof rn)for(const l of K(i))delete o.parse[l];t.removeChild(o),o.parent=a,o instanceof rn&&K(o.parse).length===0&&o.remove()}}}}}class S_e extends Qc{run(t){t instanceof Fn||t.numChildren()>0||t instanceof mh||t instanceof Oc||(this.setModified(),t.remove())}}class A_e extends Qc{run(t){const n=t.children.filter(i=>i instanceof ps),r=n.pop();for(const i of n)this.setModified(),r.merge(i)}}class $_e extends Qc{run(t){const n=t.children.filter(i=>i instanceof Ni),r={};for(const i of n){const s=Re(i.groupBy);s in r||(r[s]=[]),r[s].push(i)}for(const i of K(r)){const s=r[i];if(s.length>1){const a=s.pop();for(const o of s)a.merge(o)&&(t.removeChild(o),o.parent=a,o.remove(),this.setModified())}}}}class C_e extends Qc{constructor(t){super(),this.model=t}run(t){const n=!(zM(t)||t instanceof gh||t instanceof rn||t instanceof Xo),r=[],i=[];for(const s of t.children)s instanceof gs&&(n&&!N6(t.producedFields(),s.dependentFields())?r.push(s):i.push(s));if(r.length>0){const s=r.pop();for(const a of r)s.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof gs?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(i.length>1){const s=i.pop();for(const a of i)s.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class M_e extends Qc{run(t){const n=[...t.children];if(!kc(n,a=>a instanceof Fn)||t.numChildren()<=1)return;const i=[];let s;for(const a of n)if(a instanceof Fn){let o=a;for(;o.numChildren()===1;){const[l]=o.children;if(l instanceof Fn)o=l;else break}i.push(...o.children),s?(t.removeChild(a),a.parent=s.parent,s.parent.removeChild(s),s.parent=o,this.setModified()):s=o}else i.push(a);if(i.length){this.setModified();for(const a of i)a.parent.removeChild(a),a.parent=s}}}class ef extends Ke{clone(){return new ef(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ls(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??se(t)}hash(){return`JoinAggregateTransform ${Re(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const s of this.transform.joinaggregate)n.push(s.op),r.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const i=this.transform.groupby;return{type:"joinaggregate",as:r,ops:n,fields:t,...i!==void 0?{groupby:i}:{}}}}function T_e(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=se(r);return i&&t.push(i),t},[])}function N_e(e){return Y(e)&&e.every(t=>oe(t))&&e.length>1}class Ea extends Ke{clone(){return new Ea(null,Ee(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:r,groupby:i,as:s,offset:a="zero"}=n,o=[],l=[];if(n.sort!==void 0)for(const f of n.sort)o.push(f.field),l.push(yt(f.order,"ascending"));const u={field:o,order:l};let c;return N_e(s)?c=s:oe(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Ea(t,{dimensionFieldDefs:[],stackField:r,groupby:i,offset:a,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannels:s,fieldChannel:a,offset:o,impute:l}=r,u=s.map(h=>{const p=i[h];return Es(p)}).filter(h=>!!h),c=T_e(n),f=n.encoding.order;let d;return Y(f)||ee(f)?d=EH(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Ea(t,{dimensionFieldDefs:u,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:o,impute:l,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Re(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:r}=this._stack;return t.length>0?t.map(i=>i.bin?n?[se(i,{binSuffix:"mid"})]:[se(i,{}),se(i,{binSuffix:"end"})]:[se(i)]).flat():r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:r,stackField:i,stackby:s,sort:a,offset:o,impute:l,as:u}=this._stack;if(l)for(const c of r){const{bandPosition:f=.5,bin:d}=c;if(d){const h=se(c,{expr:"datum"}),p=se(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${p}`,as:se(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:i,groupby:[...s,...n],key:se(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:a,as:u,offset:o}),t}}class yh extends Ke{clone(){return new yh(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ls(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??se(t)}hash(){return`WindowTransform ${Re(this.transform)}`}assemble(){const t=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const s=this.transform.frame,a=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(f=>U6(f)))return{type:"joinaggregate",as:r,ops:n,fields:t,...a!==void 0?{groupby:a}:{}};const o=[],l=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)o.push(f.field),l.push(f.order??"ascending");const u={field:o,order:l},c=this.transform.ignorePeers;return{type:"window",params:i,as:r,ops:n,fields:t,sort:u,...c!==void 0?{ignorePeers:c}:{},...a!==void 0?{groupby:a}:{},...s!==void 0?{frame:s}:{}}}}function F_e(e){function t(n){if(!(n instanceof mh)){const r=n.clone();if(r instanceof Fn){const i=E$+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Ni||r instanceof Ea||r instanceof yh||r instanceof ef)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function _$(e){if(e instanceof mh)if(e.numChildren()===1&&!(e.children[0]instanceof Fn)){const t=e.children[0];(t instanceof Ni||t instanceof Ea||t instanceof yh||t instanceof ef)&&t.addDimensions(e.fields),t.swapWithParent(),_$(e)}else{const t=e.model.component.data.main;HJ(t);const n=F_e(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(_$)}function HJ(e){if(e instanceof Fn&&e.type===Qe.Main&&e.numChildren()===1){const t=e.children[0];t instanceof mh||(t.swapWithParent(),HJ(e))}}const E$="scale_",Py=5;function k$(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!k$(t.children))return!1}return!0}function hi(e,t){let n=!1;for(const r of t)n=e.optimize(r)||n;return n}function HP(e,t,n){let r=e.sources,i=!1;return i=hi(new __e,r)||i,i=hi(new x_e(t),r)||i,r=r.filter(s=>s.numChildren()>0),i=hi(new S_e,r)||i,r=r.filter(s=>s.numChildren()>0),n||(i=hi(new E_e,r)||i,i=hi(new C_e(t),r)||i,i=hi(new w_e,r)||i,i=hi(new k_e,r)||i,i=hi(new $_e,r)||i,i=hi(new A_e,r)||i,i=hi(new b_e,r)||i,i=hi(new M_e,r)||i),e.sources=r,i}function D_e(e,t){k$(e.sources);let n=0,r=0;for(let i=0;i<Py&&HP(e,t,!0);i++)n++;e.sources.map(_$);for(let i=0;i<Py&&HP(e,t,!1);i++)r++;k$(e.sources),Math.max(n,r)===Py&&Q(`Maximum optimization runs(${Py}) reached.`)}class Zn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Zn(()=>t(n))}}function VJ(e){pt(e)?O_e(e):R_e(e)}function O_e(e){const t=e.component.scales;for(const n of K(t)){const r=I_e(e,n);if(t[n].setWithExplicit("domains",r),z_e(e,n),e.component.data.isFaceted){let s=e;for(;!Fi(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const o of r.value)ga(o)&&(o.data=E$+o.data.replace(E$,""))}}}function R_e(e){for(const n of e.children)VJ(n);const t=e.component.scales;for(const n of K(t)){let r,i=null;for(const s of e.children){const a=s.component.scales[n];if(a){r===void 0?r=a.getWithExplicit("domains"):r=Vo(r,a.getWithExplicit("domains"),"domains","scale",S$);const o=a.get("selectionExtent");i&&o&&i.param!==o.param&&Q(Iye),i=o}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function P_e(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:s}=VP(t,n);if(!i){Q(s);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=VP(t,n);if(i)return"unaggregated"}return e}function I_e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=P_e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:i}),t==="x"&&kt(r.x2)?kt(r.x)?Vo(co(n,i,e,"x"),co(n,i,e,"x2"),"domain","scale",S$):co(n,i,e,"x2"):t==="y"&&kt(r.y2)?kt(r.y)?Vo(co(n,i,e,"y"),co(n,i,e,"y2"),"domain","scale",S$):co(n,i,e,"y2"):co(n,i,e,t)}function L_e(e,t,n){return e.map(r=>({signal:`{data: ${Ox(r,{timeUnit:n,type:t})}}`}))}function iA(e,t,n){var i;const r=(i=Wt(n))==null?void 0:i.unit;return t==="temporal"||r?L_e(e,t,r):[e]}function co(e,t,n,r){const{encoding:i}=n,s=kt(i[r]),{type:a}=s,o=s.timeUnit;if(obe(t)){const f=co(e,void 0,n,r),d=iA(t.unionWith,a,o);return ns([...d,...f.value])}else{if(pe(t))return ns([t]);if(t&&t!=="unaggregated"&&!VH(t))return ns(iA(t,a,o))}const l=n.stack;if(l&&r===l.fieldChannel){if(l.offset==="normalize")return yr([[0,1]]);const f=n.requestDataName(Qe.Main);return yr([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const u=Pa(r)&&ee(s)?B_e(n,r,e):void 0;if(Ps(s)){const f=iA([s.datum],a,o);return yr(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(Qe.Main),{field:d}=s;return yr([{data:f,field:se({field:d,aggregate:"min"})},{data:f,field:se({field:d,aggregate:"max"})}])}else if(tt(c.bin)){if(It(e))return yr(e==="bin-ordinal"?[]:[{data:D0(u)?n.requestDataName(Qe.Main):n.requestDataName(Qe.Raw),field:n.vgField(r,Tm(c,r)?{binSuffix:"range"}:{}),sort:u===!0||!ce(u)?{field:n.vgField(r,{}),op:"min"}:u}]);{const{bin:f}=c;if(tt(f)){const d=LM(n,c.field,f);return yr([new Zn(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return yr([{data:n.requestDataName(Qe.Main),field:n.vgField(r,{})}])}}else if(c.timeUnit&&Fe(["time","utc"],e)&&cV(c,pt(n)?n.encoding[Os(r)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Qe.Main);return yr([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return yr(u?[{data:D0(u)?n.requestDataName(Qe.Main):n.requestDataName(Qe.Raw),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(Qe.Main),field:n.vgField(r)}])}function sA(e,t){const{op:n,field:r,order:i}=e;return{op:n??(t?"sum":Mx),...r?{field:ni(r)}:{},...i?{order:i}:{}}}function z_e(e,t){var o;const n=e.component.scales[t],r=e.specifiedScales[t].domain,i=(o=e.fieldDef(t))==null?void 0:o.bin,s=VH(r)&&r,a=Xc(i)&&_x(i.extent)&&i.extent;(s||a)&&n.set("selectionExtent",s??a,!0)}function B_e(e,t,n){if(!It(n))return;const r=e.fieldDef(t),i=r.sort;if(oV(i))return{op:"min",field:Vd(r,t),order:"ascending"};const{stack:s}=e,a=s?new Set([...s.groupbyFields,...s.stackBy.map(o=>o.fieldDef.field)]):void 0;if(hs(i)){const o=s&&!a.has(i.field);return sA(i,o)}else if(aV(i)){const{encoding:o,order:l}=i,u=e.fieldDef(o),{aggregate:c,field:f}=u,d=s&&!a.has(f);if(Ca(c)||ul(c))return sA({field:se(u),order:l},d);if(U6(c)||!c)return sA({op:c,field:f,order:l},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Fe(["ascending",void 0],i))return!0}}function VP(e,t){const{aggregate:n,type:r}=e;return n?oe(n)&&!wye.has(n)?{valid:!1,reason:fve(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:dve(e)}:{valid:!0}:{valid:!1,reason:cve(e)}}function S$(e,t,n,r){return e.explicit&&t.explicit&&Q(yve(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function U_e(e){const t=ls(e.map(a=>{if(ga(a)){const{sort:o,...l}=a;return l}return a}),Re),n=ls(e.map(a=>{if(ga(a)){const o=a.sort;return o!==void 0&&!D0(o)&&("op"in o&&o.op==="count"&&delete o.field,o.order==="ascending"&&delete o.order),o}}).filter(a=>a!==void 0),Re);if(t.length===0)return;if(t.length===1){const a=e[0];if(ga(a)&&n.length>0){let o=n[0];if(n.length>1){Q(aP);const l=n.filter(u=>ce(u)&&"op"in u&&u.op!=="min");n.every(u=>ce(u)&&"op"in u)&&l.length===1?o=l[0]:o=!0}else if(ce(o)&&"field"in o){const l=o.field;a.field===l&&(o=o.order?{order:o.order}:!0)}return{...a,sort:o}}return a}const r=ls(n.map(a=>D0(a)||!("op"in a)||oe(a.op)&&a.op in yye?a:(Q(bve(a)),!0)),Re);let i;r.length===1?i=r[0]:r.length>1&&(Q(aP),i=!0);const s=ls(e.map(a=>ga(a)?a.data:null),a=>a);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(o=>o.field),...i?{sort:i}:{}}:{fields:t,...i?{sort:i}:{}}}function jM(e){if(ga(e)&&oe(e.field))return e.field;if(_ye(e)){let t;for(const n of e.fields)if(ga(n)&&oe(n.field)){if(!t)t=n.field;else if(t!==n.field)return Q(xve),t}return Q(wve),t}else if(Eye(e)){Q(_ve);const t=e.fields[0];return oe(t)?t:void 0}}function Gx(e,t){const r=e.component.scales[t].get("domains").map(i=>(ga(i)&&(i.data=e.lookupDataSource(i.data)),i));return U_e(r)}function JJ(e){return vh(e)||qM(e)?e.children.reduce((t,n)=>t.concat(JJ(n)),JP(e)):JP(e)}function JP(e){return K(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:s,type:a,selectionExtent:o,domains:l,range:u,reverse:c,...f}=i,d=j_e(i.range,s,n,e),h=Gx(e,n),p=o?Pxe(e,o,r,h):null;return t.push({name:s,type:a,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function j_e(e,t,n,r){if(Pt(n)){if(cl(e))return{step:{signal:`${t}_step`}}}else if(ce(e)&&ga(e))return{...e,data:r.lookupDataSource(e.data)};return e}class YJ extends La{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:kc(this.get("domains"),t=>Y(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const q_e=["range","scheme"];function G_e(e){const t=e.component.scales;for(const n of wx){const r=t[n];if(!r)continue;const i=W_e(n,e);r.setWithExplicit("range",i)}}function YP(e,t){const n=e.fieldDef(t);if(n!=null&&n.bin){const{bin:r,field:i}=n,s=sr(t),a=e.getName(s);if(ce(r)&&r.binned&&r.step!==void 0)return new Zn(()=>{const o=e.scaleName(t),l=`(domain("${o}")[1] - domain("${o}")[0]) / ${r.step}`;return`${e.getSignalName(a)} / (${l})`});if(tt(r)){const o=LM(e,i,r);return new Zn(()=>{const l=e.getSignalName(o),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(a)} / (${u})`})}}}function W_e(e,t){const n=t.specifiedScales[e],{size:r}=t,s=t.getScaleComponent(e).get("type");for(const f of q_e)if(n[f]!==void 0){const d=l$(s,f),h=JH(e,f);if(!d)Q(TH(s,f,e));else if(h)Q(h);else switch(f){case"range":{const p=n.range;if(Y(p)){if(Pt(e))return ns(p.map(g=>{if(g==="width"||g==="height"){const m=t.getName(g),y=t.getSignalName.bind(t);return Zn.fromName(y,m)}return g}))}else if(ce(p))return ns({data:t.requestDataName(Qe.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return ns(p)}case"scheme":return ns(H_e(n[f]))}}const a=e===at||e==="xOffset"?"width":"height",o=r[a];if(ks(o)){if(Pt(e))if(It(s)){const f=XJ(o,t,e);if(f)return ns({step:f})}else Q(NH(a));else if(dh(e)){const f=e===il?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=KJ(o,s);if(p)return ns(p)}}}const{rangeMin:l,rangeMax:u}=n,c=V_e(e,t);return(l!==void 0||u!==void 0)&&l$(s,"rangeMin")&&Y(c)&&c.length===2?ns([l??c[0],u??c[1]]):yr(c)}function H_e(e){return abe(e)?{scheme:e.name,...Xn(e,["name"])}:{scheme:e}}function V_e(e,t){const{size:n,config:r,mark:i,encoding:s}=t,a=t.getSignalName.bind(t),{type:o}=kt(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case at:case Rt:{if(Fe(["point","band"],u)){const p=ZJ(e,n,r.view);if(ks(p))return{step:XJ(p,t,e)}}const d=sr(e),h=t.getName(d);return e===Rt&&Cr(u)?[Zn.fromName(a,h),0]:[0,Zn.fromName(a,h)]}case il:case fh:return J_e(e,t,u);case Oa:{const d=t.component.scales[e].get("zero"),h=QJ(i,d,r),p=K_e(i,n,t,r);return Ud(u)?X_e(h,p,Y_e(u,r,c,e)):[h,p]}case si:return[0,Math.PI*2];case Jc:return[0,360];case ji:return[0,new Zn(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case ol:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case ll:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ir:return"symbol";case rr:case Fs:case Ds:return u==="ordinal"?o==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Ra:case sl:case al:return[r.scale.minOpacity,r.scale.maxOpacity]}}function XJ(e,t,n){const{encoding:r}=t,i=t.getScaleComponent(n),s=I6(n),a=r[s];if(zV({step:e,offsetIsDiscrete:_e(a)&&jH(a.type)})==="offset"&&wV(r,s)){const l=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(l.get("type")==="band"){const d=l.get("paddingInner")??l.get("padding")??0,h=l.get("paddingOuter")??l.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=i.get("paddingInner")??i.get("padding");return{signal:`${e.step} * ${c} / (1-${$ye(f)})`}}else return e.step}function KJ(e,t){if(zV({step:e,offsetIsDiscrete:It(t)})==="offset")return{step:e.step}}function J_e(e,t,n){const r=e===il?"x":"y",s=t.getScaleComponent(r).get("type"),a=t.scaleName(r);if(s==="band"){const o=ZJ(r,t.size,t.config.view);if(ks(o)){const l=KJ(o,n);if(l)return l}return[0,{signal:`bandwidth('${a}')`}]}else{const o=t.encoding[r];return ee(o)&&o.timeUnit?[0,{signal:zH(o.timeUnit,u=>`scale('${a}', ${u})`)}]:XW(`Cannot use ${e} scale if ${r} scale is not discrete.`)}}function ZJ(e,t,n){const r=e===at?"width":"height",i=t[r];return i||Wb(n,r)}function Y_e(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Y(n)?n.length+1:(Q(Nve(r)),3)}}function X_e(e,t,n){const r=()=>{const i=wa(t),s=wa(e),a=`(${i} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${i} + ${a}, ${a})`};return pe(t)?new Zn(r):{signal:r()}}function QJ(e,t,n){if(t)return pe(t)?{signal:`${t.signal} ? 0 : ${QJ(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Ex("size",e))}const XP=.95;function K_e(e,t,n,r){const i={x:YP(n,"x"),y:YP(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const s=KP(t,i,r.view);return Ye(s)?s-1:new Zn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const s=KP(t,i,r.view);return Ye(s)?Math.pow(XP*s,2):new Zn(()=>`pow(${XP} * ${s.signal}, 2)`)}}throw new Error(Ex("size",e))}function KP(e,t,n){const r=ks(e.width)?e.width.step:Gb(n,"width"),i=ks(e.height)?e.height.step:Gb(n,"height");return t.x||t.y?new Zn(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function eY(e,t){pt(e)?Z_e(e,t):nY(e,t)}function Z_e(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:s,specifiedScales:a}=e;for(const o of K(n)){const l=a[o],u=n[o],c=e.getScaleComponent(o),f=kt(i[o]),d=l[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=l$(h,t),y=JH(o,t);if(d!==void 0&&(m?y&&Q(y):Q(TH(h,t,o))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":Kc(l[t])||x==="temporal"||v?u.set(t,{signal:Ox(l[t],{type:x,timeUnit:v})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const v=t in ZP?ZP[t]({model:e,channel:o,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:r,hasNestedOffsetScale:c$(i,o),hasSecondaryRangeChannel:!!i[Os(o)]}):r.scale[t];v!==void 0&&u.set(t,v,!1)}}}const ZP={bins:({model:e,fieldOrDatumDef:t})=>ee(t)?Q_e(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>eEe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:s})=>tEe(e,t,n,r,i,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>nEe(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:s})=>rEe(e,t,n.type,r,i.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:s})=>iEe(e,t,n,r,i.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=ee(e)?e.sort:void 0;return sEe(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i,config:s,hasSecondaryRangeChannel:a})=>aEe(e,t,n,r,i,s.scale,a)};function tY(e){pt(e)?G_e(e):nY(e,"range")}function nY(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?tY(r):eY(r,t);for(const r of K(n)){let i;for(const s of e.children){const a=s.component.scales[r];if(a){const o=a.getWithExplicit(t);i=Vo(i,o,t,"scale",KV((l,u)=>{switch(t){case"range":return l.step&&u.step?l.step-u.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function Q_e(e,t){const n=t.bin;if(tt(n)){const r=LM(e,t.field,n);return new Zn(()=>e.getSignalName(r))}else if(zt(n)&&Xc(n)&&n.step!==void 0)return{step:n.step}}function eEe(e,t){if(Fe([rr,Fs,Ds],e)&&t!=="nominal")return"hcl"}function tEe(e,t,n,r,i,s){var a;if(!((a=Es(s))!=null&&a.bin||Y(n)||i!=null||r!=null||Fe([Kn.TIME,Kn.UTC],e)))return Pt(t)?!0:void 0}function nEe(e,t,n,r,i,s){if(Pt(e)){if($i(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:o}=i;if(a==="bar"&&!(ee(r)&&(r.bin||r.timeUnit))&&(o==="vertical"&&e==="x"||o==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Kn.POINT)return n.pointPadding}}function rEe(e,t,n,r,i,s=!1){if(e===void 0){if(Pt(t)){const{bandPaddingInner:a,barBandPaddingInner:o,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:u}=i;return s?u:yt(a,n==="bar"?o:l)}else if(dh(t)&&r===Kn.BAND)return i.offsetBandPaddingInner}}function iEe(e,t,n,r,i,s=!1){if(e===void 0){if(Pt(t)){const{bandPaddingOuter:a,bandWithNestedOffsetPaddingOuter:o}=i;if(s)return o;if(n===Kn.BAND)return yt(a,pe(r)?{signal:`${r.signal}/2`}:r/2)}else if(dh(t)){if(n===Kn.POINT)return .5;if(n===Kn.BAND)return i.offsetBandPaddingOuter}}}function sEe(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Cr(e)&&t==="descending"?pe(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Cr(e)&&t==="descending")return!0}function aEe(e,t,n,r,i,s,a){if(!!n&&n!=="unaggregated"&&Cr(i)){if(Y(n)){const l=n[0],u=n[n.length-1];if(l<=0&&u>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Ud(i))return!0;if(!(ee(t)&&t.bin)&&Fe([...Rs,...uye],e)){const{orient:l,type:u}=r;return Fe(["bar","area","line","trail"],u)&&(l==="horizontal"&&e==="y"||l==="vertical"&&e==="x")?!1:Fe(["bar","area"],u)&&!a?!0:s==null?void 0:s.zero}return!1}function oEe(e,t,n,r,i=!1){const s=lEe(t,n,r,i),{type:a}=e;return Pa(t)?a!==void 0?hbe(t,a)?ee(n)&&!dbe(a,n.type)?(Q(gve(a,s)),s):a:(Q(pve(t,a,s)),s):s:null}function lEe(e,t,n,r){var i;switch(t.type){case"nominal":case"ordinal":{if(ud(e)||K5(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Q(Z5(e,"ordinal")),"ordinal";if(Pt(e)||dh(e)){if(Fe(["rect","bar","image","rule"],n.type)||r)return"band"}else if(n.type==="arc"&&e in B6)return"band";const s=n[sr(e)];return Tc(s)||qd(t)&&((i=t.axis)!=null&&i.tickBand)?"band":"point"}case"temporal":return ud(e)?"time":K5(e)==="discrete"?(Q(Z5(e,"temporal")),"ordinal"):ee(t)&&t.timeUnit&&Wt(t.timeUnit).utc?"utc":"time";case"quantitative":return ud(e)?ee(t)&&tt(t.bin)?"bin-ordinal":"linear":K5(e)==="discrete"?(Q(Z5(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(CH(t.type))}function uEe(e,{ignoreRange:t}={}){rY(e),VJ(e);for(const n of fbe)eY(e,n);t||tY(e)}function rY(e){pt(e)?e.component.scales=cEe(e):e.component.scales=dEe(e)}function cEe(e){const{encoding:t,mark:n,markDef:r}=e,i={};for(const s of wx){const a=kt(t[s]);if(a&&n===KH&&s===ir&&a.type===hh)continue;let o=a&&a.scale;if(dh(s)){const l=dH(s);if(!c$(t,l)){o&&Q(eve(s));continue}}if(a&&o!==null&&o!==!1){o??(o={});const l=c$(t,s),u=oEe(o,s,a,r,l);i[s]=new YJ(e.scaleName(`${s}`,!0),{value:u,explicit:o.type===u})}}return i}const fEe=KV((e,t)=>lP(e)-lP(t));function dEe(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const s of e.children){rY(s);for(const a of K(s.component.scales))if((t=i.scale)[a]??(t[a]=OJ(a,e)),i.scale[a]==="shared"){const o=r[a],l=s.component.scales[a].getWithExplicit("type");o?tbe(o.value,l.value)?r[a]=Vo(o,l,"type","scale",fEe):(i.scale[a]="independent",delete r[a]):r[a]=l}}for(const s of K(r)){const a=e.scaleName(s,!0),o=r[s];n[s]=new YJ(a,o);for(const l of e.children){const u=l.component.scales[s];u&&(l.renameScale(u.get("name"),a),u.merged=!0)}}return n}class aA{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function pt(e){return(e==null?void 0:e.type)==="unit"}function Fi(e){return(e==null?void 0:e.type)==="facet"}function qM(e){return(e==null?void 0:e.type)==="concat"}function vh(e){return(e==null?void 0:e.type)==="layer"}class GM{constructor(t,n,r,i,s,a,o){this.type=n,this.parent=r,this.config=s,this.correctDataNames=l=>{var u,c,f;return(u=l.from)!=null&&u.data&&(l.from.data=this.lookupDataSource(l.from.data)),(f=(c=l.from)==null?void 0:c.facet)!=null&&f.data&&(l.from.facet.data=this.lookupDataSource(l.from.facet.data)),l},this.parent=r,this.config=s,this.view=Wn(o),this.name=t.name??i,this.title=mo(t.title)?{text:t.title}:t.title?Wn(t.title):void 0,this.scaleNameMap=r?r.scaleNameMap:new aA,this.projectionNameMap=r?r.projectionNameMap:new aA,this.signalNameMap=r?r.signalNameMap:new aA,this.data=t.data,this.description=t.description,this.transforms=bxe(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:C2e(t,n,s),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:Tx(t)||(r==null?void 0:r.component.data.isFaceted)&&t.data===void 0},layoutSize:new La,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...a?Ee(a):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){uEe(this)}parseProjection(){GJ(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){zJ(this)}assembleEncodeFromView(t){const{style:n,...r}=t,i={};for(const s of K(r)){const a=r[s];a!==void 0&&(i[s]=rt(a))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=rt(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n??{}}:Je(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:r,config:i}=this,s=Dwe(r.layoutHeaders,i);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Yr)t[r].title&&n.push($we(this,r));for(const r of OM)n=n.concat(Cwe(this,r));return n}assembleAxes(){return pwe(this.component.axes,this.config)}assembleLegends(){return UJ(this)}assembleProjections(){return n_e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},r={...bH(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(r.text)return Fe(["unit","layer"],this.type)?Fe(["middle",void 0],r.anchor)&&(r.frame??(r.frame="group")):r.anchor??(r.anchor="start"),Je(r)?void 0:r}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Fi(this.parent)?JJ(this):[];i.length>0&&(n.scales=i);const s=this.assembleAxes();s.length>0&&(n.axes=s);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return st((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Qe[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(r[n]||0)+1,n}getSizeSignalRef(t){if(Fi(this.parent)){const n=FJ(t),r=xx(n),i=this.component.scales[r];if(i&&!i.merged){const s=i.get("type"),a=i.get("range");if(It(s)&&cl(a)){const o=i.get("name"),l=Gx(this,r),u=jM(l);if(u){const c=se({aggregate:"distinct",field:u},{expr:"datum"});return{signal:NJ(o,i,c)}}else return Q(q6(r)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(uH(t)&&Pa(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(Fye(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)==null?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)==null?void 0:n.some(r=>r.hasOrientSignalRef()))}}class iY extends GM{vgField(t,n={}){const r=this.fieldDef(t);if(r)return se(r,n)}reduceFieldDef(t,n){return r2e(this.getMapping(),(r,i,s)=>{const a=Es(i);return a?t(r,a,s):r},n)}forEachFieldDef(t,n){mM(this.getMapping(),(r,i)=>{const s=Es(r);s&&t(s,i)},n)}}class Wx extends Ke{clone(){return new Wx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"value",r[1]??"density"],n.groupby&&n.minsteps==null&&n.maxsteps==null&&n.steps==null&&(this.transform.steps=200)}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Re(this.transform)}`}assemble(){const{density:t,...n}=this.transform;return{type:"kde",field:t,...n}}}class I0 extends Ke{clone(){return new I0(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n){const{config:r,mark:i,markDef:s}=n;if(He("invalid",s,r)!=="filter")return null;const o=n.reduceFieldDef((l,u,c)=>{const f=Pa(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Cr(d)&&u.aggregate!=="count"&&!fl(i)&&(l[u.field]=u)}return l},{});return K(o).length?new I0(t,o):null}dependentFields(){return new Set(K(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Re(this.filter)}`}assemble(){const t=K(this.filter).reduce((n,r)=>{const i=this.filter[r],s=se(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):i.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Hx extends Ke{clone(){return new Hx(this.parent,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((s,a)=>i[a]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Re(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Vx extends Ke{clone(){return new Vx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Re(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class dd extends Ke{clone(){return new dd(null,Ee(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Gi,qi],[ri,Wi]]){const s=i.map(a=>{const o=kt(n.encoding[a]);return ee(o)?o.field:Ps(o)?{expr:`${o.datum}`}:Pi(o)?{expr:`${o.value}`}:void 0});(s[0]||s[1])&&(t=new dd(t,s,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(ir)){const i=n.typedFieldDef(ir);i.type===hh&&(t=new dd(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}dependentFields(){const t=(this.fields??[]).filter(oe);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Re(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class L0 extends Ke{clone(){return new L0(null,this.projection,Ee(this.fields),Ee(this.as))}constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Gi,qi],[ri,Wi]]){const i=r.map(a=>{const o=kt(n.encoding[a]);return ee(o)?o.field:Ps(o)?{expr:`${o.datum}`}:Pi(o)?{expr:`${o.value}`}:void 0}),s=r[0]===ri?"2":"";(i[0]||i[1])&&(t=new L0(t,n.projectionName(),i,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(oe))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Re(this.fields)} ${Re(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class dc extends Ke{clone(){return new dc(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new dc(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,s=r.y;if(ee(i)&&ee(s)){const a=i.impute?i:s.impute?s:void 0;if(a===void 0)return;const o=i.impute?s:s.impute?i:void 0,{method:l,value:u,frame:c,keyvals:f}=a.impute,d=EV(n.mark,r);return new dc(t,{impute:a.field,key:o.field,...l?{method:l}:{},...u!==void 0?{value:u}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${Re(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:s,value:a,frame:o=[null,null]}=this.transform,l={type:"impute",field:t,key:n,...r?{keyvals:txe(r)?this.processSequence(r):r}:{},method:"value",...s?{groupby:s}:{},value:!i||i==="value"?a:null};if(i&&i!=="value"){const u={type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:o,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[l,u,c]}else return[l]}}class Jx extends Ke{clone(){return new Jx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Re(this.transform)}`}assemble(){const{loess:t,on:n,...r}=this.transform;return{type:"loess",x:n,y:t,...r}}}class z0 extends Ke{clone(){return new z0(null,Ee(this.transform),this.secondary)}constructor(t,n,r){super(t),this.transform=n,this.secondary=r}static make(t,n,r,i){const s=n.component.data.sources,{from:a}=r;let o=null;if(nxe(a)){let l=oY(a.data,s);l||(l=new Oc(a.data),s.push(l));const u=n.getName(`lookup_${i}`);o=new Fn(l,u,Qe.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=o}else if(rxe(a)){const l=a.param;r={as:l,...r};let u;try{u=n.getSelectionComponent(st(l),l)}catch{throw new Error(Rye(l))}if(o=u.materialized,!o)throw new Error(Pye(l))}return new z0(t,r,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?le(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Re({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:le(this.transform.as)}:{}};else{let n=this.transform.as;oe(n)||(Q(Gye),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class Yx extends Ke{clone(){return new Yx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Re(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class Xx extends Ke{clone(){return new Xx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ee(n);const r=this.transform.as??[void 0,void 0];this.transform.as=[r[0]??n.on,r[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Re(this.transform)}`}assemble(){const{regression:t,on:n,...r}=this.transform;return{type:"regression",x:n,y:t,...r}}}class Kx extends Ke{clone(){return new Kx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=ls((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${Re(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:s}=this.transform;return{type:"pivot",field:t,value:n,...i!==void 0?{limit:i}:{},...s!==void 0?{op:s}:{},...r!==void 0?{groupby:r}:{}}}}class Zx extends Ke{clone(){return new Zx(null,Ee(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Re(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function sY(e){let t=0;function n(r,i){if(r instanceof Oc&&!r.isGenerator&&!Wd(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof rn&&(r.parent instanceof Oc&&!i.source?(i.format={...i.format??{},parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof mh){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,e.push(...r.assemble());return}switch((r instanceof Dm||r instanceof Om||r instanceof I0||r instanceof gh||r instanceof Hd||r instanceof L0||r instanceof Ni||r instanceof z0||r instanceof yh||r instanceof ef||r instanceof Vx||r instanceof Hx||r instanceof Wx||r instanceof Jx||r instanceof Yx||r instanceof Xx||r instanceof Xo||r instanceof Zx||r instanceof Kx)&&i.transform.push(r.assemble()),(r instanceof gs||r instanceof ps||r instanceof dc||r instanceof Ea||r instanceof dd)&&i.transform.push(...r.assemble()),r instanceof Fn&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof Fn?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Fn&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let s=i.name;!i.source||i.transform.length>0?e.push(i):s=i.source;for(const a of r.children)n(a,{name:null,source:s,transform:[]});break}}}return n}function hEe(e){const t=[],n=sY(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function pEe(e,t){const n=[],r=sY(n);let i=0;for(const a of e.sources){a.hasName()||(a.dataName=`source_${i++}`);const o=a.assemble();r(a,o)}for(const a of n)a.transform.length===0&&delete a.transform;let s=0;for(const[a,o]of n.entries())(o.transform??[]).length===0&&!o.source&&n.splice(s++,0,n.splice(a,1)[0]);for(const a of n)for(const o of a.transform??[])o.type==="lookup"&&(o.from=e.outputNodes[o.from].getSource());for(const a of n)a.name in t&&(a.values=t[a.name]);return n}function gEe(e){return e==="top"||e==="left"||pe(e)?"header":"footer"}function mEe(e){for(const t of Yr)yEe(e,t);QP(e,"x"),QP(e,"y")}function yEe(e,t){var a;const{facet:n,config:r,child:i,component:s}=e;if(e.channelHasField(t)){const o=n[t],l=Jd("title",null,r,t);let u=cd(o,r,{allowDisabling:!0,includeDefault:l===void 0||!!l});i.component.layoutHeaders[t].title&&(u=Y(u)?u.join(", "):u,u+=` / ${i.component.layoutHeaders[t].title}`,i.component.layoutHeaders[t].title=null);const c=Jd("labelOrient",o.header,r,t),f=o.header!==null?yt((a=o.header)==null?void 0:a.labels,r.header.labels,!0):!1,d=Fe(["bottom","right"],c)?"footer":"header";s.layoutHeaders[t]={title:o.header!==null?u:null,facetFieldDef:o,[d]:t==="facet"?[]:[aY(e,t,f)]}}}function aY(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function QP(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:r,resolve:i}=e.component;if(i.axis[t]=IM(i,t),i.axis[t]==="shared"){const s=t==="x"?"column":"row",a=r[s];for(const o of n.component.axes[t]){const l=gEe(o.get("orient"));a[l]??(a[l]=[aY(e,s,!1)]);const u=Wg(o,"main",e.config,{header:!0});u&&a[l][0].axes.push(u),o.mainExtracted=!0}}}}function vEe(e){WM(e),Yb(e,"width"),Yb(e,"height")}function bEe(e){WM(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";Yb(e,t),Yb(e,n)}function WM(e){for(const t of e.children)t.parseLayoutSize()}function Yb(e,t){const n=FJ(t),r=xx(n),i=e.component.resolve,s=e.component.layoutSize;let a;for(const o of e.children){const l=o.component.layoutSize.getWithExplicit(n),u=i.scale[r]??OJ(r,e);if(u==="independent"&&l.value==="step"){a=void 0;break}if(a){if(u==="independent"&&a.value!==l.value){a=void 0;break}a=Vo(a,l,n,"")}else a=l}if(a){for(const o of e.children)e.renameSignal(o.getName(n),e.getName(t)),o.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,a)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function xEe(e){const{size:t,component:n}=e;for(const r of Rs){const i=sr(r);if(t[i]){const s=t[i];n.layoutSize.set(i,ks(s)?"step":s,!0)}else{const s=wEe(e,i);n.layoutSize.set(i,s,!1)}}}function wEe(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const s=i.get("type"),a=i.get("range");if(It(s)){const o=Wb(r.view,t);return cl(a)||ks(o)?"step":o}else return d$(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return d$(r.view,t);{const s=Wb(r.view,t);return ks(s)?s.step:s}}}function A$(e,t,n){return se(t,{suffix:`by_${se(e)}`,...n??{}})}class o0 extends iY{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=XM(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Cm(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=K(t),r={};for(const i of n){if(![ba,xa].includes(i)){Q(Ex(i,"facet"));break}const s=t[i];if(s.field===void 0){Q(a$(s,i));break}r[i]=this.initFacetFieldDef(s,i)}return r}initFacetFieldDef(t,n){const r=pM(t,n);return r.header?r.header=Wn(r.header):r.header===null&&(r.header=null),r}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Qx(this),this.child.parseData()}parseLayoutSize(){WM(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),mEe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Yr)for(const r of RM){const i=this.component.layoutHeaders[n],s=i[r],{facetFieldDef:a}=i;if(a){const o=Jd("titleOrient",a.header,this.config,n);if(["right","bottom"].includes(o)){const l=jx(n,o);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[l]="end"}}if(s!=null&&s[0]){const o=n==="row"?"height":"width",l=r==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(o)&&(t[l]??(t[l]={}),t[l][n]=.5),i.title&&(t.offset??(t.offset={}),t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:i}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof o0))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof o0?{...this.channelHasField("column")?{encode:{update:{columns:{field:se(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof o0){if(this.child.channelHasField("column")){const i=se(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Rs){const s=this.child.component.scales[i];if(s&&!s.merged){const a=s.get("type"),o=s.get("range");if(It(a)&&cl(o)){const l=Gx(this.child,i),u=jM(l);u?(t.push(u),n.push("distinct"),r.push(`distinct_${u}`)):Q(q6(i))}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:s,ops:a,as:o}=this.getCardinalityAggregateForChild(),l=[];for(const c of Yr){const f=this.facet[c];if(f){l.push(se(f));const{bin:d,sort:h}=f;if(tt(d)&&l.push(se(f,{binSuffix:"end"})),hs(h)){const{field:p,op:g=Mx}=h,m=A$(f,h);r&&i?(s.push(m),a.push("max"),o.push(m)):(s.push(p),a.push(g),o.push(m))}else if(Y(h)){const p=Vd(f,c);s.push(p),a.push("max"),o.push(p)}}}const u=!!r&&!!i;return{name:t,data:n,groupby:l,...u||s.length>0?{aggregate:{...u?{cross:u}:{},...s.length?{fields:s,ops:a,as:o}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,r=n[t];return r?hs(r.sort)?[A$(r,r.sort,{expr:"datum"})]:Y(r.sort)?[Vd(r,t,{expr:"datum"})]:[se(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(hs(i)?i.order:!Y(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){var i;const{facet:t,config:n}=this;if(t.facet)return x$(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const s of OM)if(t[s]){const a=Jd("labelOrient",(i=t[s])==null?void 0:i.header,n,s);if(r[s].includes(a))return x$(t[s],s,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=hEe(n),i=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...a?{style:a}:{},from:{facet:this.assembleFacet()},sort:{field:Yr.map(l=>this.facetSortFields(l)).flat(),order:Yr.map(l=>this.facetSortOrder(l)).flat()},...r.length>0?{data:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup(Fxe(this,[]))}]}getMapping(){return this.facet}}function _Ee(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const s of[n,r])if(hs(s.sort)){const{field:a,op:o=Mx}=s.sort;e=i=new ef(e,{joinaggregate:[{op:o,field:a,as:A$(s,s.sort,{forAs:!0})}],groupby:[se(s)]})}return i}return null}function oY(e,t){var n,r,i,s;for(const a of t){const o=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const l=(n=e.format)==null?void 0:n.mesh,u=(r=o.format)==null?void 0:r.feature;if(l&&u)continue;const c=(i=e.format)==null?void 0:i.feature;if((c||u)&&c!==u)continue;const f=(s=o.format)==null?void 0:s.mesh;if(!((l||f)&&l!==f)){if(R0(e)&&R0(o)){if(os(e.values,o.values))return a}else if(Wd(e)&&Wd(o)){if(e.url===o.url)return a}else if(ZV(e)&&e.name===a.dataName)return a}}return null}function EEe(e,t){if(e.data||!e.parent){if(e.data===null){const r=new Oc({values:[]});return t.push(r),r}const n=oY(e.data,t);if(n)return Do(e.data)||(n.data.format=KW({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new Oc(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function kEe(e,t,n){let r=0;for(const i of t.transforms){let s,a;if(hxe(i))a=e=new Hd(e,i),s="derived";else if($M(i)){const o=g_e(i);a=e=rn.makeWithAncestors(e,{},o,n)??e,e=new gh(e,t,i.filter)}else if(VV(i))a=e=gs.makeFromTransform(e,i,t),s="number";else if(gxe(i))s="date",n.getWithExplicit(i.field).value===void 0&&(e=new rn(e,{[i.field]:s}),n.set(i.field,s,!1)),a=e=ps.makeFromTransform(e,i);else if(mxe(i))a=e=Ni.makeFromTransform(e,i),s="number",DM(t)&&(e=new Xo(e));else if(HV(i))a=e=z0.make(e,t,i,r++),s="derived";else if(cxe(i))a=e=new yh(e,i),s="number";else if(fxe(i))a=e=new ef(e,i),s="number";else if(yxe(i))a=e=Ea.makeFromTransform(e,i),s="derived";else if(vxe(i))a=e=new Vx(e,i),s="derived";else if(dxe(i))a=e=new Hx(e,i),s="derived";else if(ixe(i))a=e=new Kx(e,i),s="derived";else if(uxe(i))e=new Zx(e,i);else if(pxe(i))a=e=dc.makeFromTransform(e,i),s="derived";else if(sxe(i))a=e=new Wx(e,i),s="derived";else if(axe(i))a=e=new Yx(e,i),s="derived";else if(oxe(i))a=e=new Xx(e,i),s="derived";else if(lxe(i))a=e=new Jx(e,i),s="derived";else{Q(qye(i));continue}if(a&&s!==void 0)for(const o of a.producedFields()??[])n.set(o,s,!1)}return e}function Qx(e){var g;let t=EEe(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=e.component.data,i=e.data,a=!(i&&(Do(i)||Wd(i)||R0(i)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Txe;Do(i)?(QV(i)?t=new Om(t,i.sequence):CM(i)&&(t=new Dm(t,i.graticule)),a.parseNothing=!0):((g=i==null?void 0:i.format)==null?void 0:g.parse)===null&&(a.parseNothing=!0),t=rn.makeExplicit(t,e,a)??t,t=new Xo(t);const o=e.parent&&vh(e.parent);(pt(e)||Fi(e))&&o&&(t=gs.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=kEe(t,e,a));const l=y_e(e),u=m_e(e);t=rn.makeWithAncestors(t,{},{...l,...u},a)??t,pt(e)&&(t=dd.parseAll(t,e),t=L0.parseAll(t,e)),(pt(e)||Fi(e))&&(o||(t=gs.makeFromEncoding(t,e)??t),t=ps.makeFromEncoding(t,e)??t,t=Hd.parseAllForSortIndex(t,e));const c=e.getDataName(Qe.Raw),f=new Fn(t,c,Qe.Raw,r);if(n[c]=f,t=f,pt(e)){const m=Ni.makeFromEncoding(t,e);m&&(t=m,DM(e)&&(t=new Xo(t))),t=dc.makeFromEncoding(t,e)??t,t=Ea.makeFromEncoding(t,e)??t}pt(e)&&(t=I0.make(t,e)??t);const d=e.getDataName(Qe.Main),h=new Fn(t,d,Qe.Main,r);n[d]=h,t=h,pt(e)&&dwe(e,h);let p=null;if(Fi(e)){const m=e.getName("facet");t=_Ee(t,e.facet)??t,p=new mh(t,e,m,h.getSource()),n[m]=p}return{...e.component.data,outputNodes:n,outputNodeRefCounts:r,raw:f,main:h,facetRoot:p,ancestorParse:a}}class SEe extends GM{constructor(t,n,r,i){var s,a,o,l;super(t,"concat",n,r,i,t.resolve),(((a=(s=t.resolve)==null?void 0:s.axis)==null?void 0:a.x)==="shared"||((l=(o=t.resolve)==null?void 0:o.axis)==null?void 0:l.y)==="shared")&&Q(Bye),this.children=this.getChildren(t).map((u,c)=>XM(u,this,this.getName(`concat_${c}`),void 0,i))}parseData(){this.component.data=Qx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of K(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Ix(t)?t.vconcat:SM(t)?t.hconcat:t.concat}parseLayoutSize(){bEe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=PM(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...r?{style:r}:{},...i?{encode:{update:i}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function AEe(e){return e===!1||e===null}const $Ee={disable:1,gridScale:1,scale:1,...bV,labelExpr:1,encode:1},lY=K($Ee);class HM extends La{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new HM(Ee(this.explicit),Ee(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!AEe(this.get(t))}hasOrientSignalRef(){return pe(this.explicit.orient)}}function CEe(e,t,n){const{encoding:r,config:i}=e,s=kt(r[t])??kt(r[Os(t)]),a=e.axis(t)||{},{format:o,formatType:l}=a;if(Nc(l))return{text:Ci({fieldOrDatumDef:s,field:"datum.value",format:o,formatType:l,config:i}),...n};if(o===void 0&&l===void 0&&i.customFormatTypes){if(jd(s)==="quantitative"){if(qd(s)&&s.stack==="normalize"&&i.normalizedNumberFormatType)return{text:Ci({fieldOrDatumDef:s,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:Ci({fieldOrDatumDef:s,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if(jd(s)==="temporal"&&i.timeFormatType&&ee(s)&&!s.timeUnit)return{text:Ci({fieldOrDatumDef:s,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}function MEe(e){return Rs.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[PEe(n,e)]),t),{})}const TEe={bottom:"top",top:"bottom",left:"right",right:"left"};function NEe(e){const{axes:t,resolve:n}=e.component,r={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const s of K(i.component.axes))n.axis[s]=IM(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=FEe(t[s],i.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const i of Rs){for(const s of e.children)if(s.component.axes[i]){if(n.axis[i]==="independent"){t[i]=(t[i]??[]).concat(s.component.axes[i]);for(const a of s.component.axes[i]){const{value:o,explicit:l}=a.getWithExplicit("orient");if(!pe(o)){if(r[o]>0&&!l){const u=TEe[o];r[o]>r[u]&&a.set("orient",u,!1)}r[o]++}}}delete s.component.axes[i]}if(n.axis[i]==="independent"&&t[i]&&t[i].length>1)for(const s of t[i])s.get("grid")&&!s.explicit.grid&&(s.implicit.grid=!1)}}function FEe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=t[r];if(!!i!=!!s)return;if(i&&s){const a=i.getWithExplicit("orient"),o=s.getWithExplicit("orient");if(a.explicit&&o.explicit&&a.value!==o.value)return;e[r]=DEe(i,s)}}}else return t.map(n=>n.clone());return e}function DEe(e,t){for(const n of lY){const r=Vo(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,s)=>{switch(n){case"title":return AH(i,s);case"gridScale":return{explicit:i.explicit,value:yt(i.value,s.value)}}return zx(i,s,n,"axis")});e.setWithExplicit(n,r)}return e}function OEe(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(pe(n.labelAngle)?n.labelAngle:O0(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===$J(r,i))return!0}return e===n[t]}const REe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function PEe(e,t){var y,v;let n=t.axis(e);const r=new HM,i=kt(t.encoding[e]),{mark:s,config:a}=t,o=(n==null?void 0:n.orient)||((y=a[e==="x"?"axisX":"axisY"])==null?void 0:y.orient)||((v=a.axis)==null?void 0:v.orient)||_we(e),l=t.getScaleComponent(e).get("type"),u=gwe(e,l,o,t.config),c=n!==void 0?!n:v$("disable",a.style,n==null?void 0:n.style,u).configValue;if(r.set("disable",c,n!==void 0),c)return r;n=n||{};const f=bwe(i,n,e,a.style,u),d=iV(n.formatType,i,l),h=rV(i,i.type,n.format,n.formatType,a,!0),p={fieldOrDatumDef:i,axis:n,channel:e,model:t,scaleType:l,orient:o,labelAngle:f,format:h,formatType:d,mark:s,config:a};for(const x of lY){const _=x in LP?LP[x](p):gP(x)?n[x]:void 0,w=_!==void 0,k=OEe(_,x,n,t,e);if(w&&k)r.set(x,_,k);else{const{configValue:E=void 0,configFrom:A=void 0}=gP(x)&&x!=="values"?v$(x,a.style,n.style,u):{},z=E!==void 0;w&&!z?r.set(x,_,k):(A!=="vgAxisConfig"||REe.has(x)&&z||Nm(E)||pe(E))&&r.set(x,E,!1)}}const g=n.encoding??{},m=vV.reduce((x,_)=>{if(!r.hasAxisPart(_))return x;const w=DJ(g[_]??{},t),k=_==="labels"?CEe(t,e,w):w;return k!==void 0&&!Je(k)&&(x[_]={update:k}),x},{});return Je(m)||r.set("encode",m,!!n.encoding||n.labelAngle!==void 0),r}function IEe({encoding:e,size:t}){for(const n of Rs){const r=sr(n);ks(t[r])&&$o(e[n])&&(delete t[r],Q(NH(r)))}return t}function LEe(e,t,n){const r=Wn(e),i=He("orient",r,n);if(r.orient=jEe(r.type,t,i),i!==void 0&&i!==r.orient&&Q(ove(r.orient,i)),r.type==="bar"&&r.orient){const o=He("cornerRadiusEnd",r,n);if(o!==void 0){const l=r.orient==="horizontal"&&t.x2||r.orient==="vertical"&&t.y2?["cornerRadius"]:Sbe[r.orient];for(const u of l)r[u]=o;r.cornerRadiusEnd!==void 0&&delete r.cornerRadiusEnd}}return He("opacity",r,n)===void 0&&(r.opacity=BEe(r.type,t)),He("cursor",r,n)===void 0&&(r.cursor=zEe(r,t,n)),r}function zEe(e,t,n){return t.href||e.href||He("href",e,n)?"pointer":e.cursor}function BEe(e,t){if(Fe([Cx,rM,iM,sM],e)&&!gM(t))return .7}function UEe(e,t,{graticule:n}){if(n)return!1;const r=$c("filled",e,t),i=e.type;return yt(r,i!==Cx&&i!==$x&&i!==Ib)}function jEe(e,t,n){switch(e){case Cx:case iM:case sM:case XH:case gbe:case pbe:return}const{x:r,y:i,x2:s,y2:a}=t;switch(e){case Ax:if(ee(r)&&(zt(r.bin)||ee(i)&&i.aggregate&&!r.aggregate))return"vertical";if(ee(i)&&(zt(i.bin)||ee(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||s){if(n)return n;if(!s)return(ee(r)&&r.type===Mc&&!tt(r.bin)||zb(r))&&ee(i)&&zt(i.bin)?"horizontal":"vertical";if(!a)return(ee(i)&&i.type===Mc&&!tt(i.bin)||zb(i))&&ee(r)&&zt(r.bin)?"vertical":"horizontal"}case Ib:if(s&&!(ee(r)&&zt(r.bin))&&a&&!(ee(i)&&zt(i.bin)))return;case Sx:if(a)return ee(i)&&zt(i.bin)?"horizontal":"vertical";if(s)return ee(r)&&zt(r.bin)?"vertical":"horizontal";if(e===Ib){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case $x:case rM:{const o=hP(r),l=hP(i);if(n)return n;if(o&&!l)return e!=="tick"?"horizontal":"vertical";if(!o&&l)return e!=="tick"?"vertical":"horizontal";if(o&&l)return"vertical";{const u=Rn(r)&&r.type===Bd,c=Rn(i)&&i.type===Bd;if(u&&!c)return"vertical";if(!u&&c)return"horizontal"}return}}return"vertical"}const qEe={vgMark:"arc",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...nn("x",e,{defaultPos:"mid"}),...nn("y",e,{defaultPos:"mid"}),...Jo(e,"radius"),...Jo(e,"theta")})},GEe={vgMark:"area",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Hb("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Hb("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...FM(e)})},WEe={vgMark:"rect",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Jo(e,"x"),...Jo(e,"y")})},HEe={vgMark:"shape",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&ee(n)&&n.type===hh?{field:se(n,{expr:"datum"})}:{}}]}},VEe={vgMark:"image",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Jo(e,"x"),...Jo(e,"y"),...TM(e,"url")})},JEe={vgMark:"line",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...nn("x",e,{defaultPos:"mid"}),...nn("y",e,{defaultPos:"mid"}),...Mt("size",e,{vgChannel:"strokeWidth"}),...FM(e)})},YEe={vgMark:"trail",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...nn("x",e,{defaultPos:"mid"}),...nn("y",e,{defaultPos:"mid"}),...Mt("size",e),...FM(e)})};function VM(e,t){const{config:n}=e;return{...ai(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...nn("x",e,{defaultPos:"mid"}),...nn("y",e,{defaultPos:"mid"}),...Mt("size",e),...Mt("angle",e),...XEe(e,n,t)}}function XEe(e,t,n){return n?{shape:{value:n}}:Mt("shape",e)}const KEe={vgMark:"symbol",encodeEntry:e=>VM(e)},ZEe={vgMark:"symbol",encodeEntry:e=>VM(e,"circle")},QEe={vgMark:"symbol",encodeEntry:e=>VM(e,"square")},eke={vgMark:"rect",encodeEntry:e=>({...ai(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Jo(e,"x"),...Jo(e,"y")})},tke={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...ai(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Hb("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Hb("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Mt("size",e,{vgChannel:"strokeWidth"})}}},nke={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...ai(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...nn("x",e,{defaultPos:"mid"}),...nn("y",e,{defaultPos:"mid"}),...TM(e),...Mt("size",e,{vgChannel:"fontSize"}),...Mt("angle",e),...OP("align",rke(e.markDef,n,t)),...OP("baseline",ike(e.markDef,n,t)),...nn("radius",e,{defaultPos:null}),...nn("theta",e,{defaultPos:null})}}};function rke(e,t,n){if(He("align",e,n)===void 0)return"center"}function ike(e,t,n){if(He("baseline",e,n)===void 0)return"middle"}const ske={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",s=r==="horizontal"?"height":"width";return{...ai(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...nn("x",e,{defaultPos:"mid",vgChannel:"xc"}),...nn("y",e,{defaultPos:"mid",vgChannel:"yc"}),...Mt("size",e,{defaultValue:ake(e),vgChannel:i}),[s]:rt(He("thickness",n,t))}}};function ake(e){const{config:t,markDef:n}=e,{orient:r}=n,i=r==="horizontal"?"width":"height",s=e.getScaleComponent(r==="horizontal"?"x":"y"),a=He("size",n,t,{vgChannel:i})??t.tick.bandSize;if(a!==void 0)return a;{const o=s?s.get("range"):void 0;return o&&cl(o)&&Ye(o.step)?o.step*3/4:Gb(t.view,i)*3/4}}const Iy={arc:qEe,area:GEe,bar:WEe,circle:ZEe,geoshape:HEe,image:VEe,line:JEe,point:KEe,rect:eke,rule:tke,square:QEe,text:nke,tick:ske,trail:YEe};function oke(e){if(Fe([$x,Sx,mbe],e.mark)){const t=EV(e.mark,e.encoding);if(t.length>0)return lke(e,t)}else if(e.mark===Ax){const t=s$.some(n=>He(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return uke(e)}return JM(e)}const eI="faceted_path_";function lke(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:eI+e.requestDataName(Qe.Main),data:e.requestDataName(Qe.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:JM(e,{fromPrefix:eI})}]}const tI="stack_group_";function uke(e){var u;const[t]=JM(e,{fromPrefix:tI}),n=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),i=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${n}',${h})`).join(",")})`};let s,a;e.stack.fieldChannel==="x"?(s={...Id(t.encode.update,["y","yc","y2","height",...s$]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...Xn(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...Id(t.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...Xn(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const c of s$){const f=$c(c,e.markDef,e.config);t.encode.update[c]?(s[c]=t.encode.update[c],delete t.encode.update[c]):f&&(s[c]=rt(f)),f&&(t.encode.update[c]={value:0})}const o=[];if(((u=e.stack.groupbyChannels)==null?void 0:u.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=se(f);d&&o.push(d),(f!=null&&f.bin||f!=null&&f.timeUnit)&&o.push(se(f,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(t.encode.update[f])return{...c,[f]:t.encode.update[f]};{const d=$c(f,e.markDef,e.config);return d!==void 0?{...c,[f]:rt(d)}:c}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Qe.Main),name:tI+e.requestDataName(Qe.Main),groupby:o,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}function cke(e){var o;const{encoding:t,stack:n,mark:r,markDef:i,config:s}=e,a=t.order;if(!(!Y(a)&&Pi(a)&&r$(a.value)||!a&&r$(He("order",i,s)))){if((Y(a)||ee(a))&&!n)return EH(a,{expr:"datum"});if(fl(r)){const l=i.orient==="horizontal"?"y":"x",u=t[l];if(ee(u)){const c=u.sort;if(Y(c))return{field:se(u,{prefix:l,suffix:"sort_index",expr:"datum"})};if(hs(c))return{field:se({aggregate:gM(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(aV(c)){const f=e.fieldDef(c.encoding);return{field:se(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:se(u,{binSuffix:(o=e.stack)!=null&&o.impute?"mid":void 0,expr:"datum"})}}return}}}function JM(e,t={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:s}=e,a=yt(r.clip,fke(e),dke(e)),o=wH(r),l=i.key,u=cke(e),c=hke(e),f=He("aria",r,s),d=Iy[n].postEncodingTransform?Iy[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Iy[n].vgMark,...a?{clip:!0}:{},...o?{style:o}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(Qe.Main)},encode:{update:Iy[n].encodeEntry(e)},...d?{transform:d}:{}}]}function fke(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t!=null&&t.get("selectionExtent")||n!=null&&n.get("selectionExtent")?!0:void 0}function dke(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function hke(e){if(!e.component.selection)return null;const t=K(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=K(r.component.selection).length,r=r.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip}:null}class uY extends iY{constructor(t,n,r,i={},s){super(t,"unit",n,r,s,void 0,yP(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=_s(t.mark)?{...t.mark}:{type:t.mark},o=a.type;a.filled===void 0&&(a.filled=UEe(a,s,{graticule:t.data&&CM(t.data)}));const l=this.encoding=t2e(t.encoding||{},o,a.filled,s);this.markDef=LEe(a,l,s),this.size=IEe({encoding:l,size:yP(t)?{...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:i}),this.stack=qV(this.markDef,l),this.specifiedScales=this.initScales(o,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(u=>EM(u))}get hasProjection(){const{encoding:t}=this,n=this.mark===KH,r=t&&tye.some(i=>_e(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return wx.reduce((r,i)=>{const s=kt(n[i]);return s&&(r[i]=this.initScale(s.scale??{})),r},{})}initScale(t){const{domain:n,range:r}=t,i=Wn(t);return Y(n)&&(i.domain=n.map(xr)),Y(r)&&(i.range=r.map(xr)),i}initAxes(t){return Rs.reduce((n,r)=>{const i=t[r];if(_e(i)||r===at&&_e(t.x2)||r===Rt&&_e(t.y2)){const s=_e(i)?i.axis:void 0;n[r]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=K(t),r={};for(const i of n){const s=t[i];r[i]=Nm(s)?xH(s):xr(s)}return r}initLegends(t){return cye.reduce((n,r)=>{const i=kt(t[r]);if(i&&dye(r)){const s=i.legend;n[r]=s&&Wn(s)}return n},{})}parseData(){this.component.data=Qx(this)}parseLayoutSize(){xEe(this)}parseSelections(){this.component.selection=fwe(this,this.selection)}parseMarkGroup(){this.component.mark=oke(this)}parseAxesAndHeaders(){this.component.axes=MEe(this)}assembleSelectionTopLevelSignals(t){return Dxe(this,t)}assembleSignals(){return[...kJ(this),...Nxe(this,[])]}assembleSelectionData(t){return Oxe(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return PM(this)}assembleMarks(){let t=this.component.mark??[];return(!this.parent||!vh(this.parent))&&(t=nJ(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return cc(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Es(n)}typedFieldDef(t){const n=this.fieldDef(t);return Rn(n)?n:null}}class YM extends GM{constructor(t,n,r,i,s){super(t,"layer",n,r,s,t.resolve,t.view);const a={...i,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((o,l)=>{if(Lx(o))return new YM(o,this,this.getName(`layer_${l}`),a,s);if(Ia(o))return new uY(o,this,this.getName(`layer_${l}`),a,s);throw new Error(j6(o))})}parseData(){this.component.data=Qx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){vEe(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of K(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){NEe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),kJ(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),PM(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const r of this.children)for(const i of le(r.assembleGroupStyle()))t.add(i);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Rxe(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),UJ(this))}}function XM(e,t,n,r,i){if(Tx(e))return new o0(e,t,n,i);if(Lx(e))return new YM(e,t,n,r,i);if(Ia(e))return new uY(e,t,n,r,i);if(S2e(e))return new SEe(e,t,n,i);throw new Error(j6(e))}function pke(e,t={}){t.logger&&Fve(t.logger),t.fieldTitle&&gV(t.fieldTitle);try{const n=jV(Xd(t.config,e.config)),r=XV(e,n),i=XM(r,null,"",void 0,n);return i.parse(),D_e(i.component.data,i),{spec:mke(i,gke(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&Dve(),t.fieldTitle&&Hbe()}}function gke(e,t,n,r){const i=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):oe(t)&&(t={type:t}),i&&s&&$xe(t.type)){if(i==="step"&&s==="step")Q(tP()),t.type="pad";else if(i==="step"||s==="step"){const a=i==="step"?"width":"height";Q(tP(xx(a)));const o=a==="width"?"height":"width";t.type=Cxe(o)}}return{...K(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...MP(n,!1),...MP(e,!0)}}function mke(e,t,n={},r){const i=e.config?z2e(e.config):void 0,s=[].concat(e.assembleSelectionData([]),pEe(e.component.data,n)),a=e.assembleProjections(),o=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...o?{title:o}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:s,...a.length>0?{projections:a}:{},...e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...LV(f)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}const yke=W1e.version,vke=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:Ld,accessPathWithDatum:F6,compile:pke,contains:Fe,deepEqual:os,deleteNestedProperty:Ob,duplicate:Ee,entries:Wo,every:M6,fieldIntersection:N6,flatAccessWithDatum:QW,getFirstDefined:yt,hasIntersection:T6,hash:Re,internalField:nH,isBoolean:D0,isEmpty:Je,isEqual:K1e,isInternalField:rH,isNullOrFalse:r$,isNumeric:px,keys:K,logicalExpr:s0,mergeDeep:KW,never:XW,normalize:XV,normalizeAngle:O0,omit:Xn,pick:Id,prefixGenerator:i$,removePathFromField:D6,replaceAll:Sc,replacePathInField:ni,resetIdCounter:Q1e,setEqual:ZW,some:kc,stringify:et,titleCase:wm,unique:ls,uniqueId:tH,vals:qt,varName:st,version:yke},Symbol.toStringTag,{value:"Module"}));function cY(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var bke="vega-themes",xke="2.13.0",wke="Themes for stylized Vega and Vega-Lite visualizations.",_ke=["vega","vega-lite","themes","style"],Eke="BSD-3-Clause",kke={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Ske=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Ake="build/vega-themes.js",$ke="build/vega-themes.module.js",Cke="build/vega-themes.min.js",Mke="build/vega-themes.min.js",Tke="build/vega-themes.module.d.ts",Nke={type:"git",url:"https://github.com/vega/vega-themes.git"},Fke=["src","build"],Dke={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},Oke={"@babel/core":"^7.21.4","@babel/plugin-transform-runtime":"^7.21.4","@babel/preset-env":"^7.21.4","@babel/preset-typescript":"^7.21.4","@release-it/conventional-changelog":"^5.1.1","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.2","@rollup/plugin-terser":"^0.4.1","@typescript-eslint/eslint-plugin":"^5.59.0","@typescript-eslint/parser":"^5.59.0","browser-sync":"^2.29.1",concurrently:"^8.0.1",eslint:"^8.38.0","eslint-config-prettier":"^8.8.0","eslint-plugin-prettier":"^4.2.1","gh-pages":"^5.0.0",prettier:"^2.8.7","release-it":"^15.10.1",rollup:"^3.20.6","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.2.0",typescript:"^5.0.4",vega:"^5.24.0","vega-lite":"^5.7.1"},Rke={vega:"*","vega-lite":"*"},Pke={},Ike={name:bke,version:xke,description:wke,keywords:_ke,license:Eke,author:kke,contributors:Ske,main:Ake,module:$ke,unpkg:Cke,jsdelivr:Mke,types:Tke,repository:Nke,files:Fke,scripts:Dke,devDependencies:Oke,peerDependencies:Rke,dependencies:Pke};const Wf="#fff",nI="#888",Lke={background:"#333",view:{stroke:nI},title:{color:Wf,subtitleColor:Wf},style:{"guide-label":{fill:Wf},"guide-title":{fill:Wf}},axis:{domainColor:Wf,gridColor:nI,tickColor:Wf}},Pu="#4572a7",zke={background:"#fff",arc:{fill:Pu},area:{fill:Pu},line:{stroke:Pu,strokeWidth:2},path:{stroke:Pu},rect:{fill:Pu},shape:{stroke:Pu},symbol:{fill:Pu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Iu="#30a2da",oA="#cbcbcb",Bke="#999",Uke="#333",rI="#f0f0f0",iI="#333",jke={arc:{fill:Iu},area:{fill:Iu},axis:{domainColor:oA,grid:!0,gridColor:oA,gridWidth:1,labelColor:Bke,labelFontSize:10,titleColor:Uke,tickColor:oA,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:rI,group:{fill:rI},legend:{labelColor:iI,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:iI,titleFontSize:14,titlePadding:10},line:{stroke:Iu,strokeWidth:2},path:{stroke:Iu,strokeWidth:.5},rect:{fill:Iu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Iu},bar:{binSpacing:2,fill:Iu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Lu="#000",qke={group:{fill:"#e5e5e5"},arc:{fill:Lu},area:{fill:Lu},line:{stroke:Lu},path:{stroke:Lu},rect:{fill:Lu},shape:{stroke:Lu},symbol:{fill:Lu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Gke=22,Wke="normal",sI="Benton Gothic, sans-serif",aI=11.5,Hke="normal",zu="#82c6df",lA="Benton Gothic Bold, sans-serif",oI="normal",lI=13,xg={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Vke={background:"#ffffff",title:{anchor:"start",color:"#000000",font:lA,fontSize:Gke,fontWeight:Wke},arc:{fill:zu},area:{fill:zu},line:{stroke:zu,strokeWidth:2},path:{stroke:zu},rect:{fill:zu},shape:{stroke:zu},symbol:{fill:zu,size:30},axis:{labelFont:sI,labelFontSize:aI,labelFontWeight:Hke,titleFont:lA,titleFontSize:lI,titleFontWeight:oI},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:sI,labelFontSize:aI,symbolType:"square",titleFont:lA,titleFontSize:lI,titleFontWeight:oI},range:{category:xg["category-6"],diverging:xg["fireandice-6"],heatmap:xg["fire-7"],ordinal:xg["fire-7"],ramp:xg["fire-7"]}},Bu="#ab5787",Ly="#979797",Jke={background:"#f9f9f9",arc:{fill:Bu},area:{fill:Bu},line:{stroke:Bu},path:{stroke:Bu},rect:{fill:Bu},shape:{stroke:Bu},symbol:{fill:Bu,size:30},axis:{domainColor:Ly,domainWidth:.5,gridWidth:.2,labelColor:Ly,tickColor:Ly,tickWidth:.2,titleColor:Ly},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Uu="#3e5c69",Yke={background:"#fff",arc:{fill:Uu},area:{fill:Uu},line:{stroke:Uu},path:{stroke:Uu},rect:{fill:Uu},shape:{stroke:Uu},symbol:{fill:Uu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Wr="#1696d2",uI="#000000",Xke="#FFFFFF",zy="Lato",uA="Lato",Kke="Lato",Zke="#DEDDDD",Qke=18,wg={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},e3e={background:Xke,title:{anchor:"start",fontSize:Qke,font:zy},axisX:{domain:!0,domainColor:uI,domainWidth:1,grid:!1,labelFontSize:12,labelFont:uA,labelAngle:0,tickColor:uI,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:zy},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:Zke,gridWidth:1,labelFontSize:12,labelFont:uA,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:zy,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:uA,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:zy,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:wg["six-groups-cat-1"],diverging:wg["diverging-colors"],heatmap:wg["diverging-colors"],ordinal:wg["six-groups-seq"],ramp:wg["shades-blue"]},area:{fill:Wr},rect:{fill:Wr},line:{color:Wr,stroke:Wr,strokeWidth:5},trail:{color:Wr,stroke:Wr,strokeWidth:0,size:1},path:{stroke:Wr,strokeWidth:.5},point:{filled:!0},text:{font:Kke,color:Wr,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Wr,stroke:null}},arc:{fill:Wr},shape:{stroke:Wr},symbol:{fill:Wr,size:30}},ju="#3366CC",cI="#ccc",By="Arial, sans-serif",t3e={arc:{fill:ju},area:{fill:ju},path:{stroke:ju},rect:{fill:ju},shape:{stroke:ju},symbol:{stroke:ju},circle:{fill:ju},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:By,fontSize:12},"guide-title":{font:By,fontSize:12},"group-title":{font:By,fontSize:12}},title:{font:By,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:cI,tickColor:cI,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},KM=e=>e*(1/3+1),fI=KM(9),dI=KM(10),hI=KM(12),_g="Segoe UI",pI="wf_standard-font, helvetica, arial, sans-serif",gI="#252423",Eg="#605E5C",mI="transparent",n3e="#C8C6C4",gi="#118DFF",r3e="#12239E",i3e="#E66C37",s3e="#6B007B",a3e="#E044A7",o3e="#744EC2",l3e="#D9B300",u3e="#D64550",fY=gi,dY="#DEEFFF",yI=[dY,fY],c3e=[dY,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",fY],f3e={view:{stroke:mI},background:mI,font:_g,header:{titleFont:pI,titleFontSize:hI,titleColor:gI,labelFont:_g,labelFontSize:dI,labelColor:Eg},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Eg,labelFontSize:fI,titleFont:pI,titleColor:gI,titleFontSize:hI,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:n3e,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:gi},line:{stroke:gi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:_g,fontSize:fI,fill:Eg},arc:{fill:gi},area:{fill:gi,line:!0,opacity:.6},path:{stroke:gi},rect:{fill:gi},point:{fill:gi,filled:!0,size:75},shape:{stroke:gi},symbol:{fill:gi,strokeWidth:1.5,size:50},legend:{titleFont:_g,titleFontWeight:"bold",titleColor:Eg,labelFont:_g,labelFontSize:dI,labelColor:Eg,symbolType:"circle",symbolSize:75},range:{category:[gi,r3e,i3e,s3e,a3e,o3e,l3e,u3e],diverging:yI,heatmap:yI,ordinal:c3e}},d3e=Ike.version,h3e=Object.freeze(Object.defineProperty({__proto__:null,dark:Lke,excel:zke,fivethirtyeight:jke,ggplot2:qke,googlecharts:t3e,latimes:Vke,powerbi:f3e,quartz:Jke,urbaninstitute:e3e,version:d3e,vox:Yke},Symbol.toStringTag,{value:"Module"}));function B0(e){return B0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B0(e)}function p3e(e,t){if(B0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(B0(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g3e(e){var t=p3e(e,"string");return B0(t)==="symbol"?t:String(t)}function m3e(e,t,n){return t=g3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y3e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function v3e(e,t){if(e==null)return{};var n=y3e(e,t),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const b3e=["title","image"];function x3e(e,t,n){if(Y(e))return`[${e.map(r=>t(oe(r)?r:vI(r,n))).join(", ")}]`;if(ce(e)){let r="";const i=e,{title:s,image:a}=i,o=v3e(i,b3e);s&&(r+=`<h2>${t(s)}</h2>`),a&&(r+=`<img src="${t(a)}">`);const l=Object.keys(o);if(l.length>0){r+="<table>";for(const u of l){let c=o[u];c!==void 0&&(ce(c)&&(c=vI(c,n)),r+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function w3e(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function vI(e,t){return JSON.stringify(e,w3e(t))}var _3e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const hY="vg-tooltip-element",E3e={offsetX:10,offsetY:10,id:hY,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:k3e,maxDepth:2,formatTooltip:x3e};function k3e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function S3e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return _3e.toString().replace(hY,e)}function A3e(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let s=e.clientY+r;return s+t.height>window.innerHeight&&(s=+e.clientY-r-t.height),{x:i,y:s}}function bI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function xI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bI(Object(n),!0).forEach(function(r){m3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}class $3e{constructor(t){this.options=xI(xI({},E3e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=S3e(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:a}=A3e(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${a}px`,this.el.style.left=`${s}px`}}function U0(e){return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}function C3e(e,t){if(U0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(U0(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M3e(e){var t=C3e(e,"string");return U0(t)==="symbol"?t:String(t)}function T3e(e,t,n){return t=M3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N3e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cA,wI;function F3e(){return wI||(wI=1,cA=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),cA}var D3e=Be;Be.Node=Rc;Be.create=Be;function Be(e){var t=this;if(t instanceof Be||(t=new Be),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}Be.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};Be.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};Be.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};Be.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)R3e(this,arguments[e]);return this.length};Be.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)P3e(this,arguments[e]);return this.length};Be.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};Be.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};Be.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};Be.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};Be.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};Be.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};Be.prototype.map=function(e,t){t=t||this;for(var n=new Be,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};Be.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Be,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};Be.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n};Be.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n};Be.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};Be.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};Be.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Be;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n};Be.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new Be;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n};Be.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var s=[],r=0;i&&r<t;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=O3e(this,i,n[r]);return s};Be.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function O3e(e,t,n){var r=t===e.head?new Rc(n,null,t,e):new Rc(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function R3e(e,t){e.tail=new Rc(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function P3e(e,t){e.head=new Rc(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Rc(e,t,n,r){if(!(this instanceof Rc))return new Rc(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{F3e()(Be)}catch{}const I3e=D3e,Ku=Symbol("max"),la=Symbol("length"),Hf=Symbol("lengthCalculator"),l0=Symbol("allowStale"),nc=Symbol("maxAge"),sa=Symbol("dispose"),_I=Symbol("noDisposeOnSet"),Ct=Symbol("lruList"),mi=Symbol("cache"),pY=Symbol("updateAgeOnGet"),fA=()=>1;class L3e{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Ku]=t.max||1/0;const n=t.length||fA;if(this[Hf]=typeof n!="function"?fA:n,this[l0]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[nc]=t.maxAge||0,this[sa]=t.dispose,this[_I]=t.noDisposeOnSet||!1,this[pY]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Ku]=t||1/0,kg(this)}get max(){return this[Ku]}set allowStale(t){this[l0]=!!t}get allowStale(){return this[l0]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[nc]=t,kg(this)}get maxAge(){return this[nc]}set lengthCalculator(t){typeof t!="function"&&(t=fA),t!==this[Hf]&&(this[Hf]=t,this[la]=0,this[Ct].forEach(n=>{n.length=this[Hf](n.value,n.key),this[la]+=n.length})),kg(this)}get lengthCalculator(){return this[Hf]}get length(){return this[la]}get itemCount(){return this[Ct].length}rforEach(t,n){n=n||this;for(let r=this[Ct].tail;r!==null;){const i=r.prev;EI(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[Ct].head;r!==null;){const i=r.next;EI(this,t,r,n),r=i}}keys(){return this[Ct].toArray().map(t=>t.key)}values(){return this[Ct].toArray().map(t=>t.value)}reset(){this[sa]&&this[Ct]&&this[Ct].length&&this[Ct].forEach(t=>this[sa](t.key,t.value)),this[mi]=new Map,this[Ct]=new I3e,this[la]=0}dump(){return this[Ct].map(t=>Xb(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Ct]}set(t,n,r){if(r=r||this[nc],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,s=this[Hf](n,t);if(this[mi].has(t)){if(s>this[Ku])return hd(this,this[mi].get(t)),!1;const l=this[mi].get(t).value;return this[sa]&&(this[_I]||this[sa](t,l.value)),l.now=i,l.maxAge=r,l.value=n,this[la]+=s-l.length,l.length=s,this.get(t),kg(this),!0}const a=new z3e(t,n,s,i,r);return a.length>this[Ku]?(this[sa]&&this[sa](t,n),!1):(this[la]+=a.length,this[Ct].unshift(a),this[mi].set(t,this[Ct].head),kg(this),!0)}has(t){if(!this[mi].has(t))return!1;const n=this[mi].get(t).value;return!Xb(this,n)}get(t){return dA(this,t,!0)}peek(t){return dA(this,t,!1)}pop(){const t=this[Ct].tail;return t?(hd(this,t),t.value):null}del(t){hd(this,this[mi].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-n;a>0&&this.set(i.k,i.v,a)}}}prune(){this[mi].forEach((t,n)=>dA(this,n,!1))}}const dA=(e,t,n)=>{const r=e[mi].get(t);if(r){const i=r.value;if(Xb(e,i)){if(hd(e,r),!e[l0])return}else n&&(e[pY]&&(r.value.now=Date.now()),e[Ct].unshiftNode(r));return i.value}},Xb=(e,t)=>{if(!t||!t.maxAge&&!e[nc])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[nc]&&n>e[nc]},kg=e=>{if(e[la]>e[Ku])for(let t=e[Ct].tail;e[la]>e[Ku]&&t!==null;){const n=t.prev;hd(e,t),t=n}},hd=(e,t)=>{if(t){const n=t.value;e[sa]&&e[sa](n.key,n.value),e[la]-=n.length,e[mi].delete(n.key),e[Ct].removeNode(t)}};class z3e{constructor(t,n,r,i,s){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=s||0}}const EI=(e,t,n,r)=>{let i=n.value;Xb(e,i)&&(hd(e,n),e[l0]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var B3e=L3e;const U3e=Object.freeze({loose:!0}),j3e=Object.freeze({}),q3e=e=>e?typeof e!="object"?U3e:e:j3e;var ZM=q3e,$$={exports:{}};const G3e="2.0.0",W3e=256,H3e=Number.MAX_SAFE_INTEGER||9007199254740991,V3e=16,J3e=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var QM={MAX_LENGTH:W3e,MAX_SAFE_COMPONENT_LENGTH:V3e,MAX_SAFE_INTEGER:H3e,RELEASE_TYPES:J3e,SEMVER_SPEC_VERSION:G3e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const Y3e=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var ew=Y3e;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=QM,r=ew;t=e.exports={};const i=t.re=[],s=t.src=[],a=t.t={};let o=0;const l=(u,c,f)=>{const d=o++;r(u,d,c),a[u]=d,s[d]=c,i[d]=new RegExp(c,f?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),l("FULL",`^${s[a.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),l("LOOSE",`^${s[a.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),l("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),l("COERCERTL",s[a.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})($$,$$.exports);var e7=$$.exports;const kI=/^[0-9]+$/,gY=(e,t)=>{const n=kI.test(e),r=kI.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},X3e=(e,t)=>gY(t,e);var K3e={compareIdentifiers:gY,rcompareIdentifiers:X3e};const Uy=ew,{MAX_LENGTH:SI,MAX_SAFE_INTEGER:jy}=QM,{re:AI,t:$I}=e7,Z3e=ZM,{compareIdentifiers:Vf}=K3e;let Q3e=class es{constructor(t,n){if(n=Z3e(n),t instanceof es){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>SI)throw new TypeError(`version is longer than ${SI} characters`);Uy("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?AI[$I.LOOSE]:AI[$I.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>jy||this.major<0)throw new TypeError("Invalid major version");if(this.minor>jy||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>jy||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<jy)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Uy("SemVer.compare",this.version,this.options,t),!(t instanceof es)){if(typeof t=="string"&&t===this.version)return 0;t=new es(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof es||(t=new es(t,this.options)),Vf(this.major,t.major)||Vf(this.minor,t.minor)||Vf(this.patch,t.patch)}comparePre(t){if(t instanceof es||(t=new es(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(Uy("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Vf(r,i)}while(++n)}compareBuild(t){t instanceof es||(t=new es(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(Uy("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Vf(r,i)}while(++n)}inc(t,n,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}if(n){const i=Number(r)?1:0;Vf(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=[n,i]):this.prerelease=[n,i]}break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}};var t7=Q3e;const CI=t7,eSe=(e,t,n)=>new CI(e,n).compare(new CI(t,n));var bh=eSe;const tSe=bh,nSe=(e,t,n)=>tSe(e,t,n)===0;var rSe=nSe;const iSe=bh,sSe=(e,t,n)=>iSe(e,t,n)!==0;var aSe=sSe;const oSe=bh,lSe=(e,t,n)=>oSe(e,t,n)>0;var uSe=lSe;const cSe=bh,fSe=(e,t,n)=>cSe(e,t,n)>=0;var dSe=fSe;const hSe=bh,pSe=(e,t,n)=>hSe(e,t,n)<0;var gSe=pSe;const mSe=bh,ySe=(e,t,n)=>mSe(e,t,n)<=0;var vSe=ySe;const bSe=rSe,xSe=aSe,wSe=uSe,_Se=dSe,ESe=gSe,kSe=vSe,SSe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return bSe(e,n,r);case"!=":return xSe(e,n,r);case">":return wSe(e,n,r);case">=":return _Se(e,n,r);case"<":return ESe(e,n,r);case"<=":return kSe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var ASe=SSe,hA,MI;function $Se(){if(MI)return hA;MI=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}a("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new o(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(a("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new l(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}hA=t;const n=ZM,{re:r,t:i}=e7,s=ASe,a=ew,o=t7,l=mY();return hA}var pA,TI;function mY(){if(TI)return pA;TI=1;class e{constructor(L,P){if(P=r(P),L instanceof e)return L.loose===!!P.loose&&L.includePrerelease===!!P.includePrerelease?L:new e(L.raw,P);if(L instanceof i)return this.raw=L.value,this.set=[[L]],this.format(),this;if(this.options=P,this.loose=!!P.loose,this.includePrerelease=!!P.includePrerelease,this.raw=L,this.set=L.split("||").map(B=>this.parseRange(B.trim())).filter(B=>B.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${L}`);if(this.set.length>1){const B=this.set[0];if(this.set=this.set.filter(U=>!p(U[0])),this.set.length===0)this.set=[B];else if(this.set.length>1){for(const U of this.set)if(U.length===1&&g(U[0])){this.set=[U];break}}}this.format()}format(){return this.range=this.set.map(L=>L.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(L){L=L.trim();const B=((this.options.includePrerelease&&d)|(this.options.loose&&h))+":"+L,U=n.get(B);if(U)return U;const q=this.options.loose,X=q?o[l.HYPHENRANGELOOSE]:o[l.HYPHENRANGE];L=L.replace(X,R(this.options.includePrerelease)),s("hyphen replace",L),L=L.replace(o[l.COMPARATORTRIM],u),s("comparator trim",L),L=L.replace(o[l.TILDETRIM],c),L=L.replace(o[l.CARETTRIM],f),L=L.split(/\s+/).join(" ");let ae=L.split(" ").map(Se=>y(Se,this.options)).join(" ").split(/\s+/).map(Se=>D(Se,this.options));q&&(ae=ae.filter(Se=>(s("loose invalid filter",Se,this.options),!!Se.match(o[l.COMPARATORLOOSE])))),s("range list",ae);const fe=new Map,we=ae.map(Se=>new i(Se,this.options));for(const Se of we){if(p(Se))return[Se];fe.set(Se.value,Se)}fe.size>1&&fe.has("")&&fe.delete("");const Te=[...fe.values()];return n.set(B,Te),Te}intersects(L,P){if(!(L instanceof e))throw new TypeError("a Range is required");return this.set.some(B=>m(B,P)&&L.set.some(U=>m(U,P)&&B.every(q=>U.every(X=>q.intersects(X,P)))))}test(L){if(!L)return!1;if(typeof L=="string")try{L=new a(L,this.options)}catch{return!1}for(let P=0;P<this.set.length;P++)if(j(this.set[P],L,this.options))return!0;return!1}}pA=e;const t=B3e,n=new t({max:1e3}),r=ZM,i=$Se(),s=ew,a=t7,{re:o,t:l,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:f}=e7,{FLAG_INCLUDE_PRERELEASE:d,FLAG_LOOSE:h}=QM,p=O=>O.value==="<0.0.0-0",g=O=>O.value==="",m=(O,L)=>{let P=!0;const B=O.slice();let U=B.pop();for(;P&&B.length;)P=B.every(q=>U.intersects(q,L)),U=B.pop();return P},y=(O,L)=>(s("comp",O,L),O=w(O,L),s("caret",O),O=x(O,L),s("tildes",O),O=E(O,L),s("xrange",O),O=z(O,L),s("stars",O),O),v=O=>!O||O.toLowerCase()==="x"||O==="*",x=(O,L)=>O.trim().split(/\s+/).map(P=>_(P,L)).join(" "),_=(O,L)=>{const P=L.loose?o[l.TILDELOOSE]:o[l.TILDE];return O.replace(P,(B,U,q,X,ae)=>{s("tilde",O,B,U,q,X,ae);let fe;return v(U)?fe="":v(q)?fe=`>=${U}.0.0 <${+U+1}.0.0-0`:v(X)?fe=`>=${U}.${q}.0 <${U}.${+q+1}.0-0`:ae?(s("replaceTilde pr",ae),fe=`>=${U}.${q}.${X}-${ae} <${U}.${+q+1}.0-0`):fe=`>=${U}.${q}.${X} <${U}.${+q+1}.0-0`,s("tilde return",fe),fe})},w=(O,L)=>O.trim().split(/\s+/).map(P=>k(P,L)).join(" "),k=(O,L)=>{s("caret",O,L);const P=L.loose?o[l.CARETLOOSE]:o[l.CARET],B=L.includePrerelease?"-0":"";return O.replace(P,(U,q,X,ae,fe)=>{s("caret",O,U,q,X,ae,fe);let we;return v(q)?we="":v(X)?we=`>=${q}.0.0${B} <${+q+1}.0.0-0`:v(ae)?q==="0"?we=`>=${q}.${X}.0${B} <${q}.${+X+1}.0-0`:we=`>=${q}.${X}.0${B} <${+q+1}.0.0-0`:fe?(s("replaceCaret pr",fe),q==="0"?X==="0"?we=`>=${q}.${X}.${ae}-${fe} <${q}.${X}.${+ae+1}-0`:we=`>=${q}.${X}.${ae}-${fe} <${q}.${+X+1}.0-0`:we=`>=${q}.${X}.${ae}-${fe} <${+q+1}.0.0-0`):(s("no pr"),q==="0"?X==="0"?we=`>=${q}.${X}.${ae}${B} <${q}.${X}.${+ae+1}-0`:we=`>=${q}.${X}.${ae}${B} <${q}.${+X+1}.0-0`:we=`>=${q}.${X}.${ae} <${+q+1}.0.0-0`),s("caret return",we),we})},E=(O,L)=>(s("replaceXRanges",O,L),O.split(/\s+/).map(P=>A(P,L)).join(" ")),A=(O,L)=>{O=O.trim();const P=L.loose?o[l.XRANGELOOSE]:o[l.XRANGE];return O.replace(P,(B,U,q,X,ae,fe)=>{s("xRange",O,B,U,q,X,ae,fe);const we=v(q),Te=we||v(X),Se=Te||v(ae),je=Se;return U==="="&&je&&(U=""),fe=L.includePrerelease?"-0":"",we?U===">"||U==="<"?B="<0.0.0-0":B="*":U&&je?(Te&&(X=0),ae=0,U===">"?(U=">=",Te?(q=+q+1,X=0,ae=0):(X=+X+1,ae=0)):U==="<="&&(U="<",Te?q=+q+1:X=+X+1),U==="<"&&(fe="-0"),B=`${U+q}.${X}.${ae}${fe}`):Te?B=`>=${q}.0.0${fe} <${+q+1}.0.0-0`:Se&&(B=`>=${q}.${X}.0${fe} <${q}.${+X+1}.0-0`),s("xRange return",B),B})},z=(O,L)=>(s("replaceStars",O,L),O.trim().replace(o[l.STAR],"")),D=(O,L)=>(s("replaceGTE0",O,L),O.trim().replace(o[L.includePrerelease?l.GTE0PRE:l.GTE0],"")),R=O=>(L,P,B,U,q,X,ae,fe,we,Te,Se,je,Ln)=>(v(B)?P="":v(U)?P=`>=${B}.0.0${O?"-0":""}`:v(q)?P=`>=${B}.${U}.0${O?"-0":""}`:X?P=`>=${P}`:P=`>=${P}${O?"-0":""}`,v(we)?fe="":v(Te)?fe=`<${+we+1}.0.0-0`:v(Se)?fe=`<${we}.${+Te+1}.0-0`:je?fe=`<=${we}.${Te}.${Se}-${je}`:O?fe=`<${we}.${Te}.${+Se+1}-0`:fe=`<=${fe}`,`${P} ${fe}`.trim()),j=(O,L,P)=>{for(let B=0;B<O.length;B++)if(!O[B].test(L))return!1;if(L.prerelease.length&&!P.includePrerelease){for(let B=0;B<O.length;B++)if(s(O[B].semver),O[B].semver!==i.ANY&&O[B].semver.prerelease.length>0){const U=O[B].semver;if(U.major===L.major&&U.minor===L.minor&&U.patch===L.patch)return!0}return!1}return!0};return pA}const CSe=mY(),MSe=(e,t,n)=>{try{t=new CSe(t,n)}catch{return!1}return t.test(e)};var TSe=MSe,yY=N3e(TSe);function NSe(e,t,n){const r=e.open(t),i=1e4,s=250,{origin:a}=new URL(t);let o=~~(i/s);function l(c){c.source===r&&(o=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function u(){o<=0||(r.postMessage(n,a),setTimeout(u,s),o-=1)}setTimeout(u,s)}var FSe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function vY(e,...t){for(const n of t)DSe(e,n);return e}function DSe(e,t){for(const n of Object.keys(t))Kd(e,n,t[n],!0)}function NI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Oo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NI(Object(n),!0).forEach(function(r){T3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const yi=d1e;let j0=vke;const qy=typeof window<"u"?window:void 0;var BI;j0===void 0&&((BI=qy==null?void 0:qy.vl)!=null&&BI.compile)&&(j0=qy.vl);const OSe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},RSe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Vg={vega:"Vega","vega-lite":"Vega-Lite"},Kb={vega:yi.version,"vega-lite":j0?j0.version:"not available"},PSe={vega:e=>e,"vega-lite":(e,t)=>j0.compile(e,{config:t}).spec},ISe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,LSe="chart-wrapper";function zSe(e){return typeof e=="function"}function FI(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+e+s),a.document.title=`${Vg[r]} JSON Source`}function BSe(e,t){if(e.$schema){const n=cY(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${Vg[n.library]}, but mode argument sets ${Vg[t]??t}.`);const r=n.library;return yY(Kb[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${Vg[r]} ${n.version}, but the current version of ${Vg[r]} is v${Kb[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function USe(e){return!!(e&&"load"in e)}function DI(e){return USe(e)?e:yi.loader(e)}function jSe(e){var n;const t=((n=e.usermeta)==null?void 0:n.embedOptions)??{};return oe(t.defaultStyle)&&(t.defaultStyle=!1),t}async function qSe(e,t,n={}){let r,i;oe(t)?(i=DI(n.loader),r=JSON.parse(await i.load(t))):r=t;const s=jSe(r),a=s.loader;(!i||a)&&(i=DI(n.loader??a));const o=await OI(s,i),l=await OI(n,i),u=Oo(Oo({},vY(l,o)),{},{config:Xd(l.config??{},o.config??{})});return await WSe(e,r,u,i)}async function OI(e,t){const n=oe(e.config)?JSON.parse(await t.load(e.config)):e.config??{},r=oe(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return Oo(Oo(Oo({},e),r?{patch:r}:{}),n?{config:n}:{})}function GSe(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function WSe(e,t,n={},r){const i=n.theme?Xd(h3e[n.theme],n.config??{}):n.config,s=Ko(n.actions)?n.actions:vY({},OSe,n.actions??{}),a=Oo(Oo({},RSe),n.i18n),o=n.renderer??"canvas",l=n.logLevel??yi.Warn,u=n.downloadFileName??"visualization",c=typeof e=="string"?document.querySelector(e):e;if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const w="vega-embed-style",{root:k,rootContainer:E}=GSe(c);if(!k.getElementById(w)){const A=document.createElement("style");A.id=w,A.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?FSe.toString():n.defaultStyle,E.appendChild(A)}}const f=BSe(t,n.mode);let d=PSe[f](t,i);if(f==="vega-lite"&&d.$schema){const w=cY(d.$schema);yY(Kb.vega,`^${w.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${w.version}, but current version is v${Kb.vega}.`)}c.classList.add("vega-embed"),s&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(s){const w=document.createElement("div");w.classList.add(LSe),c.appendChild(w),h=w}const p=n.patch;if(p&&(d=p instanceof Function?p(d):Zb(d,p,!0,!1).newDocument),n.formatLocale&&yi.formatLocale(n.formatLocale),n.timeFormatLocale&&yi.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const w in n.expressionFunctions){const k=n.expressionFunctions[w];"fn"in k?yi.expressionFunction(w,k.fn,k.visitor):k instanceof Function&&yi.expressionFunction(w,k)}const{ast:g}=n,m=yi.parse(d,f==="vega-lite"?{}:i,{ast:g}),y=new(n.viewClass||yi.View)(m,Oo({loader:r,logLevel:l,renderer:o},g?{expr:yi.expressionInterpreter??n.expr??_1e}:{}));if(y.addSignalListener("autosize",(w,k)=>{const{type:E}=k;E=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):E=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):E=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const w=zSe(n.tooltip)?n.tooltip:new $3e(n.tooltip===!0?{}:n.tooltip).call;y.tooltip(w)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:w,updateSet:k}=typeof v=="boolean"?{}:v;y.hover(w,k)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(h,n.bind).runAsync();let x;if(s!==!1){let w=c;if(n.defaultStyle!==!1){const E=document.createElement("details");E.title=a.CLICK_TO_VIEW_ACTIONS,c.append(E),w=E;const A=document.createElement("summary");A.innerHTML=ISe,E.append(A),x=z=>{E.contains(z.target)||E.removeAttribute("open")},document.addEventListener("click",x)}const k=document.createElement("div");if(w.append(k),k.classList.add("vega-actions"),s===!0||s.export!==!1){for(const E of["svg","png"])if(s===!0||s.export===!0||s.export[E]){const A=a[`${E.toUpperCase()}_ACTION`],z=document.createElement("a"),D=ce(n.scaleFactor)?n.scaleFactor[E]:n.scaleFactor;z.text=A,z.href="#",z.target="_blank",z.download=`${u}.${E}`,z.addEventListener("mousedown",async function(R){R.preventDefault();const j=await y.toImageURL(E,D);this.href=j}),k.append(z)}}if(s===!0||s.source!==!1){const E=document.createElement("a");E.text=a.SOURCE_ACTION,E.href="#",E.addEventListener("click",function(A){FI(GS(t),n.sourceHeader??"",n.sourceFooter??"",f),A.preventDefault()}),k.append(E)}if(f==="vega-lite"&&(s===!0||s.compiled!==!1)){const E=document.createElement("a");E.text=a.COMPILED_ACTION,E.href="#",E.addEventListener("click",function(A){FI(GS(d),n.sourceHeader??"",n.sourceFooter??"","vega"),A.preventDefault()}),k.append(E)}if(s===!0||s.editor!==!1){const E=n.editorUrl??"https://vega.github.io/editor/",A=document.createElement("a");A.text=a.EDITOR_ACTION,A.href="#",A.addEventListener("click",function(z){NSe(window,E,{config:i,mode:f,renderer:o,spec:GS(t)}),z.preventDefault()}),k.append(A)}}function _(){x&&document.removeEventListener("click",x),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:_,embedOptions:n}}const HSe=new Set(["width","height"]);function VSe(e,t){for(const[n,r]of Object.entries(t))r&&(r&&{}.toString.call(r)==="[object Function]"?r(e.data(n)):e.change(n,yi.changeset().remove(()=>!0).insert(r)))}function Gy(e={},t={},n=new Set){const r=Object.keys(e),i=Object.keys(t);return e===t||r.length===i.length&&r.filter(s=>!n.has(s)).every(s=>e[s]===t[s])}function RI(e,t){const n=Object.keys(t);for(const r of n)try{e.removeSignalListener(r,t[r])}catch(i){console.warn("Cannot remove invalid signal listener.",i)}return n.length>0}function gA(e,t){const n=Object.keys(t);for(const r of n)try{e.addSignalListener(r,t[r])}catch(i){console.warn("Cannot add invalid signal listener.",i)}return n.length>0}function JSe(e){return new Set(e.flatMap(t=>Object.keys(t)))}function YSe(e,t){if(e===t)return!1;const n={width:!1,height:!1,isExpensive:!1},r="width"in e||"width"in t,i="height"in e||"height"in t;return r&&(!("width"in e)||!("width"in t)||e.width!==t.width)&&("width"in e&&typeof e.width=="number"?n.width=e.width:n.isExpensive=!0),i&&(!("height"in e)||!("height"in t)||e.height!==t.height)&&("height"in e&&typeof e.height=="number"?n.height=e.height:n.isExpensive=!0),[...JSe([e,t])].filter(a=>a!=="width"&&a!=="height").some(a=>!(a in e)||!(a in t)||!YW(e[a],t[a]))&&(n.isExpensive=!0),n.width!==!1||n.height!==!1||n.isExpensive?n:!1}function PI(e,t){const{width:n,height:r}=t;return typeof n<"u"&&typeof r<"u"?{...e,width:n,height:r}:typeof n<"u"?{...e,width:n}:typeof r<"u"?{...e,height:r}:e}function XSe(e){let t;return{c(){t=N("div")},l(n){t=F(n,"DIV",{}),C(t).forEach(S)},m(n,r){ie(n,t,r),e[11](t)},p:us,i:us,o:us,d(n){n&&S(t),e[11](null)}}}function KSe(e,t,n){let{options:r}=t,{spec:i}=t,{view:s}=t,{signalListeners:a={}}=t,{data:o={}}=t;const l=FY();let u,c={},f={},d={},h={},p;DY(()=>{m()});async function g(){m();try{n(6,u=await qSe(p,i,r)),n(1,s=u.view),gA(s,a)&&s.runAsync(),v(s)}catch(w){y(w)}}function m(){u&&(u.finalize(),n(6,u=void 0),n(1,s=void 0))}function y(w){l("onError",{error:w}),console.warn(w)}function v(w){x(),l("onNewView",{view:w})}async function x(){o&&Object.keys(o).length>0&&u!==void 0&&(n(1,s=u.view),VSe(s,o),await s.resize().runAsync())}function _(w){C$[w?"unshift":"push"](()=>{p=w,n(0,p)})}return e.$$set=w=>{"options"in w&&n(2,r=w.options),"spec"in w&&n(3,i=w.spec),"view"in w&&n(1,s=w.view),"signalListeners"in w&&n(4,a=w.signalListeners),"data"in w&&n(5,o=w.data)},e.$$.update=()=>{if(e.$$.dirty&1056&&(Gy(o,h)||x(),n(10,h=o)),e.$$.dirty&991&&p!==void 0){if(!Gy(r,c,HSe))g();else{const w=YSe(PI(i,r),PI(d,c)),k=a,E=f;if(w){if(w.isExpensive)g();else if(u!==void 0){const A=!Gy(k,E);n(1,s=u.view),w.width!==!1&&s.width(w.width),w.height!==!1&&s.height(w.height),A&&(E&&RI(s,E),k&&gA(s,k)),s.runAsync()}}else!Gy(k,E)&&u!==void 0&&(n(1,s=u.view),E&&RI(s,E),k&&gA(s,k),s.runAsync())}n(7,c=r),n(8,f=a),n(9,d=i)}},[p,s,r,i,a,o,u,c,f,d,h,_]}class bY extends Pc{constructor(t){super(),Ic(this,t,KSe,XSe,Lc,{options:2,spec:3,view:1,signalListeners:4,data:5})}}function ZSe(e){let t,n,r;function i(a){e[6](a)}let s={spec:e[1],data:e[2],signalListeners:e[3],options:e[4]};return e[0]!==void 0&&(s.view=e[0]),t=new bY({props:s}),C$.push(()=>UI(t,"view",i)),t.$on("onNewView",e[7]),t.$on("onError",e[8]),{c(){fr(t.$$.fragment)},l(a){dr(t.$$.fragment,a)},m(a,o){hr(t,a,o),r=!0},p(a,[o]){const l={};o&2&&(l.spec=a[1]),o&4&&(l.data=a[2]),o&8&&(l.signalListeners=a[3]),o&16&&(l.options=a[4]),!n&&o&1&&(n=!0,l.view=a[0],jI(()=>n=!1)),t.$set(l)},i(a){r||(pr(t.$$.fragment,a),r=!0)},o(a){gr(t.$$.fragment,a),r=!1},d(a){mr(t,a)}}}const QSe="vega";function e5e(e,t,n){let r,{spec:i}=t,{options:s={}}=t,{data:a={}}=t,{signalListeners:o={}}=t,{view:l=void 0}=t;function u(d){l=d,n(0,l)}function c(d){gv.call(this,e,d)}function f(d){gv.call(this,e,d)}return e.$$set=d=>{"spec"in d&&n(1,i=d.spec),"options"in d&&n(5,s=d.options),"data"in d&&n(2,a=d.data),"signalListeners"in d&&n(3,o=d.signalListeners),"view"in d&&n(0,l=d.view)},e.$$.update=()=>{e.$$.dirty&32&&n(4,r={...s,mode:QSe})},[l,i,a,o,r,s,u,c,f]}class II extends Pc{constructor(t){super(),Ic(this,t,e5e,ZSe,Lc,{spec:1,options:5,data:2,signalListeners:3,view:0})}}function t5e(e){let t,n,r;function i(a){e[6](a)}let s={spec:e[1],data:e[2],signalListeners:e[3],options:e[4]};return e[0]!==void 0&&(s.view=e[0]),t=new bY({props:s}),C$.push(()=>UI(t,"view",i)),t.$on("onNewView",e[7]),t.$on("onError",e[8]),{c(){fr(t.$$.fragment)},l(a){dr(t.$$.fragment,a)},m(a,o){hr(t,a,o),r=!0},p(a,[o]){const l={};o&2&&(l.spec=a[1]),o&4&&(l.data=a[2]),o&8&&(l.signalListeners=a[3]),o&16&&(l.options=a[4]),!n&&o&1&&(n=!0,l.view=a[0],jI(()=>n=!1)),t.$set(l)},i(a){r||(pr(t.$$.fragment,a),r=!0)},o(a){gr(t.$$.fragment,a),r=!1},d(a){mr(t,a)}}}const n5e="vega-lite";function r5e(e,t,n){let r,{spec:i}=t,{options:s={}}=t,{data:a={}}=t,{signalListeners:o={}}=t,{view:l=void 0}=t;function u(d){l=d,n(0,l)}function c(d){gv.call(this,e,d)}function f(d){gv.call(this,e,d)}return e.$$set=d=>{"spec"in d&&n(1,i=d.spec),"options"in d&&n(5,s=d.options),"data"in d&&n(2,a=d.data),"signalListeners"in d&&n(3,o=d.signalListeners),"view"in d&&n(0,l=d.view)},e.$$.update=()=>{e.$$.dirty&32&&n(4,r={...s,mode:n5e})},[l,i,a,o,r,s,u,c,f]}class LI extends Pc{constructor(t){super(),Ic(this,t,r5e,t5e,Lc,{spec:1,options:5,data:2,signalListeners:3,view:0})}}const i5e={avif:[{src:""+new URL("../assets/jetson.ab8d0719.avif",import.meta.url).href,w:600},{src:""+new URL("../assets/jetson.3f34f8d8.avif",import.meta.url).href,w:1e3},{src:""+new URL("../assets/jetson.da7be365.avif",import.meta.url).href,w:1400}],webp:[{src:""+new URL("../assets/jetson.f10d6ed1.webp",import.meta.url).href,w:600},{src:""+new URL("../assets/jetson.4d23fede.webp",import.meta.url).href,w:1e3},{src:""+new URL("../assets/jetson.1b1bfe77.webp",import.meta.url).href,w:1400}],jpeg:[{src:""+new URL("../assets/jetson.b1afe769.jpg",import.meta.url).href,w:600},{src:""+new URL("../assets/jetson.598947d2.jpg",import.meta.url).href,w:1e3},{src:""+new URL("../assets/jetson.62b78318.jpg",import.meta.url).href,w:1400}]},s5e={src:""+new URL("../assets/jetson.62b78318.jpg",import.meta.url).href,w:1400,h:1525.4462723136157},a5e={sources:i5e,fallback:s5e},o5e={avif:[{src:""+new URL("../assets/recovery.97e3875b.avif",import.meta.url).href,w:600},{src:""+new URL("../assets/recovery.f2e2e84c.avif",import.meta.url).href,w:1e3},{src:""+new URL("../assets/recovery.545894d0.avif",import.meta.url).href,w:1400}],webp:[{src:""+new URL("../assets/recovery.4f37353e.webp",import.meta.url).href,w:600},{src:""+new URL("../assets/recovery.21ee25ee.webp",import.meta.url).href,w:1e3},{src:""+new URL("../assets/recovery.145704d3.webp",import.meta.url).href,w:1400}],jpeg:[{src:""+new URL("../assets/recovery.772d64fa.jpg",import.meta.url).href,w:600},{src:""+new URL("../assets/recovery.872df84b.jpg",import.meta.url).href,w:1e3},{src:""+new URL("../assets/recovery.6fb5a708.jpg",import.meta.url).href,w:1400}]},l5e={src:""+new URL("../assets/recovery.6fb5a708.jpg",import.meta.url).href,w:1400,h:1052.944269190326},u5e={sources:o5e,fallback:l5e},c5e={avif:[{src:""+new URL("../assets/precision.f6eec3ea.avif",import.meta.url).href,w:400},{src:""+new URL("../assets/precision.d79f708f.avif",import.meta.url).href,w:800}],webp:[{src:""+new URL("../assets/precision.39f74b3f.webp",import.meta.url).href,w:400},{src:""+new URL("../assets/precision.23f186de.webp",import.meta.url).href,w:800}],jpeg:[{src:""+new URL("../assets/precision.e6f91191.jpg",import.meta.url).href,w:400},{src:""+new URL("../assets/precision.772c849b.jpg",import.meta.url).href,w:800}]},f5e={src:""+new URL("../assets/precision.772c849b.jpg",import.meta.url).href,w:800,h:563.7113402061856},d5e={sources:c5e,fallback:f5e},h5e={avif:[{src:""+new URL("../assets/tearing.b2c2a553.avif",import.meta.url).href,w:400},{src:""+new URL("../assets/tearing.83ff10b4.avif",import.meta.url).href,w:800}],webp:[{src:""+new URL("../assets/tearing.7a0f3c7b.webp",import.meta.url).href,w:400},{src:""+new URL("../assets/tearing.0047d794.webp",import.meta.url).href,w:800}],jpeg:[{src:""+new URL("../assets/tearing.abd97f3a.jpg",import.meta.url).href,w:400},{src:""+new URL("../assets/tearing.a534af0b.jpg",import.meta.url).href,w:800}]},p5e={src:""+new URL("../assets/tearing.a534af0b.jpg",import.meta.url).href,w:800,h:617.6885512750949},g5e={sources:h5e,fallback:p5e};function m5e(e){let t,n,r,i,s,a,o=[{xmlns:"http://www.w3.org/2000/svg"},{width:"0"},{height:"0"},e[0]],l={};for(let u=0;u<o.length;u+=1)l=ka(l,o[u]);return{c(){t=qe("svg"),n=qe("defs"),r=qe("pattern"),i=qe("path"),s=qe("path"),a=qe("path"),this.h()},l(u){t=Ge(u,"svg",{xmlns:!0,width:!0,height:!0});var c=C(t);n=Ge(c,"defs",{});var f=C(n);r=Ge(f,"pattern",{id:!0,width:!0,height:!0,patternTransform:!0,patternUnits:!0,viewBox:!0});var d=C(r);i=Ge(d,"path",{fill:!0,d:!0}),C(i).forEach(S),s=Ge(d,"path",{fill:!0,d:!0}),C(s).forEach(S),a=Ge(d,"path",{fill:!0,d:!0}),C(a).forEach(S),d.forEach(S),f.forEach(S),c.forEach(S),this.h()},h(){I(i,"fill","var(--color-background)"),I(i,"d","M107.39 68.056c67.948 35.031 107.45 63.369 129.09 87.504-11.082 44.418-68.896 46.445-90.036 45.199 4.328-2.015 7.94-4.428 9.22-8.136-5.304-3.77-24.112-.397-37.243-7.774 5.044-1.045 7.403-2.063 9.762-5.785-12.406-3.957-25.769-7.367-33.628-13.921 4.242.052 8.202.949 13.74-2.893-11.112-5.988-22.969-10.734-32.18-19.887 5.745-.14 11.938-.057 13.74-2.17-10.17-6.3-18.752-13.307-25.855-20.971 8.04.97 11.435.134 13.38-1.266-7.688-7.874-17.419-14.523-22.058-24.226 5.97 2.057 11.431 2.845 15.368-.18-2.612-5.894-13.805-9.37-20.249-23.143 6.285.61 12.95 1.371 14.283 0-2.917-11.884-7.922-18.565-12.83-25.487 13.45-.2 33.827.052 32.904-1.085l-8.316-8.497c13.138-3.537 26.58.568 36.34 3.616 4.382-3.458-.078-7.83-5.424-12.294 11.165 1.49 21.254 4.057 30.373 7.593 4.873-4.4-3.164-8.799-7.05-13.198 17.248 3.273 24.556 7.87 31.82 12.475 5.268-5.05.3-9.343-3.255-13.74 13.006 4.817 19.705 11.036 26.758 17.175 2.391-3.227 6.075-5.592 1.627-13.379 9.234 5.323 16.189 11.595 21.334 18.622 5.713-3.638 3.404-8.613 3.435-13.198 9.597 7.807 15.687 16.114 23.142 24.226 1.502-1.093 2.817-4.802 3.978-10.667 22.895 22.212 55.246 78.158 8.316 100.34-39.94-32.94-87.64-56.883-140.5-74.844zM467.92 68.056c-67.94 35.034-107.44 63.364-129.08 87.504 11.082 44.418 68.896 46.445 90.036 45.199-4.328-2.015-7.94-4.428-9.22-8.136 5.304-3.77 24.113-.397 37.244-7.774-5.045-1.045-7.404-2.063-9.763-5.785 12.406-3.957 25.769-7.367 33.628-13.921-4.242.052-8.202.949-13.74-2.893 11.112-5.988 22.969-10.734 32.18-19.887-5.745-.14-11.938-.057-13.74-2.17 10.17-6.3 18.752-13.307 25.855-20.971-8.04.97-11.435.134-13.38-1.266 7.688-7.874 17.419-14.523 22.058-24.226-5.97 2.057-11.431 2.845-15.368-.18 2.612-5.894 13.805-9.37 20.249-23.143-6.285.61-12.95 1.371-14.283 0 2.922-11.889 7.927-18.57 12.836-25.492-13.45-.2-33.828.052-32.905-1.085l8.316-8.497c-13.138-3.537-26.58.568-36.34 3.616-4.382-3.458.078-7.83 5.424-12.294-11.165 1.49-21.254 4.057-30.373 7.593-4.873-4.399 3.164-8.798 7.05-13.198-17.248 3.273-24.556 7.871-31.82 12.475-5.269-5.05-.3-9.343 3.255-13.74-13.006 4.817-19.705 11.036-26.758 17.175-2.391-3.227-6.075-5.592-1.627-13.379-9.234 5.323-16.189 11.595-21.334 18.622-5.713-3.638-3.404-8.613-3.435-13.198-9.597 7.807-15.687 16.114-23.142 24.226-1.502-1.093-2.817-4.801-3.978-10.667-22.895 22.212-55.246 78.158-8.316 100.34 39.919-32.947 87.616-56.888 140.48-74.849zM369.941 520.362a81.39 75.051 0 1 1-162.777 0 81.39 75.051 0 1 1 162.777 0zM241.458 305.967a86.13 72.999-55.966 1 1-94.968 143.712 86.13 72.999-55.966 1 1 94.968-143.712z"),I(s,"fill","var(--color-background)"),I(s,"d","M332.482 301.967a72.999 86.13-34.034 1 0 94.968 143.712 72.999 86.13-34.034 1 0-94.968-143.712zM72.91 342.09c36.41-9.76 12.292 150.63-17.333 137.47C22.99 453.35 12.494 376.59 72.91 342.09z"),I(a,"fill","var(--color-background)"),I(a,"d","M493.68 340.09c-36.414-9.757-12.292 150.64 17.333 137.48 32.587-26.213 43.083-102.98-17.333-137.48zM369.97 220.65c62.835-10.61 115.12 26.722 113.01 94.858-2.067 26.121-136.16-90.969-113.01-94.858zM196.36 218.65c-62.84-10.61-115.12 26.73-113.01 94.86 2.067 26.12 136.16-90.97 113.01-94.86zM286.62 202.76c-37.503-.975-73.495 27.834-73.582 44.544-.105 20.304 29.651 41.093 73.837 41.62 45.123.323 73.916-16.64 74.061-37.594.165-23.74-41.039-48.937-74.317-48.571zM288.91 619.12c32.697-1.427 76.571 10.532 76.657 26.396.543 15.405-39.79 50.211-78.826 49.538-40.427 1.744-80.069-33.116-79.55-45.199-.605-17.716 49.226-31.548 81.719-30.735zM168.14 525.1c23.279 28.046 33.891 77.319 14.464 91.844-18.379 11.088-63.012 6.522-94.736-39.052-21.395-38.242-18.638-77.157-3.616-88.589 22.464-13.684 57.173 4.799 83.89 35.797zM405.02 516.21c-25.187 29.502-39.212 83.31-20.838 100.64 17.568 13.464 64.729 11.582 99.566-36.756 25.296-32.465 16.82-86.682 2.37-101.08-21.463-16.602-52.276 4.645-81.098 37.188z"),I(r,"id","raspberry"),I(r,"width","25"),I(r,"height","25"),I(r,"patternTransform","rotate(15)"),I(r,"patternUnits","userSpaceOnUse"),I(r,"viewBox","0 0 1000 1000"),pd(t,l)},m(u,c){ie(u,t,c),b(t,n),b(n,r),b(r,i),b(r,s),b(r,a)},p(u,[c]){pd(t,l=M$(o,[{xmlns:"http://www.w3.org/2000/svg"},{width:"0"},{height:"0"},c&1&&u[0]]))},i:us,o:us,d(u){u&&S(t)}}}function y5e(e,t,n){return e.$$set=r=>{n(0,t=ka(ka({},t),gd(r)))},t=gd(t),[t]}let v5e=class extends Pc{constructor(t){super(),Ic(this,t,y5e,m5e,Lc,{})}};function b5e(e){let t,n,r,i,s=[{xmlns:"http://www.w3.org/2000/svg"},{width:"0"},{height:"0"},e[0]],a={};for(let o=0;o<s.length;o+=1)a=ka(a,s[o]);return{c(){t=qe("svg"),n=qe("defs"),r=qe("pattern"),i=qe("path"),this.h()},l(o){t=Ge(o,"svg",{xmlns:!0,width:!0,height:!0});var l=C(t);n=Ge(l,"defs",{});var u=C(n);r=Ge(u,"pattern",{id:!0,width:!0,height:!0,patternTransform:!0,patternUnits:!0,viewBox:!0});var c=C(r);i=Ge(c,"path",{fill:!0,"fill-rule":!0,d:!0}),C(i).forEach(S),c.forEach(S),u.forEach(S),l.forEach(S),this.h()},h(){I(i,"fill","var(--color-background)"),I(i,"fill-rule","evenodd"),I(i,"d","M1557.9-.5v1030.28H581.99V908.81c20.64 2.29 41.29 3.44 63.07 3.44 225.92 0 624.43-115.24 795.3-258.58-25.23-25.22-147.37-83.13-177.18-107.21-180.05 154.8-365.82 286.09-622.7 286.09-19.5 0-39.57-1.72-59.06-4.01v-86c23.51 4.01 47.02 6.31 71.1 6.31 275.8 0 540.71-322.22 540.71-322.22s-231.08-302.14-584.86-290.1l-27.53 1.72V-.5h977.06ZM608.37 212.78c254.58-8.03 421.44 219.01 421.44 219.01S849.76 681.77 656.53 681.77c-25.8 0-51.03-4.02-75.11-12.04V387.65c99.19 12.04 119.26 55.61 178.32 154.8L892.2 431.22s-96.91-126.71-259.75-126.71c-17.2-.57-34.4.58-51.61 2.3v-92.84C299.69 236 159.4 443.26 159.4 443.26s107.23 346.29 421.44 385.28v80.27C152.52 868.67 0 427.21 0 427.21s269.49-263.74 581.42-288.96v75.64c8.98-.56 17.96-1.11 26.95-1.11Zm-27.53 530.33c-237.38-42.42-303.32-289.53-303.32-289.53s114.11-126.13 303.32-146.77v80.26h-.57c-99.2-12.04-177.18 80.84-177.18 80.84s44.15 156.52 177.75 201.82v73.38Z"),I(r,"id","nvidia"),I(r,"width","25"),I(r,"height","25"),I(r,"patternTransform","rotate(15)"),I(r,"patternUnits","userSpaceOnUse"),I(r,"viewBox","0 0 2500 2000"),pd(t,a)},m(o,l){ie(o,t,l),b(t,n),b(n,r),b(r,i)},p(o,[l]){pd(t,a=M$(s,[{xmlns:"http://www.w3.org/2000/svg"},{width:"0"},{height:"0"},l&1&&o[0]]))},i:us,o:us,d(o){o&&S(t)}}}function x5e(e,t,n){return e.$$set=r=>{n(0,t=ka(ka({},t),gd(r)))},t=gd(t),[t]}let w5e=class extends Pc{constructor(t){super(),Ic(this,t,x5e,b5e,Lc,{})}};function _5e(e){let t,n,r,i,s=[{xmlns:"http://www.w3.org/2000/svg"},{width:"10"},{height:"10"},e[0]],a={};for(let o=0;o<s.length;o+=1)a=ka(a,s[o]);return{c(){t=qe("svg"),n=qe("defs"),r=qe("pattern"),i=qe("image"),this.h()},l(o){t=Ge(o,"svg",{xmlns:!0,width:!0,height:!0});var l=C(t);n=Ge(l,"defs",{});var u=C(n);r=Ge(u,"pattern",{id:!0,width:!0,height:!0,patternUnits:!0});var c=C(r);i=Ge(c,"image",{width:!0,height:!0,href:!0}),C(i).forEach(S),c.forEach(S),u.forEach(S),l.forEach(S),this.h()},h(){I(i,"width","10"),I(i,"height","10"),I(i,"href","data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScvPgogIDxwYXRoIGQ9J00tMSwxIGwyLC0yCiAgICAgICAgICAgTTAsMTAgbDEwLC0xMAogICAgICAgICAgIE05LDExIGwyLC0yJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzEnLz4KPC9zdmc+Cg=="),I(r,"id","diagonal-stripe-1"),I(r,"width","10"),I(r,"height","10"),I(r,"patternUnits","userSpaceOnUse"),pd(t,a)},m(o,l){ie(o,t,l),b(t,n),b(n,r),b(r,i)},p(o,[l]){pd(t,a=M$(s,[{xmlns:"http://www.w3.org/2000/svg"},{width:"10"},{height:"10"},l&1&&o[0]]))},i:us,o:us,d(o){o&&S(t)}}}function E5e(e,t,n){return e.$$set=r=>{n(0,t=ka(ka({},t),gd(r)))},t=gd(t),[t]}class k5e extends Pc{constructor(t){super(),Ic(this,t,E5e,_5e,Lc,{})}}const S5e=[{name:"Jetson Nano",price:149,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[128,235.8,14.74]},{name:"ODROID-N2L",price:130,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[96,157.4,6.8]},{name:"Orange Pi 5",price:149,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[64,610.6,48]},{name:"Quartz64B",price:80,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[32,54.4,4.5]},{name:"Rock 5A",price:170,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[64,610.6,48]},{name:"Tinker Board 2",price:179,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[64,95.2,10.4]},{name:"UDOO BOLT V3",price:437,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[192,384.4,4.004]},{name:"UDOO VISION X5",price:349,spec:["Shading Units","GFLOP/s (32-bit)","GPixel/s"],value:[96,144,1.5]}],A5e={$schema:"https://vega.github.io/schema/vega/v5.json",description:"SBC GPU Specifications",autosize:{type:"fit-x",contains:"padding"},background:null,padding:5,height:350,title:{text:"Relative Specifications per Price",subtitle:"more is better",offset:30},config:{axis:{gridColor:"var(--color-line-secondary)"},style:{"guide-label":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"guide-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-subtitle":{font:"'JetBrains Mono', monospace",fontStyle:"italic",fill:"var(--color-text-primary)"}},text:{font:"'JetBrains Mono', monospace"}},legends:[{fill:"color",symbolType:"square",title:"Spec"}],signals:[{name:"width",init:"isFinite(containerSize()[0]) ? containerSize()[0] : 200",on:[{update:"isFinite(containerSize()[0]) ? containerSize()[0] : 200",events:"window:resize"}]}],data:[{name:"table",values:S5e},{name:"data",source:"table",transform:[{type:"collect",sort:{field:"price",order:"descending"}},{type:"flatten",fields:["spec","value"]},{type:"formula",expr:"datum.value/datum.price",as:"perdollar"},{type:"joinaggregate",groupby:["spec"],ops:["max"],fields:["perdollar"],as:["perdollarmax"]},{type:"formula",expr:"datum.perdollar/datum.perdollarmax",as:"perdollarpercent"}]}],scales:[{name:"yscale",type:"band",domain:{data:"table",field:"name"},range:"height"},{name:"pricescale",type:"linear",domain:{data:"table",field:"price"},range:[0,{signal:"max(30, 0.1 * width)"}],round:!0,zero:!0,nice:!0},{name:"xscale",type:"linear",domain:{data:"data",field:"perdollarpercent"},range:[{signal:"max(30, 0.1 * width) + 15"},{signal:"width"}],round:!0,zero:!0,nice:!0},{name:"pricecolor",type:"linear",domain:{data:"table",field:"price"},range:{scheme:"goldred"}},{name:"color",type:"ordinal",domain:{data:"data",field:"spec"},range:{scheme:"category20c"}}],axes:[{scale:"yscale",orient:"left",ticks:!1,grid:!0,gridDash:5,bandPosition:-.1,labelFontSize:11,labelFontWeight:"bold",labelPadding:10},{scale:"pricescale",orient:"bottom",grid:!0,labelOverlap:!0,labelSeparation:10,tickCount:4,title:"$ Price",format:"$d"},{scale:"xscale",orient:"bottom",grid:!0,labelOverlap:!0,labelSeparation:10,labelBound:!0,tickMinStep:.1,title:"% of Spec / Price",format:"%"}],marks:[{type:"rect",from:{data:"table"},encode:{enter:{y:{scale:"yscale",field:"name"},height:{scale:"yscale",band:.8},x:{scale:"pricescale",field:"price"},x2:{scale:"pricescale",value:0},fill:{scale:"pricecolor",field:"price"}}}},{type:"group",from:{facet:{data:"data",name:"facet",groupby:"name"}},encode:{enter:{y:{scale:"yscale",field:"name"}}},scales:[{name:"spec",type:"band",range:"height",domain:{data:"facet",field:"spec"}}],signals:[{name:"height",update:"0.8*bandwidth('yscale')"}],marks:[{name:"bars",from:{data:"facet"},type:"rect",encode:{enter:{y:{scale:"spec",field:"spec"},height:{scale:"spec",band:1},x:{scale:"xscale",field:"perdollarpercent"},x2:{scale:"xscale",value:0},fill:{scale:"color",field:"spec"}}}},{type:"text",from:{data:"bars"},encode:{enter:{x:{field:"x2"},dx:[{test:"datum.datum.perdollarpercent > 0.9",value:-4},{value:4}],y:{field:"y"},text:{field:"datum.value"},fill:[{test:"datum.datum.perdollarpercent > 0.9 && contrast('white', datum.fill) > contrast('black', datum.fill)",value:"white"},{test:"datum.datum.perdollarpercent > 0.9",value:"black"},{value:"var(--color-text-emphasis)"}],align:[{test:"datum.datum.perdollarpercent > 0.9",value:"right"},{value:"left"}],baseline:{value:"top"}}}}]}]},$5e=[{name:"AMD Radeon™ Vega 3",score:4406},{name:"NVIDIA Tegra X1 (rev B)",score:4312},{name:"Mali-G610 MC4",score:3522},{name:"Mali-G52",score:1006},{name:"Mali-T860",score:67},{name:"Intel® HD Graphics 510",score:2630},{name:"VideoCore VI (V3D-620)",score:76}],C5e={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Geekbench Vulkan Benchmark",background:null,width:"container",height:150,config:{axis:{gridColor:"var(--color-line-secondary)"},style:{"guide-label":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"guide-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-subtitle":{font:"'JetBrains Mono', monospace",fontStyle:"italic",fill:"var(--color-text-primary)"}},text:{font:"'JetBrains Mono', monospace",fontSize:11},view:{stroke:null}},title:{text:"Geekbench Vulkan Benchmark",subtitle:"more is better",offset:20},data:{name:"scores",values:$5e},encoding:{y:{field:"name",type:"nominal",sort:"-x",title:null,axis:{ticks:!1,labelPadding:8,labelFontWeight:"bold",labelFontSize:11}},x:{field:"score",type:"quantitative",title:null,axis:{labelSeparation:10,labelFlush:!1}}},layer:[{mark:{type:"bar",height:{band:.75}},encoding:{color:{field:"score",type:"quantitative",scale:{domainMin:0},legend:{title:"Score",titleOrient:"bottom",gradientLength:100,padding:20,labelOffset:10,tickCount:1}}}},{mark:{type:"text",aria:!1,align:{expr:"datum.score < 1500 ? 'left' : 'right'"},dx:{expr:"datum.score < 1500 ? 4 : -4"}},encoding:{text:{field:"score",type:"quantitative"},color:{condition:{test:{field:"score",gt:2e3},value:"white"},value:"var(--color-text-emphasis)"}}}]},M5e=[{name:"Intel HD Graphics 510",score:43274},{name:"ARM Mali-G52 MP2",score:25142},{name:"ARM Mali-G52 MP6",score:46944},{name:"ARM Mali-T860 MP2",score:9806.5},{name:"NVIDIA Tegra X1 Maxwell",score:57697},{name:"AMD Radeon RX Vega 3",score:80755}],T5e={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"3DMark Benchmark",background:null,width:"container",height:150,config:{axis:{gridColor:"var(--color-line-secondary)"},style:{"guide-label":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"guide-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-subtitle":{font:"'JetBrains Mono', monospace",fontStyle:"italic",fill:"var(--color-text-primary)"}},text:{font:"'JetBrains Mono', monospace",fontSize:11},view:{stroke:null}},title:{text:"3DMark Ice Storm GPU Benchmark",subtitle:"more is better",offset:20},data:{name:"scores",values:M5e},encoding:{y:{field:"name",type:"nominal",sort:"-x",title:null,axis:{ticks:!1,labelPadding:8,labelFontWeight:"bold",labelFontSize:11}},x:{field:"score",type:"quantitative",title:null,axis:{labelSeparation:10,labelFlush:!1}}},layer:[{mark:{type:"bar",height:{band:.75}},encoding:{color:{field:"score",type:"quantitative",scale:{domainMin:0},legend:{title:"Score",titleOrient:"bottom",gradientLength:100,padding:16,labelOffset:10,tickCount:1}}}},{mark:{type:"text",aria:!1,align:{expr:"datum.score < 30000 ? 'left' : 'right'"},dx:{expr:"datum.score < 30000 ? 4 : -4"}},encoding:{text:{field:"score",type:"quantitative"},color:{condition:{test:{field:"score",gt:3e4},value:"white"},value:"var(--color-text-emphasis)"}}}]},N5e=[{category:"Raspberry Pi 4",shader:"2d_cloud",fps:.98},{category:"Jetson Nano",shader:"2d_cloud",fps:11.9},{category:["Raspberry Pi 4","(async)"],shader:"2d_cloud",fps:.99},{category:["Jetson Nano","(async)"],shader:"2d_cloud",fps:12.8},{category:"Raspberry Pi 4",shader:"animated_triangle_grid_wave",fps:4.6},{category:["Raspberry Pi 4","(async)"],shader:"animated_triangle_grid_wave",fps:4.88},{category:"Jetson Nano",shader:"animated_triangle_grid_wave",fps:29.9},{category:["Jetson Nano","(async)"],shader:"animated_triangle_grid_wave",fps:56.7},{category:"Raspberry Pi 4",shader:"blobs",fps:14.9},{category:["Raspberry Pi 4","(async)"],shader:"blobs",fps:16.35},{category:"Jetson Nano",shader:"blobs",fps:29.9},{category:["Jetson Nano","(async)"],shader:"blobs",fps:77.8},{category:"Raspberry Pi 4",shader:"bokeh_parallax",fps:10.1},{category:["Raspberry Pi 4","(async)"],shader:"bokeh_parallax",fps:12.11},{category:"Jetson Nano",shader:"bokeh_parallax",fps:29.9},{category:["Jetson Nano","(async)"],shader:"bokeh_parallax",fps:73.1},{category:"Raspberry Pi 4",shader:"breathing_spirals",fps:29.5},{category:["Raspberry Pi 4","(async)"],shader:"breathing_spirals",fps:35.42},{category:"Jetson Nano",shader:"breathing_spirals",fps:29.9},{category:["Jetson Nano","(async)"],shader:"breathing_spirals",fps:81.2},{category:"Raspberry Pi 4",shader:"clockwork_spacetime",fps:15.3},{category:["Raspberry Pi 4","(async)"],shader:"clockwork_spacetime",fps:20.88},{category:"Jetson Nano",shader:"clockwork_spacetime",fps:29.9},{category:["Jetson Nano","(async)"],shader:"clockwork_spacetime",fps:71.3},{category:"Raspberry Pi 4",shader:"cloudy_crystal",fps:.44},{category:["Raspberry Pi 4","(async)"],shader:"cloudy_crystal",fps:.44},{category:"Jetson Nano",shader:"cloudy_crystal",fps:7.4},{category:["Jetson Nano","(async)"],shader:"cloudy_crystal",fps:7.8},{category:"Raspberry Pi 4",shader:"complex_field_lines",fps:14.98},{category:["Raspberry Pi 4","(async)"],shader:"complex_field_lines",fps:17.88},{category:"Jetson Nano",shader:"complex_field_lines",fps:29.9},{category:["Jetson Nano","(async)"],shader:"complex_field_lines",fps:40.2},{category:"Raspberry Pi 4",shader:"costal_landscape",fps:2.39},{category:["Raspberry Pi 4","(async)"],shader:"costal_landscape",fps:2.45},{category:"Jetson Nano",shader:"costal_landscape",fps:19.9},{category:["Jetson Nano","(async)"],shader:"costal_landscape",fps:27.3},{category:"Raspberry Pi 4",shader:"creation_by_silexars",fps:29.9},{category:["Raspberry Pi 4","(async)"],shader:"creation_by_silexars",fps:46.6},{category:"Jetson Nano",shader:"creation_by_silexars",fps:29.9},{category:["Jetson Nano","(async)"],shader:"creation_by_silexars",fps:67.3},{category:"Raspberry Pi 4",shader:"cross_galactic_ocean",fps:.32},{category:["Raspberry Pi 4","(async)"],shader:"cross_galactic_ocean",fps:.32},{category:"Jetson Nano",shader:"cross_galactic_ocean",fps:7.8},{category:["Jetson Nano","(async)"],shader:"cross_galactic_ocean",fps:8.8},{category:"Raspberry Pi 4",shader:"cyber_fuji_2020",fps:15},{category:["Raspberry Pi 4","(async)"],shader:"cyber_fuji_2020",fps:18.8},{category:"Jetson Nano",shader:"cyber_fuji_2020",fps:29.9},{category:["Jetson Nano","(async)"],shader:"cyber_fuji_2020",fps:78.6},{category:"Raspberry Pi 4",shader:"duality2",fps:20},{category:["Raspberry Pi 4","(async)"],shader:"duality2",fps:26.17},{category:"Jetson Nano",shader:"duality2",fps:29.9},{category:["Jetson Nano","(async)"],shader:"duality2",fps:71.2},{category:"Raspberry Pi 4",shader:"extruded_truchet_pattern",fps:1.26},{category:["Raspberry Pi 4","(async)"],shader:"extruded_truchet_pattern",fps:1.28},{category:"Jetson Nano",shader:"extruded_truchet_pattern",fps:12},{category:["Jetson Nano","(async)"],shader:"extruded_truchet_pattern",fps:15.1},{category:"Raspberry Pi 4",shader:"figure_eight_knot",fps:.12},{category:["Raspberry Pi 4","(async)"],shader:"figure_eight_knot",fps:.12},{category:"Jetson Nano",shader:"figure_eight_knot",fps:2.15},{category:["Jetson Nano","(async)"],shader:"figure_eight_knot",fps:2.16},{category:"Raspberry Pi 4",shader:"flower_of_life_rgb",fps:6.64},{category:["Raspberry Pi 4","(async)"],shader:"flower_of_life_rgb",fps:7.17},{category:"Jetson Nano",shader:"flower_of_life_rgb",fps:29.9},{category:["Jetson Nano","(async)"],shader:"flower_of_life_rgb",fps:76.1},{category:"Raspberry Pi 4",shader:"glossy_cubes",fps:.14},{category:["Raspberry Pi 4","(async)"],shader:"glossy_cubes",fps:.14},{category:"Jetson Nano",shader:"glossy_cubes",fps:2.6},{category:["Jetson Nano","(async)"],shader:"glossy_cubes",fps:2.67},{category:"Raspberry Pi 4",shader:"grid_blend",fps:20},{category:["Raspberry Pi 4","(async)"],shader:"grid_blend",fps:27.02},{category:"Jetson Nano",shader:"grid_blend",fps:29.9},{category:["Jetson Nano","(async)"],shader:"grid_blend",fps:69.2},{category:"Raspberry Pi 4",shader:"gyroidal_morphoma",fps:.38},{category:["Raspberry Pi 4","(async)"],shader:"gyroidal_morphoma",fps:.38},{category:"Jetson Nano",shader:"gyroidal_morphoma",fps:7.5},{category:["Jetson Nano","(async)"],shader:"gyroidal_morphoma",fps:8.4},{category:"Raspberry Pi 4",shader:"hexagon_triangle_wedge_pattern",fps:5.9},{category:["Raspberry Pi 4","(async)"],shader:"hexagon_triangle_wedge_pattern",fps:6.37},{category:"Jetson Nano",shader:"hexagon_triangle_wedge_pattern",fps:29.9},{category:["Jetson Nano","(async)"],shader:"hexagon_triangle_wedge_pattern",fps:35},{category:"Raspberry Pi 4",shader:"hexagonal_maze_flow",fps:8.6},{category:["Raspberry Pi 4","(async)"],shader:"hexagonal_maze_flow",fps:10.3},{category:"Jetson Nano",shader:"hexagonal_maze_flow",fps:29.9},{category:["Jetson Nano","(async)"],shader:"hexagonal_maze_flow",fps:68.6},{category:"Raspberry Pi 4",shader:"hilbert_curve_animation",fps:2.84},{category:["Raspberry Pi 4","(async)"],shader:"hilbert_curve_animation",fps:2.89},{category:"Jetson Nano",shader:"hilbert_curve_animation",fps:29.9},{category:["Jetson Nano","(async)"],shader:"hilbert_curve_animation",fps:41.6},{category:"Raspberry Pi 4",shader:"hyperbolic_poincare_weave",fps:1.33},{category:["Raspberry Pi 4","(async)"],shader:"hyperbolic_poincare_weave",fps:1.36},{category:"Jetson Nano",shader:"hyperbolic_poincare_weave",fps:15},{category:["Jetson Nano","(async)"],shader:"hyperbolic_poincare_weave",fps:16.2},{category:"Raspberry Pi 4",shader:"infinite_gamecube",fps:3.52},{category:["Raspberry Pi 4","(async)"],shader:"infinite_gamecube",fps:3.68},{category:"Jetson Nano",shader:"infinite_gamecube",fps:29.9},{category:["Jetson Nano","(async)"],shader:"infinite_gamecube",fps:41.9},{category:"Raspberry Pi 4",shader:"linear_to_hilbert",fps:20.1},{category:["Raspberry Pi 4","(async)"],shader:"linear_to_hilbert",fps:28.7},{category:"Jetson Nano",shader:"linear_to_hilbert",fps:29.9},{category:["Jetson Nano","(async)"],shader:"linear_to_hilbert",fps:81.4},{category:"Raspberry Pi 4",shader:"lonely_waters",fps:.59},{category:["Raspberry Pi 4","(async)"],shader:"lonely_waters",fps:.6},{category:"Jetson Nano",shader:"lonely_waters",fps:13.5},{category:["Jetson Nano","(async)"],shader:"lonely_waters",fps:15.5},{category:"Raspberry Pi 4",shader:"maze_lattice",fps:.78},{category:["Raspberry Pi 4","(async)"],shader:"maze_lattice",fps:.78},{category:"Jetson Nano",shader:"maze_lattice",fps:7.6},{category:["Jetson Nano","(async)"],shader:"maze_lattice",fps:8.4},{category:"Raspberry Pi 4",shader:"menger_sponge_tunnel",fps:3.38},{category:["Raspberry Pi 4","(async)"],shader:"menger_sponge_tunnel",fps:3.45},{category:"Jetson Nano",shader:"menger_sponge_tunnel",fps:19.9},{category:["Jetson Nano","(async)"],shader:"menger_sponge_tunnel",fps:25.3},{category:"Raspberry Pi 4",shader:"nautilus_shell",fps:.25},{category:["Raspberry Pi 4","(async)"],shader:"nautilus_shell",fps:.25},{category:"Jetson Nano",shader:"nautilus_shell",fps:3.1},{category:["Jetson Nano","(async)"],shader:"nautilus_shell",fps:3.2},{category:"Raspberry Pi 4",shader:"odd_structures",fps:2.22},{category:["Raspberry Pi 4","(async)"],shader:"odd_structures",fps:2.27},{category:"Jetson Nano",shader:"odd_structures",fps:15},{category:["Jetson Nano","(async)"],shader:"odd_structures",fps:19.4},{category:"Raspberry Pi 4",shader:"oklab_based_tonemapper",fps:15},{category:["Raspberry Pi 4","(async)"],shader:"oklab_based_tonemapper",fps:19.79},{category:"Jetson Nano",shader:"oklab_based_tonemapper",fps:29.9},{category:["Jetson Nano","(async)"],shader:"oklab_based_tonemapper",fps:67.8},{category:"Raspberry Pi 4",shader:"old_skool_3d_driving",fps:30},{category:["Raspberry Pi 4","(async)"],shader:"old_skool_3d_driving",fps:64.36},{category:"Jetson Nano",shader:"old_skool_3d_driving",fps:30},{category:["Jetson Nano","(async)"],shader:"old_skool_3d_driving",fps:93.6},{category:"Raspberry Pi 4",shader:"orbital_2d",fps:1.61},{category:["Raspberry Pi 4","(async)"],shader:"orbital_2d",fps:1.65},{category:"Jetson Nano",shader:"orbital_2d",fps:19.9},{category:["Jetson Nano","(async)"],shader:"orbital_2d",fps:21.9},{category:"Raspberry Pi 4",shader:"planetary_gears",fps:1.56},{category:["Raspberry Pi 4","(async)"],shader:"planetary_gears",fps:1.58},{category:"Jetson Nano",shader:"planetary_gears",fps:12.2},{category:["Jetson Nano","(async)"],shader:"planetary_gears",fps:15.6},{category:"Raspberry Pi 4",shader:"quasi_infinite_zoom_voronoi",fps:.74},{category:["Raspberry Pi 4","(async)"],shader:"quasi_infinite_zoom_voronoi",fps:.75},{category:"Jetson Nano",shader:"quasi_infinite_zoom_voronoi",fps:12},{category:["Jetson Nano","(async)"],shader:"quasi_infinite_zoom_voronoi",fps:14.27},{category:"Raspberry Pi 4",shader:"rainbow_smith_cells",fps:6},{category:["Raspberry Pi 4","(async)"],shader:"rainbow_smith_cells",fps:6.65},{category:"Jetson Nano",shader:"rainbow_smith_cells",fps:29.9},{category:["Jetson Nano","(async)"],shader:"rainbow_smith_cells",fps:59.9},{category:"Raspberry Pi 4",shader:"ring_twister",fps:9.72},{category:["Raspberry Pi 4","(async)"],shader:"ring_twister",fps:10.4},{category:"Jetson Nano",shader:"ring_twister",fps:30},{category:["Jetson Nano","(async)"],shader:"ring_twister",fps:63.5},{category:"Raspberry Pi 4",shader:"saturday_torus",fps:8.56},{category:["Raspberry Pi 4","(async)"],shader:"saturday_torus",fps:9.27},{category:"Jetson Nano",shader:"saturday_torus",fps:29.9},{category:["Jetson Nano","(async)"],shader:"saturday_torus",fps:67.5},{category:"Raspberry Pi 4",shader:"simplex_truchet_weave",fps:6.66},{category:["Raspberry Pi 4","(async)"],shader:"simplex_truchet_weave",fps:7.4},{category:"Jetson Nano",shader:"simplex_truchet_weave",fps:29.9},{category:["Jetson Nano","(async)"],shader:"simplex_truchet_weave",fps:61.9},{category:"Raspberry Pi 4",shader:"smooth_contours",fps:19.9},{category:["Raspberry Pi 4","(async)"],shader:"smooth_contours",fps:29.4},{category:"Jetson Nano",shader:"smooth_contours",fps:29.9},{category:["Jetson Nano","(async)"],shader:"smooth_contours",fps:93.8},{category:"Raspberry Pi 4",shader:"square_truchet_flow",fps:14.96},{category:["Raspberry Pi 4","(async)"],shader:"square_truchet_flow",fps:16.73},{category:"Jetson Nano",shader:"square_truchet_flow",fps:29.9},{category:["Jetson Nano","(async)"],shader:"square_truchet_flow",fps:73.4},{category:"Raspberry Pi 4",shader:"stars_and_galaxy",fps:2.5},{category:["Raspberry Pi 4","(async)"],shader:"stars_and_galaxy",fps:2.59},{category:"Jetson Nano",shader:"stars_and_galaxy",fps:29.9},{category:["Jetson Nano","(async)"],shader:"stars_and_galaxy",fps:33.8},{category:"Raspberry Pi 4",shader:"stripey_torus_interior",fps:2.62},{category:["Raspberry Pi 4","(async)"],shader:"stripey_torus_interior",fps:2.72},{category:"Jetson Nano",shader:"stripey_torus_interior",fps:29.9},{category:["Jetson Nano","(async)"],shader:"stripey_torus_interior",fps:45.3},{category:"Raspberry Pi 4",shader:"subdivided_grid_truchet_parttern",fps:15},{category:["Raspberry Pi 4","(async)"],shader:"subdivided_grid_truchet_parttern",fps:18.78},{category:"Jetson Nano",shader:"subdivided_grid_truchet_parttern",fps:29.9},{category:["Jetson Nano","(async)"],shader:"subdivided_grid_truchet_parttern",fps:76.7},{category:"Raspberry Pi 4",shader:"surveillance_mosaic",fps:2.71},{category:["Raspberry Pi 4","(async)"],shader:"surveillance_mosaic",fps:2.78},{category:"Jetson Nano",shader:"surveillance_mosaic",fps:29.9},{category:["Jetson Nano","(async)"],shader:"surveillance_mosaic",fps:41.3},{category:"Raspberry Pi 4",shader:"synthwave_road",fps:29.9},{category:["Raspberry Pi 4","(async)"],shader:"synthwave_road",fps:38.5},{category:"Jetson Nano",shader:"synthwave_road",fps:29.9},{category:["Jetson Nano","(async)"],shader:"synthwave_road",fps:68.2},{category:"Raspberry Pi 4",shader:"the_inversion_machine",fps:2.33},{category:["Raspberry Pi 4","(async)"],shader:"the_inversion_machine",fps:2.38},{category:"Jetson Nano",shader:"the_inversion_machine",fps:29.9},{category:["Jetson Nano","(async)"],shader:"the_inversion_machine",fps:33},{category:"Raspberry Pi 4",shader:"the_secret_place",fps:4},{category:["Raspberry Pi 4","(async)"],shader:"the_secret_place",fps:4.12},{category:"Jetson Nano",shader:"the_secret_place",fps:29.9},{category:["Jetson Nano","(async)"],shader:"the_secret_place",fps:37.2},{category:"Raspberry Pi 4",shader:"tilings",fps:11.97},{category:["Raspberry Pi 4","(async)"],shader:"tilings",fps:13.42},{category:"Jetson Nano",shader:"tilings",fps:29.9},{category:["Jetson Nano","(async)"],shader:"tilings",fps:63.2},{category:"Raspberry Pi 4",shader:"torus_loop",fps:3.45},{category:["Raspberry Pi 4","(async)"],shader:"torus_loop",fps:3.6},{category:"Jetson Nano",shader:"torus_loop",fps:29.9},{category:["Jetson Nano","(async)"],shader:"torus_loop",fps:42.8},{category:"Raspberry Pi 4",shader:"traced_minkowski_tube",fps:5.97},{category:["Raspberry Pi 4","(async)"],shader:"traced_minkowski_tube",fps:6.4},{category:"Jetson Nano",shader:"traced_minkowski_tube",fps:29.9},{category:["Jetson Nano","(async)"],shader:"traced_minkowski_tube",fps:52.3},{category:"Raspberry Pi 4",shader:"triangle_grid_contouring",fps:2.6},{category:["Raspberry Pi 4","(async)"],shader:"triangle_grid_contouring",fps:2.67},{category:"Jetson Nano",shader:"triangle_grid_contouring",fps:29.9},{category:["Jetson Nano","(async)"],shader:"triangle_grid_contouring",fps:36.5},{category:"Raspberry Pi 4",shader:"truchet_kaleidoscope",fps:3.02},{category:["Raspberry Pi 4","(async)"],shader:"truchet_kaleidoscope",fps:3.1},{category:"Jetson Nano",shader:"truchet_kaleidoscope",fps:29.9},{category:["Jetson Nano","(async)"],shader:"truchet_kaleidoscope",fps:48.2},{category:"Raspberry Pi 4",shader:"truchet_trip",fps:1.48},{category:["Raspberry Pi 4","(async)"],shader:"truchet_trip",fps:1.5},{category:"Jetson Nano",shader:"truchet_trip",fps:15},{category:["Jetson Nano","(async)"],shader:"truchet_trip",fps:16.9},{category:"Raspberry Pi 4",shader:"universe_within_314",fps:.84},{category:["Raspberry Pi 4","(async)"],shader:"universe_within_314",fps:.84},{category:"Jetson Nano",shader:"universe_within_314",fps:15},{category:["Jetson Nano","(async)"],shader:"universe_within_314",fps:16.4},{category:"Raspberry Pi 4",shader:"viscosity",fps:2.48},{category:["Raspberry Pi 4","(async)"],shader:"viscosity",fps:2.5},{category:"Jetson Nano",shader:"viscosity",fps:29.9},{category:["Jetson Nano","(async)"],shader:"viscosity",fps:37.6},{category:"Raspberry Pi 4",shader:"warping_boxes",fps:14.96},{category:["Raspberry Pi 4","(async)"],shader:"warping_boxes",fps:17.5},{category:"Jetson Nano",shader:"warping_boxes",fps:29.9},{category:["Jetson Nano","(async)"],shader:"warping_boxes",fps:64.6},{category:"Raspberry Pi 4",shader:"weaving_bridges",fps:11.8},{category:["Raspberry Pi 4","(async)"],shader:"weaving_bridges",fps:12.85},{category:"Jetson Nano",shader:"weaving_bridges",fps:29.9},{category:["Jetson Nano","(async)"],shader:"weaving_bridges",fps:62.7},{category:"Raspberry Pi 4",shader:"white_drops",fps:.73},{category:["Raspberry Pi 4","(async)"],shader:"white_drops",fps:.73},{category:"Jetson Nano",shader:"white_drops",fps:8.5},{category:["Jetson Nano","(async)"],shader:"white_drops",fps:9.8}],F5e={$schema:"https://vega.github.io/schema/vega/v5.json",description:"Benchmark",autosize:{type:"fit-x",contains:"padding"},background:null,padding:5,title:{text:"Distribution of Shadersᐩ FPS at Full HD Resolution",subtitle:"more is better",offset:20},config:{axis:{gridColor:"var(--color-line-secondary)"},style:{"guide-label":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"guide-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-title":{font:"'JetBrains Mono', monospace",fill:"var(--color-text-emphasis)"},"group-subtitle":{font:"'JetBrains Mono', monospace",fontStyle:"italic",fill:"var(--color-text-primary)"}},text:{font:"'JetBrains Mono', monospace",fontSize:11},view:{stroke:null}},data:[{name:"data",values:N5e},{name:"density",source:"data",transform:[{type:"kde",field:"fps",groupby:["category"],bandwidth:2}]},{name:"stats",source:"data",transform:[{type:"aggregate",groupby:["category"],fields:["fps","fps","fps"],ops:["q1","median","q3"],as:["q1","median","q3"]}]}],signals:[{name:"width",init:"isFinite(containerSize()[0]) ? containerSize()[0] : 200",on:[{update:"isFinite(containerSize()[0]) ? containerSize()[0] : 200",events:"window:resize"}]},{name:"plotWidth",value:200},{name:"height",update:"(plotWidth) * 2.6"}],scales:[{name:"layout",type:"band",range:"height",domain:{data:"data",field:"category"}},{name:"xscale",type:"linear",range:[0,{signal:"width"}],domain:{data:"density",field:"value"},round:!0,zero:!0,nice:!0},{name:"hscale",type:"linear",range:[0,{signal:"plotWidth"}],domain:{data:"density",field:"density"}},{name:"color",type:"ordinal",domain:{data:"data",field:"category"},range:["#e91e63","#76b900","#e91e63","#76b900"]},{name:"pattern",type:"ordinal",domain:{data:"data",field:"category"},range:["url(#raspberry)","url(#nvidia)","url(#raspberry)","url(#nvidia)"]},{name:"legend",type:"ordinal",domain:["Median","[25%,75%]"],range:["diamond","M -1 -1 C -0.346 -1.317 -0.102 -0.332 0.804 -0.447 C 1.267 -0.502 1.169 -1.516 1.995 -1.52 V 1.511 L -0.999 1.508 Z"]}],axes:[{scale:"xscale",orient:"bottom",grid:!0,labelOverlap:!0,labelSeparation:10,labelBound:!0,tickMinStep:.1,title:"FPS"},{scale:"layout",orient:"left",ticks:!1,grid:!0,gridDash:5,labelFontSize:11,labelFontWeight:"bold",labelPadding:10}],legends:[{type:"symbol",shape:"legend",orient:"top-right",direction:"horizontal",labelFontSize:14,labelBaseline:"top",labelOffset:15,symbolSize:300,symbolStrokeWidth:1,symbolDashOffset:1,columnPadding:20,encode:{symbols:{enter:{fill:[{test:"datum.value === 'Median'",value:"var(--color-text-emphasis)"},{value:"url(#diagonal-stripe-1)"}],fillOpacity:[{test:"datum.value === 'Median'",value:null},{value:.5}],stroke:[{test:"datum.value === 'Median'",value:null},{value:"var(--color-text-emphasis)"}],strokeDash:[{test:"datum.value === 'Median'",value:null},{value:[7,3]}],strokeOpacity:[{test:"datum.value === 'Median'",value:null},{value:.8}]}}}}],marks:[{type:"group",from:{facet:{data:"density",name:"violin",groupby:"category"}},data:[{name:"summary",source:"stats",transform:[{type:"filter",expr:"datum.category === parent.category"}]},{name:"quartiles",source:"violin",transform:[{type:"lookup",from:"summary",key:"category",fields:["category"],as:["obj"]},{type:"filter",expr:"datum.value >= datum.obj.q1 && datum.value <= datum.obj.q3"}]}],encode:{enter:{yc:{scale:"layout",field:"category",band:.5},height:{signal:"plotWidth"},width:{signal:"width"}}},marks:[{type:"area",from:{data:"violin"},encode:{enter:{interpolate:{value:"catmull-rom"},fill:{scale:"color",field:{parent:"category"}}},update:{x:{scale:"xscale",field:"value"},yc:{signal:"plotWidth / 2"},height:{scale:"hscale",field:"density"}}}},{type:"area",from:{data:"violin"},encode:{enter:{interpolate:{value:"catmull-rom"},fill:{scale:"pattern",field:{parent:"category"}},fillOpacity:{value:1}},update:{x:{scale:"xscale",field:"value"},yc:{signal:"plotWidth / 2"},height:{scale:"hscale",field:"density"}}}},{type:"area",from:{data:"quartiles"},encode:{enter:{interpolate:{value:"catmull-rom"},stroke:{value:"var(--color-text-emphasis)"},strokeWidth:{value:1},strokeOpacity:{value:.5},strokeDash:{value:[10,5]},strokeJoin:{value:"round"},fill:{value:"url(#diagonal-stripe-1)"},fillOpacity:{value:.25}},update:{x:{scale:"xscale",field:"value"},yc:{signal:"plotWidth / 2"},height:{scale:"hscale",field:"density"}}}},{type:"symbol",from:{data:"summary"},encode:{enter:{fill:{value:"var(--color-text-emphasis)"},size:{value:140},shape:{value:"diamond"}},update:{x:{scale:"xscale",field:"median"},yc:{signal:"plotWidth / 2"}}}},{type:"text",from:{data:"summary"},encode:{enter:{fill:{value:"var(--color-text-emphasis)"},text:{field:"median"},fontSize:{value:14},fontWeight:{value:"bold"},align:[{test:"datum.median < 10",value:"center"},{value:"center"}],baseline:{value:"bottom"}},update:{x:{scale:"xscale",field:"median"},y:{signal:"plotWidth / 2"},dy:{value:-5}}}}]}]};function D5e(e){let t,n,r,i,s,a,o,l,u=" ",c,f,d,h,p,g,m,y,v,x,_,w,k,E,A,z,D,R,j,O,L,P,B,U,q,X,ae,fe,we,Te,Se,je,Ln,fn,dn,ue,he,ke,Z,dt,Ne,gt,bt,lr,tf,tw,xh,nw,rw,wh,iw,sw,nf,aw,_h,ow,lw,xt,hn,Eh,dl,uw,cw,kh,fw,dw,Sh,hw,pw,Ah,gw,mw,$h,yw,vw,Ch,bw,xw,pn,Mh,hl,ww,_w,Th,Ew,kw,Nh,Sw,Aw,Fh,$w,Cw,Dh,Mw,Tw,Oh,Nw,Fw,gn,Rh,pl,Dw,Ow,Ph,Rw,Pw,Ih,Iw,Lw,Lh,zw,Bw,zh,Uw,jw,Bh,qw,Gw,mn,Uh,gl,Ww,Hw,jh,Vw,Jw,qh,Yw,Xw,Gh,Kw,Zw,Wh,Qw,e_,Hh,t_,n_,yn,Vh,ml,r_,i_,Jh,s_,a_,Yh,o_,l_,Xh,u_,c_,Kh,f_,d_,Zh,h_,p_,vn,Qh,yl,g_,m_,ep,y_,v_,tp,b_,x_,np,w_,__,rp,E_,k_,ip,S_,A_,bn,sp,vl,$_,C_,ap,M_,T_,op,N_,F_,lp,D_,O_,up,R_,P_,cp,I_,L_,xn,fp,bl,z_,B_,dp,U_,j_,hp,q_,G_,pp,W_,H_,gp,V_,J_,mp,Y_,X_,rf,yp,K_,Z_,Rm,Mr,Q_,xl,eE,tE,wl,nE,rE,_l,iE,sE,Pm,El,Im,Is,kl,sf,aE,oE,lE,af,uE,cE,Lm,of,fE,zm,Sl,Bm,Al,Um,oi,Ls,lf,dE,hE,$l,pE,gE,mE,uf,yE,vE,Cl,bE,xE,jm,wn,Ml,cf,wE,_E,EE,Tl,kE,SE,ff,AE,$E,Nl,CE,ME,Fl,TE,NE,qm,ur,Dl,df,FE,DE,OE,hf,RE,PE,Ol,IE,LE,vp,zE,BE,Gm,zn,UE,Rl,jE,qE,Pl,GE,WE,bp,HE,VE,Il,JE,YE,Wm,za,zs,Ba,xp,XE,Hm,cr,Ll,KE,ZE,zl,QE,ek,Bl,tk,nk,Ul,rk,ik,Vm,Ua,Bs,ja,wp,sk,Jm,qa,ak,jl,ok,lk,Ym,Bn,Us,ql,uk,Gl,ck,fk,dk,Xm,xY='<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ docker run </span><span style="color: var(--shiki-token-symbol)">--</span><span style="color: var(--shiki-color-text)">rm </span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">it </span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">v &#96;pwd&#96;:</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">workdir crops</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">poky:ubuntu</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-token-numeric)">22.04</span></span></code></pre>',Km,Wl,hk,Hl,pk,gk,mk,js,Vl,yk,Jl,vk,bk,xk,Zm,wY=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ git clone </span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">b kirkstone</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">l4t</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">r32.</span><span style="color: var(--shiki-token-numeric)">7.</span><span style="color: var(--shiki-color-text)">x https:</span><span style="color: var(--shiki-token-symbol)">//github.com/</span><span style="color: var(--shiki-color-text)">OE4T</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">tegra</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">demo</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">distro.git</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ cd tegra</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">demo</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">distro</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ git submodule update </span><span style="color: var(--shiki-token-symbol)">--</span><span style="color: var(--shiki-color-text)">init</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ . .</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">setup</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">env </span><span style="color: var(--shiki-token-symbol)">--</span><span style="color: var(--shiki-color-text)">machine jetson</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">nano</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">devkit</span></span></code></pre>`,Qm,Yl,wk,_p,_k,Ek,kk,Xl,Ep,Sk,Ak,e1,_Y=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ cat &lt;&lt;EOT &gt;&gt; conf</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">local.conf</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">DISTRO_FEATURES:remove </span><span style="color: var(--shiki-token-symbol)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;wayland&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">EXTRA_IMAGE_FEATURES </span><span style="color: var(--shiki-token-symbol)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;tools-sdk dev-pkgs debug-tweaks&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">IMAGE_INSTALL:append </span><span style="color: var(--shiki-token-symbol)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot; mesa tegra-udrm-gbm tegra-udrm-probeconf egl-gbm&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">CORE_IMAGE_BASE_INSTALL:remove </span><span style="color: var(--shiki-token-symbol)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;packagegroup-demo-egltests&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment); font-style: italic"># Tools needed to build kms-glsl</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">CORE_IMAGE_EXTRA_INSTALL </span><span style="color: var(--shiki-token-symbol)">+=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;git&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">CORE_IMAGE_EXTRA_INSTALL </span><span style="color: var(--shiki-token-symbol)">+=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;make&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">CORE_IMAGE_EXTRA_INSTALL </span><span style="color: var(--shiki-token-symbol)">+=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;gcc&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">CORE_IMAGE_EXTRA_INSTALL </span><span style="color: var(--shiki-token-symbol)">+=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">&quot;vim&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">EOT</span></span></code></pre>`,$k,Kl,kp,Ck,Mk,t1,EY='<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ bitbake demo</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">image</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">egl</span></span></code></pre>',Tk,Zl,Sp,Nk,Fk,n1,kY=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ cp tmp</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">deploy</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">images</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">jetson</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">nano</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">devkit</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">demo</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">image</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">egl</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">jetson</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">nano</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">devkit.tegraflash.tar.gz </span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">workdir</span><span style="color: var(--shiki-token-symbol)">/</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ </span><span style="color: var(--shiki-token-keyword)">exit</span></span></code></pre>`,r1,Ga,qs,Wa,Ap,Dk,i1,pf,Ok,s1,Hi,Ql,eu,Rk,tu,Pk,Ik,Lk,nu,zk,ru,$p,Bk,Uk,a1,SY=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ lsusb </span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">d </span><span style="color: var(--shiki-token-numeric)">0955</span><span style="color: var(--shiki-color-text)">:</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">Bus </span><span style="color: var(--shiki-token-numeric)">011</span><span style="color: var(--shiki-color-text)"> Device </span><span style="color: var(--shiki-token-numeric)">002</span><span style="color: var(--shiki-color-text)">: ID </span><span style="color: var(--shiki-token-numeric)">0955</span><span style="color: var(--shiki-color-text)">:7f21 NVIDIA Corp. APX</span></span></code></pre>`,jk,iu,Cp,qk,Gk,o1,AY='<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ tar </span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">xf demo</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">image</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">egl</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">jetson</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">nano</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">devkit.tegraflash.tar.gz</span></span></code></pre>',l1,su,au,Mp,Wk,Hk,u1,$Y='<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ sudo .</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">doflash.sh</span></span></code></pre>',c1,Ha,Gs,Va,Tp,Vk,f1,Vi,Jk,Np,Yk,Xk,ou,Kk,Zk,d1,Ja,lu,Fp,Qk,e3,h1,CY=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ git clone https:</span><span style="color: var(--shiki-token-symbol)">//github.com/</span><span style="color: var(--shiki-color-text)">astefanutti</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">kms</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">glsl.git</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ cd kms</span><span style="color: var(--shiki-token-symbol)">-</span><span style="color: var(--shiki-color-text)">glsl</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">$ make</span></span></code></pre>`,t3,uu,Dp,n3,r3,p1,MY=`<pre class="shiki   language-ps1"><code tabindex="0"><span class="line"><span style="color: var(--shiki-color-text)">$ .</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">glsl examples</span><span style="color: var(--shiki-token-symbol)">/</span><span style="color: var(--shiki-color-text)">costal_landscape.glsl</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">Using display </span><span style="color: var(--shiki-token-numeric)">0x55aadc1320</span><span style="color: var(--shiki-color-text)"> with EGL version </span><span style="color: var(--shiki-token-numeric)">1.5</span></span>
<span class="line"><span style="color: var(--shiki-token-symbol)">===================================</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">EGL information:</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  version: </span><span style="color: var(--shiki-token-string)">&quot;1.5&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  vendor: </span><span style="color: var(--shiki-token-string)">&quot;NVIDIA&quot;</span></span>
<span class="line"><span style="color: var(--shiki-token-symbol)">===================================</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">OpenGL ES </span><span style="color: var(--shiki-token-numeric)">2.</span><span style="color: var(--shiki-color-text)">x information:</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  version: </span><span style="color: var(--shiki-token-string)">&quot;OpenGL ES 3.2 NVIDIA 32.7.3&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  shading language version: </span><span style="color: var(--shiki-token-string)">&quot;OpenGL ES GLSL ES 3.20&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  vendor: </span><span style="color: var(--shiki-token-string)">&quot;NVIDIA Corporation&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  renderer: </span><span style="color: var(--shiki-token-string)">&quot;NVIDIA Tegra X1 (nvgpu)/integrated&quot;</span></span>
<span class="line"><span style="color: var(--shiki-token-symbol)">===================================</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">Using GLSL version directive: </span><span style="color: var(--shiki-token-comment); font-style: italic">#version 320 es</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">Rendered </span><span style="color: var(--shiki-token-numeric)">41</span><span style="color: var(--shiki-color-text)"> frames </span><span style="color: var(--shiki-token-keyword)">in</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-numeric)">2.049823</span><span style="color: var(--shiki-color-text)"> sec (</span><span style="color: var(--shiki-token-numeric)">20.001726</span><span style="color: var(--shiki-color-text)"> fps)</span></span></code></pre>`,g1,Ya,i3,cu,s3,a3,m1,Xa,Ws,Ka,Op,o3,y1,gf,l3,v1,mf,fu,wt,li,yf,u3,c3,du,f3,d3,h3,hu,pu,vf,p3,g3,m3,bf,y3,v3,Rp,b3,x3,Pp,w3,_3,xf,E3,k3,Ip,S3,A3,Lp,$3,C3,M3,b1,TY=`<pre class="shiki  liquid language-glsl"><code tabindex="0"><span class="line"><span style="color: var(--shiki-token-keyword)">#ifdef</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">GL_FRAGMENT_PRECISION_HIGH</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">precision highp </span><span style="color: var(--shiki-token-keyword)">float</span><span style="color: var(--shiki-token-punctuation)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">#else</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">precision mediump </span><span style="color: var(--shiki-token-keyword)">float</span><span style="color: var(--shiki-token-punctuation)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">#endif</span></span></code></pre>`,x1,gu,Un,ui,wf,T3,N3,zp,F3,D3,Bp,O3,R3,P3,Up,I3,L3,mu,z3,B3,_f,U3,j3,jp,q3,G3,w1,yu,Hs,ci,W3,vu,H3,V3,bu,J3,Y3,qp,X3,K3,Z3,_1,NY=`<pre class="shiki  liquid language-c"><code tabindex="0"><span class="line"><span style="color: var(--shiki-token-keyword)">uint32_t</span><span style="color: var(--shiki-color-text)"> flags</span><span style="color: var(--shiki-token-punctuation)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-punctuation)">(</span><span style="color: var(--shiki-color-text)">options</span><span style="color: var(--shiki-token-operator)">-&gt;</span><span style="color: var(--shiki-color-text)">async_page_flip</span><span style="color: var(--shiki-token-punctuation)">)</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-punctuation)">&#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  flags </span><span style="color: var(--shiki-token-keyword)">|=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRM_MODE_PAGE_FLIP_ASYNC</span><span style="color: var(--shiki-token-punctuation)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-punctuation)">&#125;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">else</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-punctuation)">&#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  flags </span><span style="color: var(--shiki-token-keyword)">|=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">DRM_MODE_PAGE_FLIP_EVENT</span><span style="color: var(--shiki-token-punctuation)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-punctuation)">&#125;</span></span>
<span class="line"><span style="color: var(--shiki-token-comment); font-style: italic">// With the DRM legacy API</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">drmModePageFlip</span><span style="color: var(--shiki-token-punctuation)">(</span><span style="color: var(--shiki-token-parameter)">drm.fd</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> drm.crtc_id</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> fb</span><span style="color: var(--shiki-token-operator)">-&gt;</span><span style="color: var(--shiki-color-text)">fb_id</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> flags</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> </span><span style="color: var(--shiki-token-operator)">&amp;</span><span style="color: var(--shiki-color-text)">waiting_for_flip</span><span style="color: var(--shiki-token-punctuation)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-comment); font-style: italic">// Or with the DRM atomic API</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">drmModeAtomicCommit</span><span style="color: var(--shiki-token-punctuation)">(</span><span style="color: var(--shiki-token-parameter)">drm.fd</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> req</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> flags</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-token-parameter)"> </span><span style="color: var(--shiki-token-constant)">NULL</span><span style="color: var(--shiki-token-punctuation)">);</span></span></code></pre>`,E1,Tr,Vs,Ef,Q3,eS,tS,xu,nS,wu,rS,iS,kf,sS,aS,Gp,oS,lS,k1,Za,Js,Qa,Wp,uS,S1,eo,cS,_u,fS,dS,A1,Eu,$1,ku,C1,Su,M1,to,Au,hS,Nr,Hp,pS,gS,Sf,mS,yS,vS,bS,Vp,xS,wS,T1,Af,_S,N1,no,Ys,ro,Jp,ES,F1,Ji,kS,$u,SS,AS,Cu,$S,CS,D1,$f,MS,O1;return n=new ry({props:{src:a5e,alt:"A shader running on the Jetson Nano"}}),El=new II({props:{spec:A5e,options:{actions:!1,renderer:"svg"}}}),Sl=new LI({props:{spec:C5e,options:{actions:!1,renderer:"svg"}}}),Al=new LI({props:{spec:T5e,options:{actions:!1,renderer:"svg"}}}),nu=new ry({props:{src:u5e,alt:"Jetson Nano recovery mode"}}),hu=new ry({props:{src:d5e,alt:"An example of floating precision issue",sizes:zI}}),xu=new ry({props:{src:g5e,alt:"An example of tearing",sizes:zI}}),Eu=new v5e({}),ku=new w5e({}),Su=new k5e({}),Au=new II({props:{spec:F5e,options:{actions:!1,renderer:"svg"}}}),{c(){t=N("figure"),fr(n.$$.fragment),r=V(),i=N("figcaption"),s=M("A "),a=N("a"),o=M("shader"),l=M(" from"),c=M(u),f=V(),d=N("a"),h=M("Shadertoy"),p=M(" running on the Jetson Nano at 26 FPS in Full HD"),g=V(),m=N("p"),y=M("Few years ago, I "),v=N("a"),x=M("experimented"),_=M(" with running OpenGL shaders using the Linux kernel "),w=N("a"),k=M("Direct Rendering Manager"),E=M(", and the "),A=N("a"),z=M("Kernel Mode Setting"),D=M(` API.
I captured the result of this experiment into the `),R=N("a"),j=M("kms-glsl"),O=M(" project, that I’ve used ever since to run my favorite shaders from "),L=N("a"),P=M("Shadertoy"),B=M(`, on the Rapsberry Pi 4.
Unsurprisingly, it quickly became obvious the RPi 4 VideoCore VI GPU would not be capable of rendering complex shaders at decent FPS, nor reasonably scale with display resolution.
It was time for an upgrade!`),U=V(),q=N("h2"),X=N("a"),ae=qe("svg"),fe=qe("path"),we=M("Jetson Nano"),Te=V(),Se=N("p"),je=M(`You could argue I should go for using a desktop computer, with a mid-range graphics card.
And you’d probably be right!
Yet, I have long term goals for the project, that are best met by single board computers.
So I’ve reviewed the SBCs I’ve been able to find, and that are listed hereafter:`),Ln=V(),fn=N("figure"),dn=N("table"),ue=N("thead"),he=N("tr"),ke=N("th"),Z=M("SBC"),dt=V(),Ne=N("th"),gt=M("SoC"),bt=V(),lr=N("th"),tf=M("CPU"),tw=V(),xh=N("th"),nw=M("GPU"),rw=V(),wh=N("th"),iw=M("RAM"),sw=V(),nf=N("th"),aw=M("Price"),_h=N("sup"),ow=M("*"),lw=V(),xt=N("tbody"),hn=N("tr"),Eh=N("td"),dl=N("a"),uw=M("Jetson Nano"),cw=V(),kh=N("td"),fw=M("Tegra X1 T210 TM660M-A2"),dw=V(),Sh=N("td"),hw=M("4x Cortex-A57 @ 1.43GHz"),pw=V(),Ah=N("td"),gw=M("Maxwell 128 CUDA cores @ 921Mhz"),mw=V(),$h=N("td"),yw=M("4GB"),vw=V(),Ch=N("td"),bw=M("$149"),xw=V(),pn=N("tr"),Mh=N("td"),hl=N("a"),ww=M("ODROID-N2L"),_w=V(),Th=N("td"),Ew=M("ARM Amlogic S922X"),kw=V(),Nh=N("td"),Sw=M("4x Cortex-A73 @ 2.2Ghz, 2x Cortex-A53 @ 2Ghz"),Aw=V(),Fh=N("td"),$w=M("Mali-G52 6EE @ 800MHz"),Cw=V(),Dh=N("td"),Mw=M("4GB"),Tw=V(),Oh=N("td"),Nw=M("$130"),Fw=V(),gn=N("tr"),Rh=N("td"),pl=N("a"),Dw=M("Orange Pi 5"),Ow=V(),Ph=N("td"),Rw=M("Rockchip RK3588S"),Pw=V(),Ih=N("td"),Iw=M("4x Cortex-A76 @ 2.4GHz, 4x Cortex-A55 @ 1.8GHz"),Lw=V(),Lh=N("td"),zw=M("Mali-G610 MP4 @ 600MHz"),Bw=V(),zh=N("td"),Uw=M("16GB"),jw=V(),Bh=N("td"),qw=M("$149"),Gw=V(),mn=N("tr"),Uh=N("td"),gl=N("a"),Ww=M("Quartz64B"),Hw=V(),jh=N("td"),Vw=M("Rockchip RK3566"),Jw=V(),qh=N("td"),Yw=M("4x Cortex-A55 @ 1.8GHz"),Xw=V(),Gh=N("td"),Kw=M("Mali-G52 MP2 @ 800MHz"),Zw=V(),Wh=N("td"),Qw=M("8GB"),e_=V(),Hh=N("td"),t_=M("$80"),n_=V(),yn=N("tr"),Vh=N("td"),ml=N("a"),r_=M("ROCK 5A"),i_=V(),Jh=N("td"),s_=M("Rockchip RK3588S"),a_=V(),Yh=N("td"),o_=M("4x Cortex-A76 @ 2.4GHz, 4x Cortex-A55 @ 1.8GHz"),l_=V(),Xh=N("td"),u_=M("Mali-G610 MC4 @ 600MHz"),c_=V(),Kh=N("td"),f_=M("16GB"),d_=V(),Zh=N("td"),h_=M("$170"),p_=V(),vn=N("tr"),Qh=N("td"),yl=N("a"),g_=M("Tinker Board 2"),m_=V(),ep=N("td"),y_=M("Rockchip RK3399"),v_=V(),tp=N("td"),b_=M("2x Cortex-A72 @ 2.0 GHz, 4x Cortex-A53 @ 1.5 GHz"),x_=V(),np=N("td"),w_=M("Mali-T860 MP4 @ 800MHz"),__=V(),rp=N("td"),E_=M("4GB"),k_=V(),ip=N("td"),S_=M("$179"),A_=V(),bn=N("tr"),sp=N("td"),vl=N("a"),$_=M("UDOO BOLT V3"),C_=V(),ap=N("td"),M_=M("AMD Ryzen™ Embedded V1202B"),T_=V(),op=N("td"),N_=M("4x cores @ 2.3GHz (3.2GHz boost)"),F_=V(),lp=N("td"),D_=M("AMD Radeon™ Vega 3 @ 1GHz"),O_=V(),up=N("td"),R_=M("2x SO-DIMM DDR4"),P_=V(),cp=N("td"),I_=M("$437"),L_=V(),xn=N("tr"),fp=N("td"),bl=N("a"),z_=M("UDOO VISION X5"),B_=V(),dp=N("td"),U_=M("Intel® Atom™ x5-E3940"),j_=V(),hp=N("td"),q_=M("4x cores @ 1.6GHz"),G_=V(),pp=N("td"),W_=M("Intel® HD Graphics 500 @ 600MHz"),H_=V(),gp=N("td"),V_=M("4GB"),J_=V(),mp=N("td"),Y_=M("$349"),X_=V(),rf=N("figcaption"),yp=N("sup"),K_=M("*"),Z_=M("Retail prices, as of May 2023, are very volatile, so is availability."),Rm=V(),Mr=N("p"),Q_=M(`Given my primary use case, GPU performance, relative to price, is the main decision criteria.
The following diagram gives the relative differences between these GPUs, for some specifications, like the number of `),xl=N("a"),eE=M("shaders"),tE=M(", "),wl=N("a"),nE=M("FLOP/s"),rE=M(", or "),_l=N("a"),iE=M("pixel fillrate"),sE=M(":"),Pm=V(),fr(El.$$.fragment),Im=V(),Is=N("p"),kl=N("span"),sf=N("span"),aE=M("1"),oE=M("The second metric may be the power efficiency, if you care about electrical consumption. But that’s not yet a real issue for SBCs!"),lE=M("Ultimately, the metric that matters the most for graphical applications is FPS"),af=N("span"),uE=M("1"),cE=M(`, and deriving it from a GPU specifications requires a deep understanding of its architecture.
That led me to searching for some benchmarks, that would help me to practically compare the performance of these GPUs, for the use cases closest to mine.`),Lm=V(),of=N("p"),fE=M(`Publicly available benchmarks usually focus on graphics card GPUs, not GPUs that equip SBCs, nor mobile phones.
Even when they do, they seldomly provide data for all the GPUs listed above.
The results from the few ones I was able to find are illustrated in the diagrams below:`),zm=V(),fr(Sl.$$.fragment),Bm=V(),fr(Al.$$.fragment),Um=V(),oi=N("p"),Ls=N("span"),lf=N("span"),dE=M("2"),hE=M("The Jetson Nano compute module form factor is another advantage, with its 260-pin SODIMM-style System-on-Module (SoM), so it can be used in different contexts, like with the "),$l=N("a"),pE=M("Turing Pi 2"),gE=M("."),mE=M(`I concluded the Jetson Nano would be the best compromise.
While it has inferior FLOP/s and Pixel/s theoretical performance limits than the Orange Pi 5, it provides the greatest number of shaders per price, which is very likely to be the limiting factor for my use case`),uf=N("span"),yE=M("2"),vE=M(`.
Yet, I was still hesitant to spend that amount of money, without any guarantees I’d be able to run `),Cl=N("a"),bE=M("kms-glsl"),xE=M(" on it, nor it’d run orders of magnitude faster than on the Raspberry Pi 4!"),jm=V(),wn=N("p"),Ml=N("span"),cf=N("span"),wE=M("3"),_E=M("NVIDIA has disabled some shading units on the Jetson Nano GPU, to reach 128 shaders, unlike the Nintendo Switch (2017, HAC-001) GPU variant, which has all the 256 shaders enabled."),EE=M("What actually triggered me, is the realisation the Jetson Nano Tegra X1 GPU/SoC is "),Tl=N("a"),kE=M("almost the same"),SE=M(" as the Nintendo Switch one"),ff=N("span"),AE=M("3"),$E=M(`.
At least, it cleared the later concern I had.
So I went on and bought a `),Nl=N("a"),CE=M("Jetson Nano developer kit"),ME=M(", then tried to run "),Fl=N("a"),TE=M("kms-glsl"),NE=M(", and it failed!"),qm=V(),ur=N("p"),Dl=N("span"),df=N("span"),FE=M("4"),DE=M("That is with the DRM-NVDC compatibility library, which implements the Direct Rendering Manager API (DRM), on top of the Tegra Display Controller kernel driver (NVDC)."),OE=M("Out of the box"),hf=N("span"),RE=M("4"),PE=M(`, on the most recent Linux Jetson version, that still supports the Jetson Nano (R32.7.3 as of writing), it fails to initialize GBM.
When switching to the `),Ol=N("a"),IE=M("Tegra DRM driver"),LE=M(", with "),vp=N("code"),zE=M("sudo modprobe tegra-udrm modeset=1"),BE=M(`, it fails to initialize EGL.
It seems NVIDIA hasn’t considered GBM support a priority until recently, and the version of the Tegra DRM driver packaged in Jetson Linux 32 may be too old.`),Gm=V(),zn=N("p"),UE=M("On the other hand, the "),Rl=N("a"),jE=M("OpenEmbedded for Tegra"),qE=M(" project (OE4T) provides "),Pl=N("a"),GE=M("tegra-udrm-gbm"),WE=M(", a wrapper for "),bp=N("code"),HE=M("libnvgbm.so"),VE=M(` to work with Mesa’s GBM backend loader.
So I was set to build my own Linux distribution, with `),Il=N("a"),JE=M("OpenEmbedded for Tegra"),YE=M("! 🚀"),Wm=V(),za=N("h2"),zs=N("a"),Ba=qe("svg"),xp=qe("path"),XE=M("OpenEmbedded for Tegra"),Hm=V(),cr=N("p"),Ll=N("a"),KE=M("OE4T"),ZE=M(" is a community project that provides support for NVIDIA Tegra (Jetson) platforms, on top of "),zl=N("a"),QE=M("OpenEmbedded"),ek=M(`.
It comes with the `),Bl=N("a"),tk=M("meta-tegra"),nk=M(" BSP layer for NVIDIA Jetson platforms, based on L4T, that can be used to build a Linux distribution that includes "),Ul=N("a"),rk=M("tegra-udrm-gbm"),ik=M("."),Vm=V(),Ua=N("h3"),Bs=N("a"),ja=qe("svg"),wp=qe("path"),sk=M("Building the Distribution"),Jm=V(),qa=N("p"),ak=M("After a couple of iterations, I came up with the following instructions, that build a minimal distribution image, which can be used to flash the Jetson Nano, and run "),jl=N("a"),ok=M("kms-glsl"),lk=M(" successfully:"),Ym=V(),Bn=N("ol"),Us=N("li"),ql=N("p"),uk=M("Start a build environment, that contains the toolchain, on your host machine, using a "),Gl=N("a"),ck=M("Poky container"),fk=M(":"),dk=V(),Xm=new jr(!1),Km=V(),Wl=N("p"),hk=M(`It provides an operating system agnostic environment, that can be used on Windows, Mac, or Linux.
If you’re on a native Linux host machine, it’s also possible to `),Hl=N("a"),pk=M("set it up"),gk=M(", to run the build directly on it."),mk=V(),js=N("li"),Vl=N("p"),yk=M("Setup the build, from the "),Jl=N("a"),vk=M("tegra-demo-distro"),bk=M(" reference distributions project:"),xk=V(),Zm=new jr(!1),Qm=V(),Yl=N("p"),wk=M("It’s important to use the "),_p=N("code"),_k=M("kirkstone-l4t-r32.7.x"),Ek=M(" branch, as it’s the latest stable (LTS) branch that supports L4T R32.7.3, and the Jetson Nano."),kk=V(),Xl=N("li"),Ep=N("p"),Sk=M("Update the build configuration, by appending the following changes:"),Ak=V(),e1=new jr(!1),$k=V(),Kl=N("li"),kp=N("p"),Ck=M("Start the build (it may take a while to complete):"),Mk=V(),t1=new jr(!1),Tk=V(),Zl=N("li"),Sp=N("p"),Nk=M("Once completed, you can copy the distribution image into the mounted host directory, and exit the build container:"),Fk=V(),n1=new jr(!1),r1=V(),Ga=N("h3"),qs=N("a"),Wa=qe("svg"),Ap=qe("path"),Dk=M("Flashing the Jetson Nano"),i1=V(),pf=N("p"),Ok=M("The distribution image that you’ve just built, can now be used to flash the Jetson Nano:"),s1=V(),Hi=N("ol"),Ql=N("li"),eu=N("p"),Rk=M("Prepare the Jetson Nano to boot in recovery mode, which can be achieved by shorting pins 3 and 4 (you can find more information in the "),tu=N("a"),Pk=M("Flashing the Jetson Dev Kit"),Ik=M(" guide):"),Lk=V(),fr(nu.$$.fragment),zk=V(),ru=N("li"),$p=N("p"),Bk=M("Connect the Jetson Nano to your host machine via the micro-B USB port, power it up via the 5V jack barrel, and check it’s connected:"),Uk=V(),a1=new jr(!1),jk=V(),iu=N("li"),Cp=N("p"),qk=M("Untar the image archive:"),Gk=V(),o1=new jr(!1),l1=V(),su=N("ol"),au=N("li"),Mp=N("p"),Wk=M("Flash the Jetson Nano:"),Hk=V(),u1=new jr(!1),c1=V(),Ha=N("h3"),Gs=N("a"),Va=qe("svg"),Tp=qe("path"),Vk=M("Compiling and Testing"),f1=V(),Vi=N("p"),Jk=M(`The Jetson Nano will reboot once the flashing has successfully completed.
You can then login as `),Np=N("code"),Yk=M("root"),Xk=M(", and test "),ou=N("a"),Kk=M("kms-glsl"),Zk=M(", by running the following instructions:"),d1=V(),Ja=N("ol"),lu=N("li"),Fp=N("p"),Qk=M("Build the project:"),e3=V(),h1=new jr(!1),t3=V(),uu=N("li"),Dp=N("p"),n3=M("Run an example, e.g.:"),r3=V(),p1=new jr(!1),g1=V(),Ya=N("p"),i3=M("I was quite happy to have "),cu=N("a"),s3=M("kms-glsl"),a3=M(` running on the Jetson Nano.
At least, I had passed the embarrassement of having bought a unit for nothing.
Yet, this was not the end of the journey!`),m1=V(),Xa=N("h2"),Ws=N("a"),Ka=qe("svg"),Op=qe("path"),o3=M("Bugs and Improvements"),y1=V(),gf=N("p"),l3=M("As I gave few sample shaders a try, I quickly noticed some issues:"),v1=V(),mf=N("ol"),fu=N("li"),wt=N("p"),li=N("span"),yf=N("span"),u3=M("5"),c3=M("An example of the floating point precision issue, with this "),du=N("a"),f3=M("shader"),d3=M(" (to be compared with the picture in introduction):"),h3=N("br"),fr(hu.$$.fragment),pu=N("span"),vf=N("span"),p3=M("6"),g3=M("The Raspberry Pi does not seem to take that parameter into account, but the Jetson Nano definitely does!"),m3=M("While some shaders were rendering correctly, others were having weird glitches"),bf=N("span"),y3=M("5"),v3=M(`.
It’s only when I realised the later were performing more higher precision floating point operations than the former, that I figured it out!
The shaders were configured to use the `),Rp=N("code"),b3=M("mediump"),x3=M(" precision, and changing it to "),Pp=N("code"),w3=M("highp"),_3=M(" fixed it"),xf=N("span"),E3=M("6"),k3=M(`.
As some systems do not support `),Ip=N("code"),S3=M("highp"),A3=M(" precision, I changed the shaders setup, to rely on the "),Lp=N("code"),$3=M("GL_FRAGMENT_PRECISION_HIGH"),C3=M(" pre-processor macro:"),M3=V(),b1=new jr(!1),x1=V(),gu=N("ol"),Un=N("li"),ui=N("span"),wf=N("span"),T3=M("7"),N3=M("”"),zp=N("code"),F3=M("drmModePageFlip"),D3=V(),Bp=N("em"),O3=M("does not wait for rendering to complete, nor is future rendering blocked until the flip completes. This differs from KMS based implementations that utilize implicit synchronization."),R3=M("”"),P3=M(`As I got passed that first issue, I noticed some shaders were flickering.
Only those that render at high FPS were affected.
That’s about the only hint I could get.
So I debugged it, and noticed the calls to `),Up=N("code"),I3=M("drmModePageFlip"),L3=M(` were immediately returning, without page had flipped!
I went double check the `),mu=N("a"),z3=M("Jetson Linux DRM API implementation"),B3=M(", which explicitely documents that deviation from the usual behavior"),_f=N("span"),U3=M("7"),j3=M(`.
So the flushing must be done explicitely, which can be achieved by calling `),jp=N("code"),q3=M("glFinish()"),G3=M(`.
This fixed it, and I also double checked it did not impact the rendering on other implementations, e.g., on the Raspberry Pi.`),w1=V(),yu=N("ol"),Hs=N("li"),ci=N("p"),W3=M(`At last, all the shaders were rendering visually OK.
However, the rendering was peaking at 30 FPS for a large proportion.
For the first time since I started experimenting with `),vu=N("a"),H3=M("kms-glsl"),V3=M(`, the limiting factor wasn’t the GPU anymore, it was the display refresh rate!
That led me to `),bu=N("a"),J3=M("add support for async page flipping"),Y3=M(", using the "),qp=N("code"),X3=M("DRM_MODE_PAGE_FLIP_ASYNC"),K3=M(" flag, e.g.:"),Z3=V(),_1=new jr(!1),E1=V(),Tr=N("p"),Vs=N("span"),Ef=N("span"),Q3=M("8"),eS=M("A visible example of tearing:"),tS=N("br"),fr(xu.$$.fragment),nS=M(`While that solved the issue, it comes at the cost of possible on-screen tearing, which can become clearly visible, depending on the nature of the shader.
As the double frame buffers get swapped, asynchronously from the `),wu=N("a"),rS=M("vertical blanking"),iS=M(` period, visual artifacts can result from the display hardware scanning out the new frame buffer.
This is particularly visible for high-contrast vertical lines`),kf=N("span"),sS=M("8"),aS=M(`.
A possible solution would be to implement `),Gp=N("strong"),oS=M("tripple buffering"),lS=M(", so a third frame buffer can immediately be used to render the next frame, while the two others stay locked, until the next vertical blanking period."),k1=V(),Za=N("h2"),Js=N("a"),Qa=qe("svg"),Wp=qe("path"),uS=M("Benchmark"),S1=V(),eo=N("p"),cS=M(`I can finally answer that one question: have I made a good decision to choose the Jetson Nano to achieve my initial goal, i.e., being able to run shaders at faster FPS, and larger display resolution, than on the Raspberry Pi 4?
The following diagram illustrates the distribution of FPS, that I’ve measured for `),_u=N("a"),fS=M("a set of 59 shaders"),dS=M(", running either on the Raspberry Pi 4 or the Jetson Nano, on the same display, at full HD resolution (1920×1080 pixels):"),A1=V(),fr(Eu.$$.fragment),$1=V(),fr(ku.$$.fragment),C1=V(),fr(Su.$$.fragment),M1=V(),to=N("figure"),fr(Au.$$.fragment),hS=V(),Nr=N("figcaption"),Hp=N("sup"),pS=M("+"),gS=M("Over the set of shaders from the project "),Sf=N("a"),mS=M("examples"),yS=M(" directory."),vS=N("br"),bS=M("Async refers to async page flipping, using the "),Vp=N("code"),xS=M("DRM_MODE_PAGE_FLIP_ASYNC"),wS=M(" flag."),T1=V(),Af=N("p"),_S=M(`The Jetson Nano is an order of magnitude faster!
The median gets a 8.5× factor in synchronous pageflip mode, that locks the Jetson Nano to the display refresh rate, and a 11.9× factor in asynchronous pageflip mode.
While 75% of the shaders render under 15 FPS on the Raspberry Pi 4, 75% render above on the Jetson Nano.`),N1=V(),no=N("h2"),Ys=N("a"),ro=qe("svg"),Jp=qe("path"),ES=M("Next"),F1=V(),Ji=N("p"),kS=M("My earlier experimentation, with "),$u=N("a"),SS=M("kms-glsl"),AS=M(` on the Raspberry Pi 4, has always felt more like a toy project, than a practical solution.
Now with the Jetson Nano, I feel like I can move on to the next level, and start building more capable applications.
The Jetson Nano is already 4 years old, and is being superseeded by the `),Cu=N("a"),$S=M("Jetson Orin Nano"),CS=M(`, that raises the bar, in terms of specifications, and price :)
I can’t wait to combine the AI/ML capabilities of the Jetson Nano, to augment the interactivity of OpenGL shaders, for example.
There is so much potential there…`),D1=V(),$f=N("p"),MS=M("Stay tuned!"),this.h()},l($){t=F($,"FIGURE",{class:!0});var re=C(t);dr(n.$$.fragment,re),r=J(re),i=F(re,"FIGCAPTION",{});var io=C(i);s=T(io,"A "),a=F(io,"A",{href:!0});var n7=C(a);o=T(n7,"shader"),n7.forEach(S),l=T(io," from"),c=T(io,u),f=J(io),d=F(io,"A",{href:!0});var r7=C(d);h=T(r7,"Shadertoy"),r7.forEach(S),p=T(io," running on the Jetson Nano at 26 FPS in Full HD"),io.forEach(S),re.forEach(S),g=J($),m=F($,"P",{});var Fr=C(m);y=T(Fr,"Few years ago, I "),v=F(Fr,"A",{href:!0});var i7=C(v);x=T(i7,"experimented"),i7.forEach(S),_=T(Fr," with running OpenGL shaders using the Linux kernel "),w=F(Fr,"A",{href:!0,rel:!0});var s7=C(w);k=T(s7,"Direct Rendering Manager"),s7.forEach(S),E=T(Fr,", and the "),A=F(Fr,"A",{href:!0,rel:!0});var a7=C(A);z=T(a7,"Kernel Mode Setting"),a7.forEach(S),D=T(Fr,` API.
I captured the result of this experiment into the `),R=F(Fr,"A",{href:!0,rel:!0});var o7=C(R);j=T(o7,"kms-glsl"),o7.forEach(S),O=T(Fr," project, that I’ve used ever since to run my favorite shaders from "),L=F(Fr,"A",{href:!0,rel:!0});var l7=C(L);P=T(l7,"Shadertoy"),l7.forEach(S),B=T(Fr,`, on the Rapsberry Pi 4.
Unsurprisingly, it quickly became obvious the RPi 4 VideoCore VI GPU would not be capable of rendering complex shaders at decent FPS, nor reasonably scale with display resolution.
It was time for an upgrade!`),Fr.forEach(S),U=J($),q=F($,"H2",{id:!0});var TS=C(q);X=F(TS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var u7=C(X);ae=Ge(u7,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var c7=C(ae);fe=Ge(c7,"path",{d:!0}),C(fe).forEach(S),c7.forEach(S),u7.forEach(S),we=T(TS,"Jetson Nano"),TS.forEach(S),Te=J($),Se=F($,"P",{});var f7=C(Se);je=T(f7,`You could argue I should go for using a desktop computer, with a mid-range graphics card.
And you’d probably be right!
Yet, I have long term goals for the project, that are best met by single board computers.
So I’ve reviewed the SBCs I’ve been able to find, and that are listed hereafter:`),f7.forEach(S),Ln=J($),fn=F($,"FIGURE",{});var R1=C(fn);dn=F(R1,"TABLE",{});var P1=C(dn);ue=F(P1,"THEAD",{});var d7=C(ue);he=F(d7,"TR",{});var Dr=C(he);ke=F(Dr,"TH",{});var h7=C(ke);Z=T(h7,"SBC"),h7.forEach(S),dt=J(Dr),Ne=F(Dr,"TH",{});var p7=C(Ne);gt=T(p7,"SoC"),p7.forEach(S),bt=J(Dr),lr=F(Dr,"TH",{});var g7=C(lr);tf=T(g7,"CPU"),g7.forEach(S),tw=J(Dr),xh=F(Dr,"TH",{});var m7=C(xh);nw=T(m7,"GPU"),m7.forEach(S),rw=J(Dr),wh=F(Dr,"TH",{});var y7=C(wh);iw=T(y7,"RAM"),y7.forEach(S),sw=J(Dr),nf=F(Dr,"TH",{});var NS=C(nf);aw=T(NS,"Price"),_h=F(NS,"SUP",{});var v7=C(_h);ow=T(v7,"*"),v7.forEach(S),NS.forEach(S),Dr.forEach(S),d7.forEach(S),lw=J(P1),xt=F(P1,"TBODY",{});var Vt=C(xt);hn=F(Vt,"TR",{});var Or=C(hn);Eh=F(Or,"TD",{});var b7=C(Eh);dl=F(b7,"A",{href:!0,rel:!0});var x7=C(dl);uw=T(x7,"Jetson Nano"),x7.forEach(S),b7.forEach(S),cw=J(Or),kh=F(Or,"TD",{});var w7=C(kh);fw=T(w7,"Tegra X1 T210 TM660M-A2"),w7.forEach(S),dw=J(Or),Sh=F(Or,"TD",{});var _7=C(Sh);hw=T(_7,"4x Cortex-A57 @ 1.43GHz"),_7.forEach(S),pw=J(Or),Ah=F(Or,"TD",{});var E7=C(Ah);gw=T(E7,"Maxwell 128 CUDA cores @ 921Mhz"),E7.forEach(S),mw=J(Or),$h=F(Or,"TD",{});var k7=C($h);yw=T(k7,"4GB"),k7.forEach(S),vw=J(Or),Ch=F(Or,"TD",{});var S7=C(Ch);bw=T(S7,"$149"),S7.forEach(S),Or.forEach(S),xw=J(Vt),pn=F(Vt,"TR",{});var Rr=C(pn);Mh=F(Rr,"TD",{});var A7=C(Mh);hl=F(A7,"A",{href:!0,rel:!0});var $7=C(hl);ww=T($7,"ODROID-N2L"),$7.forEach(S),A7.forEach(S),_w=J(Rr),Th=F(Rr,"TD",{});var C7=C(Th);Ew=T(C7,"ARM Amlogic S922X"),C7.forEach(S),kw=J(Rr),Nh=F(Rr,"TD",{});var M7=C(Nh);Sw=T(M7,"4x Cortex-A73 @ 2.2Ghz, 2x Cortex-A53 @ 2Ghz"),M7.forEach(S),Aw=J(Rr),Fh=F(Rr,"TD",{});var T7=C(Fh);$w=T(T7,"Mali-G52 6EE @ 800MHz"),T7.forEach(S),Cw=J(Rr),Dh=F(Rr,"TD",{});var N7=C(Dh);Mw=T(N7,"4GB"),N7.forEach(S),Tw=J(Rr),Oh=F(Rr,"TD",{});var F7=C(Oh);Nw=T(F7,"$130"),F7.forEach(S),Rr.forEach(S),Fw=J(Vt),gn=F(Vt,"TR",{});var Pr=C(gn);Rh=F(Pr,"TD",{});var D7=C(Rh);pl=F(D7,"A",{href:!0,rel:!0});var O7=C(pl);Dw=T(O7,"Orange Pi 5"),O7.forEach(S),D7.forEach(S),Ow=J(Pr),Ph=F(Pr,"TD",{});var R7=C(Ph);Rw=T(R7,"Rockchip RK3588S"),R7.forEach(S),Pw=J(Pr),Ih=F(Pr,"TD",{});var P7=C(Ih);Iw=T(P7,"4x Cortex-A76 @ 2.4GHz, 4x Cortex-A55 @ 1.8GHz"),P7.forEach(S),Lw=J(Pr),Lh=F(Pr,"TD",{});var I7=C(Lh);zw=T(I7,"Mali-G610 MP4 @ 600MHz"),I7.forEach(S),Bw=J(Pr),zh=F(Pr,"TD",{});var L7=C(zh);Uw=T(L7,"16GB"),L7.forEach(S),jw=J(Pr),Bh=F(Pr,"TD",{});var z7=C(Bh);qw=T(z7,"$149"),z7.forEach(S),Pr.forEach(S),Gw=J(Vt),mn=F(Vt,"TR",{});var Ir=C(mn);Uh=F(Ir,"TD",{});var B7=C(Uh);gl=F(B7,"A",{href:!0,rel:!0});var U7=C(gl);Ww=T(U7,"Quartz64B"),U7.forEach(S),B7.forEach(S),Hw=J(Ir),jh=F(Ir,"TD",{});var j7=C(jh);Vw=T(j7,"Rockchip RK3566"),j7.forEach(S),Jw=J(Ir),qh=F(Ir,"TD",{});var q7=C(qh);Yw=T(q7,"4x Cortex-A55 @ 1.8GHz"),q7.forEach(S),Xw=J(Ir),Gh=F(Ir,"TD",{});var G7=C(Gh);Kw=T(G7,"Mali-G52 MP2 @ 800MHz"),G7.forEach(S),Zw=J(Ir),Wh=F(Ir,"TD",{});var W7=C(Wh);Qw=T(W7,"8GB"),W7.forEach(S),e_=J(Ir),Hh=F(Ir,"TD",{});var H7=C(Hh);t_=T(H7,"$80"),H7.forEach(S),Ir.forEach(S),n_=J(Vt),yn=F(Vt,"TR",{});var Lr=C(yn);Vh=F(Lr,"TD",{});var V7=C(Vh);ml=F(V7,"A",{href:!0,rel:!0});var J7=C(ml);r_=T(J7,"ROCK 5A"),J7.forEach(S),V7.forEach(S),i_=J(Lr),Jh=F(Lr,"TD",{});var Y7=C(Jh);s_=T(Y7,"Rockchip RK3588S"),Y7.forEach(S),a_=J(Lr),Yh=F(Lr,"TD",{});var X7=C(Yh);o_=T(X7,"4x Cortex-A76 @ 2.4GHz, 4x Cortex-A55 @ 1.8GHz"),X7.forEach(S),l_=J(Lr),Xh=F(Lr,"TD",{});var K7=C(Xh);u_=T(K7,"Mali-G610 MC4 @ 600MHz"),K7.forEach(S),c_=J(Lr),Kh=F(Lr,"TD",{});var Z7=C(Kh);f_=T(Z7,"16GB"),Z7.forEach(S),d_=J(Lr),Zh=F(Lr,"TD",{});var Q7=C(Zh);h_=T(Q7,"$170"),Q7.forEach(S),Lr.forEach(S),p_=J(Vt),vn=F(Vt,"TR",{});var zr=C(vn);Qh=F(zr,"TD",{});var eT=C(Qh);yl=F(eT,"A",{href:!0,rel:!0});var tT=C(yl);g_=T(tT,"Tinker Board 2"),tT.forEach(S),eT.forEach(S),m_=J(zr),ep=F(zr,"TD",{});var nT=C(ep);y_=T(nT,"Rockchip RK3399"),nT.forEach(S),v_=J(zr),tp=F(zr,"TD",{});var rT=C(tp);b_=T(rT,"2x Cortex-A72 @ 2.0 GHz, 4x Cortex-A53 @ 1.5 GHz"),rT.forEach(S),x_=J(zr),np=F(zr,"TD",{});var iT=C(np);w_=T(iT,"Mali-T860 MP4 @ 800MHz"),iT.forEach(S),__=J(zr),rp=F(zr,"TD",{});var sT=C(rp);E_=T(sT,"4GB"),sT.forEach(S),k_=J(zr),ip=F(zr,"TD",{});var aT=C(ip);S_=T(aT,"$179"),aT.forEach(S),zr.forEach(S),A_=J(Vt),bn=F(Vt,"TR",{});var Br=C(bn);sp=F(Br,"TD",{});var oT=C(sp);vl=F(oT,"A",{href:!0,rel:!0});var lT=C(vl);$_=T(lT,"UDOO BOLT V3"),lT.forEach(S),oT.forEach(S),C_=J(Br),ap=F(Br,"TD",{});var uT=C(ap);M_=T(uT,"AMD Ryzen™ Embedded V1202B"),uT.forEach(S),T_=J(Br),op=F(Br,"TD",{});var cT=C(op);N_=T(cT,"4x cores @ 2.3GHz (3.2GHz boost)"),cT.forEach(S),F_=J(Br),lp=F(Br,"TD",{});var fT=C(lp);D_=T(fT,"AMD Radeon™ Vega 3 @ 1GHz"),fT.forEach(S),O_=J(Br),up=F(Br,"TD",{});var dT=C(up);R_=T(dT,"2x SO-DIMM DDR4"),dT.forEach(S),P_=J(Br),cp=F(Br,"TD",{});var hT=C(cp);I_=T(hT,"$437"),hT.forEach(S),Br.forEach(S),L_=J(Vt),xn=F(Vt,"TR",{});var Ur=C(xn);fp=F(Ur,"TD",{});var pT=C(fp);bl=F(pT,"A",{href:!0,rel:!0});var gT=C(bl);z_=T(gT,"UDOO VISION X5"),gT.forEach(S),pT.forEach(S),B_=J(Ur),dp=F(Ur,"TD",{});var mT=C(dp);U_=T(mT,"Intel® Atom™ x5-E3940"),mT.forEach(S),j_=J(Ur),hp=F(Ur,"TD",{});var yT=C(hp);q_=T(yT,"4x cores @ 1.6GHz"),yT.forEach(S),G_=J(Ur),pp=F(Ur,"TD",{});var vT=C(pp);W_=T(vT,"Intel® HD Graphics 500 @ 600MHz"),vT.forEach(S),H_=J(Ur),gp=F(Ur,"TD",{});var bT=C(gp);V_=T(bT,"4GB"),bT.forEach(S),J_=J(Ur),mp=F(Ur,"TD",{});var xT=C(mp);Y_=T(xT,"$349"),xT.forEach(S),Ur.forEach(S),Vt.forEach(S),P1.forEach(S),X_=J(R1),rf=F(R1,"FIGCAPTION",{});var FS=C(rf);yp=F(FS,"SUP",{});var wT=C(yp);K_=T(wT,"*"),wT.forEach(S),Z_=T(FS,"Retail prices, as of May 2023, are very volatile, so is availability."),FS.forEach(S),R1.forEach(S),Rm=J($),Mr=F($,"P",{});var so=C(Mr);Q_=T(so,`Given my primary use case, GPU performance, relative to price, is the main decision criteria.
The following diagram gives the relative differences between these GPUs, for some specifications, like the number of `),xl=F(so,"A",{href:!0,rel:!0});var _T=C(xl);eE=T(_T,"shaders"),_T.forEach(S),tE=T(so,", "),wl=F(so,"A",{href:!0,rel:!0});var ET=C(wl);nE=T(ET,"FLOP/s"),ET.forEach(S),rE=T(so,", or "),_l=F(so,"A",{href:!0,rel:!0});var kT=C(_l);iE=T(kT,"pixel fillrate"),kT.forEach(S),sE=T(so,":"),so.forEach(S),Pm=J($),dr(El.$$.fragment,$),Im=J($),Is=F($,"P",{});var Yp=C(Is);kl=F(Yp,"SPAN",{class:!0});var DS=C(kl);sf=F(DS,"SPAN",{class:!0});var ST=C(sf);aE=T(ST,"1"),ST.forEach(S),oE=T(DS,"The second metric may be the power efficiency, if you care about electrical consumption. But that’s not yet a real issue for SBCs!"),DS.forEach(S),lE=T(Yp,"Ultimately, the metric that matters the most for graphical applications is FPS"),af=F(Yp,"SPAN",{class:!0});var AT=C(af);uE=T(AT,"1"),AT.forEach(S),cE=T(Yp,`, and deriving it from a GPU specifications requires a deep understanding of its architecture.
That led me to searching for some benchmarks, that would help me to practically compare the performance of these GPUs, for the use cases closest to mine.`),Yp.forEach(S),Lm=J($),of=F($,"P",{});var $T=C(of);fE=T($T,`Publicly available benchmarks usually focus on graphics card GPUs, not GPUs that equip SBCs, nor mobile phones.
Even when they do, they seldomly provide data for all the GPUs listed above.
The results from the few ones I was able to find are illustrated in the diagrams below:`),$T.forEach(S),zm=J($),dr(Sl.$$.fragment,$),Bm=J($),dr(Al.$$.fragment,$),Um=J($),oi=F($,"P",{});var Mu=C(oi);Ls=F(Mu,"SPAN",{class:!0});var Xp=C(Ls);lf=F(Xp,"SPAN",{class:!0});var CT=C(lf);dE=T(CT,"2"),CT.forEach(S),hE=T(Xp,"The Jetson Nano compute module form factor is another advantage, with its 260-pin SODIMM-style System-on-Module (SoM), so it can be used in different contexts, like with the "),$l=F(Xp,"A",{href:!0,rel:!0});var MT=C($l);pE=T(MT,"Turing Pi 2"),MT.forEach(S),gE=T(Xp,"."),Xp.forEach(S),mE=T(Mu,`I concluded the Jetson Nano would be the best compromise.
While it has inferior FLOP/s and Pixel/s theoretical performance limits than the Orange Pi 5, it provides the greatest number of shaders per price, which is very likely to be the limiting factor for my use case`),uf=F(Mu,"SPAN",{class:!0});var TT=C(uf);yE=T(TT,"2"),TT.forEach(S),vE=T(Mu,`.
Yet, I was still hesitant to spend that amount of money, without any guarantees I’d be able to run `),Cl=F(Mu,"A",{href:!0,rel:!0});var NT=C(Cl);bE=T(NT,"kms-glsl"),NT.forEach(S),xE=T(Mu," on it, nor it’d run orders of magnitude faster than on the Raspberry Pi 4!"),Mu.forEach(S),jm=J($),wn=F($,"P",{});var fi=C(wn);Ml=F(fi,"SPAN",{class:!0});var OS=C(Ml);cf=F(OS,"SPAN",{class:!0});var FT=C(cf);wE=T(FT,"3"),FT.forEach(S),_E=T(OS,"NVIDIA has disabled some shading units on the Jetson Nano GPU, to reach 128 shaders, unlike the Nintendo Switch (2017, HAC-001) GPU variant, which has all the 256 shaders enabled."),OS.forEach(S),EE=T(fi,"What actually triggered me, is the realisation the Jetson Nano Tegra X1 GPU/SoC is "),Tl=F(fi,"A",{href:!0,rel:!0});var DT=C(Tl);kE=T(DT,"almost the same"),DT.forEach(S),SE=T(fi," as the Nintendo Switch one"),ff=F(fi,"SPAN",{class:!0});var OT=C(ff);AE=T(OT,"3"),OT.forEach(S),$E=T(fi,`.
At least, it cleared the later concern I had.
So I went on and bought a `),Nl=F(fi,"A",{href:!0,rel:!0});var RT=C(Nl);CE=T(RT,"Jetson Nano developer kit"),RT.forEach(S),ME=T(fi,", then tried to run "),Fl=F(fi,"A",{href:!0,rel:!0});var PT=C(Fl);TE=T(PT,"kms-glsl"),PT.forEach(S),NE=T(fi,", and it failed!"),fi.forEach(S),qm=J($),ur=F($,"P",{});var Xs=C(ur);Dl=F(Xs,"SPAN",{class:!0});var RS=C(Dl);df=F(RS,"SPAN",{class:!0});var IT=C(df);FE=T(IT,"4"),IT.forEach(S),DE=T(RS,"That is with the DRM-NVDC compatibility library, which implements the Direct Rendering Manager API (DRM), on top of the Tegra Display Controller kernel driver (NVDC)."),RS.forEach(S),OE=T(Xs,"Out of the box"),hf=F(Xs,"SPAN",{class:!0});var LT=C(hf);RE=T(LT,"4"),LT.forEach(S),PE=T(Xs,`, on the most recent Linux Jetson version, that still supports the Jetson Nano (R32.7.3 as of writing), it fails to initialize GBM.
When switching to the `),Ol=F(Xs,"A",{href:!0,rel:!0});var zT=C(Ol);IE=T(zT,"Tegra DRM driver"),zT.forEach(S),LE=T(Xs,", with "),vp=F(Xs,"CODE",{});var BT=C(vp);zE=T(BT,"sudo modprobe tegra-udrm modeset=1"),BT.forEach(S),BE=T(Xs,`, it fails to initialize EGL.
It seems NVIDIA hasn’t considered GBM support a priority until recently, and the version of the Tegra DRM driver packaged in Jetson Linux 32 may be too old.`),Xs.forEach(S),Gm=J($),zn=F($,"P",{});var Yi=C(zn);UE=T(Yi,"On the other hand, the "),Rl=F(Yi,"A",{href:!0,rel:!0});var UT=C(Rl);jE=T(UT,"OpenEmbedded for Tegra"),UT.forEach(S),qE=T(Yi," project (OE4T) provides "),Pl=F(Yi,"A",{href:!0,rel:!0});var jT=C(Pl);GE=T(jT,"tegra-udrm-gbm"),jT.forEach(S),WE=T(Yi,", a wrapper for "),bp=F(Yi,"CODE",{});var qT=C(bp);HE=T(qT,"libnvgbm.so"),qT.forEach(S),VE=T(Yi,` to work with Mesa’s GBM backend loader.
So I was set to build my own Linux distribution, with `),Il=F(Yi,"A",{href:!0,rel:!0});var GT=C(Il);JE=T(GT,"OpenEmbedded for Tegra"),GT.forEach(S),YE=T(Yi,"! 🚀"),Yi.forEach(S),Wm=J($),za=F($,"H2",{id:!0});var PS=C(za);zs=F(PS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var WT=C(zs);Ba=Ge(WT,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var HT=C(Ba);xp=Ge(HT,"path",{d:!0}),C(xp).forEach(S),HT.forEach(S),WT.forEach(S),XE=T(PS,"OpenEmbedded for Tegra"),PS.forEach(S),Hm=J($),cr=F($,"P",{});var Ks=C(cr);Ll=F(Ks,"A",{href:!0,rel:!0});var VT=C(Ll);KE=T(VT,"OE4T"),VT.forEach(S),ZE=T(Ks," is a community project that provides support for NVIDIA Tegra (Jetson) platforms, on top of "),zl=F(Ks,"A",{href:!0,rel:!0});var JT=C(zl);QE=T(JT,"OpenEmbedded"),JT.forEach(S),ek=T(Ks,`.
It comes with the `),Bl=F(Ks,"A",{href:!0,rel:!0});var YT=C(Bl);tk=T(YT,"meta-tegra"),YT.forEach(S),nk=T(Ks," BSP layer for NVIDIA Jetson platforms, based on L4T, that can be used to build a Linux distribution that includes "),Ul=F(Ks,"A",{href:!0,rel:!0});var XT=C(Ul);rk=T(XT,"tegra-udrm-gbm"),XT.forEach(S),ik=T(Ks,"."),Ks.forEach(S),Vm=J($),Ua=F($,"H3",{id:!0});var IS=C(Ua);Bs=F(IS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var KT=C(Bs);ja=Ge(KT,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var ZT=C(ja);wp=Ge(ZT,"path",{d:!0}),C(wp).forEach(S),ZT.forEach(S),KT.forEach(S),sk=T(IS,"Building the Distribution"),IS.forEach(S),Jm=J($),qa=F($,"P",{});var I1=C(qa);ak=T(I1,"After a couple of iterations, I came up with the following instructions, that build a minimal distribution image, which can be used to flash the Jetson Nano, and run "),jl=F(I1,"A",{href:!0,rel:!0});var QT=C(jl);ok=T(QT,"kms-glsl"),QT.forEach(S),lk=T(I1," successfully:"),I1.forEach(S),Ym=J($),Bn=F($,"OL",{});var Xi=C(Bn);Us=F(Xi,"LI",{});var Cf=C(Us);ql=F(Cf,"P",{});var L1=C(ql);uk=T(L1,"Start a build environment, that contains the toolchain, on your host machine, using a "),Gl=F(L1,"A",{href:!0,rel:!0});var eN=C(Gl);ck=T(eN,"Poky container"),eN.forEach(S),fk=T(L1,":"),L1.forEach(S),dk=J(Cf),Xm=qr(Cf,!1),Km=J(Cf),Wl=F(Cf,"P",{});var z1=C(Wl);hk=T(z1,`It provides an operating system agnostic environment, that can be used on Windows, Mac, or Linux.
If you’re on a native Linux host machine, it’s also possible to `),Hl=F(z1,"A",{href:!0,rel:!0});var tN=C(Hl);pk=T(tN,"set it up"),tN.forEach(S),gk=T(z1,", to run the build directly on it."),z1.forEach(S),Cf.forEach(S),mk=J(Xi),js=F(Xi,"LI",{});var Mf=C(js);Vl=F(Mf,"P",{});var B1=C(Vl);yk=T(B1,"Setup the build, from the "),Jl=F(B1,"A",{href:!0,rel:!0});var nN=C(Jl);vk=T(nN,"tegra-demo-distro"),nN.forEach(S),bk=T(B1," reference distributions project:"),B1.forEach(S),xk=J(Mf),Zm=qr(Mf,!1),Qm=J(Mf),Yl=F(Mf,"P",{});var U1=C(Yl);wk=T(U1,"It’s important to use the "),_p=F(U1,"CODE",{});var rN=C(_p);_k=T(rN,"kirkstone-l4t-r32.7.x"),rN.forEach(S),Ek=T(U1," branch, as it’s the latest stable (LTS) branch that supports L4T R32.7.3, and the Jetson Nano."),U1.forEach(S),Mf.forEach(S),kk=J(Xi),Xl=F(Xi,"LI",{});var j1=C(Xl);Ep=F(j1,"P",{});var iN=C(Ep);Sk=T(iN,"Update the build configuration, by appending the following changes:"),iN.forEach(S),Ak=J(j1),e1=qr(j1,!1),j1.forEach(S),$k=J(Xi),Kl=F(Xi,"LI",{});var q1=C(Kl);kp=F(q1,"P",{});var sN=C(kp);Ck=T(sN,"Start the build (it may take a while to complete):"),sN.forEach(S),Mk=J(q1),t1=qr(q1,!1),q1.forEach(S),Tk=J(Xi),Zl=F(Xi,"LI",{});var G1=C(Zl);Sp=F(G1,"P",{});var aN=C(Sp);Nk=T(aN,"Once completed, you can copy the distribution image into the mounted host directory, and exit the build container:"),aN.forEach(S),Fk=J(G1),n1=qr(G1,!1),G1.forEach(S),Xi.forEach(S),r1=J($),Ga=F($,"H3",{id:!0});var LS=C(Ga);qs=F(LS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var oN=C(qs);Wa=Ge(oN,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var lN=C(Wa);Ap=Ge(lN,"path",{d:!0}),C(Ap).forEach(S),lN.forEach(S),oN.forEach(S),Dk=T(LS,"Flashing the Jetson Nano"),LS.forEach(S),i1=J($),pf=F($,"P",{});var uN=C(pf);Ok=T(uN,"The distribution image that you’ve just built, can now be used to flash the Jetson Nano:"),uN.forEach(S),s1=J($),Hi=F($,"OL",{});var Tf=C(Hi);Ql=F(Tf,"LI",{});var W1=C(Ql);eu=F(W1,"P",{});var H1=C(eu);Rk=T(H1,"Prepare the Jetson Nano to boot in recovery mode, which can be achieved by shorting pins 3 and 4 (you can find more information in the "),tu=F(H1,"A",{href:!0,rel:!0});var cN=C(tu);Pk=T(cN,"Flashing the Jetson Dev Kit"),cN.forEach(S),Ik=T(H1," guide):"),H1.forEach(S),Lk=J(W1),dr(nu.$$.fragment,W1),W1.forEach(S),zk=J(Tf),ru=F(Tf,"LI",{});var V1=C(ru);$p=F(V1,"P",{});var fN=C($p);Bk=T(fN,"Connect the Jetson Nano to your host machine via the micro-B USB port, power it up via the 5V jack barrel, and check it’s connected:"),fN.forEach(S),Uk=J(V1),a1=qr(V1,!1),V1.forEach(S),jk=J(Tf),iu=F(Tf,"LI",{});var J1=C(iu);Cp=F(J1,"P",{});var dN=C(Cp);qk=T(dN,"Untar the image archive:"),dN.forEach(S),Gk=J(J1),o1=qr(J1,!1),J1.forEach(S),Tf.forEach(S),l1=J($),su=F($,"OL",{start:!0});var hN=C(su);au=F(hN,"LI",{});var Y1=C(au);Mp=F(Y1,"P",{});var pN=C(Mp);Wk=T(pN,"Flash the Jetson Nano:"),pN.forEach(S),Hk=J(Y1),u1=qr(Y1,!1),Y1.forEach(S),hN.forEach(S),c1=J($),Ha=F($,"H3",{id:!0});var zS=C(Ha);Gs=F(zS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var gN=C(Gs);Va=Ge(gN,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var mN=C(Va);Tp=Ge(mN,"path",{d:!0}),C(Tp).forEach(S),mN.forEach(S),gN.forEach(S),Vk=T(zS,"Compiling and Testing"),zS.forEach(S),f1=J($),Vi=F($,"P",{});var Nf=C(Vi);Jk=T(Nf,`The Jetson Nano will reboot once the flashing has successfully completed.
You can then login as `),Np=F(Nf,"CODE",{});var yN=C(Np);Yk=T(yN,"root"),yN.forEach(S),Xk=T(Nf,", and test "),ou=F(Nf,"A",{href:!0,rel:!0});var vN=C(ou);Kk=T(vN,"kms-glsl"),vN.forEach(S),Zk=T(Nf,", by running the following instructions:"),Nf.forEach(S),d1=J($),Ja=F($,"OL",{});var X1=C(Ja);lu=F(X1,"LI",{});var K1=C(lu);Fp=F(K1,"P",{});var bN=C(Fp);Qk=T(bN,"Build the project:"),bN.forEach(S),e3=J(K1),h1=qr(K1,!1),K1.forEach(S),t3=J(X1),uu=F(X1,"LI",{});var Z1=C(uu);Dp=F(Z1,"P",{});var xN=C(Dp);n3=T(xN,"Run an example, e.g.:"),xN.forEach(S),r3=J(Z1),p1=qr(Z1,!1),Z1.forEach(S),X1.forEach(S),g1=J($),Ya=F($,"P",{});var Q1=C(Ya);i3=T(Q1,"I was quite happy to have "),cu=F(Q1,"A",{href:!0,rel:!0});var wN=C(cu);s3=T(wN,"kms-glsl"),wN.forEach(S),a3=T(Q1,` running on the Jetson Nano.
At least, I had passed the embarrassement of having bought a unit for nothing.
Yet, this was not the end of the journey!`),Q1.forEach(S),m1=J($),Xa=F($,"H2",{id:!0});var BS=C(Xa);Ws=F(BS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var _N=C(Ws);Ka=Ge(_N,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var EN=C(Ka);Op=Ge(EN,"path",{d:!0}),C(Op).forEach(S),EN.forEach(S),_N.forEach(S),o3=T(BS,"Bugs and Improvements"),BS.forEach(S),y1=J($),gf=F($,"P",{});var kN=C(gf);l3=T(kN,"As I gave few sample shaders a try, I quickly noticed some issues:"),kN.forEach(S),v1=J($),mf=F($,"OL",{});var SN=C(mf);fu=F(SN,"LI",{});var ey=C(fu);wt=F(ey,"P",{});var Jt=C(wt);li=F(Jt,"SPAN",{class:!0});var Tu=C(li);yf=F(Tu,"SPAN",{class:!0});var AN=C(yf);u3=T(AN,"5"),AN.forEach(S),c3=T(Tu,"An example of the floating point precision issue, with this "),du=F(Tu,"A",{href:!0,rel:!0});var $N=C(du);f3=T($N,"shader"),$N.forEach(S),d3=T(Tu," (to be compared with the picture in introduction):"),h3=F(Tu,"BR",{}),dr(hu.$$.fragment,Tu),Tu.forEach(S),pu=F(Jt,"SPAN",{class:!0});var US=C(pu);vf=F(US,"SPAN",{class:!0});var CN=C(vf);p3=T(CN,"6"),CN.forEach(S),g3=T(US,"The Raspberry Pi does not seem to take that parameter into account, but the Jetson Nano definitely does!"),US.forEach(S),m3=T(Jt,"While some shaders were rendering correctly, others were having weird glitches"),bf=F(Jt,"SPAN",{class:!0});var MN=C(bf);y3=T(MN,"5"),MN.forEach(S),v3=T(Jt,`.
It’s only when I realised the later were performing more higher precision floating point operations than the former, that I figured it out!
The shaders were configured to use the `),Rp=F(Jt,"CODE",{});var TN=C(Rp);b3=T(TN,"mediump"),TN.forEach(S),x3=T(Jt," precision, and changing it to "),Pp=F(Jt,"CODE",{});var NN=C(Pp);w3=T(NN,"highp"),NN.forEach(S),_3=T(Jt," fixed it"),xf=F(Jt,"SPAN",{class:!0});var FN=C(xf);E3=T(FN,"6"),FN.forEach(S),k3=T(Jt,`.
As some systems do not support `),Ip=F(Jt,"CODE",{});var DN=C(Ip);S3=T(DN,"highp"),DN.forEach(S),A3=T(Jt," precision, I changed the shaders setup, to rely on the "),Lp=F(Jt,"CODE",{});var ON=C(Lp);$3=T(ON,"GL_FRAGMENT_PRECISION_HIGH"),ON.forEach(S),C3=T(Jt," pre-processor macro:"),Jt.forEach(S),M3=J(ey),b1=qr(ey,!1),ey.forEach(S),SN.forEach(S),x1=J($),gu=F($,"OL",{start:!0});var RN=C(gu);Un=F(RN,"LI",{});var di=C(Un);ui=F(di,"SPAN",{class:!0});var Nu=C(ui);wf=F(Nu,"SPAN",{class:!0});var PN=C(wf);T3=T(PN,"7"),PN.forEach(S),N3=T(Nu,"”"),zp=F(Nu,"CODE",{});var IN=C(zp);F3=T(IN,"drmModePageFlip"),IN.forEach(S),D3=J(Nu),Bp=F(Nu,"EM",{});var LN=C(Bp);O3=T(LN,"does not wait for rendering to complete, nor is future rendering blocked until the flip completes. This differs from KMS based implementations that utilize implicit synchronization."),LN.forEach(S),R3=T(Nu,"”"),Nu.forEach(S),P3=T(di,`As I got passed that first issue, I noticed some shaders were flickering.
Only those that render at high FPS were affected.
That’s about the only hint I could get.
So I debugged it, and noticed the calls to `),Up=F(di,"CODE",{});var zN=C(Up);I3=T(zN,"drmModePageFlip"),zN.forEach(S),L3=T(di,` were immediately returning, without page had flipped!
I went double check the `),mu=F(di,"A",{href:!0,rel:!0});var BN=C(mu);z3=T(BN,"Jetson Linux DRM API implementation"),BN.forEach(S),B3=T(di,", which explicitely documents that deviation from the usual behavior"),_f=F(di,"SPAN",{class:!0});var UN=C(_f);U3=T(UN,"7"),UN.forEach(S),j3=T(di,`.
So the flushing must be done explicitely, which can be achieved by calling `),jp=F(di,"CODE",{});var jN=C(jp);q3=T(jN,"glFinish()"),jN.forEach(S),G3=T(di,`.
This fixed it, and I also double checked it did not impact the rendering on other implementations, e.g., on the Raspberry Pi.`),di.forEach(S),RN.forEach(S),w1=J($),yu=F($,"OL",{start:!0});var qN=C(yu);Hs=F(qN,"LI",{});var Ff=C(Hs);ci=F(Ff,"P",{});var ao=C(ci);W3=T(ao,`At last, all the shaders were rendering visually OK.
However, the rendering was peaking at 30 FPS for a large proportion.
For the first time since I started experimenting with `),vu=F(ao,"A",{href:!0,rel:!0});var GN=C(vu);H3=T(GN,"kms-glsl"),GN.forEach(S),V3=T(ao,`, the limiting factor wasn’t the GPU anymore, it was the display refresh rate!
That led me to `),bu=F(ao,"A",{href:!0,rel:!0});var WN=C(bu);J3=T(WN,"add support for async page flipping"),WN.forEach(S),Y3=T(ao,", using the "),qp=F(ao,"CODE",{});var HN=C(qp);X3=T(HN,"DRM_MODE_PAGE_FLIP_ASYNC"),HN.forEach(S),K3=T(ao," flag, e.g.:"),ao.forEach(S),Z3=J(Ff),_1=qr(Ff,!1),E1=J(Ff),Tr=F(Ff,"P",{});var Zs=C(Tr);Vs=F(Zs,"SPAN",{class:!0});var Kp=C(Vs);Ef=F(Kp,"SPAN",{class:!0});var VN=C(Ef);Q3=T(VN,"8"),VN.forEach(S),eS=T(Kp,"A visible example of tearing:"),tS=F(Kp,"BR",{}),dr(xu.$$.fragment,Kp),Kp.forEach(S),nS=T(Zs,`While that solved the issue, it comes at the cost of possible on-screen tearing, which can become clearly visible, depending on the nature of the shader.
As the double frame buffers get swapped, asynchronously from the `),wu=F(Zs,"A",{href:!0,rel:!0});var JN=C(wu);rS=T(JN,"vertical blanking"),JN.forEach(S),iS=T(Zs,` period, visual artifacts can result from the display hardware scanning out the new frame buffer.
This is particularly visible for high-contrast vertical lines`),kf=F(Zs,"SPAN",{class:!0});var YN=C(kf);sS=T(YN,"8"),YN.forEach(S),aS=T(Zs,`.
A possible solution would be to implement `),Gp=F(Zs,"STRONG",{});var XN=C(Gp);oS=T(XN,"tripple buffering"),XN.forEach(S),lS=T(Zs,", so a third frame buffer can immediately be used to render the next frame, while the two others stay locked, until the next vertical blanking period."),Zs.forEach(S),Ff.forEach(S),qN.forEach(S),k1=J($),Za=F($,"H2",{id:!0});var jS=C(Za);Js=F(jS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var KN=C(Js);Qa=Ge(KN,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var ZN=C(Qa);Wp=Ge(ZN,"path",{d:!0}),C(Wp).forEach(S),ZN.forEach(S),KN.forEach(S),uS=T(jS,"Benchmark"),jS.forEach(S),S1=J($),eo=F($,"P",{});var ty=C(eo);cS=T(ty,`I can finally answer that one question: have I made a good decision to choose the Jetson Nano to achieve my initial goal, i.e., being able to run shaders at faster FPS, and larger display resolution, than on the Raspberry Pi 4?
The following diagram illustrates the distribution of FPS, that I’ve measured for `),_u=F(ty,"A",{href:!0,rel:!0});var QN=C(_u);fS=T(QN,"a set of 59 shaders"),QN.forEach(S),dS=T(ty,", running either on the Raspberry Pi 4 or the Jetson Nano, on the same display, at full HD resolution (1920×1080 pixels):"),ty.forEach(S),A1=J($),dr(Eu.$$.fragment,$),$1=J($),dr(ku.$$.fragment,$),C1=J($),dr(Su.$$.fragment,$),M1=J($),to=F($,"FIGURE",{});var ny=C(to);dr(Au.$$.fragment,ny),hS=J(ny),Nr=F(ny,"FIGCAPTION",{});var Qs=C(Nr);Hp=F(Qs,"SUP",{});var eF=C(Hp);pS=T(eF,"+"),eF.forEach(S),gS=T(Qs,"Over the set of shaders from the project "),Sf=F(Qs,"A",{href:!0});var tF=C(Sf);mS=T(tF,"examples"),tF.forEach(S),yS=T(Qs," directory."),vS=F(Qs,"BR",{}),bS=T(Qs,"Async refers to async page flipping, using the "),Vp=F(Qs,"CODE",{});var nF=C(Vp);xS=T(nF,"DRM_MODE_PAGE_FLIP_ASYNC"),nF.forEach(S),wS=T(Qs," flag."),Qs.forEach(S),ny.forEach(S),T1=J($),Af=F($,"P",{});var rF=C(Af);_S=T(rF,`The Jetson Nano is an order of magnitude faster!
The median gets a 8.5× factor in synchronous pageflip mode, that locks the Jetson Nano to the display refresh rate, and a 11.9× factor in asynchronous pageflip mode.
While 75% of the shaders render under 15 FPS on the Raspberry Pi 4, 75% render above on the Jetson Nano.`),rF.forEach(S),N1=J($),no=F($,"H2",{id:!0});var qS=C(no);Ys=F(qS,"A",{class:!0,"aria-hidden":!0,tabindex:!0,href:!0});var iF=C(Ys);ro=Ge(iF,"svg",{viewBox:!0,version:!0,"aria-hidden":!0});var sF=C(ro);Jp=Ge(sF,"path",{d:!0}),C(Jp).forEach(S),sF.forEach(S),iF.forEach(S),ES=T(qS,"Next"),qS.forEach(S),F1=J($),Ji=F($,"P",{});var Df=C(Ji);kS=T(Df,"My earlier experimentation, with "),$u=F(Df,"A",{href:!0,rel:!0});var aF=C($u);SS=T(aF,"kms-glsl"),aF.forEach(S),AS=T(Df,` on the Raspberry Pi 4, has always felt more like a toy project, than a practical solution.
Now with the Jetson Nano, I feel like I can move on to the next level, and start building more capable applications.
The Jetson Nano is already 4 years old, and is being superseeded by the `),Cu=F(Df,"A",{href:!0,rel:!0});var oF=C(Cu);$S=T(oF,"Jetson Orin Nano"),oF.forEach(S),CS=T(Df,`, that raises the bar, in terms of specifications, and price :)
I can’t wait to combine the AI/ML capabilities of the Jetson Nano, to augment the interactivity of OpenGL shaders, for example.
There is so much potential there…`),Df.forEach(S),D1=J($),$f=F($,"P",{});var lF=C($f);MS=T(lF,"Stay tuned!"),lF.forEach(S),this.h()},h(){I(a,"href","https://www.shadertoy.com/view/fstyD4"),I(d,"href","https://www.shadertoy.com"),I(t,"class","fullwidth"),I(v,"href","/glsl-raspberry-pi"),I(w,"href","https://docs.kernel.org/gpu/introduction.html"),I(w,"rel","nofollow"),I(A,"href","https://docs.kernel.org/gpu/drm-kms.html"),I(A,"rel","nofollow"),I(R,"href","https://github.com/astefanutti/kms-glsl"),I(R,"rel","nofollow"),I(L,"href","https://www.shadertoy.com"),I(L,"rel","nofollow"),I(fe,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(ae,"viewBox","0 0 16 16"),I(ae,"version","1.1"),I(ae,"aria-hidden","true"),I(X,"class","anchor"),I(X,"aria-hidden","true"),I(X,"tabindex","-1"),I(X,"href","#jetson-nano"),I(q,"id","jetson-nano"),I(dl,"href","https://www.nvidia.com/en-us/autonomous-machines/embedded-systems/jetson-nano/"),I(dl,"rel","nofollow"),I(hl,"href","https://wiki.odroid.com/odroid-n2l/hardware"),I(hl,"rel","nofollow"),I(pl,"href","http://www.orangepi.org/html/hardWare/computerAndMicrocontrollers/details/Orange-Pi-5.html"),I(pl,"rel","nofollow"),I(gl,"href","https://wiki.pine64.org/wiki/Quartz64"),I(gl,"rel","nofollow"),I(ml,"href","https://wiki.radxa.com/Rock5/5a"),I(ml,"rel","nofollow"),I(yl,"href","https://tinker-board.asus.com/product/tinker-board-2.html"),I(yl,"rel","nofollow"),I(vl,"href","https://www.udoo.org/discover-the-udoo-bolt/"),I(vl,"rel","nofollow"),I(bl,"href","https://www.udoo.org/udoo-vision/"),I(bl,"rel","nofollow"),I(xl,"href","https://en.wikipedia.org/wiki/Unified_shader_model"),I(xl,"rel","nofollow"),I(wl,"href","https://en.wikipedia.org/wiki/FLOPS"),I(wl,"rel","nofollow"),I(_l,"href","https://en.wikipedia.org/wiki/Fillrate"),I(_l,"rel","nofollow"),I(sf,"class","sidenote-number"),I(kl,"class","note sidenote"),I(af,"class","sidenote-number"),I(lf,"class","sidenote-number"),I($l,"href","https://turingpi.com/product/turing-pi-2/"),I($l,"rel","nofollow"),I(Ls,"class","note sidenote"),I(uf,"class","sidenote-number"),I(Cl,"href","https://github.com/astefanutti/kms-glsl"),I(Cl,"rel","nofollow"),I(cf,"class","sidenote-number"),I(Ml,"class","note sidenote"),I(Tl,"href","https://en.wikipedia.org/wiki/Tegra#Devices_6"),I(Tl,"rel","nofollow"),I(ff,"class","sidenote-number"),I(Nl,"href","https://developer.nvidia.com/embedded/jetson-nano-developer-kit"),I(Nl,"rel","nofollow"),I(Fl,"href","https://github.com/astefanutti/kms-glsl"),I(Fl,"rel","nofollow"),I(df,"class","sidenote-number"),I(Dl,"class","note sidenote"),I(hf,"class","sidenote-number"),I(Ol,"href","https://www.kernel.org/doc/html/v4.16/gpu/tegra.html"),I(Ol,"rel","nofollow"),I(Rl,"href","https://github.com/OE4T"),I(Rl,"rel","nofollow"),I(Pl,"href","https://github.com/OE4T/tegra-udrm-gbm"),I(Pl,"rel","nofollow"),I(Il,"href","https://github.com/OE4T"),I(Il,"rel","nofollow"),I(xp,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(Ba,"viewBox","0 0 16 16"),I(Ba,"version","1.1"),I(Ba,"aria-hidden","true"),I(zs,"class","anchor"),I(zs,"aria-hidden","true"),I(zs,"tabindex","-1"),I(zs,"href","#openembedded-for-tegra"),I(za,"id","openembedded-for-tegra"),I(Ll,"href","https://github.com/OE4T"),I(Ll,"rel","nofollow"),I(zl,"href","https://www.openembedded.org"),I(zl,"rel","nofollow"),I(Bl,"href","https://github.com/OE4T/meta-tegra"),I(Bl,"rel","nofollow"),I(Ul,"href","https://github.com/OE4T/tegra-udrm-gbm"),I(Ul,"rel","nofollow"),I(wp,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(ja,"viewBox","0 0 16 16"),I(ja,"version","1.1"),I(ja,"aria-hidden","true"),I(Bs,"class","anchor"),I(Bs,"aria-hidden","true"),I(Bs,"tabindex","-1"),I(Bs,"href","#building-the-distribution"),I(Ua,"id","building-the-distribution"),I(jl,"href","https://github.com/astefanutti/kms-glsl"),I(jl,"rel","nofollow"),I(Gl,"href","https://github.com/crops/poky-container"),I(Gl,"rel","nofollow"),Xm.a=Km,I(Hl,"href","https://docs.yoctoproject.org/brief-yoctoprojectqs/index.html"),I(Hl,"rel","nofollow"),I(Jl,"href","https://github.com/OE4T/tegra-demo-distro"),I(Jl,"rel","nofollow"),Zm.a=Qm,e1.a=null,t1.a=null,n1.a=null,I(Ap,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(Wa,"viewBox","0 0 16 16"),I(Wa,"version","1.1"),I(Wa,"aria-hidden","true"),I(qs,"class","anchor"),I(qs,"aria-hidden","true"),I(qs,"tabindex","-1"),I(qs,"href","#flashing-the-jetson-nano"),I(Ga,"id","flashing-the-jetson-nano"),I(tu,"href","https://github.com/OE4T/meta-tegra/wiki/Flashing-the-Jetson-Dev-Kit"),I(tu,"rel","nofollow"),a1.a=null,o1.a=null,u1.a=null,I(su,"start","4"),I(Tp,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(Va,"viewBox","0 0 16 16"),I(Va,"version","1.1"),I(Va,"aria-hidden","true"),I(Gs,"class","anchor"),I(Gs,"aria-hidden","true"),I(Gs,"tabindex","-1"),I(Gs,"href","#compiling-and-testing"),I(Ha,"id","compiling-and-testing"),I(ou,"href","https://github.com/astefanutti/kms-glsl"),I(ou,"rel","nofollow"),h1.a=null,p1.a=null,I(cu,"href","https://github.com/astefanutti/kms-glsl"),I(cu,"rel","nofollow"),I(Op,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(Ka,"viewBox","0 0 16 16"),I(Ka,"version","1.1"),I(Ka,"aria-hidden","true"),I(Ws,"class","anchor"),I(Ws,"aria-hidden","true"),I(Ws,"tabindex","-1"),I(Ws,"href","#bugs-and-improvements"),I(Xa,"id","bugs-and-improvements"),I(yf,"class","sidenote-number"),I(du,"href","https://www.shadertoy.com/view/fstyD4"),I(du,"rel","nofollow"),I(li,"class","note sidenote"),I(vf,"class","sidenote-number"),I(pu,"class","note sidenote"),I(bf,"class","sidenote-number"),I(xf,"class","sidenote-number"),b1.a=null,I(wf,"class","sidenote-number"),I(ui,"class","note sidenote"),I(mu,"href","https://docs.nvidia.com/jetson/l4t-multimedia/group__direct__rendering__manager.html#gaf16a05d5b066b226eb1063e31a364e04"),I(mu,"rel","nofollow"),I(_f,"class","sidenote-number"),I(gu,"start","2"),I(vu,"href","https://github.com/astefanutti/kms-glsl"),I(vu,"rel","nofollow"),I(bu,"href","https://github.com/astefanutti/kms-glsl/pull/14/files"),I(bu,"rel","nofollow"),_1.a=E1,I(Ef,"class","sidenote-number"),I(Vs,"class","note sidenote"),I(wu,"href","https://www.kernel.org/doc/html/v6.3/gpu/drm-kms.html#vertical-blanking"),I(wu,"rel","nofollow"),I(kf,"class","sidenote-number"),I(yu,"start","3"),I(Wp,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(Qa,"viewBox","0 0 16 16"),I(Qa,"version","1.1"),I(Qa,"aria-hidden","true"),I(Js,"class","anchor"),I(Js,"aria-hidden","true"),I(Js,"tabindex","-1"),I(Js,"href","#benchmark"),I(Za,"id","benchmark"),I(_u,"href","https://github.com/astefanutti/kms-glsl/tree/10ce390c7f82e5ba776cc63d95949d011cce7a3a/examples"),I(_u,"rel","nofollow"),I(Sf,"href","https://github.com/astefanutti/kms-glsl/tree/10ce390c7f82e5ba776cc63d95949d011cce7a3a/examples"),I(Jp,"d","m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"),I(ro,"viewBox","0 0 16 16"),I(ro,"version","1.1"),I(ro,"aria-hidden","true"),I(Ys,"class","anchor"),I(Ys,"aria-hidden","true"),I(Ys,"tabindex","-1"),I(Ys,"href","#next"),I(no,"id","next"),I($u,"href","https://github.com/astefanutti/kms-glsl"),I($u,"rel","nofollow"),I(Cu,"href","https://www.nvidia.com/en-us/autonomous-machines/embedded-systems/jetson-orin/"),I(Cu,"rel","nofollow")},m($,re){ie($,t,re),hr(n,t,null),b(t,r),b(t,i),b(i,s),b(i,a),b(a,o),b(i,l),b(i,c),b(i,f),b(i,d),b(d,h),b(i,p),ie($,g,re),ie($,m,re),b(m,y),b(m,v),b(v,x),b(m,_),b(m,w),b(w,k),b(m,E),b(m,A),b(A,z),b(m,D),b(m,R),b(R,j),b(m,O),b(m,L),b(L,P),b(m,B),ie($,U,re),ie($,q,re),b(q,X),b(X,ae),b(ae,fe),b(q,we),ie($,Te,re),ie($,Se,re),b(Se,je),ie($,Ln,re),ie($,fn,re),b(fn,dn),b(dn,ue),b(ue,he),b(he,ke),b(ke,Z),b(he,dt),b(he,Ne),b(Ne,gt),b(he,bt),b(he,lr),b(lr,tf),b(he,tw),b(he,xh),b(xh,nw),b(he,rw),b(he,wh),b(wh,iw),b(he,sw),b(he,nf),b(nf,aw),b(nf,_h),b(_h,ow),b(dn,lw),b(dn,xt),b(xt,hn),b(hn,Eh),b(Eh,dl),b(dl,uw),b(hn,cw),b(hn,kh),b(kh,fw),b(hn,dw),b(hn,Sh),b(Sh,hw),b(hn,pw),b(hn,Ah),b(Ah,gw),b(hn,mw),b(hn,$h),b($h,yw),b(hn,vw),b(hn,Ch),b(Ch,bw),b(xt,xw),b(xt,pn),b(pn,Mh),b(Mh,hl),b(hl,ww),b(pn,_w),b(pn,Th),b(Th,Ew),b(pn,kw),b(pn,Nh),b(Nh,Sw),b(pn,Aw),b(pn,Fh),b(Fh,$w),b(pn,Cw),b(pn,Dh),b(Dh,Mw),b(pn,Tw),b(pn,Oh),b(Oh,Nw),b(xt,Fw),b(xt,gn),b(gn,Rh),b(Rh,pl),b(pl,Dw),b(gn,Ow),b(gn,Ph),b(Ph,Rw),b(gn,Pw),b(gn,Ih),b(Ih,Iw),b(gn,Lw),b(gn,Lh),b(Lh,zw),b(gn,Bw),b(gn,zh),b(zh,Uw),b(gn,jw),b(gn,Bh),b(Bh,qw),b(xt,Gw),b(xt,mn),b(mn,Uh),b(Uh,gl),b(gl,Ww),b(mn,Hw),b(mn,jh),b(jh,Vw),b(mn,Jw),b(mn,qh),b(qh,Yw),b(mn,Xw),b(mn,Gh),b(Gh,Kw),b(mn,Zw),b(mn,Wh),b(Wh,Qw),b(mn,e_),b(mn,Hh),b(Hh,t_),b(xt,n_),b(xt,yn),b(yn,Vh),b(Vh,ml),b(ml,r_),b(yn,i_),b(yn,Jh),b(Jh,s_),b(yn,a_),b(yn,Yh),b(Yh,o_),b(yn,l_),b(yn,Xh),b(Xh,u_),b(yn,c_),b(yn,Kh),b(Kh,f_),b(yn,d_),b(yn,Zh),b(Zh,h_),b(xt,p_),b(xt,vn),b(vn,Qh),b(Qh,yl),b(yl,g_),b(vn,m_),b(vn,ep),b(ep,y_),b(vn,v_),b(vn,tp),b(tp,b_),b(vn,x_),b(vn,np),b(np,w_),b(vn,__),b(vn,rp),b(rp,E_),b(vn,k_),b(vn,ip),b(ip,S_),b(xt,A_),b(xt,bn),b(bn,sp),b(sp,vl),b(vl,$_),b(bn,C_),b(bn,ap),b(ap,M_),b(bn,T_),b(bn,op),b(op,N_),b(bn,F_),b(bn,lp),b(lp,D_),b(bn,O_),b(bn,up),b(up,R_),b(bn,P_),b(bn,cp),b(cp,I_),b(xt,L_),b(xt,xn),b(xn,fp),b(fp,bl),b(bl,z_),b(xn,B_),b(xn,dp),b(dp,U_),b(xn,j_),b(xn,hp),b(hp,q_),b(xn,G_),b(xn,pp),b(pp,W_),b(xn,H_),b(xn,gp),b(gp,V_),b(xn,J_),b(xn,mp),b(mp,Y_),b(fn,X_),b(fn,rf),b(rf,yp),b(yp,K_),b(rf,Z_),ie($,Rm,re),ie($,Mr,re),b(Mr,Q_),b(Mr,xl),b(xl,eE),b(Mr,tE),b(Mr,wl),b(wl,nE),b(Mr,rE),b(Mr,_l),b(_l,iE),b(Mr,sE),ie($,Pm,re),hr(El,$,re),ie($,Im,re),ie($,Is,re),b(Is,kl),b(kl,sf),b(sf,aE),b(kl,oE),b(Is,lE),b(Is,af),b(af,uE),b(Is,cE),ie($,Lm,re),ie($,of,re),b(of,fE),ie($,zm,re),hr(Sl,$,re),ie($,Bm,re),hr(Al,$,re),ie($,Um,re),ie($,oi,re),b(oi,Ls),b(Ls,lf),b(lf,dE),b(Ls,hE),b(Ls,$l),b($l,pE),b(Ls,gE),b(oi,mE),b(oi,uf),b(uf,yE),b(oi,vE),b(oi,Cl),b(Cl,bE),b(oi,xE),ie($,jm,re),ie($,wn,re),b(wn,Ml),b(Ml,cf),b(cf,wE),b(Ml,_E),b(wn,EE),b(wn,Tl),b(Tl,kE),b(wn,SE),b(wn,ff),b(ff,AE),b(wn,$E),b(wn,Nl),b(Nl,CE),b(wn,ME),b(wn,Fl),b(Fl,TE),b(wn,NE),ie($,qm,re),ie($,ur,re),b(ur,Dl),b(Dl,df),b(df,FE),b(Dl,DE),b(ur,OE),b(ur,hf),b(hf,RE),b(ur,PE),b(ur,Ol),b(Ol,IE),b(ur,LE),b(ur,vp),b(vp,zE),b(ur,BE),ie($,Gm,re),ie($,zn,re),b(zn,UE),b(zn,Rl),b(Rl,jE),b(zn,qE),b(zn,Pl),b(Pl,GE),b(zn,WE),b(zn,bp),b(bp,HE),b(zn,VE),b(zn,Il),b(Il,JE),b(zn,YE),ie($,Wm,re),ie($,za,re),b(za,zs),b(zs,Ba),b(Ba,xp),b(za,XE),ie($,Hm,re),ie($,cr,re),b(cr,Ll),b(Ll,KE),b(cr,ZE),b(cr,zl),b(zl,QE),b(cr,ek),b(cr,Bl),b(Bl,tk),b(cr,nk),b(cr,Ul),b(Ul,rk),b(cr,ik),ie($,Vm,re),ie($,Ua,re),b(Ua,Bs),b(Bs,ja),b(ja,wp),b(Ua,sk),ie($,Jm,re),ie($,qa,re),b(qa,ak),b(qa,jl),b(jl,ok),b(qa,lk),ie($,Ym,re),ie($,Bn,re),b(Bn,Us),b(Us,ql),b(ql,uk),b(ql,Gl),b(Gl,ck),b(ql,fk),b(Us,dk),Xm.m(xY,Us),b(Us,Km),b(Us,Wl),b(Wl,hk),b(Wl,Hl),b(Hl,pk),b(Wl,gk),b(Bn,mk),b(Bn,js),b(js,Vl),b(Vl,yk),b(Vl,Jl),b(Jl,vk),b(Vl,bk),b(js,xk),Zm.m(wY,js),b(js,Qm),b(js,Yl),b(Yl,wk),b(Yl,_p),b(_p,_k),b(Yl,Ek),b(Bn,kk),b(Bn,Xl),b(Xl,Ep),b(Ep,Sk),b(Xl,Ak),e1.m(_Y,Xl),b(Bn,$k),b(Bn,Kl),b(Kl,kp),b(kp,Ck),b(Kl,Mk),t1.m(EY,Kl),b(Bn,Tk),b(Bn,Zl),b(Zl,Sp),b(Sp,Nk),b(Zl,Fk),n1.m(kY,Zl),ie($,r1,re),ie($,Ga,re),b(Ga,qs),b(qs,Wa),b(Wa,Ap),b(Ga,Dk),ie($,i1,re),ie($,pf,re),b(pf,Ok),ie($,s1,re),ie($,Hi,re),b(Hi,Ql),b(Ql,eu),b(eu,Rk),b(eu,tu),b(tu,Pk),b(eu,Ik),b(Ql,Lk),hr(nu,Ql,null),b(Hi,zk),b(Hi,ru),b(ru,$p),b($p,Bk),b(ru,Uk),a1.m(SY,ru),b(Hi,jk),b(Hi,iu),b(iu,Cp),b(Cp,qk),b(iu,Gk),o1.m(AY,iu),ie($,l1,re),ie($,su,re),b(su,au),b(au,Mp),b(Mp,Wk),b(au,Hk),u1.m($Y,au),ie($,c1,re),ie($,Ha,re),b(Ha,Gs),b(Gs,Va),b(Va,Tp),b(Ha,Vk),ie($,f1,re),ie($,Vi,re),b(Vi,Jk),b(Vi,Np),b(Np,Yk),b(Vi,Xk),b(Vi,ou),b(ou,Kk),b(Vi,Zk),ie($,d1,re),ie($,Ja,re),b(Ja,lu),b(lu,Fp),b(Fp,Qk),b(lu,e3),h1.m(CY,lu),b(Ja,t3),b(Ja,uu),b(uu,Dp),b(Dp,n3),b(uu,r3),p1.m(MY,uu),ie($,g1,re),ie($,Ya,re),b(Ya,i3),b(Ya,cu),b(cu,s3),b(Ya,a3),ie($,m1,re),ie($,Xa,re),b(Xa,Ws),b(Ws,Ka),b(Ka,Op),b(Xa,o3),ie($,y1,re),ie($,gf,re),b(gf,l3),ie($,v1,re),ie($,mf,re),b(mf,fu),b(fu,wt),b(wt,li),b(li,yf),b(yf,u3),b(li,c3),b(li,du),b(du,f3),b(li,d3),b(li,h3),hr(hu,li,null),b(wt,pu),b(pu,vf),b(vf,p3),b(pu,g3),b(wt,m3),b(wt,bf),b(bf,y3),b(wt,v3),b(wt,Rp),b(Rp,b3),b(wt,x3),b(wt,Pp),b(Pp,w3),b(wt,_3),b(wt,xf),b(xf,E3),b(wt,k3),b(wt,Ip),b(Ip,S3),b(wt,A3),b(wt,Lp),b(Lp,$3),b(wt,C3),b(fu,M3),b1.m(TY,fu),ie($,x1,re),ie($,gu,re),b(gu,Un),b(Un,ui),b(ui,wf),b(wf,T3),b(ui,N3),b(ui,zp),b(zp,F3),b(ui,D3),b(ui,Bp),b(Bp,O3),b(ui,R3),b(Un,P3),b(Un,Up),b(Up,I3),b(Un,L3),b(Un,mu),b(mu,z3),b(Un,B3),b(Un,_f),b(_f,U3),b(Un,j3),b(Un,jp),b(jp,q3),b(Un,G3),ie($,w1,re),ie($,yu,re),b(yu,Hs),b(Hs,ci),b(ci,W3),b(ci,vu),b(vu,H3),b(ci,V3),b(ci,bu),b(bu,J3),b(ci,Y3),b(ci,qp),b(qp,X3),b(ci,K3),b(Hs,Z3),_1.m(NY,Hs),b(Hs,E1),b(Hs,Tr),b(Tr,Vs),b(Vs,Ef),b(Ef,Q3),b(Vs,eS),b(Vs,tS),hr(xu,Vs,null),b(Tr,nS),b(Tr,wu),b(wu,rS),b(Tr,iS),b(Tr,kf),b(kf,sS),b(Tr,aS),b(Tr,Gp),b(Gp,oS),b(Tr,lS),ie($,k1,re),ie($,Za,re),b(Za,Js),b(Js,Qa),b(Qa,Wp),b(Za,uS),ie($,S1,re),ie($,eo,re),b(eo,cS),b(eo,_u),b(_u,fS),b(eo,dS),ie($,A1,re),hr(Eu,$,re),ie($,$1,re),hr(ku,$,re),ie($,C1,re),hr(Su,$,re),ie($,M1,re),ie($,to,re),hr(Au,to,null),b(to,hS),b(to,Nr),b(Nr,Hp),b(Hp,pS),b(Nr,gS),b(Nr,Sf),b(Sf,mS),b(Nr,yS),b(Nr,vS),b(Nr,bS),b(Nr,Vp),b(Vp,xS),b(Nr,wS),ie($,T1,re),ie($,Af,re),b(Af,_S),ie($,N1,re),ie($,no,re),b(no,Ys),b(Ys,ro),b(ro,Jp),b(no,ES),ie($,F1,re),ie($,Ji,re),b(Ji,kS),b(Ji,$u),b($u,SS),b(Ji,AS),b(Ji,Cu),b(Cu,$S),b(Ji,CS),ie($,D1,re),ie($,$f,re),b($f,MS),O1=!0},p:us,i($){O1||(pr(n.$$.fragment,$),pr(El.$$.fragment,$),pr(Sl.$$.fragment,$),pr(Al.$$.fragment,$),pr(nu.$$.fragment,$),pr(hu.$$.fragment,$),pr(xu.$$.fragment,$),pr(Eu.$$.fragment,$),pr(ku.$$.fragment,$),pr(Su.$$.fragment,$),pr(Au.$$.fragment,$),O1=!0)},o($){gr(n.$$.fragment,$),gr(El.$$.fragment,$),gr(Sl.$$.fragment,$),gr(Al.$$.fragment,$),gr(nu.$$.fragment,$),gr(hu.$$.fragment,$),gr(xu.$$.fragment,$),gr(Eu.$$.fragment,$),gr(ku.$$.fragment,$),gr(Su.$$.fragment,$),gr(Au.$$.fragment,$),O1=!1},d($){$&&S(t),mr(n),$&&S(g),$&&S(m),$&&S(U),$&&S(q),$&&S(Te),$&&S(Se),$&&S(Ln),$&&S(fn),$&&S(Rm),$&&S(Mr),$&&S(Pm),mr(El,$),$&&S(Im),$&&S(Is),$&&S(Lm),$&&S(of),$&&S(zm),mr(Sl,$),$&&S(Bm),mr(Al,$),$&&S(Um),$&&S(oi),$&&S(jm),$&&S(wn),$&&S(qm),$&&S(ur),$&&S(Gm),$&&S(zn),$&&S(Wm),$&&S(za),$&&S(Hm),$&&S(cr),$&&S(Vm),$&&S(Ua),$&&S(Jm),$&&S(qa),$&&S(Ym),$&&S(Bn),$&&S(r1),$&&S(Ga),$&&S(i1),$&&S(pf),$&&S(s1),$&&S(Hi),mr(nu),$&&S(l1),$&&S(su),$&&S(c1),$&&S(Ha),$&&S(f1),$&&S(Vi),$&&S(d1),$&&S(Ja),$&&S(g1),$&&S(Ya),$&&S(m1),$&&S(Xa),$&&S(y1),$&&S(gf),$&&S(v1),$&&S(mf),mr(hu),$&&S(x1),$&&S(gu),$&&S(w1),$&&S(yu),mr(xu),$&&S(k1),$&&S(Za),$&&S(S1),$&&S(eo),$&&S(A1),mr(Eu,$),$&&S($1),mr(ku,$),$&&S(C1),mr(Su,$),$&&S(M1),$&&S(to),mr(Au),$&&S(T1),$&&S(Af),$&&S(N1),$&&S(no),$&&S(F1),$&&S(Ji),$&&S(D1),$&&S($f)}}}const wAe={title:"Running OpenGL Shaders on the Jetson Nano",date:"2023-06-12T00:00:00.000Z",published:!0,slug:"glsl-jetson-nano",tags:["OpenGL","Jetson Nano"]},zI="(max-width: calc(1.4 * 800px)) 25vw, 400px";class _Ae extends Pc{constructor(t){super(),Ic(this,t,null,D5e,Lc,{})}}export{_Ae as default,wAe as metadata};
